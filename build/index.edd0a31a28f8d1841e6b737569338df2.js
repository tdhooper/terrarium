!function r(i,o,a){function s(t,e){if(!o[t]){if(!i[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(c)return c(t,!0);throw(e=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",e}n=o[t]={exports:{}},i[t][0].call(n.exports,function(e){return s(i[t][1][e]||e)},n,n.exports,r,i,o,a)}return o[t].exports}for(var c="function"==typeof require&&require,e=0;e<a.length;e++)s(a[e]);return s}({1:[function(e,t,n){e("babel-polyfill"),e("what-input");new(e("./src/main"))},{"./src/main":432,"babel-polyfill":4,"what-input":410}],2:[function(e,i,o){!function(n){!function(){function e(){this._tweens={},this._tweensAddedDuringUpdate={}}e.prototype={getAll:function(){return Object.keys(this._tweens).map(function(e){return this._tweens[e]}.bind(this))},removeAll:function(){this._tweens={}},add:function(e){this._tweens[e.getId()]=e,this._tweensAddedDuringUpdate[e.getId()]=e},remove:function(e){delete this._tweens[e.getId()],delete this._tweensAddedDuringUpdate[e.getId()]},update:function(e,t){var n=Object.keys(this._tweens);if(0===n.length)return!1;for(e=void 0!==e?e:s.now();0<n.length;){this._tweensAddedDuringUpdate={};for(var r=0;r<n.length;r++){var i=this._tweens[n[r]];i&&!1===i.update(e)&&(i._isPlaying=!1,t||delete this._tweens[n[r]])}n=Object.keys(this._tweensAddedDuringUpdate)}return!0}};var r,t,s=new e;s.Group=e,s._nextId=0,s.nextId=function(){return s._nextId++},"undefined"==typeof window&&void 0!==n?s.now=function(){var e=n.hrtime();return 1e3*e[0]+e[1]/1e6}:"undefined"!=typeof window&&void 0!==window.performance&&void 0!==window.performance.now?s.now=window.performance.now.bind(window.performance):void 0!==Date.now?s.now=Date.now:s.now=function(){return(new Date).getTime()},s.Tween=function(e,t){this._object=e,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._repeat=0,this._repeatDelayTime=void 0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=null,this._easingFunction=s.Easing.Linear.None,this._interpolationFunction=s.Interpolation.Linear,this._chainedTweens=[],this._onStartCallback=null,this._onStartCallbackFired=!1,this._onUpdateCallback=null,this._onCompleteCallback=null,this._onStopCallback=null,this._group=t||s,this._id=s.nextId()},s.Tween.prototype={getId:function(){return this._id},isPlaying:function(){return this._isPlaying},to:function(e,t){return this._valuesEnd=e,void 0!==t&&(this._duration=t),this},start:function(e){for(var t in this._group.add(this),this._isPlaying=!0,this._onStartCallbackFired=!1,this._startTime=void 0!==e?"string"==typeof e?s.now()+parseFloat(e):e:s.now(),this._startTime+=this._delayTime,this._valuesEnd){if(this._valuesEnd[t]instanceof Array){if(0===this._valuesEnd[t].length)continue;this._valuesEnd[t]=[this._object[t]].concat(this._valuesEnd[t])}void 0!==this._object[t]&&(this._valuesStart[t]=this._object[t],this._valuesStart[t]instanceof Array==!1&&(this._valuesStart[t]*=1),this._valuesStartRepeat[t]=this._valuesStart[t]||0)}return this},stop:function(){return this._isPlaying&&(this._group.remove(this),this._isPlaying=!1,null!==this._onStopCallback&&this._onStopCallback(this._object),this.stopChainedTweens()),this},end:function(){return this.update(this._startTime+this._duration),this},stopChainedTweens:function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop()},delay:function(e){return this._delayTime=e,this},repeat:function(e){return this._repeat=e,this},repeatDelay:function(e){return this._repeatDelayTime=e,this},yoyo:function(e){return this._yoyo=e,this},easing:function(e){return this._easingFunction=e,this},interpolation:function(e){return this._interpolationFunction=e,this},chain:function(){return this._chainedTweens=arguments,this},onStart:function(e){return this._onStartCallback=e,this},onUpdate:function(e){return this._onUpdateCallback=e,this},onComplete:function(e){return this._onCompleteCallback=e,this},onStop:function(e){return this._onStopCallback=e,this},update:function(e){var t,n,r,i,o,a;if(e<this._startTime)return!0;for(t in!1===this._onStartCallbackFired&&(null!==this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),n=(e-this._startTime)/this._duration,r=this._easingFunction(n=1<n?1:n),this._valuesEnd)void 0!==this._valuesStart[t]&&(i=this._valuesStart[t]||0,(o=this._valuesEnd[t])instanceof Array?this._object[t]=this._interpolationFunction(o,r):"number"==typeof(o="string"==typeof o?"+"===o.charAt(0)||"-"===o.charAt(0)?i+parseFloat(o):parseFloat(o):o)&&(this._object[t]=i+(o-i)*r));if(null!==this._onUpdateCallback&&this._onUpdateCallback(this._object,r),1!=n)return!0;if(0<this._repeat){for(t in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat)"string"==typeof this._valuesEnd[t]&&(this._valuesStartRepeat[t]=this._valuesStartRepeat[t]+parseFloat(this._valuesEnd[t])),this._yoyo&&(a=this._valuesStartRepeat[t],this._valuesStartRepeat[t]=this._valuesEnd[t],this._valuesEnd[t]=a),this._valuesStart[t]=this._valuesStartRepeat[t];return this._yoyo&&(this._reversed=!this._reversed),void 0!==this._repeatDelayTime?this._startTime=e+this._repeatDelayTime:this._startTime=e+this._delayTime,!0}null!==this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var s=0,c=this._chainedTweens.length;s<c;s++)this._chainedTweens[s].start(this._startTime+this._duration);return!1}},s.Easing={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}},Quartic:{In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}},Quintic:{In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}},Sinusoidal:{In:function(e){return 1-Math.cos(e*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.cos(Math.PI*e))}},Exponential:{In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))}},Circular:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}},Elastic:{In:function(e){return 0===e?0:1===e?1:-Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)},Out:function(e){return 0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin(5*(e-.1)*Math.PI)+1},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?-.5*Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI):.5*Math.pow(2,-10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)+1}},Back:{In:function(e){return e*e*(2.70158*e-1.70158)},Out:function(e){return--e*e*(2.70158*e+1.70158)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?e*e*((1+t)*e-t)*.5:.5*((e-=2)*e*((1+t)*e+t)+2)}},Bounce:{In:function(e){return 1-s.Easing.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return e<.5?.5*s.Easing.Bounce.In(2*e):.5*s.Easing.Bounce.Out(2*e-1)+.5}}},s.Interpolation={Linear:function(e,t){var n=e.length-1,r=n*t,i=Math.floor(r),o=s.Interpolation.Utils.Linear;return t<0?o(e[0],e[1],r):1<t?o(e[n],e[n-1],n-r):o(e[i],e[n<i+1?n:i+1],r-i)},Bezier:function(e,t){for(var n=0,r=e.length-1,i=Math.pow,o=s.Interpolation.Utils.Bernstein,a=0;a<=r;a++)n+=i(1-t,r-a)*i(t,a)*e[a]*o(r,a);return n},CatmullRom:function(e,t){var n=e.length-1,r=n*t,i=Math.floor(r),o=s.Interpolation.Utils.CatmullRom;return e[0]===e[n]?o(e[((i=t<0?Math.floor(r=n*(1+t)):i)-1+n)%n],e[i],e[(i+1)%n],e[(i+2)%n],r-i):t<0?e[0]-(o(e[0],e[0],e[1],e[1],-r)-e[0]):1<t?e[n]-(o(e[n],e[n],e[n-1],e[n-1],r-n)-e[n]):o(e[i?i-1:0],e[i],e[n<i+1?n:i+1],e[n<i+2?n:i+2],r-i)},Utils:{Linear:function(e,t,n){return(t-e)*n+e},Bernstein:function(e,t){var n=s.Interpolation.Utils.Factorial;return n(e)/n(t)/n(e-t)},Factorial:(r=[1],function(e){var t=1;if(r[e])return r[e];for(var n=e;1<n;n--)t*=n;return r[e]=t}),CatmullRom:function(e,t,n,r,i){var e=.5*(n-e),r=.5*(r-t),o=i*i;return(2*t-2*n+e+r)*(i*o)+(-3*t+3*n-2*e-r)*o+e*i+t}}},t=this,"function"==typeof define&&define.amd?define([],function(){return s}):void 0!==i&&"object"==typeof o?i.exports=s:void 0!==t&&(t.TWEEN=s)}.call(this)}.call(this,e("_process"))},{_process:404}],3:[function(e,t,n){t.exports=function(m){var f=function(e){var t,n,r,i,o,a,s,c=[];if(e instanceof m.Geometry)this.matrix=new m.Matrix4;else{if(!(e instanceof m.Mesh)){if(e instanceof f.Node)return this.tree=e,this.matrix=new m.Matrix4,this;throw"ThreeBSP: Given geometry is unsupported"}e.updateMatrix(),this.matrix=e.matrix.clone(),e=e.geometry}for(t=0,n=e.faces.length;t<n;t++)r=e.faces[t],o=e.faceVertexUvs[0][t],s=new f.Polygon,(i=r instanceof m.Face3?(i=e.vertices[r.a],a=o?new m.Vector2(o[0].x,o[0].y):null,(i=new f.Vertex(i.x,i.y,i.z,r.vertexNormals[0],a)).applyMatrix4(this.matrix),s.vertices.push(i),i=e.vertices[r.b],a=o?new m.Vector2(o[1].x,o[1].y):null,(i=new f.Vertex(i.x,i.y,i.z,r.vertexNormals[1],a)).applyMatrix4(this.matrix),s.vertices.push(i),i=e.vertices[r.c],a=o?new m.Vector2(o[2].x,o[2].y):null,new f.Vertex(i.x,i.y,i.z,r.vertexNormals[2],a)):(m.Face4,i=e.vertices[r.a],a=o?new m.Vector2(o[0].x,o[0].y):null,(i=new f.Vertex(i.x,i.y,i.z,r.vertexNormals[0],a)).applyMatrix4(this.matrix),s.vertices.push(i),i=e.vertices[r.b],a=o?new m.Vector2(o[1].x,o[1].y):null,(i=new f.Vertex(i.x,i.y,i.z,r.vertexNormals[1],a)).applyMatrix4(this.matrix),s.vertices.push(i),i=e.vertices[r.c],a=o?new m.Vector2(o[2].x,o[2].y):null,(i=new f.Vertex(i.x,i.y,i.z,r.vertexNormals[2],a)).applyMatrix4(this.matrix),s.vertices.push(i),i=e.vertices[r.d],a=o?new m.Vector2(o[3].x,o[3].y):null,new f.Vertex(i.x,i.y,i.z,r.vertexNormals[3],a))).applyMatrix4(this.matrix),s.vertices.push(i),s.calculateProperties(),c.push(s);this.tree=new f.Node(c)};return f.prototype.subtract=function(e){var t=this.tree.clone(),e=e.tree.clone();return t.invert(),t.clipTo(e),e.clipTo(t),e.invert(),e.clipTo(t),e.invert(),t.build(e.allPolygons()),t.invert(),(t=new f(t)).matrix=this.matrix,t},f.prototype.union=function(e){var t=this.tree.clone(),e=e.tree.clone();return t.clipTo(e),e.clipTo(t),e.invert(),e.clipTo(t),e.invert(),t.build(e.allPolygons()),(t=new f(t)).matrix=this.matrix,t},f.prototype.intersect=function(e){var t=this.tree.clone(),e=e.tree.clone();return t.invert(),e.clipTo(t),e.invert(),t.clipTo(e),e.clipTo(t),t.build(e.allPolygons()),t.invert(),(t=new f(t)).matrix=this.matrix,t},f.prototype.toGeometry=function(){for(var e,t,n,r,i,o,a,s,c,l=(new m.Matrix4).getInverse(this.matrix),u=new m.Geometry,h=this.tree.allPolygons(),d=h.length,p={},f=0;f<d;f++)for(n=(t=h[f]).vertices.length,e=2;e<n;e++)c=[],o=t.vertices[0],(a=[]).push(new m.Vector2(o.uv.x,o.uv.y)),s=new m.Vector3(o.normal.x,o.normal.y,o.normal.z),(o=new m.Vector3(o.x,o.y,o.z)).applyMatrix4(l),s.applyMatrix4(l),c.push(s),r=void 0!==p[o.x+","+o.y+","+o.z]?p[o.x+","+o.y+","+o.z]:(u.vertices.push(o),p[o.x+","+o.y+","+o.z]=u.vertices.length-1),o=t.vertices[e-1],a.push(new m.Vector2(o.uv.x,o.uv.y)),s=new m.Vector3(o.normal.x,o.normal.y,o.normal.z),(o=new m.Vector3(o.x,o.y,o.z)).applyMatrix4(l),s.applyMatrix4(l),c.push(s),i=void 0!==p[o.x+","+o.y+","+o.z]?p[o.x+","+o.y+","+o.z]:(u.vertices.push(o),p[o.x+","+o.y+","+o.z]=u.vertices.length-1),o=t.vertices[e],a.push(new m.Vector2(o.uv.x,o.uv.y)),s=new m.Vector3(o.normal.x,o.normal.y,o.normal.z),(o=new m.Vector3(o.x,o.y,o.z)).applyMatrix4(l),s.applyMatrix4(l),c.push(s),s=void 0!==p[o.x+","+o.y+","+o.z]?p[o.x+","+o.y+","+o.z]:(u.vertices.push(o),p[o.x+","+o.y+","+o.z]=u.vertices.length-1),o=new m.Face3(r,i,s,c),u.faces.push(o),u.faceVertexUvs[0].push(a);return u},f.prototype.toMesh=function(e){var t=this.toGeometry(),t=new m.Mesh(t,e);return t.position.setFromMatrixPosition(this.matrix),t.rotation.setFromRotationMatrix(this.matrix),t},(f.Polygon=function(e,t,n){e instanceof Array||(e=[]),0<(this.vertices=e).length?this.calculateProperties():this.normal=this.w=void 0}).prototype.calculateProperties=function(){var e=this.vertices[0],t=this.vertices[1],n=this.vertices[2];return this.normal=t.clone().subtract(e).cross(n.clone().subtract(e)).normalize(),this.w=this.normal.clone().dot(e),this},f.Polygon.prototype.clone=function(){for(var e=new f.Polygon,t=0,n=this.vertices.length;t<n;t++)e.vertices.push(this.vertices[t].clone());return e.calculateProperties(),e},f.Polygon.prototype.flip=function(){var e,t=[];for(this.normal.multiplyScalar(-1),this.w*=-1,e=this.vertices.length-1;0<=e;e--)t.push(this.vertices[e]);return this.vertices=t,this},f.Polygon.prototype.classifyVertex=function(e){e=this.normal.dot(e)-this.w;return e<-1e-5?2:1e-5<e?1:0},f.Polygon.prototype.classifySide=function(e){for(var t,n=0,r=0,i=e.vertices.length,o=0;o<i;o++)t=e.vertices[o],1===(t=this.classifyVertex(t))?n++:2===t&&r++;return 0<n&&0===r?1:0===n&&0<r?2:0===n&&0===r?0:3},f.Polygon.prototype.splitPolygon=function(e,t,n,r,i){var o=this.classifySide(e);if(0===o)(0<this.normal.dot(e.normal)?t:n).push(e);else if(1===o)r.push(e);else if(2===o)i.push(e);else{for(var a,s,c,l,u=[],h=[],d=0,p=e.vertices.length;d<p;d++)a=e.vertices[d],s=e.vertices[(d+1)%p],c=this.classifyVertex(a),l=this.classifyVertex(s),2!=c&&u.push(a),1!=c&&h.push(a),3==(c|l)&&(c=(this.w-this.normal.dot(a))/this.normal.dot(s.clone().subtract(a)),l=a.interpolate(s,c),u.push(l),h.push(l));3<=u.length&&r.push(new f.Polygon(u).calculateProperties()),3<=h.length&&i.push(new f.Polygon(h).calculateProperties())}},(f.Vertex=function(e,t,n,r,i){this.x=e,this.y=t,this.z=n,this.normal=r||new m.Vector3,this.uv=i||new m.Vector2}).prototype.clone=function(){return new f.Vertex(this.x,this.y,this.z,this.normal.clone(),this.uv.clone())},f.Vertex.prototype.add=function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this},f.Vertex.prototype.subtract=function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this},f.Vertex.prototype.multiplyScalar=function(e){return this.x*=e,this.y*=e,this.z*=e,this},f.Vertex.prototype.cross=function(e){var t=this.x,n=this.y,r=this.z;return this.x=n*e.z-r*e.y,this.y=r*e.x-t*e.z,this.z=t*e.y-n*e.x,this},f.Vertex.prototype.normalize=function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);return this.x/=e,this.y/=e,this.z/=e,this},f.Vertex.prototype.dot=function(e){return this.x*e.x+this.y*e.y+this.z*e.z},f.Vertex.prototype.lerp=function(e,t){return this.add(e.clone().subtract(this).multiplyScalar(t)),this.normal.add(e.normal.clone().sub(this.normal).multiplyScalar(t)),this.uv.add(e.uv.clone().sub(this.uv).multiplyScalar(t)),this},f.Vertex.prototype.interpolate=function(e,t){return this.clone().lerp(e,t)},f.Vertex.prototype.applyMatrix4=function(e){var t=this.x,n=this.y,r=this.z,e=e.elements;return this.x=e[0]*t+e[4]*n+e[8]*r+e[12],this.y=e[1]*t+e[5]*n+e[9]*r+e[13],this.z=e[2]*t+e[6]*n+e[10]*r+e[14],this},(f.Node=function(e){var t,n,r=[],i=[];if(this.polygons=[],this.front=this.back=void 0,e instanceof Array&&0!==e.length){for(this.divider=e[0].clone(),t=0,n=e.length;t<n;t++)this.divider.splitPolygon(e[t],this.polygons,this.polygons,r,i);0<r.length&&(this.front=new f.Node(r)),0<i.length&&(this.back=new f.Node(i))}}).isConvex=function(e){for(var t,n=0;n<e.length;n++)for(t=0;t<e.length;t++)if(n!==t&&2!==e[n].classifySide(e[t]))return!1;return!0},f.Node.prototype.build=function(e){var t,n,r=[],i=[];for(this.divider||(this.divider=e[0].clone()),t=0,n=e.length;t<n;t++)this.divider.splitPolygon(e[t],this.polygons,this.polygons,r,i);0<r.length&&(this.front||(this.front=new f.Node),this.front.build(r)),0<i.length&&(this.back||(this.back=new f.Node),this.back.build(i))},f.Node.prototype.allPolygons=function(){var e=this.polygons.slice();return this.front&&(e=e.concat(this.front.allPolygons())),e=this.back?e.concat(this.back.allPolygons()):e},f.Node.prototype.clone=function(){var e=new f.Node;return e.divider=this.divider.clone(),e.polygons=this.polygons.map(function(e){return e.clone()}),e.front=this.front&&this.front.clone(),e.back=this.back&&this.back.clone(),e},f.Node.prototype.invert=function(){for(var e,t=0,n=this.polygons.length;t<n;t++)this.polygons[t].flip();return this.divider.flip(),this.front&&this.front.invert(),this.back&&this.back.invert(),e=this.front,this.front=this.back,this.back=e,this},f.Node.prototype.clipPolygons=function(e){var t,n,r,i;if(!this.divider)return e.slice();for(r=[],i=[],t=0,n=e.length;t<n;t++)this.divider.splitPolygon(e[t],r,i,r,i);return this.front&&(r=this.front.clipPolygons(r)),i=this.back?this.back.clipPolygons(i):[],r.concat(i)},f.Node.prototype.clipTo=function(e){this.polygons=e.clipPolygons(this.polygons),this.front&&this.front.clipTo(e),this.back&&this.back.clipTo(e)},f}},{}],4:[function(n,e,t){!function(e){!function(){if(n("core-js/shim"),n("regenerator-runtime/runtime"),n("core-js/fn/regexp/escape"),e._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");e._babelPolyfill=!0;function t(e,t,n){e[t]||Object.defineProperty(e,t,{writable:!0,configurable:!0,value:n})}t(String.prototype,"padLeft","".padStart),t(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(e){[][e]&&t(Array,e,Function.call.bind([][e]))})}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"core-js/fn/regexp/escape":26,"core-js/shim":354,"regenerator-runtime/runtime":406}],5:[function(e,t,n){t.exports=function(e,t,n){return(t[0]-e[0])*(n[1]-e[1])-(n[0]-e[0])*(t[1]-e[1])}},{}],6:[function(e,t,n){var m=e("./is-equal-1d"),g=e("./is-left-2d");t.exports=function(e){for(var t,n,r=-1,i=-1e6,o=1e7,a=e.length,s=0;s<a;s++)t=e[s][0],((n=e[s][1])<o||n==o&&i<t)&&(r=s,i=t,o=n);for(var c,l,u=[],s=0;s<a;s++)t=e[s][0]-i,n=e[s][1]-o,u[s]={key:s,value:Math.atan2(n,t),length:t*t+n*n};u.sort(function(e,t){return m(e.value,t.value)?0:e.value<t.value?-1:1});for(s=1;s<u.length;s++)m((c=u[s-1]).value,(l=u[s]).value)&&(c.length>l.length?u.splice(s,1):u.splice(s-1,1),s--);for(var s=1,h=u.length,d=[u[h-1].key,r];s<h;){var p=u[s].key,f=d.length-1;g(e[d[f-1]],e[d[f]],e[p])?(d.push(p),s++):d.pop()}return d}},{"./is-equal-1d":19,"./is-left-2d":21}],7:[function(e,t,n){t.exports=function(e,t){return e[0]*t[1]-t[0]*e[1]}},{}],8:[function(e,t,n){var g=e("gl-matrix").vec2,v=e("gl-matrix").vec3,y=e("./intersection-2d");t.exports=function(e,t){t=null==t?.5:t;var n,r=[],i=e.length,o=v.create(),a=v.fromValues(0,0,1),s=v.create(),c=g.create(),l=g.create(),u=g.create(),h=g.create(),d=g.create(),p=e[i-1],f=e[0];g.copy(c,p),g.copy(l,f),g.subtract(d,l,c),v.set(s,d[0],d[1],0),v.cross(o,s,a),v.normalize(o,o),v.scale(o,o,t),g.copy(d,o),g.add(c,c,d),g.add(l,l,d);for(var m=0;m<i;m++)f=e[m],n=e[(m+1)%i],g.copy(u,f),g.copy(h,n),g.subtract(d,h,u),v.set(s,d[0],d[1],0),v.cross(o,s,a),v.normalize(o,o),v.scale(o,o,t),g.copy(d,o),g.add(u,u,d),g.add(h,h,d),r.push(y(c,l,u,h)),g.copy(c,u),g.copy(l,h);return r}},{"./intersection-2d":11,"gl-matrix":356}],9:[function(e,t,n){t.exports=function(e){return 1e-5<e}},{}],10:[function(e,t,n){var i=e("./is-left-on-2d"),o=e("./is-left-2d");t.exports=function(e,t,n,r){return i(t,n,e)?o(t,r,e)&&o(r,t,n):!(i(r,t,e)&&i(t,r,n))}},{"./is-left-2d":21,"./is-left-on-2d":22}],11:[function(e,t,n){var s=e("gl-matrix").vec2,c=e("./cross-2d"),l=e("./is-zero-1d");t.exports=function(e,t,n,r){var e=s.clone(e),t=s.clone(t),n=(s.subtract(t,t,e),s.clone(n)),r=s.clone(r),i=(s.subtract(r,r,n),s.create()),n=(s.subtract(i,n,e),-1),o=c(t,r),a=c(i,t),r=c(i,r);if(0!=o)n=r/o;else if(l(a)&&l(o))n=s.dot(i,t)/s.dot(t,t);else if(!l(a)&&l(o))throw"lines are parallel and do no intersect";return s.fromValues(e[0]+n*t[0],e[1]+n*t[1])}},{"./cross-2d":7,"./is-zero-1d":23,"gl-matrix":356}],12:[function(e,t,n){var i=e("./intersects-proper-2d"),o=e("./is-between-2d");t.exports=function(e,t,n,r){return!!i(e,t,n,r)||!!(o(e,t,n)||o(e,t,r)||o(n,r,e)||o(n,r,t))}},{"./intersects-proper-2d":13,"./is-between-2d":14}],13:[function(e,t,n){var i=e("./is-colinear-2d"),o=e("./is-left-2d");t.exports=function(e,t,n,r){return!(i(e,t,n)||i(e,t,r)||i(n,r,e)||i(n,r,t))&&o(e,t,n)!=o(e,t,r)&&o(n,r,e)!=o(n,r,t)}},{"./is-colinear-2d":15,"./is-left-2d":21}],14:[function(e,t,n){var r=e("./is-colinear-2d");t.exports=function(e,t,n){return!!r(e,t,n)&&(e[0]!==t[0]?e[0]<=n[0]&&n[0]<=t[0]||e[0]>=n[0]&&n[0]>=t[0]:e[1]<=n[1]&&n[1]<=t[1]||e[1]>=n[1]&&n[1]>=t[1])}},{"./is-colinear-2d":15}],15:[function(e,t,n){var r=e("./is-zero-1d"),i=e("./area2-2d");t.exports=function(e,t,n){return r(i(e,t,n))}},{"./area2-2d":5,"./is-zero-1d":23}],16:[function(e,t,n){var s=e("./is-zero-1d");t.exports=function(e,t,n){var r=n[0]-e[0],i=n[1]-e[1],n=n[2]-e[2],o=t[0]-e[0],a=t[1]-e[1],t=t[2]-e[2];return s(n*a-t*i)&&s(t*r-o*n)&&s(o*i-a*r)}},{"./is-zero-1d":23}],17:[function(e,t,n){var s=e("./in-cone-2d"),c=e("./is-diagonalie-2d");t.exports=function(e,t,n){var r=n.length,i=n[e],o=n[t-1<0?r-1:t-1],a=n[t],t=n[(t+1)%r];return!!(s(n[e-1<0?r-1:e-1],i,n[(e+1)%r],a)&&s(o,a,t,i)&&c(i,a,n))}},{"./in-cone-2d":10,"./is-diagonalie-2d":18}],18:[function(e,t,n){var s=e("./is-equal-2d"),c=e("./intersects-proper-2d");t.exports=function(e,t,n){for(var r,i,o=n.length,a=0;a<o;a++)if(r=n[a],i=n[(a+1)%o],!s(r,e)&&!s(i,e)&&!s(r,t)&&!s(i,t)&&c(e,t,r,i))return!1;return!0}},{"./intersects-proper-2d":13,"./is-equal-2d":20}],19:[function(e,t,n){var r=e("./is-zero-1d");t.exports=function(e,t){return e===t||r(e-t)}},{"./is-zero-1d":23}],20:[function(e,t,n){e("./is-zero-1d");var r=e("./is-equal-1d");t.exports=function(e,t){return!(!r(e[0],t[0])||!r(e[1],t[1]))}},{"./is-equal-1d":19,"./is-zero-1d":23}],21:[function(e,t,n){var r=e("./greater-than-zero-1d"),i=e("./area2-2d");t.exports=function(e,t,n){return r(i(e,t,n))}},{"./area2-2d":5,"./greater-than-zero-1d":9}],22:[function(e,t,n){var r=e("./area2-2d"),i=e("./greater-than-zero-1d"),o=e("./is-zero-1d");t.exports=function(e,t,n){e=r(e,t,n);return i(e)||o(e)}},{"./area2-2d":5,"./greater-than-zero-1d":9,"./is-zero-1d":23}],23:[function(e,t,n){t.exports=function(e){return 0===e||Math.abs(e)<1e-6}},{}],24:[function(e,t,n){var m=e("./is-diagonal-2d");t.exports=function(e){for(var t=e.length,n=[],r=0;r<t;r++)n.push(m(r-1<0?t-1:r-1,(r+1)%t,e));for(var i,o,a,s,c,l=e.slice(0),u=0,h=l.length,d=0,p=[],r=0;r<t;r++)p[r]=r;for(var f=[];3<h;)do{if(n[p[u%=c=p.length]]){s=(u+2)%c,a=(u+1)%c,i=(i=(o=(o=u-1)<0?c+o:o)-1)<0?c+i:i,u%=c,s%=c,n[p[o%=c]]=m(p[i%=c],p[a%=c],l),n[p[a]]=m(p[o],p[s],l),f.push([p[u],p[a],p[o]]),p.splice(u,1),d=a,h--;break}}while(++u!=d);return f.push([p[1],p[2],p[0]]),f}},{"./is-diagonal-2d":17}],25:[function(e,t,n){n.greaterThanZero=e("./cga/greater-than-zero-1d.js"),n.isEqual=e("./cga/is-equal-1d.js"),n.isZero=e("./cga/is-zero-1d.js"),n.area2=e("./cga/area2-2d.js"),n.convexHull2=e("./cga/convex-hull-2d.js"),n.cross2=e("./cga/cross-2d.js"),n.expandPolygon2=e("./cga/expand-polygon-2d.js"),n.inCone2=e("./cga/in-cone-2d.js"),n.intersection2=e("./cga/intersection-2d.js"),n.intersects2=e("./cga/intersects-2d.js"),n.intersectsProper2=e("./cga/intersects-proper-2d.js"),n.isBetween2=e("./cga/is-between-2d.js"),n.isColinear2=e("./cga/is-colinear-2d.js"),n.isDiagonal2=e("./cga/is-diagonal-2d.js"),n.isDiagonalie2=e("./cga/is-diagonalie-2d.js"),n.isEqual2=e("./cga/is-equal-2d.js"),n.isLeft2=e("./cga/is-left-2d.js"),n.isLeftOn2=e("./cga/is-left-on-2d.js"),n.triangulatePolygon2=e("./cga/triangulate-polygon-2d.js"),n.isColinear3=e("./cga/is-colinear-3d.js")},{"./cga/area2-2d.js":5,"./cga/convex-hull-2d.js":6,"./cga/cross-2d.js":7,"./cga/expand-polygon-2d.js":8,"./cga/greater-than-zero-1d.js":9,"./cga/in-cone-2d.js":10,"./cga/intersection-2d.js":11,"./cga/intersects-2d.js":12,"./cga/intersects-proper-2d.js":13,"./cga/is-between-2d.js":14,"./cga/is-colinear-2d.js":15,"./cga/is-colinear-3d.js":16,"./cga/is-diagonal-2d.js":17,"./cga/is-diagonalie-2d.js":18,"./cga/is-equal-1d.js":19,"./cga/is-equal-2d.js":20,"./cga/is-left-2d.js":21,"./cga/is-left-on-2d.js":22,"./cga/is-zero-1d.js":23,"./cga/triangulate-polygon-2d.js":24}],26:[function(e,t,n){e("../../modules/core.regexp.escape"),t.exports=e("../../modules/_core").RegExp.escape},{"../../modules/_core":48,"../../modules/core.regexp.escape":156}],27:[function(e,t,n){t.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},{}],28:[function(e,t,n){var r=e("./_cof");t.exports=function(e,t){if("number"!=typeof e&&"Number"!=r(e))throw TypeError(t);return+e}},{"./_cof":43}],29:[function(e,t,n){var r=e("./_wks")("unscopables"),i=Array.prototype;null==i[r]&&e("./_hide")(i,r,{}),t.exports=function(e){i[r][e]=!0}},{"./_hide":68,"./_wks":154}],30:[function(e,t,n){var r=e("./_string-at")(!0);t.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},{"./_string-at":131}],31:[function(e,t,n){t.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}},{}],32:[function(e,t,n){var r=e("./_is-object");t.exports=function(e){if(r(e))return e;throw TypeError(e+" is not an object!")}},{"./_is-object":77}],33:[function(e,t,n){var c=e("./_to-object"),l=e("./_to-absolute-index"),u=e("./_to-length");t.exports=[].copyWithin||function(e,t){var n=c(this),r=u(n.length),i=l(e,r),o=l(t,r),e=2<arguments.length?arguments[2]:void 0,a=Math.min((void 0===e?r:l(e,r))-o,r-i),s=1;for(o<i&&i<o+a&&(s=-1,o+=a-1,i+=a-1);0<a--;)o in n?n[i]=n[o]:delete n[i],i+=s,o+=s;return n}},{"./_to-absolute-index":139,"./_to-length":143,"./_to-object":144}],34:[function(e,t,n){var a=e("./_to-object"),s=e("./_to-absolute-index"),c=e("./_to-length");t.exports=function(e){for(var t=a(this),n=c(t.length),r=arguments.length,i=s(1<r?arguments[1]:void 0,n),r=2<r?arguments[2]:void 0,o=void 0===r?n:s(r,n);i<o;)t[i++]=e;return t}},{"./_to-absolute-index":139,"./_to-length":143,"./_to-object":144}],35:[function(e,t,n){var r=e("./_for-of");t.exports=function(e,t){var n=[];return r(e,!1,n.push,n,t),n}},{"./_for-of":64}],36:[function(e,t,n){var c=e("./_to-iobject"),l=e("./_to-length"),u=e("./_to-absolute-index");t.exports=function(s){return function(e,t,n){var r,i=c(e),o=l(i.length),a=u(n,o);if(s&&t!=t){for(;a<o;)if((r=i[a++])!=r)return!0}else for(;a<o;a++)if((s||a in i)&&i[a]===t)return s||a||0;return!s&&-1}}},{"./_to-absolute-index":139,"./_to-iobject":142,"./_to-length":143}],37:[function(e,t,n){var _=e("./_ctx"),x=e("./_iobject"),b=e("./_to-object"),w=e("./_to-length"),r=e("./_array-species-create");t.exports=function(h,e){var d=1==h,p=2==h,f=3==h,m=4==h,g=6==h,v=5==h||g,y=e||r;return function(e,t,n){for(var r,i,o=b(e),a=x(o),s=_(t,n,3),c=w(a.length),l=0,u=d?y(e,c):p?y(e,0):void 0;l<c;l++)if((v||l in a)&&(i=s(r=a[l],l,o),h))if(d)u[l]=i;else if(i)switch(h){case 3:return!0;case 5:return r;case 6:return l;case 2:u.push(r)}else if(m)return!1;return g?-1:f||m?m:u}}},{"./_array-species-create":40,"./_ctx":50,"./_iobject":73,"./_to-length":143,"./_to-object":144}],38:[function(e,t,n){var u=e("./_a-function"),h=e("./_to-object"),d=e("./_iobject"),p=e("./_to-length");t.exports=function(e,t,n,r,i){u(t);var o=h(e),a=d(o),s=p(o.length),c=i?s-1:0,l=i?-1:1;if(n<2)for(;;){if(c in a){r=a[c],c+=l;break}if(c+=l,i?c<0:s<=c)throw TypeError("Reduce of empty array with no initial value")}for(;i?0<=c:c<s;c+=l)c in a&&(r=t(r,a[c],c,o));return r}},{"./_a-function":27,"./_iobject":73,"./_to-length":143,"./_to-object":144}],39:[function(e,t,n){var r=e("./_is-object"),i=e("./_is-array"),o=e("./_wks")("species");t.exports=function(e){var t;return void 0===(t=i(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!i(t.prototype)||(t=void 0),r(t))&&null===(t=t[o])?void 0:t)?Array:t}},{"./_is-array":75,"./_is-object":77,"./_wks":154}],40:[function(e,t,n){var r=e("./_array-species-constructor");t.exports=function(e,t){return new(r(e))(t)}},{"./_array-species-constructor":39}],41:[function(e,t,n){var r=e("./_a-function"),i=e("./_is-object"),u=e("./_invoke"),h=[].slice,d={};t.exports=Function.bind||function(a){var s=r(this),c=h.call(arguments,1),l=function(){var e=c.concat(h.call(arguments));if(this instanceof l){var t=s,n=e.length,r=e;if(!(n in d)){for(var i=[],o=0;o<n;o++)i[o]="a["+o+"]";d[n]=Function("F,a","return new F("+i.join(",")+")")}return d[n](t,r)}return u(s,e,a)};return i(s.prototype)&&(l.prototype=s.prototype),l}},{"./_a-function":27,"./_invoke":72,"./_is-object":77}],42:[function(e,t,n){var r=e("./_cof"),i=e("./_wks")("toStringTag"),o="Arguments"==r(function(){return arguments}());t.exports=function(e){var t;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(t=((e,t)=>{try{return e[t]}catch(e){}})(e=Object(e),i))?t:o?r(e):"Object"==(t=r(e))&&"function"==typeof e.callee?"Arguments":t}},{"./_cof":43,"./_wks":154}],43:[function(e,t,n){var r={}.toString;t.exports=function(e){return r.call(e).slice(8,-1)}},{}],44:[function(e,t,n){function a(e,t){var n,r=f(t);if("F"!==r)return e._i[r];for(n=e._f;n;n=n.n)if(n.k==t)return n}var s=e("./_object-dp").f,c=e("./_object-create"),l=e("./_redefine-all"),u=e("./_ctx"),h=e("./_an-instance"),d=e("./_for-of"),r=e("./_iter-define"),i=e("./_iter-step"),o=e("./_set-species"),p=e("./_descriptors"),f=e("./_meta").fastKey,m=e("./_validate-collection"),g=p?"_s":"size";t.exports={getConstructor:function(e,i,n,r){var o=e(function(e,t){h(e,o,i,"_i"),e._t=i,e._i=c(null),e._f=void 0,e._l=void 0,e[g]=0,null!=t&&d(t,n,e[r],e)});return l(o.prototype,{clear:function(){for(var e=m(this,i),t=e._i,n=e._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete t[n.i];e._f=e._l=void 0,e[g]=0},delete:function(e){var t,n,r=m(this,i),e=a(r,e);return e&&(t=e.n,n=e.p,delete r._i[e.i],e.r=!0,n&&(n.n=t),t&&(t.p=n),r._f==e&&(r._f=t),r._l==e&&(r._l=n),r[g]--),!!e},forEach:function(e){m(this,i);for(var t,n=u(e,1<arguments.length?arguments[1]:void 0,3);t=t?t.n:this._f;)for(n(t.v,t.k,this);t&&t.r;)t=t.p},has:function(e){return!!a(m(this,i),e)}}),p&&s(o.prototype,"size",{get:function(){return m(this,i)[g]}}),o},def:function(e,t,n){var r,i=a(e,t);return i?i.v=n:(e._l=i={i:r=f(t,!0),k:t,v:n,p:t=e._l,n:void 0,r:!1},e._f||(e._f=i),t&&(t.n=i),e[g]++,"F"!==r&&(e._i[r]=i)),e},getEntry:a,setStrong:function(e,n,t){r(e,n,function(e,t){this._t=m(e,n),this._k=t,this._l=void 0},function(){for(var e=this,t=e._k,n=e._l;n&&n.r;)n=n.p;return e._t&&(e._l=n=n?n.n:e._t._f)?i(0,"keys"==t?n.k:"values"==t?n.v:[n.k,n.v]):(e._t=void 0,i(1))},t?"entries":"values",!t,!0),o(n)}}},{"./_an-instance":31,"./_ctx":50,"./_descriptors":54,"./_for-of":64,"./_iter-define":81,"./_iter-step":83,"./_meta":91,"./_object-create":96,"./_object-dp":97,"./_redefine-all":116,"./_set-species":125,"./_validate-collection":151}],45:[function(e,t,n){var r=e("./_classof"),i=e("./_array-from-iterable");t.exports=function(e){return function(){if(r(this)!=e)throw TypeError(e+"#toJSON isn't generic");return i(this)}}},{"./_array-from-iterable":35,"./_classof":42}],46:[function(e,t,n){function a(e){return e._l||(e._l=new r)}function r(){this.a=[]}function i(e,t){return m(e.a,function(e){return e[0]===t})}var s=e("./_redefine-all"),c=e("./_meta").getWeak,o=e("./_an-object"),l=e("./_is-object"),u=e("./_an-instance"),h=e("./_for-of"),d=e("./_array-methods"),p=e("./_has"),f=e("./_validate-collection"),m=d(5),g=d(6),v=0;r.prototype={get:function(e){e=i(this,e);if(e)return e[1]},has:function(e){return!!i(this,e)},set:function(e,t){var n=i(this,e);n?n[1]=t:this.a.push([e,t])},delete:function(t){var e=g(this.a,function(e){return e[0]===t});return~e&&this.a.splice(e,1),!!~e}},t.exports={getConstructor:function(e,n,r,i){var o=e(function(e,t){u(e,o,n,"_i"),e._t=n,e._i=v++,e._l=void 0,null!=t&&h(t,r,e[i],e)});return s(o.prototype,{delete:function(e){var t;return!!l(e)&&(!0===(t=c(e))?a(f(this,n)).delete(e):t&&p(t,this._i)&&delete t[this._i])},has:function(e){var t;return!!l(e)&&(!0===(t=c(e))?a(f(this,n)).has(e):t&&p(t,this._i))}}),o},def:function(e,t,n){var r=c(o(t),!0);return!0===r?a(e).set(t,n):r[e._i]=n,e},ufstore:a}},{"./_an-instance":31,"./_an-object":32,"./_array-methods":37,"./_for-of":64,"./_has":67,"./_is-object":77,"./_meta":91,"./_redefine-all":116,"./_validate-collection":151}],47:[function(e,t,n){var v=e("./_global"),y=e("./_export"),_=e("./_redefine"),x=e("./_redefine-all"),b=e("./_meta"),w=e("./_for-of"),E=e("./_an-instance"),M=e("./_is-object"),T=e("./_fails"),S=e("./_iter-detect"),A=e("./_set-to-string-tag"),P=e("./_inherit-if-required");t.exports=function(n,e,t,r,i,o){function a(e){var n=m[e];_(m,e,"delete"==e?function(e){return!(o&&!M(e))&&n.call(this,0===e?0:e)}:"has"==e?function(e){return!(o&&!M(e))&&n.call(this,0===e?0:e)}:"get"==e?function(e){return o&&!M(e)?void 0:n.call(this,0===e?0:e)}:"add"==e?function(e){return n.call(this,0===e?0:e),this}:function(e,t){return n.call(this,0===e?0:e,t),this})}var s,c,l,u,h,d=v[n],p=d,f=i?"set":"add",m=p&&p.prototype,g={};return"function"==typeof p&&(o||m.forEach&&!T(function(){(new p).entries().next()}))?(c=(s=new p)[f](o?{}:-0,1)!=s,l=T(function(){s.has(1)}),u=S(function(e){new p(e)}),h=!o&&T(function(){for(var e=new p,t=5;t--;)e[f](t,t);return!e.has(-0)}),u||(((p=e(function(e,t){E(e,p,n);e=P(new d,e,p);return null!=t&&w(t,i,e[f],e),e})).prototype=m).constructor=p),(l||h)&&(a("delete"),a("has"),i)&&a("get"),(h||c)&&a(f),o&&m.clear&&delete m.clear):(p=r.getConstructor(e,n,i,f),x(p.prototype,t),b.NEED=!0),A(p,n),g[n]=p,y(y.G+y.W+y.F*(p!=d),g),o||r.setStrong(p,n,i),p}},{"./_an-instance":31,"./_export":58,"./_fails":60,"./_for-of":64,"./_global":66,"./_inherit-if-required":71,"./_is-object":77,"./_iter-detect":82,"./_meta":91,"./_redefine":117,"./_redefine-all":116,"./_set-to-string-tag":126}],48:[function(e,t,n){t=t.exports={version:"2.6.12"};"number"==typeof __e&&(__e=t)},{}],49:[function(e,t,n){var r=e("./_object-dp"),i=e("./_property-desc");t.exports=function(e,t,n){t in e?r.f(e,t,i(0,n)):e[t]=n}},{"./_object-dp":97,"./_property-desc":115}],50:[function(e,t,n){var o=e("./_a-function");t.exports=function(r,i,e){if(o(r),void 0===i)return r;switch(e){case 1:return function(e){return r.call(i,e)};case 2:return function(e,t){return r.call(i,e,t)};case 3:return function(e,t,n){return r.call(i,e,t,n)}}return function(){return r.apply(i,arguments)}}},{"./_a-function":27}],51:[function(e,t,n){function i(e){return 9<e?e:"0"+e}var e=e("./_fails"),o=Date.prototype.getTime,r=Date.prototype.toISOString;t.exports=e(function(){return"0385-07-25T07:06:39.999Z"!=r.call(new Date(-5e13-1))})||!e(function(){r.call(new Date(NaN))})?function(){var e,t,n,r;if(isFinite(o.call(this)))return t=(e=this).getUTCFullYear(),n=e.getUTCMilliseconds(),(r=t<0?"-":9999<t?"+":"")+("00000"+Math.abs(t)).slice(r?-6:-4)+"-"+i(e.getUTCMonth()+1)+"-"+i(e.getUTCDate())+"T"+i(e.getUTCHours())+":"+i(e.getUTCMinutes())+":"+i(e.getUTCSeconds())+"."+(99<n?n:"0"+i(n))+"Z";throw RangeError("Invalid time value")}:r},{"./_fails":60}],52:[function(e,t,n){var r=e("./_an-object"),i=e("./_to-primitive");t.exports=function(e){if("string"!==e&&"number"!==e&&"default"!==e)throw TypeError("Incorrect hint");return i(r(this),"number"!=e)}},{"./_an-object":32,"./_to-primitive":145}],53:[function(e,t,n){t.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},{}],54:[function(e,t,n){t.exports=!e("./_fails")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},{"./_fails":60}],55:[function(e,t,n){var r=e("./_is-object"),i=e("./_global").document,o=r(i)&&r(i.createElement);t.exports=function(e){return o?i.createElement(e):{}}},{"./_global":66,"./_is-object":77}],56:[function(e,t,n){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},{}],57:[function(e,t,n){var s=e("./_object-keys"),c=e("./_object-gops"),l=e("./_object-pie");t.exports=function(e){var t=s(e),n=c.f;if(n)for(var r,i=n(e),o=l.f,a=0;i.length>a;)o.call(e,r=i[a++])&&t.push(r);return t}},{"./_object-gops":103,"./_object-keys":106,"./_object-pie":107}],58:[function(e,t,n){function p(e,t,n){var r,i,o,a=e&p.F,s=e&p.G,c=e&p.P,l=e&p.B,u=s?f:e&p.S?f[t]||(f[t]={}):(f[t]||{})[_],h=s?m:m[t]||(m[t]={}),d=h[_]||(h[_]={});for(r in n=s?t:n)i=((o=!a&&u&&void 0!==u[r])?u:n)[r],o=l&&o?y(i,f):c&&"function"==typeof i?y(Function.call,i):i,u&&v(u,r,i,e&p.U),h[r]!=i&&g(h,r,o),c&&d[r]!=i&&(d[r]=i)}var f=e("./_global"),m=e("./_core"),g=e("./_hide"),v=e("./_redefine"),y=e("./_ctx"),_="prototype";f.core=m,p.F=1,p.G=2,p.S=4,p.P=8,p.B=16,p.W=32,p.U=64,p.R=128,t.exports=p},{"./_core":48,"./_ctx":50,"./_global":66,"./_hide":68,"./_redefine":117}],59:[function(e,t,n){var r=e("./_wks")("match");t.exports=function(t){var n=/./;try{"/./"[t](n)}catch(e){try{return n[r]=!1,!"/./"[t](n)}catch(e){}}return!0}},{"./_wks":154}],60:[function(e,t,n){t.exports=function(e){try{return!!e()}catch(e){return!0}}},{}],61:[function(e,t,n){e("./es6.regexp.exec");var r,c=e("./_redefine"),l=e("./_hide"),u=e("./_fails"),h=e("./_defined"),d=e("./_wks"),p=e("./_regexp-exec"),f=d("species"),m=!u(function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}),g=(r=(e=/(?:)/).exec,e.exec=function(){return r.apply(this,arguments)},2===(e="ab".split(e)).length&&"a"===e[0]&&"b"===e[1]);t.exports=function(n,e,t){var o,r,i=d(n),a=!u(function(){var e={};return e[i]=function(){return 7},7!=""[n](e)}),s=a?!u(function(){var e=!1,t=/a/;return t.exec=function(){return e=!0,null},"split"===n&&(t.constructor={},t.constructor[f]=function(){return t}),t[i](""),!e}):void 0;a&&s&&("replace"!==n||m)&&("split"!==n||g)||(o=/./[i],t=(s=t(h,i,""[n],function(e,t,n,r,i){return t.exec===p?a&&!i?{done:!0,value:o.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}}))[0],r=s[1],c(String.prototype,n,t),l(RegExp.prototype,i,2==e?function(e,t){return r.call(e,this,t)}:function(e){return r.call(e,this)}))}},{"./_defined":53,"./_fails":60,"./_hide":68,"./_redefine":117,"./_regexp-exec":119,"./_wks":154,"./es6.regexp.exec":251}],62:[function(e,t,n){var r=e("./_an-object");t.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},{"./_an-object":32}],63:[function(e,t,n){var f=e("./_is-array"),m=e("./_is-object"),g=e("./_to-length"),v=e("./_ctx"),y=e("./_wks")("isConcatSpreadable");t.exports=function e(t,n,r,i,o,a,s,c){for(var l,u,h=o,d=0,p=!!s&&v(s,c,3);d<i;){if(d in r){if(l=p?p(r[d],d,n):r[d],u=!1,(u=m(l)?void 0!==(u=l[y])?!!u:f(l):u)&&0<a)h=e(t,n,l,g(l.length),h,a-1)-1;else{if(9007199254740991<=h)throw TypeError();t[h]=l}h++}d++}return h}},{"./_ctx":50,"./_is-array":75,"./_is-object":77,"./_to-length":143,"./_wks":154}],64:[function(e,t,n){var h=e("./_ctx"),d=e("./_iter-call"),p=e("./_is-array-iter"),f=e("./_an-object"),m=e("./_to-length"),g=e("./core.get-iterator-method"),v={},y={};(n=t.exports=function(e,t,n,r,i){var o,a,s,c,i=i?function(){return e}:g(e),l=h(n,r,t?2:1),u=0;if("function"!=typeof i)throw TypeError(e+" is not iterable!");if(p(i)){for(o=m(e.length);u<o;u++)if((c=t?l(f(a=e[u])[0],a[1]):l(e[u]))===v||c===y)return c}else for(s=i.call(e);!(a=s.next()).done;)if((c=d(s,l,a.value,t))===v||c===y)return c}).BREAK=v,n.RETURN=y},{"./_an-object":32,"./_ctx":50,"./_is-array-iter":74,"./_iter-call":79,"./_to-length":143,"./core.get-iterator-method":155}],65:[function(e,t,n){t.exports=e("./_shared")("native-function-to-string",Function.toString)},{"./_shared":128}],66:[function(e,t,n){t=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)},{}],67:[function(e,t,n){var r={}.hasOwnProperty;t.exports=function(e,t){return r.call(e,t)}},{}],68:[function(e,t,n){var r=e("./_object-dp"),i=e("./_property-desc");t.exports=e("./_descriptors")?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},{"./_descriptors":54,"./_object-dp":97,"./_property-desc":115}],69:[function(e,t,n){e=e("./_global").document;t.exports=e&&e.documentElement},{"./_global":66}],70:[function(e,t,n){t.exports=!e("./_descriptors")&&!e("./_fails")(function(){return 7!=Object.defineProperty(e("./_dom-create")("div"),"a",{get:function(){return 7}}).a})},{"./_descriptors":54,"./_dom-create":55,"./_fails":60}],71:[function(e,t,n){var r=e("./_is-object"),i=e("./_set-proto").set;t.exports=function(e,t,n){var t=t.constructor;return t!==n&&"function"==typeof t&&(t=t.prototype)!==n.prototype&&r(t)&&i&&i(e,t),e}},{"./_is-object":77,"./_set-proto":124}],72:[function(e,t,n){t.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},{}],73:[function(e,t,n){var r=e("./_cof");t.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},{"./_cof":43}],74:[function(e,t,n){var r=e("./_iterators"),i=e("./_wks")("iterator"),o=Array.prototype;t.exports=function(e){return void 0!==e&&(r.Array===e||o[i]===e)}},{"./_iterators":84,"./_wks":154}],75:[function(e,t,n){var r=e("./_cof");t.exports=Array.isArray||function(e){return"Array"==r(e)}},{"./_cof":43}],76:[function(e,t,n){var r=e("./_is-object"),i=Math.floor;t.exports=function(e){return!r(e)&&isFinite(e)&&i(e)===e}},{"./_is-object":77}],77:[function(e,t,n){t.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},{}],78:[function(e,t,n){var r=e("./_is-object"),i=e("./_cof"),o=e("./_wks")("match");t.exports=function(e){var t;return r(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==i(e))}},{"./_cof":43,"./_is-object":77,"./_wks":154}],79:[function(e,t,n){var i=e("./_an-object");t.exports=function(t,e,n,r){try{return r?e(i(n)[0],n[1]):e(n)}catch(e){r=t.return;throw void 0!==r&&i(r.call(t)),e}}},{"./_an-object":32}],80:[function(e,t,n){var r=e("./_object-create"),i=e("./_property-desc"),o=e("./_set-to-string-tag"),a={};e("./_hide")(a,e("./_wks")("iterator"),function(){return this}),t.exports=function(e,t,n){e.prototype=r(a,{next:i(1,n)}),o(e,t+" Iterator")}},{"./_hide":68,"./_object-create":96,"./_property-desc":115,"./_set-to-string-tag":126,"./_wks":154}],81:[function(e,t,n){function v(){return this}var y=e("./_library"),_=e("./_export"),x=e("./_redefine"),b=e("./_hide"),w=e("./_iterators"),E=e("./_iter-create"),M=e("./_set-to-string-tag"),T=e("./_object-gpo"),S=e("./_wks")("iterator"),A=!([].keys&&"next"in[].keys()),P="values";t.exports=function(e,t,n,r,i,o,a){E(n,t,r);function s(e){if(!A&&e in d)return d[e];switch(e){case"keys":case P:return function(){return new n(this,e)}}return function(){return new n(this,e)}}var c,l,r=t+" Iterator",u=i==P,h=!1,d=e.prototype,p=d[S]||d["@@iterator"]||i&&d[i],f=p||s(i),m=i?u?s("entries"):f:void 0,g="Array"==t&&d.entries||p;if(g&&(g=T(g.call(new e)))!==Object.prototype&&g.next&&(M(g,r,!0),y||"function"==typeof g[S]||b(g,S,v)),u&&p&&p.name!==P&&(h=!0,f=function(){return p.call(this)}),y&&!a||!A&&!h&&d[S]||b(d,S,f),w[t]=f,w[r]=v,i)if(c={values:u?f:s(P),keys:o?f:s("keys"),entries:m},a)for(l in c)l in d||x(d,l,c[l]);else _(_.P+_.F*(A||h),t,c);return c}},{"./_export":58,"./_hide":68,"./_iter-create":80,"./_iterators":84,"./_library":85,"./_object-gpo":104,"./_redefine":117,"./_set-to-string-tag":126,"./_wks":154}],82:[function(e,t,n){var o=e("./_wks")("iterator"),a=!1;try{var r=[7][o]();r.return=function(){a=!0},Array.from(r,function(){throw 2})}catch(e){}t.exports=function(e,t){if(!t&&!a)return!1;var n=!1;try{var r=[7],i=r[o]();i.next=function(){return{done:n=!0}},r[o]=function(){return i},e(r)}catch(e){}return n}},{"./_wks":154}],83:[function(e,t,n){t.exports=function(e,t){return{value:t,done:!!e}}},{}],84:[function(e,t,n){t.exports={}},{}],85:[function(e,t,n){t.exports=!1},{}],86:[function(e,t,n){var r=Math.expm1;t.exports=!r||22025.465794806718<r(10)||r(10)<22025.465794806718||-2e-17!=r(-2e-17)?function(e){return 0==(e=+e)?e:-1e-6<e&&e<1e-6?e+e*e/2:Math.exp(e)-1}:r},{}],87:[function(e,t,n){var r=e("./_math-sign"),e=Math.pow,i=e(2,-52),o=e(2,-23),a=e(2,127)*(2-o),s=e(2,-126);t.exports=Math.fround||function(e){var t,n=Math.abs(e),e=r(e);return n<s?e*(n/s/o+1/i-1/i)*s*o:a<(t=(t=(1+o/i)*n)-(t-n))||t!=t?e*(1/0):e*t}},{"./_math-sign":90}],88:[function(e,t,n){t.exports=Math.log1p||function(e){return-1e-8<(e=+e)&&e<1e-8?e-e*e/2:Math.log(1+e)}},{}],89:[function(e,t,n){t.exports=Math.scale||function(e,t,n,r,i){return 0===arguments.length||e!=e||t!=t||n!=n||r!=r||i!=i?NaN:e===1/0||e===-1/0?e:(e-t)*(i-r)/(n-t)+r}},{}],90:[function(e,t,n){t.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1}},{}],91:[function(e,t,n){function r(e){s(e,i,{value:{i:"O"+ ++c,w:{}}})}var i=e("./_uid")("meta"),o=e("./_is-object"),a=e("./_has"),s=e("./_object-dp").f,c=0,l=Object.isExtensible||function(){return!0},u=!e("./_fails")(function(){return l(Object.preventExtensions({}))}),h=t.exports={KEY:i,NEED:!1,fastKey:function(e,t){if(!o(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!a(e,i)){if(!l(e))return"F";if(!t)return"E";r(e)}return e[i].i},getWeak:function(e,t){if(!a(e,i)){if(!l(e))return!0;if(!t)return!1;r(e)}return e[i].w},onFreeze:function(e){return u&&h.NEED&&l(e)&&!a(e,i)&&r(e),e}}},{"./_fails":60,"./_has":67,"./_is-object":77,"./_object-dp":97,"./_uid":149}],92:[function(e,t,n){function i(e,t,n){var r=s.get(e);if(!r){if(!n)return;s.set(e,r=new o)}if(!(e=r.get(t))){if(!n)return;r.set(t,e=new o)}return e}var o=e("./es6.map"),r=e("./_export"),a=e("./_shared")("metadata"),s=a.store||(a.store=new(e("./es6.weak-map")));t.exports={store:s,map:i,has:function(e,t,n){t=i(t,n,!1);return void 0!==t&&t.has(e)},get:function(e,t,n){t=i(t,n,!1);return void 0===t?void 0:t.get(e)},set:function(e,t,n,r){i(n,r,!0).set(e,t)},keys:function(e,t){var e=i(e,t,!1),n=[];return e&&e.forEach(function(e,t){n.push(t)}),n},key:function(e){return void 0===e||"symbol"==typeof e?e:String(e)},exp:function(e){r(r.S,"Reflect",e)}}},{"./_export":58,"./_shared":128,"./es6.map":186,"./es6.weak-map":293}],93:[function(e,t,n){var s=e("./_global"),c=e("./_task").set,l=s.MutationObserver||s.WebKitMutationObserver,u=s.process,h=s.Promise,d="process"==e("./_cof")(u);t.exports=function(){function e(){var e,t;for(d&&(e=u.domain)&&e.exit();n;){t=n.fn,n=n.next;try{t()}catch(e){throw n?i():r=void 0,e}}r=void 0,e&&e.enter()}var n,r,t,i,o,a;return i=d?function(){u.nextTick(e)}:!l||s.navigator&&s.navigator.standalone?h&&h.resolve?(t=h.resolve(void 0),function(){t.then(e)}):function(){c.call(s,e)}:(o=!0,a=document.createTextNode(""),new l(e).observe(a,{characterData:!0}),function(){a.data=o=!o}),function(e){e={fn:e,next:void 0};r&&(r.next=e),n||(n=e,i()),r=e}}},{"./_cof":43,"./_global":66,"./_task":138}],94:[function(e,t,n){var i=e("./_a-function");function r(e){var n,r;this.promise=new e(function(e,t){if(void 0!==n||void 0!==r)throw TypeError("Bad Promise constructor");n=e,r=t}),this.resolve=i(n),this.reject=i(r)}t.exports.f=function(e){return new r(e)}},{"./_a-function":27}],95:[function(e,t,n){var d=e("./_descriptors"),p=e("./_object-keys"),f=e("./_object-gops"),m=e("./_object-pie"),g=e("./_to-object"),v=e("./_iobject"),i=Object.assign;t.exports=!i||e("./_fails")(function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach(function(e){t[e]=e}),7!=i({},e)[n]||Object.keys(i({},t)).join("")!=r})?function(e,t){for(var n=g(e),r=arguments.length,i=1,o=f.f,a=m.f;i<r;)for(var s,c=v(arguments[i++]),l=o?p(c).concat(o(c)):p(c),u=l.length,h=0;h<u;)s=l[h++],d&&!a.call(c,s)||(n[s]=c[s]);return n}:i},{"./_descriptors":54,"./_fails":60,"./_iobject":73,"./_object-gops":103,"./_object-keys":106,"./_object-pie":107,"./_to-object":144}],96:[function(n,e,t){function r(){}var i=n("./_an-object"),o=n("./_object-dps"),a=n("./_enum-bug-keys"),s=n("./_shared-key")("IE_PROTO"),c="prototype",l=function(){var e=n("./_dom-create")("iframe"),t=a.length;for(e.style.display="none",n("./_html").appendChild(e),e.src="javascript:",(e=e.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;t--;)delete l[c][a[t]];return l()};e.exports=Object.create||function(e,t){var n;return null!==e?(r[c]=i(e),n=new r,r[c]=null,n[s]=e):n=l(),void 0===t?n:o(n,t)}},{"./_an-object":32,"./_dom-create":55,"./_enum-bug-keys":56,"./_html":69,"./_object-dps":98,"./_shared-key":127}],97:[function(e,t,n){var r=e("./_an-object"),i=e("./_ie8-dom-define"),o=e("./_to-primitive"),a=Object.defineProperty;n.f=e("./_descriptors")?Object.defineProperty:function(e,t,n){if(r(e),t=o(t,!0),r(n),i)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},{"./_an-object":32,"./_descriptors":54,"./_ie8-dom-define":70,"./_to-primitive":145}],98:[function(e,t,n){var a=e("./_object-dp"),s=e("./_an-object"),c=e("./_object-keys");t.exports=e("./_descriptors")?Object.defineProperties:function(e,t){s(e);for(var n,r=c(t),i=r.length,o=0;o<i;)a.f(e,n=r[o++],t[n]);return e}},{"./_an-object":32,"./_descriptors":54,"./_object-dp":97,"./_object-keys":106}],99:[function(t,e,n){e.exports=t("./_library")||!t("./_fails")(function(){var e=Math.random();__defineSetter__.call(null,e,function(){}),delete t("./_global")[e]})},{"./_fails":60,"./_global":66,"./_library":85}],100:[function(e,t,n){var r=e("./_object-pie"),i=e("./_property-desc"),o=e("./_to-iobject"),a=e("./_to-primitive"),s=e("./_has"),c=e("./_ie8-dom-define"),l=Object.getOwnPropertyDescriptor;n.f=e("./_descriptors")?l:function(e,t){if(e=o(e),t=a(t,!0),c)try{return l(e,t)}catch(e){}if(s(e,t))return i(!r.f.call(e,t),e[t])}},{"./_descriptors":54,"./_has":67,"./_ie8-dom-define":70,"./_object-pie":107,"./_property-desc":115,"./_to-iobject":142,"./_to-primitive":145}],101:[function(e,t,n){var r=e("./_to-iobject"),i=e("./_object-gopn").f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(e){if(!a||"[object Window]"!=o.call(e))return i(r(e));try{return i(e)}catch(e){return a.slice()}}},{"./_object-gopn":102,"./_to-iobject":142}],102:[function(e,t,n){var r=e("./_object-keys-internal"),i=e("./_enum-bug-keys").concat("length","prototype");n.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},{"./_enum-bug-keys":56,"./_object-keys-internal":105}],103:[function(e,t,n){n.f=Object.getOwnPropertySymbols},{}],104:[function(e,t,n){var r=e("./_has"),i=e("./_to-object"),o=e("./_shared-key")("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(e){return e=i(e),r(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},{"./_has":67,"./_shared-key":127,"./_to-object":144}],105:[function(e,t,n){var a=e("./_has"),s=e("./_to-iobject"),c=e("./_array-includes")(!1),l=e("./_shared-key")("IE_PROTO");t.exports=function(e,t){var n,r=s(e),i=0,o=[];for(n in r)n!=l&&a(r,n)&&o.push(n);for(;t.length>i;)!a(r,n=t[i++])||~c(o,n)||o.push(n);return o}},{"./_array-includes":36,"./_has":67,"./_shared-key":127,"./_to-iobject":142}],106:[function(e,t,n){var r=e("./_object-keys-internal"),i=e("./_enum-bug-keys");t.exports=Object.keys||function(e){return r(e,i)}},{"./_enum-bug-keys":56,"./_object-keys-internal":105}],107:[function(e,t,n){n.f={}.propertyIsEnumerable},{}],108:[function(e,t,n){var i=e("./_export"),o=e("./_core"),a=e("./_fails");t.exports=function(e,t){var n=(o.Object||{})[e]||Object[e],r={};r[e]=t(n),i(i.S+i.F*a(function(){n(1)}),"Object",r)}},{"./_core":48,"./_export":58,"./_fails":60}],109:[function(e,t,n){var c=e("./_descriptors"),l=e("./_object-keys"),u=e("./_to-iobject"),h=e("./_object-pie").f;t.exports=function(s){return function(e){for(var t,n=u(e),r=l(n),i=r.length,o=0,a=[];o<i;)t=r[o++],c&&!h.call(n,t)||a.push(s?[t,n[t]]:n[t]);return a}}},{"./_descriptors":54,"./_object-keys":106,"./_object-pie":107,"./_to-iobject":142}],110:[function(e,t,n){var r=e("./_object-gopn"),i=e("./_object-gops"),o=e("./_an-object"),e=e("./_global").Reflect;t.exports=e&&e.ownKeys||function(e){var t=r.f(o(e)),n=i.f;return n?t.concat(n(e)):t}},{"./_an-object":32,"./_global":66,"./_object-gopn":102,"./_object-gops":103}],111:[function(e,t,n){var r=e("./_global").parseFloat,i=e("./_string-trim").trim;t.exports=1/r(e("./_string-ws")+"-0")!=-1/0?function(e){var e=i(String(e),3),t=r(e);return 0===t&&"-"==e.charAt(0)?-0:t}:r},{"./_global":66,"./_string-trim":136,"./_string-ws":137}],112:[function(e,t,n){var r=e("./_global").parseInt,i=e("./_string-trim").trim,e=e("./_string-ws"),o=/^[-+]?0[xX]/;t.exports=8!==r(e+"08")||22!==r(e+"0x16")?function(e,t){e=i(String(e),3);return r(e,t>>>0||(o.test(e)?16:10))}:r},{"./_global":66,"./_string-trim":136,"./_string-ws":137}],113:[function(e,t,n){t.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},{}],114:[function(e,t,n){var r=e("./_an-object"),i=e("./_is-object"),o=e("./_new-promise-capability");t.exports=function(e,t){return r(e),i(t)&&t.constructor===e?t:((0,(e=o.f(e)).resolve)(t),e.promise)}},{"./_an-object":32,"./_is-object":77,"./_new-promise-capability":94}],115:[function(e,t,n){t.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},{}],116:[function(e,t,n){var i=e("./_redefine");t.exports=function(e,t,n){for(var r in t)i(e,r,t[r],n);return e}},{"./_redefine":117}],117:[function(e,t,n){var o=e("./_global"),a=e("./_hide"),s=e("./_has"),c=e("./_uid")("src"),r=e("./_function-to-string"),i="toString",l=(""+r).split(i);e("./_core").inspectSource=function(e){return r.call(e)},(t.exports=function(e,t,n,r){var i="function"==typeof n;i&&!s(n,"name")&&a(n,"name",t),e[t]!==n&&(i&&!s(n,c)&&a(n,c,e[t]?""+e[t]:l.join(String(t))),e===o?e[t]=n:r?e[t]?e[t]=n:a(e,t,n):(delete e[t],a(e,t,n)))})(Function.prototype,i,function(){return"function"==typeof this&&this[c]||r.call(this)})},{"./_core":48,"./_function-to-string":65,"./_global":66,"./_has":67,"./_hide":68,"./_uid":149}],118:[function(e,t,n){var r=e("./_classof"),i=RegExp.prototype.exec;t.exports=function(e,t){var n=e.exec;if("function"==typeof n){n=n.call(e,t);if("object"!=typeof n)throw new TypeError("RegExp exec method returned something other than an Object or null");return n}if("RegExp"!==r(e))throw new TypeError("RegExp#exec called on incompatible receiver");return i.call(e,t)}},{"./_classof":42}],119:[function(e,t,n){var r,i,a=e("./_flags"),s=RegExp.prototype.exec,c=String.prototype.replace,e=s,l="lastIndex",u=(r=/a/,i=/b*/g,s.call(r,"a"),s.call(i,"a"),0!==r[l]||0!==i[l]),h=void 0!==/()??/.exec("")[1];t.exports=e=u||h?function(e){var t,n,r,i,o=this;return h&&(n=new RegExp("^"+o.source+"$(?!\\s)",a.call(o))),u&&(t=o[l]),r=s.call(o,e),u&&r&&(o[l]=o.global?r.index+r[0].length:t),h&&r&&1<r.length&&c.call(r[0],n,function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(r[i]=void 0)}),r}:e},{"./_flags":62}],120:[function(e,t,n){t.exports=function(t,n){var r=n===Object(n)?function(e){return n[e]}:n;return function(e){return String(e).replace(t,r)}}},{}],121:[function(e,t,n){t.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},{}],122:[function(e,t,n){var r=e("./_export"),a=e("./_a-function"),s=e("./_ctx"),c=e("./_for-of");t.exports=function(e){r(r.S,e,{from:function(e){var t,n,r,i,o=arguments[1];return a(this),(t=void 0!==o)&&a(o),null==e?new this:(n=[],t?(r=0,i=s(o,arguments[2],2),c(e,!1,function(e){n.push(i(e,r++))})):c(e,!1,n.push,n),new this(n))}})}},{"./_a-function":27,"./_ctx":50,"./_export":58,"./_for-of":64}],123:[function(e,t,n){var r=e("./_export");t.exports=function(e){r(r.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},{"./_export":58}],124:[function(t,e,n){function i(e,t){if(o(e),!r(t)&&null!==t)throw TypeError(t+": can't set as prototype!")}var r=t("./_is-object"),o=t("./_an-object");e.exports={set:Object.setPrototypeOf||("__proto__"in{}?((e,n,r)=>{try{(r=t("./_ctx")(Function.call,t("./_object-gopd").f(Object.prototype,"__proto__").set,2))(e,[]),n=!(e instanceof Array)}catch(e){n=!0}return function(e,t){return i(e,t),n?e.__proto__=t:r(e,t),e}})({},!1):void 0),check:i}},{"./_an-object":32,"./_ctx":50,"./_is-object":77,"./_object-gopd":100}],125:[function(e,t,n){var r=e("./_global"),i=e("./_object-dp"),o=e("./_descriptors"),a=e("./_wks")("species");t.exports=function(e){e=r[e];o&&e&&!e[a]&&i.f(e,a,{configurable:!0,get:function(){return this}})}},{"./_descriptors":54,"./_global":66,"./_object-dp":97,"./_wks":154}],126:[function(e,t,n){var r=e("./_object-dp").f,i=e("./_has"),o=e("./_wks")("toStringTag");t.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,o)&&r(e,o,{configurable:!0,value:t})}},{"./_has":67,"./_object-dp":97,"./_wks":154}],127:[function(e,t,n){var r=e("./_shared")("keys"),i=e("./_uid");t.exports=function(e){return r[e]||(r[e]=i(e))}},{"./_shared":128,"./_uid":149}],128:[function(e,t,n){var r=e("./_core"),i=e("./_global"),o="__core-js_shared__",a=i[o]||(i[o]={});(t.exports=function(e,t){return a[e]||(a[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:e("./_library")?"pure":"global",copyright:" 2020 Denis Pushkarev (zloirock.ru)"})},{"./_core":48,"./_global":66,"./_library":85}],129:[function(e,t,n){var r=e("./_an-object"),i=e("./_a-function"),o=e("./_wks")("species");t.exports=function(e,t){var e=r(e).constructor;return void 0===e||null==(e=r(e)[o])?t:i(e)}},{"./_a-function":27,"./_an-object":32,"./_wks":154}],130:[function(e,t,n){var r=e("./_fails");t.exports=function(e,t){return!!e&&r(function(){t?e.call(null,function(){},1):e.call(null)})}},{"./_fails":60}],131:[function(e,t,n){var o=e("./_to-integer"),a=e("./_defined");t.exports=function(i){return function(e,t){var n,e=String(a(e)),t=o(t),r=e.length;return t<0||r<=t?i?"":void 0:(n=e.charCodeAt(t))<55296||56319<n||t+1===r||(r=e.charCodeAt(t+1))<56320||57343<r?i?e.charAt(t):n:i?e.slice(t,t+2):r-56320+(n-55296<<10)+65536}}},{"./_defined":53,"./_to-integer":141}],132:[function(e,t,n){var r=e("./_is-regexp"),i=e("./_defined");t.exports=function(e,t,n){if(r(t))throw TypeError("String#"+n+" doesn't accept regex!");return String(i(e))}},{"./_defined":53,"./_is-regexp":78}],133:[function(e,t,n){function r(e,t,n,r){var e=String(a(e)),i="<"+t;return""!==n&&(i+=" "+n+'="'+String(r).replace(s,"&quot;")+'"'),i+">"+e+"</"+t+">"}var i=e("./_export"),o=e("./_fails"),a=e("./_defined"),s=/"/g;t.exports=function(t,e){var n={};n[t]=e(r),i(i.P+i.F*o(function(){var e=""[t]('"');return e!==e.toLowerCase()||3<e.split('"').length}),"String",n)}},{"./_defined":53,"./_export":58,"./_fails":60}],134:[function(e,t,n){var o=e("./_to-length"),a=e("./_string-repeat"),s=e("./_defined");t.exports=function(e,t,n,r){var e=String(s(e)),i=e.length,n=void 0===n?" ":String(n),t=o(t);return t<=i||""==n?e:(t=t-i,(i=a.call(n,Math.ceil(t/n.length))).length>t&&(i=i.slice(0,t)),r?i+e:e+i)}},{"./_defined":53,"./_string-repeat":135,"./_to-length":143}],135:[function(e,t,n){var i=e("./_to-integer"),o=e("./_defined");t.exports=function(e){var t=String(o(this)),n="",r=i(e);if(r<0||r==1/0)throw RangeError("Count can't be negative");for(;0<r;(r>>>=1)&&(t+=t))1&r&&(n+=t);return n}},{"./_defined":53,"./_to-integer":141}],136:[function(e,t,n){function r(e,t,n){var r={},i=a(function(){return!!s[e]()||""!=""[e]()}),t=r[e]=i?t(u):s[e];n&&(r[n]=t),o(o.P+o.F*i,"String",r)}var o=e("./_export"),i=e("./_defined"),a=e("./_fails"),s=e("./_string-ws"),e="["+s+"]",c=RegExp("^"+e+e+"*"),l=RegExp(e+e+"*$"),u=r.trim=function(e,t){return e=String(i(e)),1&t&&(e=e.replace(c,"")),e=2&t?e.replace(l,""):e};t.exports=r},{"./_defined":53,"./_export":58,"./_fails":60,"./_string-ws":137}],137:[function(e,t,n){t.exports="\t\n\v\f\r \u2028\u2029\ufeff"},{}],138:[function(e,t,n){function r(){var e,t=+this;v.hasOwnProperty(t)&&(e=v[t],delete v[t],e())}function i(e){r.call(e.data)}var o,a=e("./_ctx"),s=e("./_invoke"),c=e("./_html"),l=e("./_dom-create"),u=e("./_global"),h=u.process,d=u.setImmediate,p=u.clearImmediate,f=u.MessageChannel,m=u.Dispatch,g=0,v={},y="onreadystatechange";d&&p||(d=function(e){for(var t=[],n=1;n<arguments.length;)t.push(arguments[n++]);return v[++g]=function(){s("function"==typeof e?e:Function(e),t)},o(g),g},p=function(e){delete v[e]},"process"==e("./_cof")(h)?o=function(e){h.nextTick(a(r,e,1))}:m&&m.now?o=function(e){m.now(a(r,e,1))}:f?(f=(e=new f).port2,e.port1.onmessage=i,o=a(f.postMessage,f,1)):u.addEventListener&&"function"==typeof postMessage&&!u.importScripts?(o=function(e){u.postMessage(e+"","*")},u.addEventListener("message",i,!1)):o=y in l("script")?function(e){c.appendChild(l("script"))[y]=function(){c.removeChild(this),r.call(e)}}:function(e){setTimeout(a(r,e,1),0)}),t.exports={set:d,clear:p}},{"./_cof":43,"./_ctx":50,"./_dom-create":55,"./_global":66,"./_html":69,"./_invoke":72}],139:[function(e,t,n){var r=e("./_to-integer"),i=Math.max,o=Math.min;t.exports=function(e,t){return(e=r(e))<0?i(e+t,0):o(e,t)}},{"./_to-integer":141}],140:[function(e,t,n){var r=e("./_to-integer"),i=e("./_to-length");t.exports=function(e){if(void 0===e)return 0;var e=r(e),t=i(e);if(e!==t)throw RangeError("Wrong length!");return t}},{"./_to-integer":141,"./_to-length":143}],141:[function(e,t,n){var r=Math.ceil,i=Math.floor;t.exports=function(e){return isNaN(e=+e)?0:(0<e?i:r)(e)}},{}],142:[function(e,t,n){var r=e("./_iobject"),i=e("./_defined");t.exports=function(e){return r(i(e))}},{"./_defined":53,"./_iobject":73}],143:[function(e,t,n){var r=e("./_to-integer"),i=Math.min;t.exports=function(e){return 0<e?i(r(e),9007199254740991):0}},{"./_to-integer":141}],144:[function(e,t,n){var r=e("./_defined");t.exports=function(e){return Object(r(e))}},{"./_defined":53}],145:[function(e,t,n){var i=e("./_is-object");t.exports=function(e,t){if(!i(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!i(r=n.call(e))||"function"==typeof(n=e.valueOf)&&!i(r=n.call(e))||!t&&"function"==typeof(n=e.toString)&&!i(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")}},{"./_is-object":77}],146:[function(e,F,D){var p,f,m,g,v,H,U,z,y,t,k,_,B,V,G,r,W,x,q,X,Y,Q,b,Z,J,K,n,i,$,ee,te,ne,re,ie,w,oe,E,ae,o,se,ce,le,M,T,ue,he,de,pe,fe,me,ge,ve,ye,_e,xe,be,we,Ee,Me,Te,Se,Ae,S,a,A,P,Pe,R,s,L,Re,C,Le,Ce,Ie,I,c,h,Oe,O,l,je,Ne,Fe,De,He,Ue,ze,j,ke,u,d,N;e("./_descriptors")?(p=e("./_library"),f=e("./_global"),m=e("./_fails"),g=e("./_export"),v=e("./_typed"),s=e("./_typed-buffer"),H=e("./_ctx"),U=e("./_an-instance"),z=e("./_property-desc"),y=e("./_hide"),t=e("./_redefine-all"),k=e("./_to-integer"),_=e("./_to-length"),B=e("./_to-index"),V=e("./_to-absolute-index"),G=e("./_to-primitive"),r=e("./_has"),W=e("./_classof"),x=e("./_is-object"),q=e("./_to-object"),X=e("./_is-array-iter"),Y=e("./_object-create"),Q=e("./_object-gpo"),b=e("./_object-gopn").f,Z=e("./core.get-iterator-method"),J=e("./_uid"),K=e("./_wks"),n=e("./_array-methods"),l=e("./_array-includes"),i=e("./_species-constructor"),u=e("./es6.array.iterator"),$=e("./_iterators"),ee=e("./_iter-detect"),te=e("./_set-species"),ne=e("./_array-fill"),re=e("./_array-copy-within"),ie=e("./_object-dp"),e=e("./_object-gopd"),w=ie.f,oe=e.f,E=f.RangeError,ae=f.TypeError,o=f.Uint8Array,ce="Shared"+(se="ArrayBuffer"),le="BYTES_PER_ELEMENT",M="prototype",d=Array[M],T=s.ArrayBuffer,ue=s.DataView,he=n(0),de=n(2),pe=n(3),fe=n(4),me=n(5),ge=n(6),ve=l(!0),ye=l(!1),_e=u.values,xe=u.keys,be=u.entries,we=d.lastIndexOf,Ee=d.reduce,Me=d.reduceRight,Te=d.join,Se=d.sort,Ae=d.slice,S=d.toString,a=d.toLocaleString,A=K("iterator"),P=K("toStringTag"),Pe=J("typed_constructor"),R=J("def_constructor"),s=v.CONSTR,L=v.TYPED,Re=v.VIEW,C="Wrong length!",Le=n(1,function(e,t){return h(i(e,e[R]),t)}),Ce=m(function(){return 1===new o(new Uint16Array([1]).buffer)[0]}),Ie=!!o&&!!o[M].set&&m(function(){new o(1).set({})}),I=function(e,t){e=k(e);if(e<0||e%t)throw E("Wrong offset!");return e},c=function(e){if(x(e)&&L in e)return e;throw ae(e+" is not a typed array!")},h=function(e,t){if(x(e)&&Pe in e)return new e(t);throw ae("It is not a typed array constructor!")},Oe=function(e,t){return O(i(e,e[R]),t)},O=function(e,t){for(var n=0,r=t.length,i=h(e,r);n<r;)i[n]=t[n++];return i},l=function(e,t,n){w(e,t,{get:function(){return this._d[n]}})},je=function(e){var t,n,r,i,o,a,s=q(e),e=arguments.length,c=1<e?arguments[1]:void 0,l=void 0!==c,u=Z(s);if(null!=u&&!X(u)){for(a=u.call(s),r=[],t=0;!(o=a.next()).done;t++)r.push(o.value);s=r}for(l&&2<e&&(c=H(c,arguments[2],2)),t=0,n=_(s.length),i=h(this,n);t<n;t++)i[t]=l?c(s[t],t):s[t];return i},Ne=function(){for(var e=0,t=arguments.length,n=h(this,t);e<t;)n[e]=arguments[e++];return n},Fe=!!o&&m(function(){a.call(new o(1))}),De=function(){return a.apply(Fe?Ae.call(c(this)):c(this),arguments)},He={copyWithin:function(e,t){return re.call(c(this),e,t,2<arguments.length?arguments[2]:void 0)},every:function(e){return fe(c(this),e,1<arguments.length?arguments[1]:void 0)},fill:function(e){return ne.apply(c(this),arguments)},filter:function(e){return Oe(this,de(c(this),e,1<arguments.length?arguments[1]:void 0))},find:function(e){return me(c(this),e,1<arguments.length?arguments[1]:void 0)},findIndex:function(e){return ge(c(this),e,1<arguments.length?arguments[1]:void 0)},forEach:function(e){he(c(this),e,1<arguments.length?arguments[1]:void 0)},indexOf:function(e){return ye(c(this),e,1<arguments.length?arguments[1]:void 0)},includes:function(e){return ve(c(this),e,1<arguments.length?arguments[1]:void 0)},join:function(e){return Te.apply(c(this),arguments)},lastIndexOf:function(e){return we.apply(c(this),arguments)},map:function(e){return Le(c(this),e,1<arguments.length?arguments[1]:void 0)},reduce:function(e){return Ee.apply(c(this),arguments)},reduceRight:function(e){return Me.apply(c(this),arguments)},reverse:function(){for(var e,t=this,n=c(t).length,r=Math.floor(n/2),i=0;i<r;)e=t[i],t[i++]=t[--n],t[n]=e;return t},some:function(e){return pe(c(this),e,1<arguments.length?arguments[1]:void 0)},sort:function(e){return Se.call(c(this),e)},subarray:function(e,t){var n=c(this),r=n.length,e=V(e,r);return new(i(n,n[R]))(n.buffer,n.byteOffset+e*n.BYTES_PER_ELEMENT,_((void 0===t?r:V(t,r))-e))}},Ue=function(e,t){return Oe(this,Ae.call(c(this),e,t))},ze=function(e){c(this);var t=I(arguments[1],1),n=this.length,r=q(e),i=_(r.length),o=0;if(n<i+t)throw E(C);for(;o<i;)this[t+o]=r[o++]},j={entries:function(){return be.call(c(this))},keys:function(){return xe.call(c(this))},values:function(){return _e.call(c(this))}},ke=function(e,t){return x(e)&&e[L]&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)},u=function(e,t){return ke(e,t=G(t,!0))?z(2,e[t]):oe(e,t)},d=function(e,t,n){return!(ke(e,t=G(t,!0))&&x(n)&&r(n,"value"))||r(n,"get")||r(n,"set")||n.configurable||r(n,"writable")&&!n.writable||r(n,"enumerable")&&!n.enumerable?w(e,t,n):(e[t]=n.value,e)},s||(e.f=u,ie.f=d),g(g.S+g.F*!s,"Object",{getOwnPropertyDescriptor:u,defineProperty:d}),m(function(){S.call({})})&&(S=a=function(){return Te.call(this)}),N=t({},He),t(N,j),y(N,A,j.values),t(N,{slice:Ue,set:ze,constructor:function(){},toString:S,toLocaleString:De}),l(N,"buffer","b"),l(N,"byteOffset","o"),l(N,"byteLength","l"),l(N,"length","e"),w(N,P,{get:function(){return this[L]}}),F.exports=function(e,l,t,i){function u(e,r){w(e,r,{get:function(){var e=this,t=r;return(e=e._d).v[n](t*l+e.o,Ce)},set:function(e){var t=this,n=r;t=t._d,i&&(e=(e=Math.round(e))<0?0:255<e?255:255&e),t.v[o](n*l+t.o,e,Ce)},enumerable:!0})}var h=e+((i=!!i)?"Clamped":"")+"Array",n="get"+e,o="set"+e,d=f[h],a=d||{},e=d&&Q(d),r=!d||!v.ABV,s={},c=d&&d[M],r=(r?(d=t(function(e,t,n,r){U(e,d,h,"_d");var i,o,a=0,s=0;if(x(t)){if(!(t instanceof T||(c=W(t))==se||c==ce))return L in t?O(d,t):je.call(d,t);var c=t,s=I(n,l),n=t.byteLength;if(void 0===r){if(n%l)throw E(C);if((i=n-s)<0)throw E(C)}else if(n<(i=_(r)*l)+s)throw E(C);o=i/l}else o=B(t),c=new T(i=o*l);for(y(e,"_d",{b:c,o:s,l:i,e:o,v:new ue(c)});a<o;)u(e,a++)}),c=d[M]=Y(N),y(c,"constructor",d)):m(function(){d(1)})&&m(function(){new d(-1)})&&ee(function(e){new d,new d(null),new d(1.5),new d(e)},!0)||(d=t(function(e,t,n,r){return U(e,d,h),x(t)?t instanceof T||(e=W(t))==se||e==ce?void 0!==r?new a(t,I(n,l),r):void 0!==n?new a(t,I(n,l)):new a(t):L in t?O(d,t):je.call(d,t):new a(B(t))}),he(e!==Function.prototype?b(a).concat(b(e)):b(a),function(e){e in d||y(d,e,a[e])}),d[M]=c,p)||(c.constructor=d),c[A]),t=!!r&&("values"==r.name||null==r.name),e=j.values;y(d,Pe,!0),y(c,L,h),y(c,Re,!0),y(c,R,d),(i?new d(1)[P]==h:P in c)||w(c,P,{get:function(){return h}}),s[h]=d,g(g.G+g.W+g.F*(d!=a),s),g(g.S,h,{BYTES_PER_ELEMENT:l}),g(g.S+g.F*m(function(){a.of.call(d,1)}),h,{from:je,of:Ne}),le in c||y(c,le,l),g(g.P,h,He),te(h),g(g.P+g.F*Ie,h,{set:ze}),g(g.P+g.F*!t,h,j),p||c.toString==S||(c.toString=S),g(g.P+g.F*m(function(){new d(1).slice()}),h,{slice:Ue}),g(g.P+g.F*(m(function(){return[1,2].toLocaleString()!=new d([1,2]).toLocaleString()})||!m(function(){c.toLocaleString.call([1,2])})),h,{toLocaleString:De}),$[h]=t?r:e,p||t||y(c,A,e)}):F.exports=function(){}},{"./_an-instance":31,"./_array-copy-within":33,"./_array-fill":34,"./_array-includes":36,"./_array-methods":37,"./_classof":42,"./_ctx":50,"./_descriptors":54,"./_export":58,"./_fails":60,"./_global":66,"./_has":67,"./_hide":68,"./_is-array-iter":74,"./_is-object":77,"./_iter-detect":82,"./_iterators":84,"./_library":85,"./_object-create":96,"./_object-dp":97,"./_object-gopd":100,"./_object-gopn":102,"./_object-gpo":104,"./_property-desc":115,"./_redefine-all":116,"./_set-species":125,"./_species-constructor":129,"./_to-absolute-index":139,"./_to-index":140,"./_to-integer":141,"./_to-length":143,"./_to-object":144,"./_to-primitive":145,"./_typed":148,"./_typed-buffer":147,"./_uid":149,"./_wks":154,"./core.get-iterator-method":155,"./es6.array.iterator":167}],147:[function(e,F,t){var n=e("./_global"),r=e("./_descriptors"),D=e("./_library"),i=e("./_typed"),o=e("./_hide"),a=e("./_redefine-all"),s=e("./_fails"),c=e("./_an-instance"),H=e("./_to-integer"),U=e("./_to-length"),u=e("./_to-index"),l=e("./_object-gopn").f,z=e("./_object-dp").f,k=e("./_array-fill"),e=e("./_set-to-string-tag"),h="ArrayBuffer",d="DataView",p="prototype",f="Wrong index!",m=n[h],g=n[d],v=n.Math,y=n.RangeError,_=n.Infinity,x=m,B=v.abs,b=v.pow,V=v.floor,G=v.log,W=v.LN2,n="byteLength",v="byteOffset",w=r?"_b":"buffer",E=r?"_l":n,M=r?"_o":v;function T(e,t,n){var r,i,o,a=new Array(n),s=8*n-t-1,n=(1<<s)-1,c=n>>1,l=23===t?b(2,-24)-b(2,-77):0,u=0,h=e<0||0===e&&1/e<0?1:0;for((e=B(e))!=e||e===_?(i=e!=e?1:0,r=n):(r=V(G(e)/W),e*(o=b(2,-r))<1&&(r--,o*=2),2<=(e+=1<=r+c?l/o:l*b(2,1-c))*o&&(r++,o/=2),n<=r+c?(i=0,r=n):1<=r+c?(i=(e*o-1)*b(2,t),r+=c):(i=e*b(2,c-1)*b(2,t),r=0));8<=t;a[u++]=255&i,i/=256,t-=8);for(r=r<<t|i,s+=t;0<s;a[u++]=255&r,r/=256,s-=8);return a[--u]|=128*h,a}function S(e,t,n){var r,i=8*n-t-1,o=(1<<i)-1,a=o>>1,s=i-7,c=n-1,i=e[c--],l=127&i;for(i>>=7;0<s;l=256*l+e[c],c--,s-=8);for(r=l&(1<<-s)-1,l>>=-s,s+=t;0<s;r=256*r+e[c],c--,s-=8);if(0===l)l=1-a;else{if(l===o)return r?NaN:i?-_:_;r+=b(2,t),l-=a}return(i?-1:1)*r*b(2,l-t)}function A(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function P(e){return[255&e]}function R(e){return[255&e,e>>8&255]}function L(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function q(e){return T(e,52,8)}function X(e){return T(e,23,4)}function C(e,t,n){z(e[p],t,{get:function(){return this[n]}})}function I(e,t,n,r){n=u(+n);if(n+t>e[E])throw y(f);var i=e[w]._b,n=n+e[M],e=i.slice(n,n+t);return r?e:e.reverse()}function O(e,t,n,r,i,o){n=u(+n);if(n+t>e[E])throw y(f);for(var a=e[w]._b,s=n+e[M],c=r(+i),l=0;l<t;l++)a[s+l]=c[o?l:t-l-1]}if(i.ABV){if(!s(function(){m(1)})||!s(function(){new m(-1)})||s(function(){return new m,new m(1.5),new m(NaN),m.name!=h})){for(var j,s=(m=function(e){return c(this,m),new x(u(e))})[p]=x[p],N=l(x),Y=0;N.length>Y;)(j=N[Y++])in m||o(m,j,x[j]);D||(s.constructor=m)}var l=new g(new m(2)),Q=g[p].setInt8;l.setInt8(0,2147483648),l.setInt8(1,2147483649),!l.getInt8(0)&&l.getInt8(1)||a(g[p],{setInt8:function(e,t){Q.call(this,e,t<<24>>24)},setUint8:function(e,t){Q.call(this,e,t<<24>>24)}},!0)}else m=function(e){c(this,m,h);e=u(e);this._b=k.call(new Array(e),0),this[E]=e},g=function(e,t,n){c(this,g,d),c(e,m,d);var r=e[E],t=H(t);if(t<0||r<t)throw y("Wrong offset!");if(r<t+(n=void 0===n?r-t:U(n)))throw y("Wrong length!");this[w]=e,this[M]=t,this[E]=n},r&&(C(m,n,"_l"),C(g,"buffer","_b"),C(g,n,"_l"),C(g,v,"_o")),a(g[p],{getInt8:function(e){return I(this,1,e)[0]<<24>>24},getUint8:function(e){return I(this,1,e)[0]},getInt16:function(e){e=I(this,2,e,arguments[1]);return(e[1]<<8|e[0])<<16>>16},getUint16:function(e){e=I(this,2,e,arguments[1]);return e[1]<<8|e[0]},getInt32:function(e){return A(I(this,4,e,arguments[1]))},getUint32:function(e){return A(I(this,4,e,arguments[1]))>>>0},getFloat32:function(e){return S(I(this,4,e,arguments[1]),23,4)},getFloat64:function(e){return S(I(this,8,e,arguments[1]),52,8)},setInt8:function(e,t){O(this,1,e,P,t)},setUint8:function(e,t){O(this,1,e,P,t)},setInt16:function(e,t){O(this,2,e,R,t,arguments[2])},setUint16:function(e,t){O(this,2,e,R,t,arguments[2])},setInt32:function(e,t){O(this,4,e,L,t,arguments[2])},setUint32:function(e,t){O(this,4,e,L,t,arguments[2])},setFloat32:function(e,t){O(this,4,e,X,t,arguments[2])},setFloat64:function(e,t){O(this,8,e,q,t,arguments[2])}});e(m,h),e(g,d),o(g[p],i.VIEW,!0),t[h]=m,t[d]=g},{"./_an-instance":31,"./_array-fill":34,"./_descriptors":54,"./_fails":60,"./_global":66,"./_hide":68,"./_library":85,"./_object-dp":97,"./_object-gopn":102,"./_redefine-all":116,"./_set-to-string-tag":126,"./_to-index":140,"./_to-integer":141,"./_to-length":143,"./_typed":148}],148:[function(e,t,n){for(var r,i=e("./_global"),o=e("./_hide"),e=e("./_uid"),a=e("typed_array"),s=e("view"),e=!(!i.ArrayBuffer||!i.DataView),c=e,l=0,u="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");l<9;)(r=i[u[l++]])?(o(r.prototype,a,!0),o(r.prototype,s,!0)):c=!1;t.exports={ABV:e,CONSTR:c,TYPED:a,VIEW:s}},{"./_global":66,"./_hide":68,"./_uid":149}],149:[function(e,t,n){var r=0,i=Math.random();t.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++r+i).toString(36))}},{}],150:[function(e,t,n){e=e("./_global").navigator;t.exports=e&&e.userAgent||""},{"./_global":66}],151:[function(e,t,n){var r=e("./_is-object");t.exports=function(e,t){if(r(e)&&e._t===t)return e;throw TypeError("Incompatible receiver, "+t+" required!")}},{"./_is-object":77}],152:[function(e,t,n){var r=e("./_global"),i=e("./_core"),o=e("./_library"),a=e("./_wks-ext"),s=e("./_object-dp").f;t.exports=function(e){var t=i.Symbol||(i.Symbol=!o&&r.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:a.f(e)})}},{"./_core":48,"./_global":66,"./_library":85,"./_object-dp":97,"./_wks-ext":153}],153:[function(e,t,n){n.f=e("./_wks")},{"./_wks":154}],154:[function(e,t,n){var r=e("./_shared")("wks"),i=e("./_uid"),o=e("./_global").Symbol,a="function"==typeof o;(t.exports=function(e){return r[e]||(r[e]=a&&o[e]||(a?o:i)("Symbol."+e))}).store=r},{"./_global":66,"./_shared":128,"./_uid":149}],155:[function(e,t,n){var r=e("./_classof"),i=e("./_wks")("iterator"),o=e("./_iterators");t.exports=e("./_core").getIteratorMethod=function(e){if(null!=e)return e[i]||e["@@iterator"]||o[r(e)]}},{"./_classof":42,"./_core":48,"./_iterators":84,"./_wks":154}],156:[function(e,t,n){var r=e("./_export"),i=e("./_replacer")(/[\\^$*+?.()|[\]{}]/g,"\\$&");r(r.S,"RegExp",{escape:function(e){return i(e)}})},{"./_export":58,"./_replacer":120}],157:[function(e,t,n){var r=e("./_export");r(r.P,"Array",{copyWithin:e("./_array-copy-within")}),e("./_add-to-unscopables")("copyWithin")},{"./_add-to-unscopables":29,"./_array-copy-within":33,"./_export":58}],158:[function(e,t,n){var r=e("./_export"),i=e("./_array-methods")(4);r(r.P+r.F*!e("./_strict-method")([].every,!0),"Array",{every:function(e){return i(this,e,arguments[1])}})},{"./_array-methods":37,"./_export":58,"./_strict-method":130}],159:[function(e,t,n){var r=e("./_export");r(r.P,"Array",{fill:e("./_array-fill")}),e("./_add-to-unscopables")("fill")},{"./_add-to-unscopables":29,"./_array-fill":34,"./_export":58}],160:[function(e,t,n){var r=e("./_export"),i=e("./_array-methods")(2);r(r.P+r.F*!e("./_strict-method")([].filter,!0),"Array",{filter:function(e){return i(this,e,arguments[1])}})},{"./_array-methods":37,"./_export":58,"./_strict-method":130}],161:[function(e,t,n){var r=e("./_export"),i=e("./_array-methods")(6),o="findIndex",a=!0;o in[]&&Array(1)[o](function(){a=!1}),r(r.P+r.F*a,"Array",{findIndex:function(e){return i(this,e,1<arguments.length?arguments[1]:void 0)}}),e("./_add-to-unscopables")(o)},{"./_add-to-unscopables":29,"./_array-methods":37,"./_export":58}],162:[function(e,t,n){var r=e("./_export"),i=e("./_array-methods")(5),o="find",a=!0;o in[]&&Array(1)[o](function(){a=!1}),r(r.P+r.F*a,"Array",{find:function(e){return i(this,e,1<arguments.length?arguments[1]:void 0)}}),e("./_add-to-unscopables")(o)},{"./_add-to-unscopables":29,"./_array-methods":37,"./_export":58}],163:[function(e,t,n){var r=e("./_export"),i=e("./_array-methods")(0),e=e("./_strict-method")([].forEach,!0);r(r.P+r.F*!e,"Array",{forEach:function(e){return i(this,e,arguments[1])}})},{"./_array-methods":37,"./_export":58,"./_strict-method":130}],164:[function(e,t,n){var h=e("./_ctx"),r=e("./_export"),d=e("./_to-object"),p=e("./_iter-call"),f=e("./_is-array-iter"),m=e("./_to-length"),g=e("./_create-property"),v=e("./core.get-iterator-method");r(r.S+r.F*!e("./_iter-detect")(function(e){Array.from(e)}),"Array",{from:function(e){var t,n,r,i,o=d(e),e="function"==typeof this?this:Array,a=arguments.length,s=1<a?arguments[1]:void 0,c=void 0!==s,l=0,u=v(o);if(c&&(s=h(s,2<a?arguments[2]:void 0,2)),null==u||e==Array&&f(u))for(n=new e(t=m(o.length));l<t;l++)g(n,l,c?s(o[l],l):o[l]);else for(i=u.call(o),n=new e;!(r=i.next()).done;l++)g(n,l,c?p(i,s,[r.value,l],!0):r.value);return n.length=l,n}})},{"./_create-property":49,"./_ctx":50,"./_export":58,"./_is-array-iter":74,"./_iter-call":79,"./_iter-detect":82,"./_to-length":143,"./_to-object":144,"./core.get-iterator-method":155}],165:[function(e,t,n){var r=e("./_export"),i=e("./_array-includes")(!1),o=[].indexOf,a=!!o&&1/[1].indexOf(1,-0)<0;r(r.P+r.F*(a||!e("./_strict-method")(o)),"Array",{indexOf:function(e){return a?o.apply(this,arguments)||0:i(this,e,arguments[1])}})},{"./_array-includes":36,"./_export":58,"./_strict-method":130}],166:[function(e,t,n){var r=e("./_export");r(r.S,"Array",{isArray:e("./_is-array")})},{"./_export":58,"./_is-array":75}],167:[function(e,t,n){var r=e("./_add-to-unscopables"),i=e("./_iter-step"),o=e("./_iterators"),a=e("./_to-iobject");t.exports=e("./_iter-define")(Array,"Array",function(e,t){this._t=a(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,i(1)):i(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])},"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},{"./_add-to-unscopables":29,"./_iter-define":81,"./_iter-step":83,"./_iterators":84,"./_to-iobject":142}],168:[function(e,t,n){var r=e("./_export"),i=e("./_to-iobject"),o=[].join;r(r.P+r.F*(e("./_iobject")!=Object||!e("./_strict-method")(o)),"Array",{join:function(e){return o.call(i(this),void 0===e?",":e)}})},{"./_export":58,"./_iobject":73,"./_strict-method":130,"./_to-iobject":142}],169:[function(e,t,n){var r=e("./_export"),i=e("./_to-iobject"),o=e("./_to-integer"),a=e("./_to-length"),s=[].lastIndexOf,c=!!s&&1/[1].lastIndexOf(1,-0)<0;r(r.P+r.F*(c||!e("./_strict-method")(s)),"Array",{lastIndexOf:function(e){if(c)return s.apply(this,arguments)||0;var t=i(this),n=a(t.length),r=n-1;for((r=1<arguments.length?Math.min(r,o(arguments[1])):r)<0&&(r=n+r);0<=r;r--)if(r in t&&t[r]===e)return r||0;return-1}})},{"./_export":58,"./_strict-method":130,"./_to-integer":141,"./_to-iobject":142,"./_to-length":143}],170:[function(e,t,n){var r=e("./_export"),i=e("./_array-methods")(1);r(r.P+r.F*!e("./_strict-method")([].map,!0),"Array",{map:function(e){return i(this,e,arguments[1])}})},{"./_array-methods":37,"./_export":58,"./_strict-method":130}],171:[function(e,t,n){var r=e("./_export"),i=e("./_create-property");r(r.S+r.F*e("./_fails")(function(){function e(){}return!(Array.of.call(e)instanceof e)}),"Array",{of:function(){for(var e=0,t=arguments.length,n=new("function"==typeof this?this:Array)(t);e<t;)i(n,e,arguments[e++]);return n.length=t,n}})},{"./_create-property":49,"./_export":58,"./_fails":60}],172:[function(e,t,n){var r=e("./_export"),i=e("./_array-reduce");r(r.P+r.F*!e("./_strict-method")([].reduceRight,!0),"Array",{reduceRight:function(e){return i(this,e,arguments.length,arguments[1],!0)}})},{"./_array-reduce":38,"./_export":58,"./_strict-method":130}],173:[function(e,t,n){var r=e("./_export"),i=e("./_array-reduce");r(r.P+r.F*!e("./_strict-method")([].reduce,!0),"Array",{reduce:function(e){return i(this,e,arguments.length,arguments[1],!1)}})},{"./_array-reduce":38,"./_export":58,"./_strict-method":130}],174:[function(e,t,n){var r=e("./_export"),i=e("./_html"),c=e("./_cof"),l=e("./_to-absolute-index"),u=e("./_to-length"),h=[].slice;r(r.P+r.F*e("./_fails")(function(){i&&h.call(i)}),"Array",{slice:function(e,t){var n=u(this.length),r=c(this);if(t=void 0===t?n:t,"Array"==r)return h.call(this,e,t);for(var i=l(e,n),e=l(t,n),o=u(e-i),a=new Array(o),s=0;s<o;s++)a[s]="String"==r?this.charAt(i+s):this[i+s];return a}})},{"./_cof":43,"./_export":58,"./_fails":60,"./_html":69,"./_to-absolute-index":139,"./_to-length":143}],175:[function(e,t,n){var r=e("./_export"),i=e("./_array-methods")(3);r(r.P+r.F*!e("./_strict-method")([].some,!0),"Array",{some:function(e){return i(this,e,arguments[1])}})},{"./_array-methods":37,"./_export":58,"./_strict-method":130}],176:[function(e,t,n){var r=e("./_export"),i=e("./_a-function"),o=e("./_to-object"),a=e("./_fails"),s=[].sort,c=[1,2,3];r(r.P+r.F*(a(function(){c.sort(void 0)})||!a(function(){c.sort(null)})||!e("./_strict-method")(s)),"Array",{sort:function(e){return void 0===e?s.call(o(this)):s.call(o(this),i(e))}})},{"./_a-function":27,"./_export":58,"./_fails":60,"./_strict-method":130,"./_to-object":144}],177:[function(e,t,n){e("./_set-species")("Array")},{"./_set-species":125}],178:[function(e,t,n){e=e("./_export");e(e.S,"Date",{now:function(){return(new Date).getTime()}})},{"./_export":58}],179:[function(e,t,n){var r=e("./_export"),e=e("./_date-to-iso-string");r(r.P+r.F*(Date.prototype.toISOString!==e),"Date",{toISOString:e})},{"./_date-to-iso-string":51,"./_export":58}],180:[function(e,t,n){var r=e("./_export"),i=e("./_to-object"),o=e("./_to-primitive");r(r.P+r.F*e("./_fails")(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(e){var t=i(this),n=o(t);return"number"!=typeof n||isFinite(n)?t.toISOString():null}})},{"./_export":58,"./_fails":60,"./_to-object":144,"./_to-primitive":145}],181:[function(e,t,n){var r=e("./_wks")("toPrimitive"),i=Date.prototype;r in i||e("./_hide")(i,r,e("./_date-to-primitive"))},{"./_date-to-primitive":52,"./_hide":68,"./_wks":154}],182:[function(e,t,n){var r=Date.prototype,i="Invalid Date",o="toString",a=r[o],s=r.getTime;new Date(NaN)+""!=i&&e("./_redefine")(r,o,function(){var e=s.call(this);return e==e?a.call(this):i})},{"./_redefine":117}],183:[function(e,t,n){var r=e("./_export");r(r.P,"Function",{bind:e("./_bind")})},{"./_bind":41,"./_export":58}],184:[function(e,t,n){var r=e("./_is-object"),i=e("./_object-gpo"),o=e("./_wks")("hasInstance"),a=Function.prototype;o in a||e("./_object-dp").f(a,o,{value:function(e){if("function"==typeof this&&r(e)){if(!r(this.prototype))return e instanceof this;for(;e=i(e);)if(this.prototype===e)return!0}return!1}})},{"./_is-object":77,"./_object-dp":97,"./_object-gpo":104,"./_wks":154}],185:[function(e,t,n){var r=e("./_object-dp").f,i=Function.prototype,o=/^\s*function ([^ (]*)/;"name"in i||e("./_descriptors")&&r(i,"name",{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(e){return""}}})},{"./_descriptors":54,"./_object-dp":97}],186:[function(e,t,n){var r=e("./_collection-strong"),i=e("./_validate-collection");t.exports=e("./_collection")("Map",function(e){return function(){return e(this,0<arguments.length?arguments[0]:void 0)}},{get:function(e){e=r.getEntry(i(this,"Map"),e);return e&&e.v},set:function(e,t){return r.def(i(this,"Map"),0===e?0:e,t)}},r,!0)},{"./_collection":47,"./_collection-strong":44,"./_validate-collection":151}],187:[function(e,t,n){var r=e("./_export"),i=e("./_math-log1p"),o=Math.sqrt,e=Math.acosh;r(r.S+r.F*!(e&&710==Math.floor(e(Number.MAX_VALUE))&&e(1/0)==1/0),"Math",{acosh:function(e){return(e=+e)<1?NaN:94906265.62425156<e?Math.log(e)+Math.LN2:i(e-1+o(e-1)*o(e+1))}})},{"./_export":58,"./_math-log1p":88}],188:[function(e,t,n){var e=e("./_export"),r=Math.asinh;e(e.S+e.F*!(r&&0<1/r(0)),"Math",{asinh:function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):Math.log(t+Math.sqrt(t*t+1)):t}})},{"./_export":58}],189:[function(e,t,n){var e=e("./_export"),r=Math.atanh;e(e.S+e.F*!(r&&1/r(-0)<0),"Math",{atanh:function(e){return 0==(e=+e)?e:Math.log((1+e)/(1-e))/2}})},{"./_export":58}],190:[function(e,t,n){var r=e("./_export"),i=e("./_math-sign");r(r.S,"Math",{cbrt:function(e){return i(e=+e)*Math.pow(Math.abs(e),1/3)}})},{"./_export":58,"./_math-sign":90}],191:[function(e,t,n){e=e("./_export");e(e.S,"Math",{clz32:function(e){return(e>>>=0)?31-Math.floor(Math.log(e+.5)*Math.LOG2E):32}})},{"./_export":58}],192:[function(e,t,n){var e=e("./_export"),r=Math.exp;e(e.S,"Math",{cosh:function(e){return(r(e=+e)+r(-e))/2}})},{"./_export":58}],193:[function(e,t,n){var r=e("./_export"),e=e("./_math-expm1");r(r.S+r.F*(e!=Math.expm1),"Math",{expm1:e})},{"./_export":58,"./_math-expm1":86}],194:[function(e,t,n){var r=e("./_export");r(r.S,"Math",{fround:e("./_math-fround")})},{"./_export":58,"./_math-fround":87}],195:[function(e,t,n){var e=e("./_export"),c=Math.abs;e(e.S,"Math",{hypot:function(e,t){for(var n,r,i=0,o=0,a=arguments.length,s=0;o<a;)s<(n=c(arguments[o++]))?(i=i*(r=s/n)*r+1,s=n):i+=0<n?(r=n/s)*r:n;return s===1/0?1/0:s*Math.sqrt(i)}})},{"./_export":58}],196:[function(e,t,n){var r=e("./_export"),i=Math.imul;r(r.S+r.F*e("./_fails")(function(){return-5!=i(4294967295,5)||2!=i.length}),"Math",{imul:function(e,t){var n=65535,e=+e,t=+t,r=n&e,i=n&t;return 0|r*i+((n&e>>>16)*i+r*(n&t>>>16)<<16>>>0)}})},{"./_export":58,"./_fails":60}],197:[function(e,t,n){e=e("./_export");e(e.S,"Math",{log10:function(e){return Math.log(e)*Math.LOG10E}})},{"./_export":58}],198:[function(e,t,n){var r=e("./_export");r(r.S,"Math",{log1p:e("./_math-log1p")})},{"./_export":58,"./_math-log1p":88}],199:[function(e,t,n){e=e("./_export");e(e.S,"Math",{log2:function(e){return Math.log(e)/Math.LN2}})},{"./_export":58}],200:[function(e,t,n){var r=e("./_export");r(r.S,"Math",{sign:e("./_math-sign")})},{"./_export":58,"./_math-sign":90}],201:[function(e,t,n){var r=e("./_export"),i=e("./_math-expm1"),o=Math.exp;r(r.S+r.F*e("./_fails")(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(e){return Math.abs(e=+e)<1?(i(e)-i(-e))/2:(o(e-1)-o(-e-1))*(Math.E/2)}})},{"./_export":58,"./_fails":60,"./_math-expm1":86}],202:[function(e,t,n){var r=e("./_export"),i=e("./_math-expm1"),o=Math.exp;r(r.S,"Math",{tanh:function(e){var t=i(e=+e),n=i(-e);return t==1/0?1:n==1/0?-1:(t-n)/(o(e)+o(-e))}})},{"./_export":58,"./_math-expm1":86}],203:[function(e,t,n){e=e("./_export");e(e.S,"Math",{trunc:function(e){return(0<e?Math.floor:Math.ceil)(e)}})},{"./_export":58}],204:[function(e,t,n){function r(e){if("string"==typeof(t=l(e,!1))&&2<t.length){var t,n,r,i,e=(t=y?t.trim():p(t,3)).charCodeAt(0);if(43===e||45===e){if(88===(n=t.charCodeAt(2))||120===n)return NaN}else if(48===e){switch(t.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+t}for(var o,a=t.slice(2),s=0,c=a.length;s<c;s++)if((o=a.charCodeAt(s))<48||i<o)return NaN;return parseInt(a,r)}}return+t}var i=e("./_global"),o=e("./_has"),a=e("./_cof"),s=e("./_inherit-if-required"),l=e("./_to-primitive"),c=e("./_fails"),u=e("./_object-gopn").f,h=e("./_object-gopd").f,d=e("./_object-dp").f,p=e("./_string-trim").trim,f="Number",m=x=i[f],g=x.prototype,v=a(e("./_object-create")(g))==f,y="trim"in String.prototype;if(!x(" 0o1")||!x("0b1")||x("+0x1")){for(var _,x=function(e){var e=arguments.length<1?0:e,t=this;return t instanceof x&&(v?c(function(){g.valueOf.call(t)}):a(t)!=f)?s(new m(r(e)),t,x):r(e)},b=e("./_descriptors")?u(m):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),w=0;b.length>w;w++)o(m,_=b[w])&&!o(x,_)&&d(x,_,h(m,_));(x.prototype=g).constructor=x,e("./_redefine")(i,f,x)}},{"./_cof":43,"./_descriptors":54,"./_fails":60,"./_global":66,"./_has":67,"./_inherit-if-required":71,"./_object-create":96,"./_object-dp":97,"./_object-gopd":100,"./_object-gopn":102,"./_redefine":117,"./_string-trim":136,"./_to-primitive":145}],205:[function(e,t,n){e=e("./_export");e(e.S,"Number",{EPSILON:Math.pow(2,-52)})},{"./_export":58}],206:[function(e,t,n){var r=e("./_export"),i=e("./_global").isFinite;r(r.S,"Number",{isFinite:function(e){return"number"==typeof e&&i(e)}})},{"./_export":58,"./_global":66}],207:[function(e,t,n){var r=e("./_export");r(r.S,"Number",{isInteger:e("./_is-integer")})},{"./_export":58,"./_is-integer":76}],208:[function(e,t,n){e=e("./_export");e(e.S,"Number",{isNaN:function(e){return e!=e}})},{"./_export":58}],209:[function(e,t,n){var r=e("./_export"),i=e("./_is-integer"),o=Math.abs;r(r.S,"Number",{isSafeInteger:function(e){return i(e)&&o(e)<=9007199254740991}})},{"./_export":58,"./_is-integer":76}],210:[function(e,t,n){e=e("./_export");e(e.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},{"./_export":58}],211:[function(e,t,n){e=e("./_export");e(e.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},{"./_export":58}],212:[function(e,t,n){var r=e("./_export"),e=e("./_parse-float");r(r.S+r.F*(Number.parseFloat!=e),"Number",{parseFloat:e})},{"./_export":58,"./_parse-float":111}],213:[function(e,t,n){var r=e("./_export"),e=e("./_parse-int");r(r.S+r.F*(Number.parseInt!=e),"Number",{parseInt:e})},{"./_export":58,"./_parse-int":112}],214:[function(e,t,n){function a(e,t){for(var n=-1,r=t;++n<6;)p[n]=(r+=e*p[n])%1e7,r=o(r/1e7)}function s(e){for(var t=6,n=0;0<=--t;)p[t]=o((n+=p[t])/e),n=n%e*1e7}function c(){for(var e,t=6,n="";0<=--t;)""===n&&0!==t&&0===p[t]||(e=String(p[t]),n=""===n?e:n+d.call("0",7-e.length)+e);return n}function l(e,t,n){return 0===t?n:t%2==1?l(e,t-1,n*e):l(e*e,t/2,n)}var r=e("./_export"),u=e("./_to-integer"),h=e("./_a-number-value"),d=e("./_string-repeat"),i=1..toFixed,o=Math.floor,p=[0,0,0,0,0,0],f="Number.toFixed: incorrect invocation!";r(r.P+r.F*(!!i&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==0xde0b6b3a7640080.toFixed(0))||!e("./_fails")(function(){i.call({})})),"Number",{toFixed:function(e){var t,n,r=h(this,f),e=u(e),i="",o="0";if(e<0||20<e)throw RangeError(f);if(r!=r)return"NaN";if(r<=-1e21||1e21<=r)return String(r);if(r<0&&(i="-",r=-r),1e-21<r)if(r=(t=(e=>{for(var t=0,n=e;4096<=n;)t+=12,n/=4096;for(;2<=n;)t+=1,n/=2;return t})(r*l(2,69,1))-69)<0?r*l(2,-t,1):r/l(2,t,1),r*=4503599627370496,0<(t=52-t)){for(a(0,r),n=e;7<=n;)a(1e7,0),n-=7;for(a(l(10,n,1),0),n=t-1;23<=n;)s(1<<23),n-=23;s(1<<n),a(1,1),s(2),o=c()}else a(0,r),a(1<<-t,0),o=c()+d.call("0",e);return o=0<e?i+((r=o.length)<=e?"0."+d.call("0",e-r)+o:o.slice(0,r-e)+"."+o.slice(r-e)):i+o}})},{"./_a-number-value":28,"./_export":58,"./_fails":60,"./_string-repeat":135,"./_to-integer":141}],215:[function(e,t,n){var r=e("./_export"),i=e("./_fails"),o=e("./_a-number-value"),a=1..toPrecision;r(r.P+r.F*(i(function(){return"1"!==a.call(1,void 0)})||!i(function(){a.call({})})),"Number",{toPrecision:function(e){var t=o(this,"Number#toPrecision: incorrect invocation!");return void 0===e?a.call(t):a.call(t,e)}})},{"./_a-number-value":28,"./_export":58,"./_fails":60}],216:[function(e,t,n){var r=e("./_export");r(r.S+r.F,"Object",{assign:e("./_object-assign")})},{"./_export":58,"./_object-assign":95}],217:[function(e,t,n){var r=e("./_export");r(r.S,"Object",{create:e("./_object-create")})},{"./_export":58,"./_object-create":96}],218:[function(e,t,n){var r=e("./_export");r(r.S+r.F*!e("./_descriptors"),"Object",{defineProperties:e("./_object-dps")})},{"./_descriptors":54,"./_export":58,"./_object-dps":98}],219:[function(e,t,n){var r=e("./_export");r(r.S+r.F*!e("./_descriptors"),"Object",{defineProperty:e("./_object-dp").f})},{"./_descriptors":54,"./_export":58,"./_object-dp":97}],220:[function(e,t,n){var r=e("./_is-object"),i=e("./_meta").onFreeze;e("./_object-sap")("freeze",function(t){return function(e){return t&&r(e)?t(i(e)):e}})},{"./_is-object":77,"./_meta":91,"./_object-sap":108}],221:[function(e,t,n){var r=e("./_to-iobject"),i=e("./_object-gopd").f;e("./_object-sap")("getOwnPropertyDescriptor",function(){return function(e,t){return i(r(e),t)}})},{"./_object-gopd":100,"./_object-sap":108,"./_to-iobject":142}],222:[function(e,t,n){e("./_object-sap")("getOwnPropertyNames",function(){return e("./_object-gopn-ext").f})},{"./_object-gopn-ext":101,"./_object-sap":108}],223:[function(e,t,n){var r=e("./_to-object"),i=e("./_object-gpo");e("./_object-sap")("getPrototypeOf",function(){return function(e){return i(r(e))}})},{"./_object-gpo":104,"./_object-sap":108,"./_to-object":144}],224:[function(e,t,n){var r=e("./_is-object");e("./_object-sap")("isExtensible",function(t){return function(e){return!!r(e)&&(!t||t(e))}})},{"./_is-object":77,"./_object-sap":108}],225:[function(e,t,n){var r=e("./_is-object");e("./_object-sap")("isFrozen",function(t){return function(e){return!r(e)||!!t&&t(e)}})},{"./_is-object":77,"./_object-sap":108}],226:[function(e,t,n){var r=e("./_is-object");e("./_object-sap")("isSealed",function(t){return function(e){return!r(e)||!!t&&t(e)}})},{"./_is-object":77,"./_object-sap":108}],227:[function(e,t,n){var r=e("./_export");r(r.S,"Object",{is:e("./_same-value")})},{"./_export":58,"./_same-value":121}],228:[function(e,t,n){var r=e("./_to-object"),i=e("./_object-keys");e("./_object-sap")("keys",function(){return function(e){return i(r(e))}})},{"./_object-keys":106,"./_object-sap":108,"./_to-object":144}],229:[function(e,t,n){var r=e("./_is-object"),i=e("./_meta").onFreeze;e("./_object-sap")("preventExtensions",function(t){return function(e){return t&&r(e)?t(i(e)):e}})},{"./_is-object":77,"./_meta":91,"./_object-sap":108}],230:[function(e,t,n){var r=e("./_is-object"),i=e("./_meta").onFreeze;e("./_object-sap")("seal",function(t){return function(e){return t&&r(e)?t(i(e)):e}})},{"./_is-object":77,"./_meta":91,"./_object-sap":108}],231:[function(e,t,n){var r=e("./_export");r(r.S,"Object",{setPrototypeOf:e("./_set-proto").set})},{"./_export":58,"./_set-proto":124}],232:[function(e,t,n){var r=e("./_classof"),i={};i[e("./_wks")("toStringTag")]="z",i+""!="[object z]"&&e("./_redefine")(Object.prototype,"toString",function(){return"[object "+r(this)+"]"},!0)},{"./_classof":42,"./_redefine":117,"./_wks":154}],233:[function(e,t,n){var r=e("./_export"),e=e("./_parse-float");r(r.G+r.F*(parseFloat!=e),{parseFloat:e})},{"./_export":58,"./_parse-float":111}],234:[function(e,t,n){var r=e("./_export"),e=e("./_parse-int");r(r.G+r.F*(parseInt!=e),{parseInt:e})},{"./_export":58,"./_parse-int":112}],235:[function(n,F,D){function r(){}function f(i){y.call(c,function(){var e,t,n=i._v,r=O(i);if(r&&(e=b(function(){R?S.emit("unhandledRejection",n,i):(t=c.onunhandledrejection)?t({promise:i,reason:n}):(t=c.console)&&t.error&&t.error("Unhandled promise rejection",n)}),i._h=R||O(i)?2:1),i._a=void 0,r&&e.e)throw e.v})}function m(t){y.call(c,function(){var e;R?S.emit("rejectionHandled",t):(e=c.onrejectionhandled)&&e({promise:t,reason:t._v})})}var t,i,o,a,s=n("./_library"),c=n("./_global"),l=n("./_ctx"),e=n("./_classof"),u=n("./_export"),h=n("./_is-object"),d=n("./_a-function"),p=n("./_an-instance"),g=n("./_for-of"),v=n("./_species-constructor"),y=n("./_task").set,_=n("./_microtask")(),x=n("./_new-promise-capability"),b=n("./_perform"),w=n("./_user-agent"),E=n("./_promise-resolve"),M="Promise",T=c.TypeError,S=c.process,A=S&&S.versions,H=A&&A.v8||"",P=c[M],R="process"==e(S),L=i=x.f,A=!!(()=>{try{var e=P.resolve(1),t=(e.constructor={})[n("./_wks")("species")]=function(e){e(r,r)};return(R||"function"==typeof PromiseRejectionEvent)&&e.then(r)instanceof t&&0!==H.indexOf("6.6")&&-1===w.indexOf("Chrome/66")}catch(e){}})(),C=function(e){var t;return!(!h(e)||"function"!=typeof(t=e.then))&&t},I=function(h,d){var p;h._n||(h._n=!0,p=h._c,_(function(){for(var e=h._v,t=1==h._s,n=0;p.length>n;){a=o=i=u=l=c=s=r=void 0;var r=p[n++],i,o,a,s=t?r.ok:r.fail,c=r.resolve,l=r.reject,u=r.domain;try{s?(t||(2==h._h&&m(h),h._h=1),!0===s?i=e:(u&&u.enter(),i=s(e),u&&(u.exit(),a=!0)),i===r.promise?l(T("Promise-chain cycle")):(o=C(i))?o.call(i,c,l):c(i)):l(e)}catch(e){u&&!a&&u.exit(),l(e)}}h._c=[],h._n=!1,d&&!h._h&&f(h)}))},O=function(e){return 1!==e._h&&0===(e._a||e._c).length},j=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),I(t,!0))},N=function(e){var n,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===e)throw T("Promise can't be resolved itself");(n=C(e))?_(function(){var t={_w:r,_d:!1};try{n.call(e,l(N,t,1),l(j,t,1))}catch(e){j.call(t,e)}}):(r._v=e,r._s=1,I(r,!1))}catch(e){j.call({_w:r,_d:!1},e)}}};A||(P=function(e){p(this,P,M,"_h"),d(e),t.call(this);try{e(l(N,this,1),l(j,this,1))}catch(e){j.call(this,e)}},(t=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n("./_redefine-all")(P.prototype,{then:function(e,t){var n=L(v(this,P));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=R?S.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&I(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),o=function(){var e=new t;this.promise=e,this.resolve=l(N,e,1),this.reject=l(j,e,1)},x.f=L=function(e){return e===P||e===a?new o:i(e)}),u(u.G+u.W+u.F*!A,{Promise:P}),n("./_set-to-string-tag")(P,M),n("./_set-species")(M),a=n("./_core")[M],u(u.S+u.F*!A,M,{reject:function(e){var t=L(this);return(0,t.reject)(e),t.promise}}),u(u.S+u.F*(s||!A),M,{resolve:function(e){return E(s&&this===a?P:this,e)}}),u(u.S+u.F*!(A&&n("./_iter-detect")(function(e){P.all(e).catch(r)})),M,{all:function(e){var a=this,t=L(a),s=t.resolve,c=t.reject,n=b(function(){var r=[],i=0,o=1;g(e,!1,function(e){var t=i++,n=!1;r.push(void 0),o++,a.resolve(e).then(function(e){n||(n=!0,r[t]=e,--o)||s(r)},c)}),--o||s(r)});return n.e&&c(n.v),t.promise},race:function(e){var t=this,n=L(t),r=n.reject,i=b(function(){g(e,!1,function(e){t.resolve(e).then(n.resolve,r)})});return i.e&&r(i.v),n.promise}})},{"./_a-function":27,"./_an-instance":31,"./_classof":42,"./_core":48,"./_ctx":50,"./_export":58,"./_for-of":64,"./_global":66,"./_is-object":77,"./_iter-detect":82,"./_library":85,"./_microtask":93,"./_new-promise-capability":94,"./_perform":113,"./_promise-resolve":114,"./_redefine-all":116,"./_set-species":125,"./_set-to-string-tag":126,"./_species-constructor":129,"./_task":138,"./_user-agent":150,"./_wks":154}],236:[function(e,t,n){var r=e("./_export"),i=e("./_a-function"),o=e("./_an-object"),a=(e("./_global").Reflect||{}).apply,s=Function.apply;r(r.S+r.F*!e("./_fails")(function(){a(function(){})}),"Reflect",{apply:function(e,t,n){e=i(e),n=o(n);return a?a(e,t,n):s.call(e,t,n)}})},{"./_a-function":27,"./_an-object":32,"./_export":58,"./_fails":60,"./_global":66}],237:[function(e,t,n){var r=e("./_export"),i=e("./_object-create"),o=e("./_a-function"),a=e("./_an-object"),s=e("./_is-object"),c=e("./_fails"),l=e("./_bind"),u=(e("./_global").Reflect||{}).construct,h=c(function(){function e(){}return!(u(function(){},[],e)instanceof e)}),d=!c(function(){u(function(){})});r(r.S+r.F*(h||d),"Reflect",{construct:function(e,t){o(e),a(t);var n=arguments.length<3?e:o(arguments[2]);if(d&&!h)return u(e,t,n);if(e==n){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var r=[null];return r.push.apply(r,t),new(l.apply(e,r))}r=n.prototype,n=i(s(r)?r:Object.prototype),r=Function.apply.call(e,n,t);return s(r)?r:n}})},{"./_a-function":27,"./_an-object":32,"./_bind":41,"./_export":58,"./_fails":60,"./_global":66,"./_is-object":77,"./_object-create":96}],238:[function(e,t,n){var r=e("./_object-dp"),i=e("./_export"),o=e("./_an-object"),a=e("./_to-primitive");i(i.S+i.F*e("./_fails")(function(){Reflect.defineProperty(r.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(e,t,n){o(e),t=a(t,!0),o(n);try{return r.f(e,t,n),!0}catch(e){return!1}}})},{"./_an-object":32,"./_export":58,"./_fails":60,"./_object-dp":97,"./_to-primitive":145}],239:[function(e,t,n){var r=e("./_export"),i=e("./_object-gopd").f,o=e("./_an-object");r(r.S,"Reflect",{deleteProperty:function(e,t){var n=i(o(e),t);return!(n&&!n.configurable)&&delete e[t]}})},{"./_an-object":32,"./_export":58,"./_object-gopd":100}],240:[function(e,t,n){function r(e){this._t=o(e),this._i=0;var t,n=this._k=[];for(t in e)n.push(t)}var i=e("./_export"),o=e("./_an-object");e("./_iter-create")(r,"Object",function(){var e,t=this._k;do{if(this._i>=t.length)return{value:void 0,done:!0}}while(!((e=t[this._i++])in this._t));return{value:e,done:!1}}),i(i.S,"Reflect",{enumerate:function(e){return new r(e)}})},{"./_an-object":32,"./_export":58,"./_iter-create":80}],241:[function(e,t,n){var r=e("./_object-gopd"),i=e("./_export"),o=e("./_an-object");i(i.S,"Reflect",{getOwnPropertyDescriptor:function(e,t){return r.f(o(e),t)}})},{"./_an-object":32,"./_export":58,"./_object-gopd":100}],242:[function(e,t,n){var r=e("./_export"),i=e("./_object-gpo"),o=e("./_an-object");r(r.S,"Reflect",{getPrototypeOf:function(e){return i(o(e))}})},{"./_an-object":32,"./_export":58,"./_object-gpo":104}],243:[function(e,t,n){var o=e("./_object-gopd"),a=e("./_object-gpo"),s=e("./_has"),r=e("./_export"),c=e("./_is-object"),l=e("./_an-object");r(r.S,"Reflect",{get:function e(t,n){var r,i=arguments.length<3?t:arguments[2];return l(t)===i?t[n]:(r=o.f(t,n))?s(r,"value")?r.value:void 0!==r.get?r.get.call(i):void 0:c(r=a(t))?e(r,n,i):void 0}})},{"./_an-object":32,"./_export":58,"./_has":67,"./_is-object":77,"./_object-gopd":100,"./_object-gpo":104}],244:[function(e,t,n){e=e("./_export");e(e.S,"Reflect",{has:function(e,t){return t in e}})},{"./_export":58}],245:[function(e,t,n){var r=e("./_export"),i=e("./_an-object"),o=Object.isExtensible;r(r.S,"Reflect",{isExtensible:function(e){return i(e),!o||o(e)}})},{"./_an-object":32,"./_export":58}],246:[function(e,t,n){var r=e("./_export");r(r.S,"Reflect",{ownKeys:e("./_own-keys")})},{"./_export":58,"./_own-keys":110}],247:[function(e,t,n){var r=e("./_export"),i=e("./_an-object"),o=Object.preventExtensions;r(r.S,"Reflect",{preventExtensions:function(e){i(e);try{return o&&o(e),!0}catch(e){return!1}}})},{"./_an-object":32,"./_export":58}],248:[function(e,t,n){var r=e("./_export"),i=e("./_set-proto");i&&r(r.S,"Reflect",{setPrototypeOf:function(e,t){i.check(e,t);try{return i.set(e,t),!0}catch(e){return!1}}})},{"./_export":58,"./_set-proto":124}],249:[function(e,t,n){var a=e("./_object-dp"),s=e("./_object-gopd"),c=e("./_object-gpo"),l=e("./_has"),r=e("./_export"),u=e("./_property-desc"),h=e("./_an-object"),d=e("./_is-object");r(r.S,"Reflect",{set:function e(t,n,r){var i=arguments.length<4?t:arguments[3],o=s.f(h(t),n);if(!o){if(d(t=c(t)))return e(t,n,r,i);o=u(0)}if(l(o,"value")){if(!1===o.writable||!d(i))return!1;if(t=s.f(i,n)){if(t.get||t.set||!1===t.writable)return!1;t.value=r,a.f(i,n,t)}else a.f(i,n,u(0,r));return!0}return void 0!==o.set&&(o.set.call(i,r),!0)}})},{"./_an-object":32,"./_export":58,"./_has":67,"./_is-object":77,"./_object-dp":97,"./_object-gopd":100,"./_object-gpo":104,"./_property-desc":115}],250:[function(e,t,n){var r=e("./_global"),o=e("./_inherit-if-required"),i=e("./_object-dp").f,a=e("./_object-gopn").f,s=e("./_is-regexp"),c=e("./_flags"),l=f=r.RegExp,u=f.prototype,h=/a/g,d=/a/g,p=new f(h)!==h;if(e("./_descriptors")&&(!p||e("./_fails")(function(){return d[e("./_wks")("match")]=!1,f(h)!=h||f(d)==d||"/a/i"!=f(h,"i")}))){for(var f=function(e,t){var n=this instanceof f,r=s(e),i=void 0===t;return!n&&r&&e.constructor===f&&i?e:o(p?new l(r&&!i?e.source:e,t):l((r=e instanceof f)?e.source:e,r&&i?c.call(e):t),n?this:u,f)},m=a(l),g=0;m.length>g;)(t=>{t in f||i(f,t,{configurable:!0,get:function(){return l[t]},set:function(e){l[t]=e}})})(m[g++]);(u.constructor=f).prototype=u,e("./_redefine")(r,"RegExp",f)}e("./_set-species")("RegExp")},{"./_descriptors":54,"./_fails":60,"./_flags":62,"./_global":66,"./_inherit-if-required":71,"./_is-regexp":78,"./_object-dp":97,"./_object-gopn":102,"./_redefine":117,"./_set-species":125,"./_wks":154}],251:[function(e,t,n){var r=e("./_regexp-exec");e("./_export")({target:"RegExp",proto:!0,forced:r!==/./.exec},{exec:r})},{"./_export":58,"./_regexp-exec":119}],252:[function(e,t,n){e("./_descriptors")&&"g"!=/./g.flags&&e("./_object-dp").f(RegExp.prototype,"flags",{configurable:!0,get:e("./_flags")})},{"./_descriptors":54,"./_flags":62,"./_object-dp":97}],253:[function(e,t,n){var u=e("./_an-object"),h=e("./_to-length"),d=e("./_advance-string-index"),p=e("./_regexp-exec-abstract");e("./_fix-re-wks")("match",1,function(r,i,c,l){return[function(e){var t=r(this),n=null==e?void 0:e[i];return void 0!==n?n.call(e,t):new RegExp(e)[i](String(t))},function(e){var t=l(c,e,this);if(t.done)return t.value;var n=u(e),r=String(this);if(!n.global)return p(n,r);for(var i=n.unicode,o=[],a=n.lastIndex=0;null!==(s=p(n,r));){var s=String(s[0]);""===(o[a]=s)&&(n.lastIndex=d(r,h(n.lastIndex),i)),a++}return 0===a?null:o}]})},{"./_advance-string-index":30,"./_an-object":32,"./_fix-re-wks":61,"./_regexp-exec-abstract":118,"./_to-length":143}],254:[function(e,t,n){var w=e("./_an-object"),E=e("./_to-object"),M=e("./_to-length"),T=e("./_to-integer"),S=e("./_advance-string-index"),A=e("./_regexp-exec-abstract"),P=Math.max,R=Math.min,L=Math.floor,C=/\$([$&`']|\d\d?|<[^>]*>)/g,I=/\$([$&`']|\d\d?)/g;e("./_fix-re-wks")("replace",2,function(i,o,x,b){return[function(e,t){var n=i(this),r=null==e?void 0:e[o];return void 0!==r?r.call(e,n,t):x.call(String(n),e,t)},function(e,t){var n=b(x,e,this,t);if(n.done)return n.value;for(var r,i=w(e),o=String(this),a="function"==typeof t,s=(a||(t=String(t)),i.global),c=(s&&(r=i.unicode,i.lastIndex=0),[]);null!==(p=A(i,o))&&(c.push(p),s);)""===String(p[0])&&(i.lastIndex=S(o,M(i.lastIndex),r));for(var l,u="",h=0,d=0;d<c.length;d++){for(var p=c[d],f=String(p[0]),m=P(R(T(p.index),o.length),0),g=[],v=1;v<p.length;v++)g.push(void 0===(l=p[v])?l:String(l));var y=p.groups,_=a?(_=[f].concat(g,m,o),void 0!==y&&_.push(y),String(t.apply(void 0,_))):((o,a,s,c,l,e)=>{var u=s+o.length,h=c.length,t=I;return void 0!==l&&(l=E(l),t=C),x.call(e,t,function(e,t){var n;switch(t.charAt(0)){case"$":return"$";case"&":return o;case"`":return a.slice(0,s);case"'":return a.slice(u);case"<":n=l[t.slice(1,-1)];break;default:var r,i=+t;if(0==i)return e;if(h<i)return 0!==(r=L(i/10))&&r<=h?void 0===c[r-1]?t.charAt(1):c[r-1]+t.charAt(1):e;n=c[i-1]}return void 0===n?"":n})})(f,o,m,g,y,t);h<=m&&(u+=o.slice(h,m)+_,h=m+f.length)}return u+o.slice(h)}]})},{"./_advance-string-index":30,"./_an-object":32,"./_fix-re-wks":61,"./_regexp-exec-abstract":118,"./_to-integer":141,"./_to-length":143,"./_to-object":144}],255:[function(e,t,n){var s=e("./_an-object"),c=e("./_same-value"),l=e("./_regexp-exec-abstract");e("./_fix-re-wks")("search",1,function(r,i,o,a){return[function(e){var t=r(this),n=null==e?void 0:e[i];return void 0!==n?n.call(e,t):new RegExp(e)[i](String(t))},function(e){var t,n=a(o,e,this);return n.done?n.value:(n=s(e),e=String(this),t=n.lastIndex,c(t,0)||(n.lastIndex=0),e=l(n,e),c(n.lastIndex,t)||(n.lastIndex=t),null===e?-1:e.index)}]})},{"./_an-object":32,"./_fix-re-wks":61,"./_regexp-exec-abstract":118,"./_same-value":121}],256:[function(e,t,n){var h=e("./_is-regexp"),v=e("./_an-object"),y=e("./_species-constructor"),_=e("./_advance-string-index"),x=e("./_to-length"),b=e("./_regexp-exec-abstract"),d=e("./_regexp-exec"),r=e("./_fails"),w=Math.min,p=[].push,a="split",E="length",M="lastIndex",T=4294967295,S=!r(function(){RegExp(T,"y")});e("./_fix-re-wks")("split",2,function(i,o,f,m){var g="c"=="abbc"[a](/(b)*/)[1]||4!="test"[a](/(?:)/,-1)[E]||2!="ab"[a](/(?:ab)*/)[E]||4!="."[a](/(.?)(.?)/)[E]||1<"."[a](/()()/)[E]||""[a](/.?/)[E]?function(e,t){var n=String(this);if(void 0===e&&0===t)return[];if(!h(e))return f.call(n,e,t);for(var r,i,o,a=[],s=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),c=0,l=void 0===t?T:t>>>0,u=new RegExp(e.source,s+"g");(r=d.call(u,n))&&!(c<(i=u[M])&&(a.push(n.slice(c,r.index)),1<r[E]&&r.index<n[E]&&p.apply(a,r.slice(1)),o=r[0][E],c=i,l<=a[E]));)u[M]===r.index&&u[M]++;return c===n[E]?!o&&u.test("")||a.push(""):a.push(n.slice(c)),l<a[E]?a.slice(0,l):a}:"0"[a](void 0,0)[E]?function(e,t){return void 0===e&&0===t?[]:f.call(this,e,t)}:f;return[function(e,t){var n=i(this),r=null==e?void 0:e[o];return void 0!==r?r.call(e,n,t):g.call(String(n),e,t)},function(e,t){var n=m(g,e,this,t,g!==f);if(n.done)return n.value;var n=v(e),r=String(this),e=y(n,RegExp),i=n.unicode,o=(n.ignoreCase?"i":"")+(n.multiline?"m":"")+(n.unicode?"u":"")+(S?"y":"g"),a=new e(S?n:"^(?:"+n.source+")",o),s=void 0===t?T:t>>>0;if(0==s)return[];if(0===r.length)return null===b(a,r)?[r]:[];for(var c=0,l=0,u=[];l<r.length;){a.lastIndex=S?l:0;var h,d=b(a,S?r:r.slice(l));if(null===d||(h=w(x(a.lastIndex+(S?0:l)),r.length))===c)l=_(r,l,i);else{if(u.push(r.slice(c,l)),u.length===s)return u;for(var p=1;p<=d.length-1;p++)if(u.push(d[p]),u.length===s)return u;l=c=h}}return u.push(r.slice(c)),u}]})},{"./_advance-string-index":30,"./_an-object":32,"./_fails":60,"./_fix-re-wks":61,"./_is-regexp":78,"./_regexp-exec":119,"./_regexp-exec-abstract":118,"./_species-constructor":129,"./_to-length":143}],257:[function(t,e,n){t("./es6.regexp.flags");function r(e){t("./_redefine")(RegExp.prototype,s,e,!0)}var i=t("./_an-object"),o=t("./_flags"),a=t("./_descriptors"),s="toString",c=/./[s];t("./_fails")(function(){return"/a/b"!=c.call({source:"a",flags:"b"})})?r(function(){var e=i(this);return"/".concat(e.source,"/","flags"in e?e.flags:!a&&e instanceof RegExp?o.call(e):void 0)}):c.name!=s&&r(function(){return c.call(this)})},{"./_an-object":32,"./_descriptors":54,"./_fails":60,"./_flags":62,"./_redefine":117,"./es6.regexp.flags":252}],258:[function(e,t,n){var r=e("./_collection-strong"),i=e("./_validate-collection");t.exports=e("./_collection")("Set",function(e){return function(){return e(this,0<arguments.length?arguments[0]:void 0)}},{add:function(e){return r.def(i(this,"Set"),e=0===e?0:e,e)}},r)},{"./_collection":47,"./_collection-strong":44,"./_validate-collection":151}],259:[function(e,t,n){e("./_string-html")("anchor",function(t){return function(e){return t(this,"a","name",e)}})},{"./_string-html":133}],260:[function(e,t,n){e("./_string-html")("big",function(e){return function(){return e(this,"big","","")}})},{"./_string-html":133}],261:[function(e,t,n){e("./_string-html")("blink",function(e){return function(){return e(this,"blink","","")}})},{"./_string-html":133}],262:[function(e,t,n){e("./_string-html")("bold",function(e){return function(){return e(this,"b","","")}})},{"./_string-html":133}],263:[function(e,t,n){var r=e("./_export"),i=e("./_string-at")(!1);r(r.P,"String",{codePointAt:function(e){return i(this,e)}})},{"./_export":58,"./_string-at":131}],264:[function(e,t,n){var r=e("./_export"),i=e("./_to-length"),o=e("./_string-context"),a="endsWith",s=""[a];r(r.P+r.F*e("./_fails-is-regexp")(a),"String",{endsWith:function(e){var t=o(this,e,a),n=1<arguments.length?arguments[1]:void 0,r=i(t.length),n=void 0===n?r:Math.min(i(n),r),r=String(e);return s?s.call(t,r,n):t.slice(n-r.length,n)===r}})},{"./_export":58,"./_fails-is-regexp":59,"./_string-context":132,"./_to-length":143}],265:[function(e,t,n){e("./_string-html")("fixed",function(e){return function(){return e(this,"tt","","")}})},{"./_string-html":133}],266:[function(e,t,n){e("./_string-html")("fontcolor",function(t){return function(e){return t(this,"font","color",e)}})},{"./_string-html":133}],267:[function(e,t,n){e("./_string-html")("fontsize",function(t){return function(e){return t(this,"font","size",e)}})},{"./_string-html":133}],268:[function(e,t,n){var r=e("./_export"),o=e("./_to-absolute-index"),a=String.fromCharCode,e=String.fromCodePoint;r(r.S+r.F*(!!e&&1!=e.length),"String",{fromCodePoint:function(e){for(var t,n=[],r=arguments.length,i=0;i<r;){if(t=+arguments[i++],o(t,1114111)!==t)throw RangeError(t+" is not a valid code point");n.push(t<65536?a(t):a(55296+((t-=65536)>>10),t%1024+56320))}return n.join("")}})},{"./_export":58,"./_to-absolute-index":139}],269:[function(e,t,n){var r=e("./_export"),i=e("./_string-context");r(r.P+r.F*e("./_fails-is-regexp")("includes"),"String",{includes:function(e){return!!~i(this,e,"includes").indexOf(e,1<arguments.length?arguments[1]:void 0)}})},{"./_export":58,"./_fails-is-regexp":59,"./_string-context":132}],270:[function(e,t,n){e("./_string-html")("italics",function(e){return function(){return e(this,"i","","")}})},{"./_string-html":133}],271:[function(e,t,n){var r=e("./_string-at")(!0);e("./_iter-define")(String,"String",function(e){this._t=String(e),this._i=0},function(){var e=this._t,t=this._i;return t>=e.length?{value:void 0,done:!0}:(e=r(e,t),this._i+=e.length,{value:e,done:!1})})},{"./_iter-define":81,"./_string-at":131}],272:[function(e,t,n){e("./_string-html")("link",function(t){return function(e){return t(this,"a","href",e)}})},{"./_string-html":133}],273:[function(e,t,n){var r=e("./_export"),a=e("./_to-iobject"),s=e("./_to-length");r(r.S,"String",{raw:function(e){for(var t=a(e.raw),n=s(t.length),r=arguments.length,i=[],o=0;o<n;)i.push(String(t[o++])),o<r&&i.push(String(arguments[o]));return i.join("")}})},{"./_export":58,"./_to-iobject":142,"./_to-length":143}],274:[function(e,t,n){var r=e("./_export");r(r.P,"String",{repeat:e("./_string-repeat")})},{"./_export":58,"./_string-repeat":135}],275:[function(e,t,n){e("./_string-html")("small",function(e){return function(){return e(this,"small","","")}})},{"./_string-html":133}],276:[function(e,t,n){var r=e("./_export"),i=e("./_to-length"),o=e("./_string-context"),a="startsWith",s=""[a];r(r.P+r.F*e("./_fails-is-regexp")(a),"String",{startsWith:function(e){var t=o(this,e,a),n=i(Math.min(1<arguments.length?arguments[1]:void 0,t.length)),e=String(e);return s?s.call(t,e,n):t.slice(n,n+e.length)===e}})},{"./_export":58,"./_fails-is-regexp":59,"./_string-context":132,"./_to-length":143}],277:[function(e,t,n){e("./_string-html")("strike",function(e){return function(){return e(this,"strike","","")}})},{"./_string-html":133}],278:[function(e,t,n){e("./_string-html")("sub",function(e){return function(){return e(this,"sub","","")}})},{"./_string-html":133}],279:[function(e,t,n){e("./_string-html")("sup",function(e){return function(){return e(this,"sup","","")}})},{"./_string-html":133}],280:[function(e,t,n){e("./_string-trim")("trim",function(e){return function(){return e(this,3)}})},{"./_string-trim":136}],281:[function(e,F,D){function r(e){var t=P[e]=_(w[T]);return t._k=e,t}function n(e,t){m(e);for(var n,r=V(t=g(t)),i=0,o=r.length;i<o;)N(e,n=r[i++],t[n]);return e}function t(e){var t=ee.call(this,e=v(e,!0));return!(this===L&&c(P,e)&&!c(R,e))&&(!(t||!c(this,e)||!c(P,e)||c(this,S)&&this[S][e])||t)}function i(e,t){var n;if(e=g(e),t=v(t,!0),e!==L||!c(P,t)||c(R,t))return!(n=J(e,t))||!c(P,t)||c(e,S)&&e[S][t]||(n.enumerable=!0),n}function o(e){for(var t,n=K(g(e)),r=[],i=0;n.length>i;)c(P,t=n[i++])||t==S||t==U||r.push(t);return r}function a(e){for(var t,n=e===L,r=K(n?R:g(e)),i=[],o=0;r.length>o;)!c(P,t=r[o++])||n&&!c(L,t)||i.push(P[t]);return i}var s=e("./_global"),c=e("./_has"),l=e("./_descriptors"),u=e("./_export"),H=e("./_redefine"),U=e("./_meta").KEY,h=e("./_fails"),d=e("./_shared"),p=e("./_set-to-string-tag"),z=e("./_uid"),f=e("./_wks"),k=e("./_wks-ext"),B=e("./_wks-define"),V=e("./_enum-keys"),G=e("./_is-array"),m=e("./_an-object"),W=e("./_is-object"),q=e("./_to-object"),g=e("./_to-iobject"),v=e("./_to-primitive"),y=e("./_property-desc"),_=e("./_object-create"),X=e("./_object-gopn-ext"),Y=e("./_object-gopd"),x=e("./_object-gops"),Q=e("./_object-dp"),Z=e("./_object-keys"),J=Y.f,b=Q.f,K=X.f,w=s.Symbol,E=s.JSON,M=E&&E.stringify,T="prototype",S=f("_hidden"),$=f("toPrimitive"),ee={}.propertyIsEnumerable,A=d("symbol-registry"),P=d("symbols"),R=d("op-symbols"),L=Object[T],d="function"==typeof w&&!!x.f,C=s.QObject,I=!C||!C[T]||!C[T].findChild,O=l&&h(function(){return 7!=_(b({},"a",{get:function(){return b(this,"a",{value:7}).a}})).a})?function(e,t,n){var r=J(L,t);r&&delete L[t],b(e,t,n),r&&e!==L&&b(L,t,r)}:b,j=d&&"symbol"==typeof w.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof w},N=function(e,t,n){return e===L&&N(R,t,n),m(e),t=v(t,!0),m(n),(c(P,t)?(n.enumerable?(c(e,S)&&e[S][t]&&(e[S][t]=!1),n=_(n,{enumerable:y(0,!1)})):(c(e,S)||b(e,S,y(1,{})),e[S][t]=!0),O):b)(e,t,n)};d||(H((w=function(){if(this instanceof w)throw TypeError("Symbol is not a constructor!");var t=z(0<arguments.length?arguments[0]:void 0),n=function(e){this===L&&n.call(R,e),c(this,S)&&c(this[S],t)&&(this[S][t]=!1),O(this,t,y(1,e))};return l&&I&&O(L,t,{configurable:!0,set:n}),r(t)})[T],"toString",function(){return this._k}),Y.f=i,Q.f=N,e("./_object-gopn").f=X.f=o,e("./_object-pie").f=t,x.f=a,l&&!e("./_library")&&H(L,"propertyIsEnumerable",t,!0),k.f=function(e){return r(f(e))}),u(u.G+u.W+u.F*!d,{Symbol:w});for(var te="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ne=0;te.length>ne;)f(te[ne++]);for(var re=Z(f.store),ie=0;re.length>ie;)B(re[ie++]);u(u.S+u.F*!d,"Symbol",{for:function(e){return c(A,e+="")?A[e]:A[e]=w(e)},keyFor:function(e){if(!j(e))throw TypeError(e+" is not a symbol!");for(var t in A)if(A[t]===e)return t},useSetter:function(){I=!0},useSimple:function(){I=!1}}),u(u.S+u.F*!d,"Object",{create:function(e,t){return void 0===t?_(e):n(_(e),t)},defineProperty:N,defineProperties:n,getOwnPropertyDescriptor:i,getOwnPropertyNames:o,getOwnPropertySymbols:a});C=h(function(){x.f(1)});u(u.S+u.F*C,"Object",{getOwnPropertySymbols:function(e){return x.f(q(e))}}),E&&u(u.S+u.F*(!d||h(function(){var e=w();return"[null]"!=M([e])||"{}"!=M({a:e})||"{}"!=M(Object(e))})),"JSON",{stringify:function(e){for(var t,n,r=[e],i=1;i<arguments.length;)r.push(arguments[i++]);if(n=t=r[1],(W(t)||void 0!==e)&&!j(e))return G(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!j(t))return t}),r[1]=t,M.apply(E,r)}}),w[T][$]||e("./_hide")(w[T],$,w[T].valueOf),p(w,"Symbol"),p(Math,"Math",!0),p(s.JSON,"JSON",!0)},{"./_an-object":32,"./_descriptors":54,"./_enum-keys":57,"./_export":58,"./_fails":60,"./_global":66,"./_has":67,"./_hide":68,"./_is-array":75,"./_is-object":77,"./_library":85,"./_meta":91,"./_object-create":96,"./_object-dp":97,"./_object-gopd":100,"./_object-gopn":102,"./_object-gopn-ext":101,"./_object-gops":103,"./_object-keys":106,"./_object-pie":107,"./_property-desc":115,"./_redefine":117,"./_set-to-string-tag":126,"./_shared":128,"./_to-iobject":142,"./_to-object":144,"./_to-primitive":145,"./_uid":149,"./_wks":154,"./_wks-define":152,"./_wks-ext":153}],282:[function(e,t,n){var r=e("./_export"),i=e("./_typed"),o=e("./_typed-buffer"),c=e("./_an-object"),l=e("./_to-absolute-index"),u=e("./_to-length"),a=e("./_is-object"),s=e("./_global").ArrayBuffer,h=e("./_species-constructor"),d=o.ArrayBuffer,p=o.DataView,f=i.ABV&&s.isView,m=d.prototype.slice,g=i.VIEW,o="ArrayBuffer";r(r.G+r.W+r.F*(s!==d),{ArrayBuffer:d}),r(r.S+r.F*!i.CONSTR,o,{isView:function(e){return f&&f(e)||a(e)&&g in e}}),r(r.P+r.U+r.F*e("./_fails")(function(){return!new d(2).slice(1,void 0).byteLength}),o,{slice:function(e,t){if(void 0!==m&&void 0===t)return m.call(c(this),e);for(var n=c(this).byteLength,r=l(e,n),i=l(void 0===t?n:t,n),e=new(h(this,d))(u(i-r)),o=new p(this),a=new p(e),s=0;r<i;)a.setUint8(s++,o.getUint8(r++));return e}}),e("./_set-species")(o)},{"./_an-object":32,"./_export":58,"./_fails":60,"./_global":66,"./_is-object":77,"./_set-species":125,"./_species-constructor":129,"./_to-absolute-index":139,"./_to-length":143,"./_typed":148,"./_typed-buffer":147}],283:[function(e,t,n){var r=e("./_export");r(r.G+r.W+r.F*!e("./_typed").ABV,{DataView:e("./_typed-buffer").DataView})},{"./_export":58,"./_typed":148,"./_typed-buffer":147}],284:[function(e,t,n){e("./_typed-array")("Float32",4,function(r){return function(e,t,n){return r(this,e,t,n)}})},{"./_typed-array":146}],285:[function(e,t,n){e("./_typed-array")("Float64",8,function(r){return function(e,t,n){return r(this,e,t,n)}})},{"./_typed-array":146}],286:[function(e,t,n){e("./_typed-array")("Int16",2,function(r){return function(e,t,n){return r(this,e,t,n)}})},{"./_typed-array":146}],287:[function(e,t,n){e("./_typed-array")("Int32",4,function(r){return function(e,t,n){return r(this,e,t,n)}})},{"./_typed-array":146}],288:[function(e,t,n){e("./_typed-array")("Int8",1,function(r){return function(e,t,n){return r(this,e,t,n)}})},{"./_typed-array":146}],289:[function(e,t,n){e("./_typed-array")("Uint16",2,function(r){return function(e,t,n){return r(this,e,t,n)}})},{"./_typed-array":146}],290:[function(e,t,n){e("./_typed-array")("Uint32",4,function(r){return function(e,t,n){return r(this,e,t,n)}})},{"./_typed-array":146}],291:[function(e,t,n){e("./_typed-array")("Uint8",1,function(r){return function(e,t,n){return r(this,e,t,n)}})},{"./_typed-array":146}],292:[function(e,t,n){e("./_typed-array")("Uint8",1,function(r){return function(e,t,n){return r(this,e,t,n)}},!0)},{"./_typed-array":146}],293:[function(e,t,n){function r(e){return function(){return e(this,0<arguments.length?arguments[0]:void 0)}}var o,i=e("./_global"),a=e("./_array-methods")(0),s=e("./_redefine"),c=e("./_meta"),l=e("./_object-assign"),u=e("./_collection-weak"),h=e("./_is-object"),d=e("./_validate-collection"),p=e("./_validate-collection"),i=!i.ActiveXObject&&"ActiveXObject"in i,f="WeakMap",m=c.getWeak,g=Object.isExtensible,v=u.ufstore,y={get:function(e){var t;if(h(e))return!0===(t=m(e))?v(d(this,f)).get(e):t?t[this._i]:void 0},set:function(e,t){return u.def(d(this,f),e,t)}},_=t.exports=e("./_collection")(f,r,y,u,!0,!0);p&&i&&(l((o=u.getConstructor(r,f)).prototype,y),c.NEED=!0,a(["delete","has","get","set"],function(r){var e=_.prototype,i=e[r];s(e,r,function(e,t){var n;return h(e)&&!g(e)?(this._f||(this._f=new o),n=this._f[r](e,t),"set"==r?this:n):i.call(this,e,t)})}))},{"./_array-methods":37,"./_collection":47,"./_collection-weak":46,"./_global":66,"./_is-object":77,"./_meta":91,"./_object-assign":95,"./_redefine":117,"./_validate-collection":151}],294:[function(e,t,n){var r=e("./_collection-weak"),i=e("./_validate-collection");e("./_collection")("WeakSet",function(e){return function(){return e(this,0<arguments.length?arguments[0]:void 0)}},{add:function(e){return r.def(i(this,"WeakSet"),e,!0)}},r,!1,!0)},{"./_collection":47,"./_collection-weak":46,"./_validate-collection":151}],295:[function(e,t,n){var r=e("./_export"),i=e("./_flatten-into-array"),o=e("./_to-object"),a=e("./_to-length"),s=e("./_a-function"),c=e("./_array-species-create");r(r.P,"Array",{flatMap:function(e){var t,n,r=o(this);return s(e),t=a(r.length),n=c(r,0),i(n,r,r,t,0,1,e,arguments[1]),n}}),e("./_add-to-unscopables")("flatMap")},{"./_a-function":27,"./_add-to-unscopables":29,"./_array-species-create":40,"./_export":58,"./_flatten-into-array":63,"./_to-length":143,"./_to-object":144}],296:[function(e,t,n){var r=e("./_export"),i=e("./_flatten-into-array"),o=e("./_to-object"),a=e("./_to-length"),s=e("./_to-integer"),c=e("./_array-species-create");r(r.P,"Array",{flatten:function(){var e=arguments[0],t=o(this),n=a(t.length),r=c(t,0);return i(r,t,t,n,0,void 0===e?1:s(e)),r}}),e("./_add-to-unscopables")("flatten")},{"./_add-to-unscopables":29,"./_array-species-create":40,"./_export":58,"./_flatten-into-array":63,"./_to-integer":141,"./_to-length":143,"./_to-object":144}],297:[function(e,t,n){var r=e("./_export"),i=e("./_array-includes")(!0);r(r.P,"Array",{includes:function(e){return i(this,e,1<arguments.length?arguments[1]:void 0)}}),e("./_add-to-unscopables")("includes")},{"./_add-to-unscopables":29,"./_array-includes":36,"./_export":58}],298:[function(e,t,n){var r=e("./_export"),i=e("./_microtask")(),o=e("./_global").process,a="process"==e("./_cof")(o);r(r.G,{asap:function(e){var t=a&&o.domain;i(t?t.bind(e):e)}})},{"./_cof":43,"./_export":58,"./_global":66,"./_microtask":93}],299:[function(e,t,n){var r=e("./_export"),i=e("./_cof");r(r.S,"Error",{isError:function(e){return"Error"===i(e)}})},{"./_cof":43,"./_export":58}],300:[function(e,t,n){var r=e("./_export");r(r.G,{global:e("./_global")})},{"./_export":58,"./_global":66}],301:[function(e,t,n){e("./_set-collection-from")("Map")},{"./_set-collection-from":122}],302:[function(e,t,n){e("./_set-collection-of")("Map")},{"./_set-collection-of":123}],303:[function(e,t,n){var r=e("./_export");r(r.P+r.R,"Map",{toJSON:e("./_collection-to-json")("Map")})},{"./_collection-to-json":45,"./_export":58}],304:[function(e,t,n){e=e("./_export");e(e.S,"Math",{clamp:function(e,t,n){return Math.min(n,Math.max(t,e))}})},{"./_export":58}],305:[function(e,t,n){e=e("./_export");e(e.S,"Math",{DEG_PER_RAD:Math.PI/180})},{"./_export":58}],306:[function(e,t,n){var e=e("./_export"),r=180/Math.PI;e(e.S,"Math",{degrees:function(e){return e*r}})},{"./_export":58}],307:[function(e,t,n){var r=e("./_export"),o=e("./_math-scale"),a=e("./_math-fround");r(r.S,"Math",{fscale:function(e,t,n,r,i){return a(o(e,t,n,r,i))}})},{"./_export":58,"./_math-fround":87,"./_math-scale":89}],308:[function(e,t,n){e=e("./_export");e(e.S,"Math",{iaddh:function(e,t,n,r){e>>>=0,n>>>=0;return(t>>>0)+(r>>>0)+((e&n|(e|n)&~(e+n>>>0))>>>31)|0}})},{"./_export":58}],309:[function(e,t,n){e=e("./_export");e(e.S,"Math",{imulh:function(e,t){var e=+e,t=+t,n=65535&e,r=65535&t,e=e>>16,t=t>>16,r=(e*r>>>0)+(n*r>>>16);return e*t+(r>>16)+((n*t>>>0)+(65535&r)>>16)}})},{"./_export":58}],310:[function(e,t,n){e=e("./_export");e(e.S,"Math",{isubh:function(e,t,n,r){e>>>=0,n>>>=0;return(t>>>0)-(r>>>0)-((~e&n|~(e^n)&e-n>>>0)>>>31)|0}})},{"./_export":58}],311:[function(e,t,n){e=e("./_export");e(e.S,"Math",{RAD_PER_DEG:180/Math.PI})},{"./_export":58}],312:[function(e,t,n){var e=e("./_export"),r=Math.PI/180;e(e.S,"Math",{radians:function(e){return e*r}})},{"./_export":58}],313:[function(e,t,n){var r=e("./_export");r(r.S,"Math",{scale:e("./_math-scale")})},{"./_export":58,"./_math-scale":89}],314:[function(e,t,n){e=e("./_export");e(e.S,"Math",{signbit:function(e){return(e=+e)!=e?e:0==e?1/e==1/0:0<e}})},{"./_export":58}],315:[function(e,t,n){e=e("./_export");e(e.S,"Math",{umulh:function(e,t){var e=+e,t=+t,n=65535&e,r=65535&t,e=e>>>16,t=t>>>16,r=(e*r>>>0)+(n*r>>>16);return e*t+(r>>>16)+((n*t>>>0)+(65535&r)>>>16)}})},{"./_export":58}],316:[function(e,t,n){var r=e("./_export"),i=e("./_to-object"),o=e("./_a-function"),a=e("./_object-dp");e("./_descriptors")&&r(r.P+e("./_object-forced-pam"),"Object",{__defineGetter__:function(e,t){a.f(i(this),e,{get:o(t),enumerable:!0,configurable:!0})}})},{"./_a-function":27,"./_descriptors":54,"./_export":58,"./_object-dp":97,"./_object-forced-pam":99,"./_to-object":144}],317:[function(e,t,n){var r=e("./_export"),i=e("./_to-object"),o=e("./_a-function"),a=e("./_object-dp");e("./_descriptors")&&r(r.P+e("./_object-forced-pam"),"Object",{__defineSetter__:function(e,t){a.f(i(this),e,{set:o(t),enumerable:!0,configurable:!0})}})},{"./_a-function":27,"./_descriptors":54,"./_export":58,"./_object-dp":97,"./_object-forced-pam":99,"./_to-object":144}],318:[function(e,t,n){var r=e("./_export"),i=e("./_object-to-array")(!0);r(r.S,"Object",{entries:function(e){return i(e)}})},{"./_export":58,"./_object-to-array":109}],319:[function(e,t,n){var r=e("./_export"),c=e("./_own-keys"),l=e("./_to-iobject"),u=e("./_object-gopd"),h=e("./_create-property");r(r.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t,n,r=l(e),i=u.f,o=c(r),a={},s=0;o.length>s;)void 0!==(n=i(r,t=o[s++]))&&h(a,t,n);return a}})},{"./_create-property":49,"./_export":58,"./_object-gopd":100,"./_own-keys":110,"./_to-iobject":142}],320:[function(e,t,n){var r=e("./_export"),i=e("./_to-object"),o=e("./_to-primitive"),a=e("./_object-gpo"),s=e("./_object-gopd").f;e("./_descriptors")&&r(r.P+e("./_object-forced-pam"),"Object",{__lookupGetter__:function(e){var t,n=i(this),r=o(e,!0);do{if(t=s(n,r))return t.get}while(n=a(n))}})},{"./_descriptors":54,"./_export":58,"./_object-forced-pam":99,"./_object-gopd":100,"./_object-gpo":104,"./_to-object":144,"./_to-primitive":145}],321:[function(e,t,n){var r=e("./_export"),i=e("./_to-object"),o=e("./_to-primitive"),a=e("./_object-gpo"),s=e("./_object-gopd").f;e("./_descriptors")&&r(r.P+e("./_object-forced-pam"),"Object",{__lookupSetter__:function(e){var t,n=i(this),r=o(e,!0);do{if(t=s(n,r))return t.set}while(n=a(n))}})},{"./_descriptors":54,"./_export":58,"./_object-forced-pam":99,"./_object-gopd":100,"./_object-gpo":104,"./_to-object":144,"./_to-primitive":145}],322:[function(e,t,n){var r=e("./_export"),i=e("./_object-to-array")(!1);r(r.S,"Object",{values:function(e){return i(e)}})},{"./_export":58,"./_object-to-array":109}],323:[function(e,t,n){function i(e){return null==e?void 0:p(e)}function o(e){var t=e._c;t&&(e._c=void 0,t())}function a(e){return void 0===e._o}function s(e){a(e)||(e._o=void 0,o(e))}function r(t,e){f(t),this._c=void 0,this._o=t,t=new x(this);try{var n=e(t),r=n;null!=n&&("function"==typeof n.unsubscribe?n=function(){r.unsubscribe()}:p(n),this._c=n)}catch(e){return void t.error(e)}a(this)&&o(this)}var c=e("./_export"),l=e("./_global"),u=e("./_core"),h=e("./_microtask")(),d=e("./_wks")("observable"),p=e("./_a-function"),f=e("./_an-object"),m=e("./_an-instance"),g=e("./_redefine-all"),v=e("./_hide"),y=e("./_for-of"),_=y.RETURN,x=(r.prototype=g({},{unsubscribe:function(){s(this)}}),function(e){this._s=e}),b=(x.prototype=g({},{next:function(e){var t=this._s;if(!a(t)){var n=t._o;try{var r=i(n.next);if(r)return r.call(n,e)}catch(e){try{s(t)}finally{throw e}}}},error:function(e){var t=this._s;if(a(t))throw e;var n=t._o;t._o=void 0;try{var r=i(n.error);if(!r)throw e;e=r.call(n,e)}catch(e){try{o(t)}finally{throw e}}return o(t),e},complete:function(e){var t=this._s;if(!a(t)){var n=t._o;t._o=void 0;try{var r=i(n.complete);e=r?r.call(n,e):void 0}catch(e){try{o(t)}finally{throw e}}return o(t),e}}}),function(e){m(this,b,"Observable","_f")._f=p(e)});g(b.prototype,{subscribe:function(e){return new r(e,this._f)},forEach:function(r){var i=this;return new(u.Promise||l.Promise)(function(e,t){p(r);var n=i.subscribe({next:function(e){try{return r(e)}catch(e){t(e),n.unsubscribe()}},error:t,complete:e})})}}),g(b,{from:function(e){var t,n="function"==typeof this?this:b,r=i(f(e)[d]);return r?(t=f(r.call(e))).constructor===n?t:new n(function(e){return t.subscribe(e)}):new n(function(t){var n=!1;return h(function(){if(!n){try{if(y(e,!1,function(e){if(t.next(e),n)return _})===_)return}catch(e){if(n)throw e;return void t.error(e)}t.complete()}}),function(){n=!0}})},of:function(){for(var e=0,t=arguments.length,r=new Array(t);e<t;)r[e]=arguments[e++];return new("function"==typeof this?this:b)(function(t){var n=!1;return h(function(){if(!n){for(var e=0;e<r.length;++e)if(t.next(r[e]),n)return;t.complete()}}),function(){n=!0}})}}),v(b.prototype,d,function(){return this}),c(c.G,{Observable:b}),e("./_set-species")("Observable")},{"./_a-function":27,"./_an-instance":31,"./_an-object":32,"./_core":48,"./_export":58,"./_for-of":64,"./_global":66,"./_hide":68,"./_microtask":93,"./_redefine-all":116,"./_set-species":125,"./_wks":154}],324:[function(e,t,n){var r=e("./_export"),i=e("./_core"),o=e("./_global"),a=e("./_species-constructor"),s=e("./_promise-resolve");r(r.P+r.R,"Promise",{finally:function(t){var n=a(this,i.Promise||o.Promise),e="function"==typeof t;return this.then(e?function(e){return s(n,t()).then(function(){return e})}:t,e?function(e){return s(n,t()).then(function(){throw e})}:t)}})},{"./_core":48,"./_export":58,"./_global":66,"./_promise-resolve":114,"./_species-constructor":129}],325:[function(e,t,n){var r=e("./_export"),i=e("./_new-promise-capability"),o=e("./_perform");r(r.S,"Promise",{try:function(e){var t=i.f(this),e=o(e);return(e.e?t.reject:t.resolve)(e.v),t.promise}})},{"./_export":58,"./_new-promise-capability":94,"./_perform":113}],326:[function(e,t,n){var r=e("./_metadata"),i=e("./_an-object"),o=r.key,a=r.set;r.exp({defineMetadata:function(e,t,n,r){a(e,t,i(n),o(r))}})},{"./_an-object":32,"./_metadata":92}],327:[function(e,t,n){var r=e("./_metadata"),i=e("./_an-object"),o=r.key,a=r.map,s=r.store;r.exp({deleteMetadata:function(e,t){var n=arguments.length<3?void 0:o(arguments[2]),r=a(i(t),n,!1);return!(void 0===r||!r.delete(e))&&(!!r.size||((e=s.get(t)).delete(n),!!e.size)||s.delete(t))}})},{"./_an-object":32,"./_metadata":92}],328:[function(e,t,n){function r(e,t){var n=l(e,t);return null!==(e=c(e))&&(e=r(e,t)).length?n.length?o(new i(n.concat(e))):e:n}var i=e("./es6.set"),o=e("./_array-from-iterable"),a=e("./_metadata"),s=e("./_an-object"),c=e("./_object-gpo"),l=a.keys,u=a.key;a.exp({getMetadataKeys:function(e){return r(s(e),arguments.length<2?void 0:u(arguments[1]))}})},{"./_an-object":32,"./_array-from-iterable":35,"./_metadata":92,"./_object-gpo":104,"./es6.set":258}],329:[function(e,t,n){function r(e,t,n){return s(e,t,n)?c(e,t,n):null!==(t=a(t))?r(e,t,n):void 0}var i=e("./_metadata"),o=e("./_an-object"),a=e("./_object-gpo"),s=i.has,c=i.get,l=i.key;i.exp({getMetadata:function(e,t){return r(e,o(t),arguments.length<3?void 0:l(arguments[2]))}})},{"./_an-object":32,"./_metadata":92,"./_object-gpo":104}],330:[function(e,t,n){var r=e("./_metadata"),i=e("./_an-object"),o=r.keys,a=r.key;r.exp({getOwnMetadataKeys:function(e){return o(i(e),arguments.length<2?void 0:a(arguments[1]))}})},{"./_an-object":32,"./_metadata":92}],331:[function(e,t,n){var r=e("./_metadata"),i=e("./_an-object"),o=r.get,a=r.key;r.exp({getOwnMetadata:function(e,t){return o(e,i(t),arguments.length<3?void 0:a(arguments[2]))}})},{"./_an-object":32,"./_metadata":92}],332:[function(e,t,n){function r(e,t,n){return!!s(e,t,n)||null!==(t=a(t))&&r(e,t,n)}var i=e("./_metadata"),o=e("./_an-object"),a=e("./_object-gpo"),s=i.has,c=i.key;i.exp({hasMetadata:function(e,t){return r(e,o(t),arguments.length<3?void 0:c(arguments[2]))}})},{"./_an-object":32,"./_metadata":92,"./_object-gpo":104}],333:[function(e,t,n){var r=e("./_metadata"),i=e("./_an-object"),o=r.has,a=r.key;r.exp({hasOwnMetadata:function(e,t){return o(e,i(t),arguments.length<3?void 0:a(arguments[2]))}})},{"./_an-object":32,"./_metadata":92}],334:[function(e,t,n){var r=e("./_metadata"),i=e("./_an-object"),o=e("./_a-function"),a=r.key,s=r.set;r.exp({metadata:function(n,r){return function(e,t){s(n,r,(void 0!==t?i:o)(e),a(t))}}})},{"./_a-function":27,"./_an-object":32,"./_metadata":92}],335:[function(e,t,n){e("./_set-collection-from")("Set")},{"./_set-collection-from":122}],336:[function(e,t,n){e("./_set-collection-of")("Set")},{"./_set-collection-of":123}],337:[function(e,t,n){var r=e("./_export");r(r.P+r.R,"Set",{toJSON:e("./_collection-to-json")("Set")})},{"./_collection-to-json":45,"./_export":58}],338:[function(e,t,n){var r=e("./_export"),i=e("./_string-at")(!0),e=e("./_fails")(function(){return""!=="".at(0)});r(r.P+r.F*e,"String",{at:function(e){return i(this,e)}})},{"./_export":58,"./_fails":60,"./_string-at":131}],339:[function(e,t,n){function r(e,t){this._r=e,this._s=t}var i=e("./_export"),o=e("./_defined"),a=e("./_to-length"),s=e("./_is-regexp"),c=e("./_flags"),l=RegExp.prototype;e("./_iter-create")(r,"RegExp String",function(){var e=this._r.exec(this._s);return{value:e,done:null===e}}),i(i.P,"String",{matchAll:function(e){var t,n;if(o(this),s(e))return t=String(this),n="flags"in l?String(e.flags):c.call(e),(n=new RegExp(e.source,~n.indexOf("g")?n:"g"+n)).lastIndex=a(e.lastIndex),new r(n,t);throw TypeError(e+" is not a regexp!")}})},{"./_defined":53,"./_export":58,"./_flags":62,"./_is-regexp":78,"./_iter-create":80,"./_to-length":143}],340:[function(e,t,n){var r=e("./_export"),i=e("./_string-pad"),e=e("./_user-agent"),e=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(e);r(r.P+r.F*e,"String",{padEnd:function(e){return i(this,e,1<arguments.length?arguments[1]:void 0,!1)}})},{"./_export":58,"./_string-pad":134,"./_user-agent":150}],341:[function(e,t,n){var r=e("./_export"),i=e("./_string-pad"),e=e("./_user-agent"),e=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(e);r(r.P+r.F*e,"String",{padStart:function(e){return i(this,e,1<arguments.length?arguments[1]:void 0,!0)}})},{"./_export":58,"./_string-pad":134,"./_user-agent":150}],342:[function(e,t,n){e("./_string-trim")("trimLeft",function(e){return function(){return e(this,1)}},"trimStart")},{"./_string-trim":136}],343:[function(e,t,n){e("./_string-trim")("trimRight",function(e){return function(){return e(this,2)}},"trimEnd")},{"./_string-trim":136}],344:[function(e,t,n){e("./_wks-define")("asyncIterator")},{"./_wks-define":152}],345:[function(e,t,n){e("./_wks-define")("observable")},{"./_wks-define":152}],346:[function(e,t,n){var r=e("./_export");r(r.S,"System",{global:e("./_global")})},{"./_export":58,"./_global":66}],347:[function(e,t,n){e("./_set-collection-from")("WeakMap")},{"./_set-collection-from":122}],348:[function(e,t,n){e("./_set-collection-of")("WeakMap")},{"./_set-collection-of":123}],349:[function(e,t,n){e("./_set-collection-from")("WeakSet")},{"./_set-collection-from":122}],350:[function(e,t,n){e("./_set-collection-of")("WeakSet")},{"./_set-collection-of":123}],351:[function(e,t,n){for(var r=e("./es6.array.iterator"),i=e("./_object-keys"),o=e("./_redefine"),a=e("./_global"),s=e("./_hide"),c=e("./_iterators"),e=e("./_wks"),l=e("iterator"),u=e("toStringTag"),h=c.Array,d={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=i(d),f=0;f<p.length;f++){var m,g=p[f],v=d[g],y=a[g],_=y&&y.prototype;if(_&&(_[l]||s(_,l,h),_[u]||s(_,u,g),c[g]=h,v))for(m in r)_[m]||o(_,m,r[m],!0)}},{"./_global":66,"./_hide":68,"./_iterators":84,"./_object-keys":106,"./_redefine":117,"./_wks":154,"./es6.array.iterator":167}],352:[function(e,t,n){var r=e("./_export"),e=e("./_task");r(r.G+r.B,{setImmediate:e.set,clearImmediate:e.clear})},{"./_export":58,"./_task":138}],353:[function(e,t,n){function r(i){return function(e,t){var n=2<arguments.length,r=n&&a.call(arguments,2);return i(n?function(){("function"==typeof e?e:Function(e)).apply(this,r)}:e,t)}}var i=e("./_global"),o=e("./_export"),e=e("./_user-agent"),a=[].slice,e=/MSIE .\./.test(e);o(o.G+o.B+o.F*e,{setTimeout:r(i.setTimeout),setInterval:r(i.setInterval)})},{"./_export":58,"./_global":66,"./_user-agent":150}],354:[function(e,t,n){e("./modules/es6.symbol"),e("./modules/es6.object.create"),e("./modules/es6.object.define-property"),e("./modules/es6.object.define-properties"),e("./modules/es6.object.get-own-property-descriptor"),e("./modules/es6.object.get-prototype-of"),e("./modules/es6.object.keys"),e("./modules/es6.object.get-own-property-names"),e("./modules/es6.object.freeze"),e("./modules/es6.object.seal"),e("./modules/es6.object.prevent-extensions"),e("./modules/es6.object.is-frozen"),e("./modules/es6.object.is-sealed"),e("./modules/es6.object.is-extensible"),e("./modules/es6.object.assign"),e("./modules/es6.object.is"),e("./modules/es6.object.set-prototype-of"),e("./modules/es6.object.to-string"),e("./modules/es6.function.bind"),e("./modules/es6.function.name"),e("./modules/es6.function.has-instance"),e("./modules/es6.parse-int"),e("./modules/es6.parse-float"),e("./modules/es6.number.constructor"),e("./modules/es6.number.to-fixed"),e("./modules/es6.number.to-precision"),e("./modules/es6.number.epsilon"),e("./modules/es6.number.is-finite"),e("./modules/es6.number.is-integer"),e("./modules/es6.number.is-nan"),e("./modules/es6.number.is-safe-integer"),e("./modules/es6.number.max-safe-integer"),e("./modules/es6.number.min-safe-integer"),e("./modules/es6.number.parse-float"),e("./modules/es6.number.parse-int"),e("./modules/es6.math.acosh"),e("./modules/es6.math.asinh"),e("./modules/es6.math.atanh"),e("./modules/es6.math.cbrt"),e("./modules/es6.math.clz32"),e("./modules/es6.math.cosh"),e("./modules/es6.math.expm1"),e("./modules/es6.math.fround"),e("./modules/es6.math.hypot"),e("./modules/es6.math.imul"),e("./modules/es6.math.log10"),e("./modules/es6.math.log1p"),e("./modules/es6.math.log2"),e("./modules/es6.math.sign"),e("./modules/es6.math.sinh"),e("./modules/es6.math.tanh"),e("./modules/es6.math.trunc"),e("./modules/es6.string.from-code-point"),e("./modules/es6.string.raw"),e("./modules/es6.string.trim"),e("./modules/es6.string.iterator"),e("./modules/es6.string.code-point-at"),e("./modules/es6.string.ends-with"),e("./modules/es6.string.includes"),e("./modules/es6.string.repeat"),e("./modules/es6.string.starts-with"),e("./modules/es6.string.anchor"),e("./modules/es6.string.big"),e("./modules/es6.string.blink"),e("./modules/es6.string.bold"),e("./modules/es6.string.fixed"),e("./modules/es6.string.fontcolor"),e("./modules/es6.string.fontsize"),e("./modules/es6.string.italics"),e("./modules/es6.string.link"),e("./modules/es6.string.small"),e("./modules/es6.string.strike"),e("./modules/es6.string.sub"),e("./modules/es6.string.sup"),e("./modules/es6.date.now"),e("./modules/es6.date.to-json"),e("./modules/es6.date.to-iso-string"),e("./modules/es6.date.to-string"),e("./modules/es6.date.to-primitive"),e("./modules/es6.array.is-array"),e("./modules/es6.array.from"),e("./modules/es6.array.of"),e("./modules/es6.array.join"),e("./modules/es6.array.slice"),e("./modules/es6.array.sort"),e("./modules/es6.array.for-each"),e("./modules/es6.array.map"),e("./modules/es6.array.filter"),e("./modules/es6.array.some"),e("./modules/es6.array.every"),e("./modules/es6.array.reduce"),e("./modules/es6.array.reduce-right"),e("./modules/es6.array.index-of"),e("./modules/es6.array.last-index-of"),e("./modules/es6.array.copy-within"),e("./modules/es6.array.fill"),e("./modules/es6.array.find"),e("./modules/es6.array.find-index"),e("./modules/es6.array.species"),e("./modules/es6.array.iterator"),e("./modules/es6.regexp.constructor"),e("./modules/es6.regexp.exec"),e("./modules/es6.regexp.to-string"),e("./modules/es6.regexp.flags"),e("./modules/es6.regexp.match"),e("./modules/es6.regexp.replace"),e("./modules/es6.regexp.search"),e("./modules/es6.regexp.split"),e("./modules/es6.promise"),e("./modules/es6.map"),e("./modules/es6.set"),e("./modules/es6.weak-map"),e("./modules/es6.weak-set"),e("./modules/es6.typed.array-buffer"),e("./modules/es6.typed.data-view"),e("./modules/es6.typed.int8-array"),e("./modules/es6.typed.uint8-array"),e("./modules/es6.typed.uint8-clamped-array"),e("./modules/es6.typed.int16-array"),e("./modules/es6.typed.uint16-array"),e("./modules/es6.typed.int32-array"),e("./modules/es6.typed.uint32-array"),e("./modules/es6.typed.float32-array"),e("./modules/es6.typed.float64-array"),e("./modules/es6.reflect.apply"),e("./modules/es6.reflect.construct"),e("./modules/es6.reflect.define-property"),e("./modules/es6.reflect.delete-property"),e("./modules/es6.reflect.enumerate"),e("./modules/es6.reflect.get"),e("./modules/es6.reflect.get-own-property-descriptor"),e("./modules/es6.reflect.get-prototype-of"),e("./modules/es6.reflect.has"),e("./modules/es6.reflect.is-extensible"),e("./modules/es6.reflect.own-keys"),e("./modules/es6.reflect.prevent-extensions"),e("./modules/es6.reflect.set"),e("./modules/es6.reflect.set-prototype-of"),e("./modules/es7.array.includes"),e("./modules/es7.array.flat-map"),e("./modules/es7.array.flatten"),e("./modules/es7.string.at"),e("./modules/es7.string.pad-start"),e("./modules/es7.string.pad-end"),e("./modules/es7.string.trim-left"),e("./modules/es7.string.trim-right"),e("./modules/es7.string.match-all"),e("./modules/es7.symbol.async-iterator"),e("./modules/es7.symbol.observable"),e("./modules/es7.object.get-own-property-descriptors"),e("./modules/es7.object.values"),e("./modules/es7.object.entries"),e("./modules/es7.object.define-getter"),e("./modules/es7.object.define-setter"),e("./modules/es7.object.lookup-getter"),e("./modules/es7.object.lookup-setter"),e("./modules/es7.map.to-json"),e("./modules/es7.set.to-json"),e("./modules/es7.map.of"),e("./modules/es7.set.of"),e("./modules/es7.weak-map.of"),e("./modules/es7.weak-set.of"),e("./modules/es7.map.from"),e("./modules/es7.set.from"),e("./modules/es7.weak-map.from"),e("./modules/es7.weak-set.from"),e("./modules/es7.global"),e("./modules/es7.system.global"),e("./modules/es7.error.is-error"),e("./modules/es7.math.clamp"),e("./modules/es7.math.deg-per-rad"),e("./modules/es7.math.degrees"),e("./modules/es7.math.fscale"),e("./modules/es7.math.iaddh"),e("./modules/es7.math.isubh"),e("./modules/es7.math.imulh"),e("./modules/es7.math.rad-per-deg"),e("./modules/es7.math.radians"),e("./modules/es7.math.scale"),e("./modules/es7.math.umulh"),e("./modules/es7.math.signbit"),e("./modules/es7.promise.finally"),e("./modules/es7.promise.try"),e("./modules/es7.reflect.define-metadata"),e("./modules/es7.reflect.delete-metadata"),e("./modules/es7.reflect.get-metadata"),e("./modules/es7.reflect.get-metadata-keys"),e("./modules/es7.reflect.get-own-metadata"),e("./modules/es7.reflect.get-own-metadata-keys"),e("./modules/es7.reflect.has-metadata"),e("./modules/es7.reflect.has-own-metadata"),e("./modules/es7.reflect.metadata"),e("./modules/es7.asap"),e("./modules/es7.observable"),e("./modules/web.timers"),e("./modules/web.immediate"),e("./modules/web.dom.iterable"),t.exports=e("./modules/_core")},{"./modules/_core":48,"./modules/es6.array.copy-within":157,"./modules/es6.array.every":158,"./modules/es6.array.fill":159,"./modules/es6.array.filter":160,"./modules/es6.array.find":162,"./modules/es6.array.find-index":161,"./modules/es6.array.for-each":163,"./modules/es6.array.from":164,"./modules/es6.array.index-of":165,"./modules/es6.array.is-array":166,"./modules/es6.array.iterator":167,"./modules/es6.array.join":168,"./modules/es6.array.last-index-of":169,"./modules/es6.array.map":170,"./modules/es6.array.of":171,"./modules/es6.array.reduce":173,"./modules/es6.array.reduce-right":172,"./modules/es6.array.slice":174,"./modules/es6.array.some":175,"./modules/es6.array.sort":176,"./modules/es6.array.species":177,"./modules/es6.date.now":178,"./modules/es6.date.to-iso-string":179,"./modules/es6.date.to-json":180,"./modules/es6.date.to-primitive":181,"./modules/es6.date.to-string":182,"./modules/es6.function.bind":183,"./modules/es6.function.has-instance":184,"./modules/es6.function.name":185,"./modules/es6.map":186,"./modules/es6.math.acosh":187,"./modules/es6.math.asinh":188,"./modules/es6.math.atanh":189,"./modules/es6.math.cbrt":190,"./modules/es6.math.clz32":191,"./modules/es6.math.cosh":192,"./modules/es6.math.expm1":193,"./modules/es6.math.fround":194,"./modules/es6.math.hypot":195,"./modules/es6.math.imul":196,"./modules/es6.math.log10":197,"./modules/es6.math.log1p":198,"./modules/es6.math.log2":199,"./modules/es6.math.sign":200,"./modules/es6.math.sinh":201,"./modules/es6.math.tanh":202,"./modules/es6.math.trunc":203,"./modules/es6.number.constructor":204,"./modules/es6.number.epsilon":205,"./modules/es6.number.is-finite":206,"./modules/es6.number.is-integer":207,"./modules/es6.number.is-nan":208,"./modules/es6.number.is-safe-integer":209,"./modules/es6.number.max-safe-integer":210,"./modules/es6.number.min-safe-integer":211,"./modules/es6.number.parse-float":212,"./modules/es6.number.parse-int":213,"./modules/es6.number.to-fixed":214,"./modules/es6.number.to-precision":215,"./modules/es6.object.assign":216,"./modules/es6.object.create":217,"./modules/es6.object.define-properties":218,"./modules/es6.object.define-property":219,"./modules/es6.object.freeze":220,"./modules/es6.object.get-own-property-descriptor":221,"./modules/es6.object.get-own-property-names":222,"./modules/es6.object.get-prototype-of":223,"./modules/es6.object.is":227,"./modules/es6.object.is-extensible":224,"./modules/es6.object.is-frozen":225,"./modules/es6.object.is-sealed":226,"./modules/es6.object.keys":228,"./modules/es6.object.prevent-extensions":229,"./modules/es6.object.seal":230,"./modules/es6.object.set-prototype-of":231,"./modules/es6.object.to-string":232,"./modules/es6.parse-float":233,"./modules/es6.parse-int":234,"./modules/es6.promise":235,"./modules/es6.reflect.apply":236,"./modules/es6.reflect.construct":237,"./modules/es6.reflect.define-property":238,"./modules/es6.reflect.delete-property":239,"./modules/es6.reflect.enumerate":240,"./modules/es6.reflect.get":243,"./modules/es6.reflect.get-own-property-descriptor":241,"./modules/es6.reflect.get-prototype-of":242,"./modules/es6.reflect.has":244,"./modules/es6.reflect.is-extensible":245,"./modules/es6.reflect.own-keys":246,"./modules/es6.reflect.prevent-extensions":247,"./modules/es6.reflect.set":249,"./modules/es6.reflect.set-prototype-of":248,"./modules/es6.regexp.constructor":250,"./modules/es6.regexp.exec":251,"./modules/es6.regexp.flags":252,"./modules/es6.regexp.match":253,"./modules/es6.regexp.replace":254,"./modules/es6.regexp.search":255,"./modules/es6.regexp.split":256,"./modules/es6.regexp.to-string":257,"./modules/es6.set":258,"./modules/es6.string.anchor":259,"./modules/es6.string.big":260,"./modules/es6.string.blink":261,"./modules/es6.string.bold":262,"./modules/es6.string.code-point-at":263,"./modules/es6.string.ends-with":264,"./modules/es6.string.fixed":265,"./modules/es6.string.fontcolor":266,"./modules/es6.string.fontsize":267,"./modules/es6.string.from-code-point":268,"./modules/es6.string.includes":269,"./modules/es6.string.italics":270,"./modules/es6.string.iterator":271,"./modules/es6.string.link":272,"./modules/es6.string.raw":273,"./modules/es6.string.repeat":274,"./modules/es6.string.small":275,"./modules/es6.string.starts-with":276,"./modules/es6.string.strike":277,"./modules/es6.string.sub":278,"./modules/es6.string.sup":279,"./modules/es6.string.trim":280,"./modules/es6.symbol":281,"./modules/es6.typed.array-buffer":282,"./modules/es6.typed.data-view":283,"./modules/es6.typed.float32-array":284,"./modules/es6.typed.float64-array":285,"./modules/es6.typed.int16-array":286,"./modules/es6.typed.int32-array":287,"./modules/es6.typed.int8-array":288,"./modules/es6.typed.uint16-array":289,"./modules/es6.typed.uint32-array":290,"./modules/es6.typed.uint8-array":291,"./modules/es6.typed.uint8-clamped-array":292,"./modules/es6.weak-map":293,"./modules/es6.weak-set":294,"./modules/es7.array.flat-map":295,"./modules/es7.array.flatten":296,"./modules/es7.array.includes":297,"./modules/es7.asap":298,"./modules/es7.error.is-error":299,"./modules/es7.global":300,"./modules/es7.map.from":301,"./modules/es7.map.of":302,"./modules/es7.map.to-json":303,"./modules/es7.math.clamp":304,"./modules/es7.math.deg-per-rad":305,"./modules/es7.math.degrees":306,"./modules/es7.math.fscale":307,"./modules/es7.math.iaddh":308,"./modules/es7.math.imulh":309,"./modules/es7.math.isubh":310,"./modules/es7.math.rad-per-deg":311,"./modules/es7.math.radians":312,"./modules/es7.math.scale":313,"./modules/es7.math.signbit":314,"./modules/es7.math.umulh":315,"./modules/es7.object.define-getter":316,"./modules/es7.object.define-setter":317,"./modules/es7.object.entries":318,"./modules/es7.object.get-own-property-descriptors":319,"./modules/es7.object.lookup-getter":320,"./modules/es7.object.lookup-setter":321,"./modules/es7.object.values":322,"./modules/es7.observable":323,"./modules/es7.promise.finally":324,"./modules/es7.promise.try":325,"./modules/es7.reflect.define-metadata":326,"./modules/es7.reflect.delete-metadata":327,"./modules/es7.reflect.get-metadata":329,"./modules/es7.reflect.get-metadata-keys":328,"./modules/es7.reflect.get-own-metadata":331,"./modules/es7.reflect.get-own-metadata-keys":330,"./modules/es7.reflect.has-metadata":332,"./modules/es7.reflect.has-own-metadata":333,"./modules/es7.reflect.metadata":334,"./modules/es7.set.from":335,"./modules/es7.set.of":336,"./modules/es7.set.to-json":337,"./modules/es7.string.at":338,"./modules/es7.string.match-all":339,"./modules/es7.string.pad-end":340,"./modules/es7.string.pad-start":341,"./modules/es7.string.trim-left":342,"./modules/es7.string.trim-right":343,"./modules/es7.symbol.async-iterator":344,"./modules/es7.symbol.observable":345,"./modules/es7.system.global":346,"./modules/es7.weak-map.from":347,"./modules/es7.weak-map.of":348,"./modules/es7.weak-set.from":349,"./modules/es7.weak-set.of":350,"./modules/web.dom.iterable":351,"./modules/web.immediate":352,"./modules/web.timers":353}],355:[function(e,t,n){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function c(e){return"function"==typeof e}function l(e){return"object"==typeof e&&null!==e}function u(e){return void 0===e}((t.exports=r).EventEmitter=r).prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,n,r,i,o,a,s;if((this._events||(this._events={}),"error"===e)&&(!this._events.error||l(this._events.error)&&!this._events.error.length))throw(s=arguments[1])instanceof Error?s:((a=new Error('Uncaught, unspecified "error" event. ('+s+")")).context=s,a);if(u(t=this._events[e]))return!1;if(c(t))switch(arguments.length){case 1:t.call(this);break;case 2:t.call(this,arguments[1]);break;case 3:t.call(this,arguments[1],arguments[2]);break;default:r=Array.prototype.slice.call(arguments,1),t.apply(this,r)}else if(l(t))for(r=Array.prototype.slice.call(arguments,1),n=(o=t.slice()).length,i=0;i<n;i++)o[i].apply(this,r);return!0},r.prototype.on=r.prototype.addListener=function(e,t){if(c(t))return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,c(t.listener)?t.listener:t),this._events[e]?l(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,l(this._events[e])&&!this._events[e].warned&&(t=u(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&0<t&&this._events[e].length>t&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace)&&console.trace(),this;throw TypeError("listener must be a function")},r.prototype.once=function(e,t){var n;if(c(t))return n=!1,r.listener=t,this.on(e,r),this;throw TypeError("listener must be a function");function r(){this.removeListener(e,r),n||(n=!0,t.apply(this,arguments))}},r.prototype.removeListener=function(e,t){var n,r,i,o;if(!c(t))throw TypeError("listener must be a function");if(this._events&&this._events[e])if(i=(n=this._events[e]).length,r=-1,n===t||c(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(l(n)){for(o=i;0<o--;)if(n[o]===t||n[o].listener&&n[o].listener===t){r=o;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,n;if(this._events)if(this._events.removeListener)if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);this.removeAllListeners("removeListener"),this._events={}}else{if(c(n=this._events[e]))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);delete this._events[e]}else 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e];return this},r.prototype.listeners=function(e){e=this._events&&this._events[e]?c(this._events[e])?[this._events[e]]:this._events[e].slice():[];return e},r.prototype.listenerCount=function(e){if(this._events){e=this._events[e];if(c(e))return 1;if(e)return e.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},{}],356:[function(e,t,n){function r(){return n=[function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.setMatrixArrayType=function(e){t.ARRAY_TYPE=e},t.toRadian=function(e){return e*i},t.equals=function(e,t){return Math.abs(e-t)<=r*Math.max(1,Math.abs(e),Math.abs(t))};var r=t.EPSILON=1e-6,i=(t.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,t.RANDOM=Math.random,Math.PI/180)},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=t.sqrLen=t.len=t.sqrDist=t.dist=t.div=t.mul=t.sub=void 0,t.create=r,t.clone=function(e){var t=new l.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},t.fromValues=function(e,t,n,r){var i=new l.ARRAY_TYPE(4);return i[0]=e,i[1]=t,i[2]=n,i[3]=r,i},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},t.set=function(e,t,n,r,i){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e},t.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e},t.subtract=i,t.multiply=o,t.divide=a,t.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e},t.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e},t.min=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e[3]=Math.min(t[3],n[3]),e},t.max=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e[3]=Math.max(t[3],n[3]),e},t.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e},t.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e},t.scaleAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e},t.distance=s,t.squaredDistance=u,t.length=h,t.squaredLength=d,t.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},t.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},t.normalize=function(e,t){var n=t[0],r=t[1],i=t[2],t=t[3],o=n*n+r*r+i*i+t*t;return 0<o&&(o=1/Math.sqrt(o),e[0]=n*o,e[1]=r*o,e[2]=i*o,e[3]=t*o),e},t.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},t.lerp=function(e,t,n,r){var i=t[0],o=t[1],a=t[2],t=t[3];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e[2]=a+r*(n[2]-a),e[3]=t+r*(n[3]-t),e},t.random=function(e,t){var n,r,i,o,a,s;for(t=t||1;1<=(a=(n=2*l.RANDOM()-1)*n+(r=2*l.RANDOM()-1)*r););for(;1<=(s=(i=2*l.RANDOM()-1)*i+(o=2*l.RANDOM()-1)*o););var c=Math.sqrt((1-a)/s);return e[0]=t*n,e[1]=t*r,e[2]=t*i*c,e[3]=t*o*c,e},t.transformMat4=function(e,t,n){var r=t[0],i=t[1],o=t[2],t=t[3];return e[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*t,e[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*t,e[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*t,e[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*t,e},t.transformQuat=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],s=n[1],c=n[2],n=n[3],l=n*r+s*o-c*i,u=n*i+c*r-a*o,h=n*o+a*i-s*r,r=-a*r-s*i-c*o;return e[0]=l*n+r*-a+u*-c-h*-s,e[1]=u*n+r*-s+h*-a-l*-c,e[2]=h*n+r*-c+l*-s-u*-a,e[3]=t[3],e},t.str=function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},t.equals=function(e,t){var n=e[0],r=e[1],i=e[2],e=e[3],o=t[0],a=t[1],s=t[2],t=t[3];return Math.abs(n-o)<=l.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-a)<=l.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-s)<=l.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(e-t)<=l.EPSILON*Math.max(1,Math.abs(e),Math.abs(t))};var c,l=(e=>{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t})(n(0));function r(){var e=new l.ARRAY_TYPE(4);return l.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function i(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e}function o(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e[3]=t[3]*n[3],e}function a(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e[3]=t[3]/n[3],e}function s(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2],t=t[3]-e[3];return Math.sqrt(n*n+r*r+i*i+t*t)}function u(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2],t=t[3]-e[3];return n*n+r*r+i*i+t*t}function h(e){var t=e[0],n=e[1],r=e[2],e=e[3];return Math.sqrt(t*t+n*n+r*r+e*e)}function d(e){var t=e[0],n=e[1],r=e[2],e=e[3];return t*t+n*n+r*r+e*e}t.sub=i,t.mul=o,t.div=a,t.dist=s,t.sqrDist=u,t.len=h,t.sqrLen=d,t.forEach=(c=r(),function(e,t,n,r,i,o){var a,s=void 0;for(t=t||4,n=n||0,a=r?Math.min(r*t+n,e.length):e.length,s=n;s<a;s+=t)c[0]=e[s],c[1]=e[s+1],c[2]=e[s+2],c[3]=e[s+3],i(c,c,o),e[s]=c[0],e[s+1]=c[1],e[s+2]=c[2],e[s+3]=c[3];return e})},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=t.sqrLen=t.len=t.sqrDist=t.dist=t.div=t.mul=t.sub=void 0,t.create=r,t.clone=function(e){var t=new a.ARRAY_TYPE(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},t.length=i,t.fromValues=o,t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},t.set=function(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e},t.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e},t.subtract=s,t.multiply=l,t.divide=u,t.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e},t.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e},t.min=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e},t.max=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e},t.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e},t.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e},t.scaleAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e},t.distance=h,t.squaredDistance=d,t.squaredLength=p,t.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},t.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},t.normalize=f,t.dot=m,t.cross=function(e,t,n){var r=t[0],i=t[1],t=t[2],o=n[0],a=n[1],n=n[2];return e[0]=i*n-t*a,e[1]=t*o-r*n,e[2]=r*a-i*o,e},t.lerp=function(e,t,n,r){var i=t[0],o=t[1],t=t[2];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e[2]=t+r*(n[2]-t),e},t.hermite=function(e,t,n,r,i,o){var a=o*o,s=a*(2*o-3)+1,c=a*(o-2)+o,l=a*(o-1),a=a*(3-2*o);return e[0]=t[0]*s+n[0]*c+r[0]*l+i[0]*a,e[1]=t[1]*s+n[1]*c+r[1]*l+i[1]*a,e[2]=t[2]*s+n[2]*c+r[2]*l+i[2]*a,e},t.bezier=function(e,t,n,r,i,o){var a=1-o,s=a*a,c=o*o,l=s*a,s=3*o*s,a=3*c*a,c=c*o;return e[0]=t[0]*l+n[0]*s+r[0]*a+i[0]*c,e[1]=t[1]*l+n[1]*s+r[1]*a+i[1]*c,e[2]=t[2]*l+n[2]*s+r[2]*a+i[2]*c,e},t.random=function(e,t){t=t||1;var n=2*a.RANDOM()*Math.PI,r=2*a.RANDOM()-1,i=Math.sqrt(1-r*r)*t;return e[0]=Math.cos(n)*i,e[1]=Math.sin(n)*i,e[2]=r*t,e},t.transformMat4=function(e,t,n){var r=t[0],i=t[1],t=t[2],o=n[3]*r+n[7]*i+n[11]*t+n[15];return e[0]=(n[0]*r+n[4]*i+n[8]*t+n[12])/(o=o||1),e[1]=(n[1]*r+n[5]*i+n[9]*t+n[13])/o,e[2]=(n[2]*r+n[6]*i+n[10]*t+n[14])/o,e},t.transformMat3=function(e,t,n){var r=t[0],i=t[1],t=t[2];return e[0]=r*n[0]+i*n[3]+t*n[6],e[1]=r*n[1]+i*n[4]+t*n[7],e[2]=r*n[2]+i*n[5]+t*n[8],e},t.transformQuat=function(e,t,n){var r=n[0],i=n[1],o=n[2],a=t[0],s=t[1],t=t[2],c=i*t-o*s,l=o*a-r*t,u=r*s-i*a,h=i*u-o*l,o=o*c-r*u,r=r*l-i*c,i=2*n[3];return l*=i,u*=i,o*=2,r*=2,e[0]=a+(c*=i)+(h*=2),e[1]=s+l+o,e[2]=t+u+r,e},t.rotateX=function(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e},t.rotateY=function(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e},t.rotateZ=function(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e},t.angle=function(e,t){e=o(e[0],e[1],e[2]),t=o(t[0],t[1],t[2]),f(e,e),f(t,t),e=m(e,t);return 1<e?0:e<-1?Math.PI:Math.acos(e)},t.str=function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},t.equals=function(e,t){var n=e[0],r=e[1],e=e[2],i=t[0],o=t[1],t=t[2];return Math.abs(n-i)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-o)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(e-t)<=a.EPSILON*Math.max(1,Math.abs(e),Math.abs(t))};var c,a=(e=>{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t})(n(0));function r(){var e=new a.ARRAY_TYPE(3);return a.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function i(e){var t=e[0],n=e[1],e=e[2];return Math.sqrt(t*t+n*n+e*e)}function o(e,t,n){var r=new a.ARRAY_TYPE(3);return r[0]=e,r[1]=t,r[2]=n,r}function s(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}function l(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e}function u(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e}function h(e,t){var n=t[0]-e[0],r=t[1]-e[1],t=t[2]-e[2];return Math.sqrt(n*n+r*r+t*t)}function d(e,t){var n=t[0]-e[0],r=t[1]-e[1],t=t[2]-e[2];return n*n+r*r+t*t}function p(e){var t=e[0],n=e[1],e=e[2];return t*t+n*n+e*e}function f(e,t){var n=t[0],r=t[1],i=t[2],n=n*n+r*r+i*i;return 0<n&&(n=1/Math.sqrt(n),e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n),e}function m(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}t.sub=s,t.mul=l,t.div=u,t.dist=h,t.sqrDist=d,t.len=i,t.sqrLen=p,t.forEach=(c=r(),function(e,t,n,r,i,o){var a,s=void 0;for(t=t||3,n=n||0,a=r?Math.min(r*t+n,e.length):e.length,s=n;s<a;s+=t)c[0]=e[s],c[1]=e[s+1],c[2]=e[s+2],i(c,c,o),e[s]=c[0],e[s+1]=c[1],e[s+2]=c[2];return e})},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.setAxes=t.sqlerp=t.rotationTo=t.equals=t.exactEquals=t.normalize=t.sqrLen=t.squaredLength=t.len=t.length=t.lerp=t.dot=t.scale=t.mul=t.add=t.set=t.copy=t.fromValues=t.clone=void 0,t.create=a,t.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},t.setAxisAngle=s,t.getAxisAngle=function(e,t){var n=2*Math.acos(t[3]),r=Math.sin(n/2);return r>f.EPSILON?(e[0]=t[0]/r,e[1]=t[1]/r,e[2]=t[2]/r):(e[0]=1,e[1]=0,e[2]=0),n},t.multiply=c,t.rotateX=function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],t=t[3],a=Math.sin(n),n=Math.cos(n);return e[0]=r*n+t*a,e[1]=i*n+o*a,e[2]=o*n-i*a,e[3]=t*n-r*a,e},t.rotateY=function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],t=t[3],a=Math.sin(n),n=Math.cos(n);return e[0]=r*n-o*a,e[1]=i*n+t*a,e[2]=o*n+r*a,e[3]=t*n-i*a,e},t.rotateZ=function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],t=t[3],a=Math.sin(n),n=Math.cos(n);return e[0]=r*n+i*a,e[1]=i*n-r*a,e[2]=o*n+t*a,e[3]=t*n-o*a,e},t.calculateW=function(e,t){var n=t[0],r=t[1],t=t[2];return e[0]=n,e[1]=r,e[2]=t,e[3]=Math.sqrt(Math.abs(1-n*n-r*r-t*t)),e},t.slerp=l,t.random=function(e){var t=f.RANDOM(),n=f.RANDOM(),r=f.RANDOM(),i=Math.sqrt(1-t),t=Math.sqrt(t);return e[0]=i*Math.sin(2*Math.PI*n),e[1]=i*Math.cos(2*Math.PI*n),e[2]=t*Math.sin(2*Math.PI*r),e[3]=t*Math.cos(2*Math.PI*r),e},t.invert=function(e,t){var n=t[0],r=t[1],i=t[2],t=t[3],o=n*n+r*r+i*i+t*t,o=o?1/o:0;return e[0]=-n*o,e[1]=-r*o,e[2]=-i*o,e[3]=t*o,e},t.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},t.fromMat3=u,t.fromEuler=function(e,t,n,r){var i=.5*Math.PI/180,i=(n*=i,r*=i,Math.sin(t*=i)),t=Math.cos(t),o=Math.sin(n),n=Math.cos(n),a=Math.sin(r),r=Math.cos(r);return e[0]=i*n*r-t*o*a,e[1]=t*o*r+i*n*a,e[2]=t*n*a-i*o*r,e[3]=t*n*r+i*o*a,e},t.str=function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"};var f=o(n(0)),r=o(n(5)),i=o(n(2)),n=o(n(1));function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function a(){var e=new f.ARRAY_TYPE(4);return f.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function s(e,t,n){n*=.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}function c(e,t,n){var r=t[0],i=t[1],o=t[2],t=t[3],a=n[0],s=n[1],c=n[2],n=n[3];return e[0]=r*n+t*a+i*c-o*s,e[1]=i*n+t*s+o*a-r*c,e[2]=o*n+t*c+r*s-i*a,e[3]=t*n-r*a-i*s-o*c,e}function l(e,t,n,r){var i,o=t[0],a=t[1],s=t[2],t=t[3],c=n[0],l=n[1],u=n[2],n=n[3],h=void 0,d=void 0,p=void 0;return(h=o*c+a*l+s*u+t*n)<0&&(h=-h,c=-c,l=-l,u=-u,n=-n),p=1-h>f.EPSILON?(h=Math.acos(h),i=Math.sin(h),d=Math.sin((1-r)*h)/i,Math.sin(r*h)/i):(d=1-r,r),e[0]=d*o+p*c,e[1]=d*a+p*l,e[2]=d*s+p*u,e[3]=d*t+p*n,e}function u(e,t){var n,r,i=t[0]+t[4]+t[8],o=void 0;return 0<i?(o=Math.sqrt(i+1),e[3]=.5*o,e[0]=(t[5]-t[7])*(o=.5/o),e[1]=(t[6]-t[2])*o,e[2]=(t[1]-t[3])*o):(n=((i=t[3*(i=t[4]>t[i=0]?1:i)+i]<t[8]?2:i)+1)%3,r=(i+2)%3,o=Math.sqrt(t[3*i+i]-t[3*n+n]-t[3*r+r]+1),e[i]=.5*o,e[3]=(t[3*n+r]-t[3*r+n])*(o=.5/o),e[n]=(t[3*n+i]+t[3*i+n])*o,e[r]=(t[3*r+i]+t[3*i+r])*o),e}t.clone=n.clone,t.fromValues=n.fromValues,t.copy=n.copy,t.set=n.set,t.add=n.add,t.mul=c,t.scale=n.scale,t.dot=n.dot,t.lerp=n.lerp;var h,d,p,m,g,v,y=t.length=n.length,y=(t.len=y,t.squaredLength=n.squaredLength),_=(t.sqrLen=y,t.normalize=n.normalize);t.exactEquals=n.exactEquals,t.equals=n.equals,t.rotationTo=(m=i.create(),g=i.fromValues(1,0,0),v=i.fromValues(0,1,0),function(e,t,n){var r=i.dot(t,n);return r<-.999999?(i.cross(m,g,t),i.len(m)<1e-6&&i.cross(m,v,t),i.normalize(m,m),s(e,m,Math.PI),e):.999999<r?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(i.cross(m,t,n),e[0]=m[0],e[1]=m[1],e[2]=m[2],e[3]=1+r,_(e,e))}),t.sqlerp=(d=a(),p=a(),function(e,t,n,r,i,o){return l(d,t,i,o),l(p,n,r,o),l(e,d,p,2*o*(1-o)),e}),t.setAxes=(h=r.create(),function(e,t,n,r){return h[0]=n[0],h[3]=n[1],h[6]=n[2],h[1]=r[0],h[4]=r[1],h[7]=r[2],h[2]=-t[0],h[5]=-t[1],h[8]=-t[2],_(e,u(e,h))})},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=function(){var e=new I.ARRAY_TYPE(16);return I.ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},t.clone=function(e){var t=new I.ARRAY_TYPE(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.fromValues=function(e,t,n,r,i,o,a,s,c,l,u,h,d,p,f,m){var g=new I.ARRAY_TYPE(16);return g[0]=e,g[1]=t,g[2]=n,g[3]=r,g[4]=i,g[5]=o,g[6]=a,g[7]=s,g[8]=c,g[9]=l,g[10]=u,g[11]=h,g[12]=d,g[13]=p,g[14]=f,g[15]=m,g},t.set=function(e,t,n,r,i,o,a,s,c,l,u,h,d,p,f,m,g){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=o,e[5]=a,e[6]=s,e[7]=c,e[8]=l,e[9]=u,e[10]=h,e[11]=d,e[12]=p,e[13]=f,e[14]=m,e[15]=g,e},t.identity=v,t.transpose=function(e,t){var n,r,i,o,a,s;return e===t?(n=t[1],r=t[2],i=t[3],o=t[6],a=t[7],s=t[11],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=o,e[11]=t[14],e[12]=i,e[13]=a,e[14]=s):(e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15]),e},t.invert=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],c=t[6],l=t[7],u=t[8],h=t[9],d=t[10],p=t[11],f=t[12],m=t[13],g=t[14],t=t[15],v=n*s-r*a,y=n*c-i*a,_=n*l-o*a,x=r*c-i*s,b=r*l-o*s,w=i*l-o*c,E=u*m-h*f,M=u*g-d*f,T=u*t-p*f,S=h*g-d*m,A=h*t-p*m,P=d*t-p*g,R=v*P-y*A+_*S+x*T-b*M+w*E;return R?(e[0]=(s*P-c*A+l*S)*(R=1/R),e[1]=(i*A-r*P-o*S)*R,e[2]=(m*w-g*b+t*x)*R,e[3]=(d*b-h*w-p*x)*R,e[4]=(c*T-a*P-l*M)*R,e[5]=(n*P-i*T+o*M)*R,e[6]=(g*_-f*w-t*y)*R,e[7]=(u*w-d*_+p*y)*R,e[8]=(a*A-s*T+l*E)*R,e[9]=(r*T-n*A-o*E)*R,e[10]=(f*b-m*_+t*v)*R,e[11]=(h*_-u*b-p*v)*R,e[12]=(s*M-a*S-c*E)*R,e[13]=(n*S-r*M+i*E)*R,e[14]=(m*y-f*x-g*v)*R,e[15]=(u*x-h*y+d*v)*R,e):null},t.adjoint=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],c=t[6],l=t[7],u=t[8],h=t[9],d=t[10],p=t[11],f=t[12],m=t[13],g=t[14],t=t[15];return e[0]=s*(d*t-p*g)-h*(c*t-l*g)+m*(c*p-l*d),e[1]=-(r*(d*t-p*g)-h*(i*t-o*g)+m*(i*p-o*d)),e[2]=r*(c*t-l*g)-s*(i*t-o*g)+m*(i*l-o*c),e[3]=-(r*(c*p-l*d)-s*(i*p-o*d)+h*(i*l-o*c)),e[4]=-(a*(d*t-p*g)-u*(c*t-l*g)+f*(c*p-l*d)),e[5]=n*(d*t-p*g)-u*(i*t-o*g)+f*(i*p-o*d),e[6]=-(n*(c*t-l*g)-a*(i*t-o*g)+f*(i*l-o*c)),e[7]=n*(c*p-l*d)-a*(i*p-o*d)+u*(i*l-o*c),e[8]=a*(h*t-p*m)-u*(s*t-l*m)+f*(s*p-l*h),e[9]=-(n*(h*t-p*m)-u*(r*t-o*m)+f*(r*p-o*h)),e[10]=n*(s*t-l*m)-a*(r*t-o*m)+f*(r*l-o*s),e[11]=-(n*(s*p-l*h)-a*(r*p-o*h)+u*(r*l-o*s)),e[12]=-(a*(h*g-d*m)-u*(s*g-c*m)+f*(s*d-c*h)),e[13]=n*(h*g-d*m)-u*(r*g-i*m)+f*(r*d-i*h),e[14]=-(n*(s*g-c*m)-a*(r*g-i*m)+f*(r*c-i*s)),e[15]=n*(s*d-c*h)-a*(r*d-i*h)+u*(r*c-i*s),e},t.determinant=function(e){var t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],c=e[7],l=e[8],u=e[9],h=e[10],d=e[11],p=e[12],f=e[13],m=e[14],e=e[15];return(t*a-n*o)*(h*e-d*m)-(t*s-r*o)*(u*e-d*f)+(t*c-i*o)*(u*m-h*f)+(n*s-r*a)*(l*e-d*p)-(n*c-i*a)*(l*m-h*p)+(r*c-i*s)*(l*f-u*p)},t.multiply=r,t.translate=function(e,t,n){var r,i,o,a,s,c,l,u,h,d,p,f,m=n[0],g=n[1],n=n[2];return t===e?(e[12]=t[0]*m+t[4]*g+t[8]*n+t[12],e[13]=t[1]*m+t[5]*g+t[9]*n+t[13],e[14]=t[2]*m+t[6]*g+t[10]*n+t[14],e[15]=t[3]*m+t[7]*g+t[11]*n+t[15]):(r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],c=t[5],l=t[6],u=t[7],h=t[8],d=t[9],p=t[10],f=t[11],e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=c,e[6]=l,e[7]=u,e[8]=h,e[9]=d,e[10]=p,e[11]=f,e[12]=r*m+s*g+h*n+t[12],e[13]=i*m+c*g+d*n+t[13],e[14]=o*m+l*g+p*n+t[14],e[15]=a*m+u*g+f*n+t[15]),e},t.scale=function(e,t,n){var r=n[0],i=n[1],n=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*n,e[9]=t[9]*n,e[10]=t[10]*n,e[11]=t[11]*n,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.rotate=function(e,t,n,r){var i,o,a,s,c,l,u,h,d,p,f,m,g,v,y,_,x,b,w,E,M=r[0],T=r[1],r=r[2],S=Math.sqrt(M*M+T*T+r*r);return S<I.EPSILON?null:(M*=S=1/S,T*=S,r*=S,S=Math.sin(n),n=Math.cos(n),o=t[0],a=t[1],s=t[2],c=t[3],u=t[5],h=t[6],d=t[7],f=t[9],m=t[10],g=t[11],y=M*T*(i=1-n)-r*S,_=T*T*i+n,x=r*T*i+M*S,b=M*r*i+T*S,w=T*r*i-M*S,E=r*r*i+n,e[0]=o*(n=M*M*i+n)+(l=t[4])*(v=T*M*i+r*S)+(p=t[8])*(r=r*M*i-T*S),e[1]=a*n+u*v+f*r,e[2]=s*n+h*v+m*r,e[3]=c*n+d*v+g*r,e[4]=o*y+l*_+p*x,e[5]=a*y+u*_+f*x,e[6]=s*y+h*_+m*x,e[7]=c*y+d*_+g*x,e[8]=o*b+l*w+p*E,e[9]=a*b+u*w+f*E,e[10]=s*b+h*w+m*E,e[11]=c*b+d*w+g*E,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)},t.rotateX=function(e,t,n){var r=Math.sin(n),n=Math.cos(n),i=t[4],o=t[5],a=t[6],s=t[7],c=t[8],l=t[9],u=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=i*n+c*r,e[5]=o*n+l*r,e[6]=a*n+u*r,e[7]=s*n+h*r,e[8]=c*n-i*r,e[9]=l*n-o*r,e[10]=u*n-a*r,e[11]=h*n-s*r,e},t.rotateY=function(e,t,n){var r=Math.sin(n),n=Math.cos(n),i=t[0],o=t[1],a=t[2],s=t[3],c=t[8],l=t[9],u=t[10],h=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*n-c*r,e[1]=o*n-l*r,e[2]=a*n-u*r,e[3]=s*n-h*r,e[8]=i*r+c*n,e[9]=o*r+l*n,e[10]=a*r+u*n,e[11]=s*r+h*n,e},t.rotateZ=function(e,t,n){var r=Math.sin(n),n=Math.cos(n),i=t[0],o=t[1],a=t[2],s=t[3],c=t[4],l=t[5],u=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*n+c*r,e[1]=o*n+l*r,e[2]=a*n+u*r,e[3]=s*n+h*r,e[4]=c*n-i*r,e[5]=l*n-o*r,e[6]=u*n-a*r,e[7]=h*n-s*r,e},t.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromRotation=function(e,t,n){var r,i=n[0],o=n[1],n=n[2],a=Math.sqrt(i*i+o*o+n*n);return a<I.EPSILON?null:(i*=a=1/a,o*=a,n*=a,a=Math.sin(t),t=Math.cos(t),e[0]=i*i*(r=1-t)+t,e[1]=o*i*r+n*a,e[2]=n*i*r-o*a,e[3]=0,e[4]=i*o*r-n*a,e[5]=o*o*r+t,e[6]=n*o*r+i*a,e[7]=0,e[8]=i*n*r+o*a,e[9]=o*n*r-i*a,e[10]=n*n*r+t,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)},t.fromXRotation=function(e,t){var n=Math.sin(t),t=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=t,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromYRotation=function(e,t){var n=Math.sin(t),t=Math.cos(t);return e[0]=t,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=t,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromZRotation=function(e,t){var n=Math.sin(t),t=Math.cos(t);return e[0]=t,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=t,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromRotationTranslation=d,t.fromQuat2=function(e,t){var n=new I.ARRAY_TYPE(3),r=-t[0],i=-t[1],o=-t[2],a=t[3],s=t[4],c=t[5],l=t[6],u=t[7],h=r*r+i*i+o*o+a*a;return 0<h?(n[0]=2*(s*a+u*r+c*o-l*i)/h,n[1]=2*(c*a+u*i+l*r-s*o)/h,n[2]=2*(l*a+u*o+s*i-c*r)/h):(n[0]=2*(s*a+u*r+c*o-l*i),n[1]=2*(c*a+u*i+l*r-s*o),n[2]=2*(l*a+u*o+s*i-c*r)),d(e,t,n),e},t.getTranslation=function(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e},t.getScaling=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[4],a=t[5],s=t[6],c=t[8],l=t[9],t=t[10];return e[0]=Math.sqrt(n*n+r*r+i*i),e[1]=Math.sqrt(o*o+a*a+s*s),e[2]=Math.sqrt(c*c+l*l+t*t),e},t.getRotation=function(e,t){var n=t[0]+t[5]+t[10],r=0;return 0<n?(r=2*Math.sqrt(n+1),e[3]=.25*r,e[0]=(t[6]-t[9])/r,e[1]=(t[8]-t[2])/r,e[2]=(t[1]-t[4])/r):t[0]>t[5]&&t[0]>t[10]?(r=2*Math.sqrt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/r,e[0]=.25*r,e[1]=(t[1]+t[4])/r,e[2]=(t[8]+t[2])/r):t[5]>t[10]?(r=2*Math.sqrt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/r,e[0]=(t[1]+t[4])/r,e[1]=.25*r,e[2]=(t[6]+t[9])/r):(r=2*Math.sqrt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/r,e[0]=(t[8]+t[2])/r,e[1]=(t[6]+t[9])/r,e[2]=.25*r),e},t.fromRotationTranslationScale=function(e,t,n,r){var i=t[0],o=t[1],a=t[2],t=t[3],s=i+i,c=o+o,l=a+a,u=i*s,h=i*c,i=i*l,d=o*c,o=o*l,a=a*l,s=t*s,c=t*c,t=t*l,l=r[0],p=r[1],r=r[2];return e[0]=(1-(d+a))*l,e[1]=(h+t)*l,e[2]=(i-c)*l,e[3]=0,e[4]=(h-t)*p,e[5]=(1-(u+a))*p,e[6]=(o+s)*p,e[7]=0,e[8]=(i+c)*r,e[9]=(o-s)*r,e[10]=(1-(u+d))*r,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e},t.fromRotationTranslationScaleOrigin=function(e,t,n,r,i){var o=t[0],a=t[1],s=t[2],t=t[3],c=o+o,l=a+a,u=s+s,h=o*c,d=o*l,o=o*u,p=a*l,a=a*u,s=s*u,c=t*c,l=t*l,t=t*u,u=r[0],f=r[1],r=r[2],m=i[0],g=i[1],i=i[2],v=(1-(p+s))*u,y=(d+t)*u,u=(o-l)*u,d=(d-t)*f,t=(1-(h+s))*f,s=(a+c)*f,f=(o+l)*r,o=(a-c)*r,l=(1-(h+p))*r;return e[0]=v,e[1]=y,e[2]=u,e[3]=0,e[4]=d,e[5]=t,e[6]=s,e[7]=0,e[8]=f,e[9]=o,e[10]=l,e[11]=0,e[12]=n[0]+m-(v*m+d*g+f*i),e[13]=n[1]+g-(y*m+t*g+o*i),e[14]=n[2]+i-(u*m+s*g+l*i),e[15]=1,e},t.fromQuat=function(e,t){var n=t[0],r=t[1],i=t[2],t=t[3],o=n+n,a=r+r,s=i+i,n=n*o,c=r*o,r=r*a,l=i*o,u=i*a,i=i*s,o=t*o,a=t*a,t=t*s;return e[0]=1-r-i,e[1]=c+t,e[2]=l-a,e[3]=0,e[4]=c-t,e[5]=1-n-i,e[6]=u+o,e[7]=0,e[8]=l+a,e[9]=u-o,e[10]=1-n-r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.frustum=function(e,t,n,r,i,o,a){var s=1/(n-t),c=1/(i-r),l=1/(o-a);return e[0]=2*o*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*o*c,e[6]=0,e[7]=0,e[8]=(n+t)*s,e[9]=(i+r)*c,e[10]=(a+o)*l,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*o*2*l,e[15]=0,e},t.perspective=function(e,t,n,r,i){t=1/Math.tan(t/2);return e[0]=t/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(e[10]=(i+r)*(n=1/(r-i)),e[14]=2*i*r*n):(e[10]=-1,e[14]=-2*r),e},t.perspectiveFromFieldOfView=function(e,t,n,r){var i=Math.tan(t.upDegrees*Math.PI/180),o=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),t=Math.tan(t.rightDegrees*Math.PI/180),s=2/(a+t),c=2/(i+o);return e[0]=s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=-(a-t)*s*.5,e[9]=(i-o)*c*.5,e[10]=r/(n-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*n/(n-r),e[15]=0,e},t.ortho=function(e,t,n,r,i,o,a){var s=1/(t-n),c=1/(r-i),l=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*c,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*l,e[11]=0,e[12]=(t+n)*s,e[13]=(i+r)*c,e[14]=(a+o)*l,e[15]=1,e},t.lookAt=function(e,t,n,r){var i=void 0,o=void 0,a=void 0,s=void 0,c=void 0,l=void 0,u=void 0,h=t[0],d=t[1],t=t[2],p=r[0],f=r[1],r=r[2],m=n[0],g=n[1],n=n[2];return Math.abs(h-m)<I.EPSILON&&Math.abs(d-g)<I.EPSILON&&Math.abs(t-n)<I.EPSILON?v(e):(m=h-m,g=d-g,n=t-n,i=f*(n*=u=1/Math.sqrt(m*m+g*g+n*n))-r*(g*=u),o=r*(m*=u)-p*n,a=p*g-f*m,(u=Math.sqrt(i*i+o*o+a*a))?(i*=u=1/u,o*=u,a*=u):a=o=i=0,s=g*a-n*o,c=n*i-m*a,l=m*o-g*i,(u=Math.sqrt(s*s+c*c+l*l))?(s*=u=1/u,c*=u,l*=u):l=c=s=0,e[0]=i,e[1]=s,e[2]=m,e[3]=0,e[4]=o,e[5]=c,e[6]=g,e[7]=0,e[8]=a,e[9]=l,e[10]=n,e[11]=0,e[12]=-(i*h+o*d+a*t),e[13]=-(s*h+c*d+l*t),e[14]=-(m*h+g*d+n*t),e[15]=1,e)},t.targetTo=function(e,t,n,r){var i=t[0],o=t[1],t=t[2],a=r[0],s=r[1],r=r[2],c=i-n[0],l=o-n[1],n=t-n[2],u=c*c+l*l+n*n,h=(0<u&&(c*=u=1/Math.sqrt(u),l*=u,n*=u),s*n-r*l),r=r*c-a*n,a=a*l-s*c;return 0<(u=h*h+r*r+a*a)&&(h*=u=1/Math.sqrt(u),r*=u,a*=u),e[0]=h,e[1]=r,e[2]=a,e[3]=0,e[4]=l*a-n*r,e[5]=n*h-c*a,e[6]=c*r-l*h,e[7]=0,e[8]=c,e[9]=l,e[10]=n,e[11]=0,e[12]=i,e[13]=o,e[14]=t,e[15]=1,e},t.str=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))},t.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e[9]=t[9]+n[9],e[10]=t[10]+n[10],e[11]=t[11]+n[11],e[12]=t[12]+n[12],e[13]=t[13]+n[13],e[14]=t[14]+n[14],e[15]=t[15]+n[15],e},t.subtract=i,t.multiplyScalar=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e[9]=t[9]*n,e[10]=t[10]*n,e[11]=t[11]*n,e[12]=t[12]*n,e[13]=t[13]*n,e[14]=t[14]*n,e[15]=t[15]*n,e},t.multiplyScalarAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e[9]=t[9]+n[9]*r,e[10]=t[10]+n[10]*r,e[11]=t[11]+n[11]*r,e[12]=t[12]+n[12]*r,e[13]=t[13]+n[13]*r,e[14]=t[14]+n[14]*r,e[15]=t[15]+n[15]*r,e},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},t.equals=function(e,t){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],c=e[6],l=e[7],u=e[8],h=e[9],d=e[10],p=e[11],f=e[12],m=e[13],g=e[14],e=e[15],v=t[0],y=t[1],_=t[2],x=t[3],b=t[4],w=t[5],E=t[6],M=t[7],T=t[8],S=t[9],A=t[10],P=t[11],R=t[12],L=t[13],C=t[14],t=t[15];return Math.abs(n-v)<=I.EPSILON*Math.max(1,Math.abs(n),Math.abs(v))&&Math.abs(r-y)<=I.EPSILON*Math.max(1,Math.abs(r),Math.abs(y))&&Math.abs(i-_)<=I.EPSILON*Math.max(1,Math.abs(i),Math.abs(_))&&Math.abs(o-x)<=I.EPSILON*Math.max(1,Math.abs(o),Math.abs(x))&&Math.abs(a-b)<=I.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))&&Math.abs(s-w)<=I.EPSILON*Math.max(1,Math.abs(s),Math.abs(w))&&Math.abs(c-E)<=I.EPSILON*Math.max(1,Math.abs(c),Math.abs(E))&&Math.abs(l-M)<=I.EPSILON*Math.max(1,Math.abs(l),Math.abs(M))&&Math.abs(u-T)<=I.EPSILON*Math.max(1,Math.abs(u),Math.abs(T))&&Math.abs(h-S)<=I.EPSILON*Math.max(1,Math.abs(h),Math.abs(S))&&Math.abs(d-A)<=I.EPSILON*Math.max(1,Math.abs(d),Math.abs(A))&&Math.abs(p-P)<=I.EPSILON*Math.max(1,Math.abs(p),Math.abs(P))&&Math.abs(f-R)<=I.EPSILON*Math.max(1,Math.abs(f),Math.abs(R))&&Math.abs(m-L)<=I.EPSILON*Math.max(1,Math.abs(m),Math.abs(L))&&Math.abs(g-C)<=I.EPSILON*Math.max(1,Math.abs(g),Math.abs(C))&&Math.abs(e-t)<=I.EPSILON*Math.max(1,Math.abs(e),Math.abs(t))};var I=(e=>{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t})(n(0));function v(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function r(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],c=t[5],l=t[6],u=t[7],h=t[8],d=t[9],p=t[10],f=t[11],m=t[12],g=t[13],v=t[14],t=t[15],y=n[0],_=n[1],x=n[2],b=n[3];return e[0]=y*r+_*s+x*h+b*m,e[1]=y*i+_*c+x*d+b*g,e[2]=y*o+_*l+x*p+b*v,e[3]=y*a+_*u+x*f+b*t,e[4]=(y=n[4])*r+(_=n[5])*s+(x=n[6])*h+(b=n[7])*m,e[5]=y*i+_*c+x*d+b*g,e[6]=y*o+_*l+x*p+b*v,e[7]=y*a+_*u+x*f+b*t,e[8]=(y=n[8])*r+(_=n[9])*s+(x=n[10])*h+(b=n[11])*m,e[9]=y*i+_*c+x*d+b*g,e[10]=y*o+_*l+x*p+b*v,e[11]=y*a+_*u+x*f+b*t,e[12]=(y=n[12])*r+(_=n[13])*s+(x=n[14])*h+(b=n[15])*m,e[13]=y*i+_*c+x*d+b*g,e[14]=y*o+_*l+x*p+b*v,e[15]=y*a+_*u+x*f+b*t,e}function d(e,t,n){var r=t[0],i=t[1],o=t[2],t=t[3],a=r+r,s=i+i,c=o+o,l=r*a,u=r*s,r=r*c,h=i*s,i=i*c,o=o*c,a=t*a,s=t*s,t=t*c;return e[0]=1-(h+o),e[1]=u+t,e[2]=r-s,e[3]=0,e[4]=u-t,e[5]=1-(l+o),e[6]=i+a,e[7]=0,e[8]=r+s,e[9]=i-a,e[10]=1-(l+h),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function i(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e[9]=t[9]-n[9],e[10]=t[10]-n[10],e[11]=t[11]-n[11],e[12]=t[12]-n[12],e[13]=t[13]-n[13],e[14]=t[14]-n[14],e[15]=t[15]-n[15],e}t.mul=r,t.sub=i},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=function(){var e=new y.ARRAY_TYPE(9);return y.ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},t.fromMat4=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},t.clone=function(e){var t=new y.ARRAY_TYPE(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},t.fromValues=function(e,t,n,r,i,o,a,s,c){var l=new y.ARRAY_TYPE(9);return l[0]=e,l[1]=t,l[2]=n,l[3]=r,l[4]=i,l[5]=o,l[6]=a,l[7]=s,l[8]=c,l},t.set=function(e,t,n,r,i,o,a,s,c,l){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=o,e[5]=a,e[6]=s,e[7]=c,e[8]=l,e},t.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},t.transpose=function(e,t){var n,r,i;return e===t?(n=t[1],r=t[2],i=t[5],e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=r,e[7]=i):(e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8]),e},t.invert=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],c=t[6],l=t[7],t=t[8],u=t*a-s*l,h=-t*o+s*c,d=l*o-a*c,p=n*u+r*h+i*d;return p?(e[0]=u*(p=1/p),e[1]=(-t*r+i*l)*p,e[2]=(s*r-i*a)*p,e[3]=h*p,e[4]=(t*n-i*c)*p,e[5]=(-s*n+i*o)*p,e[6]=d*p,e[7]=(-l*n+r*c)*p,e[8]=(a*n-r*o)*p,e):null},t.adjoint=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],c=t[6],l=t[7],t=t[8];return e[0]=a*t-s*l,e[1]=i*l-r*t,e[2]=r*s-i*a,e[3]=s*c-o*t,e[4]=n*t-i*c,e[5]=i*o-n*s,e[6]=o*l-a*c,e[7]=r*c-n*l,e[8]=n*a-r*o,e},t.determinant=function(e){var t=e[0],n=e[3],r=e[4],i=e[5],o=e[6],a=e[7],s=e[8];return t*(s*r-i*a)+e[1]*(-s*n+i*o)+e[2]*(a*n-r*o)},t.multiply=r,t.translate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],c=t[5],l=t[6],u=t[7],t=t[8],h=n[0],n=n[1];return e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=c,e[6]=h*r+n*a+l,e[7]=h*i+n*s+u,e[8]=h*o+n*c+t,e},t.rotate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],c=t[5],l=t[6],u=t[7],t=t[8],h=Math.sin(n),n=Math.cos(n);return e[0]=n*r+h*a,e[1]=n*i+h*s,e[2]=n*o+h*c,e[3]=n*a-h*r,e[4]=n*s-h*i,e[5]=n*c-h*o,e[6]=l,e[7]=u,e[8]=t,e},t.scale=function(e,t,n){var r=n[0],n=n[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=n*t[3],e[4]=n*t[4],e[5]=n*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},t.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e},t.fromRotation=function(e,t){var n=Math.sin(t),t=Math.cos(t);return e[0]=t,e[1]=n,e[2]=0,e[3]=-n,e[4]=t,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},t.fromMat2d=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},t.fromQuat=function(e,t){var n=t[0],r=t[1],i=t[2],t=t[3],o=n+n,a=r+r,s=i+i,n=n*o,c=r*o,r=r*a,l=i*o,u=i*a,i=i*s,o=t*o,a=t*a,t=t*s;return e[0]=1-r-i,e[3]=c-t,e[6]=l+a,e[1]=c+t,e[4]=1-n-i,e[7]=u-o,e[2]=l-a,e[5]=u+o,e[8]=1-n-r,e},t.normalFromMat4=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],c=t[6],l=t[7],u=t[8],h=t[9],d=t[10],p=t[11],f=t[12],m=t[13],g=t[14],t=t[15],v=n*s-r*a,y=n*c-i*a,_=n*l-o*a,x=r*c-i*s,b=r*l-o*s,w=i*l-o*c,E=u*m-h*f,M=u*g-d*f,u=u*t-p*f,T=h*g-d*m,h=h*t-p*m,d=d*t-p*g,p=v*d-y*h+_*T+x*u-b*M+w*E;return p?(e[0]=(s*d-c*h+l*T)*(p=1/p),e[1]=(c*u-a*d-l*M)*p,e[2]=(a*h-s*u+l*E)*p,e[3]=(i*h-r*d-o*T)*p,e[4]=(n*d-i*u+o*M)*p,e[5]=(r*u-n*h-o*E)*p,e[6]=(m*w-g*b+t*x)*p,e[7]=(g*_-f*w-t*y)*p,e[8]=(f*b-m*_+t*v)*p,e):null},t.projection=function(e,t,n){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/n,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e},t.str=function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))},t.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e},t.subtract=i,t.multiplyScalar=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e},t.multiplyScalarAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},t.equals=function(e,t){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],c=e[6],l=e[7],e=e[8],u=t[0],h=t[1],d=t[2],p=t[3],f=t[4],m=t[5],g=t[6],v=t[7],t=t[8];return Math.abs(n-u)<=y.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(r-h)<=y.EPSILON*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(i-d)<=y.EPSILON*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(o-p)<=y.EPSILON*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(a-f)<=y.EPSILON*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(s-m)<=y.EPSILON*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(c-g)<=y.EPSILON*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(l-v)<=y.EPSILON*Math.max(1,Math.abs(l),Math.abs(v))&&Math.abs(e-t)<=y.EPSILON*Math.max(1,Math.abs(e),Math.abs(t))};var y=(e=>{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t})(n(0));function r(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],c=t[5],l=t[6],u=t[7],t=t[8],h=n[0],d=n[1],p=n[2],f=n[3],m=n[4],g=n[5],v=n[6],y=n[7],n=n[8];return e[0]=h*r+d*a+p*l,e[1]=h*i+d*s+p*u,e[2]=h*o+d*c+p*t,e[3]=f*r+m*a+g*l,e[4]=f*i+m*s+g*u,e[5]=f*o+m*c+g*t,e[6]=v*r+y*a+n*l,e[7]=v*i+y*s+n*u,e[8]=v*o+y*c+n*t,e}function i(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e}t.mul=r,t.sub=i},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=t.sqrLen=t.sqrDist=t.dist=t.div=t.mul=t.sub=t.len=void 0,t.create=r,t.clone=function(e){var t=new i.ARRAY_TYPE(2);return t[0]=e[0],t[1]=e[1],t},t.fromValues=function(e,t){var n=new i.ARRAY_TYPE(2);return n[0]=e,n[1]=t,n},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e},t.set=function(e,t,n){return e[0]=t,e[1]=n,e},t.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e},t.subtract=o,t.multiply=a,t.divide=s,t.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e},t.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e},t.min=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e},t.max=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e},t.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e},t.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e},t.scaleAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e},t.distance=l,t.squaredDistance=u,t.length=h,t.squaredLength=d,t.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e},t.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e},t.normalize=function(e,t){var n=t[0],r=t[1],n=n*n+r*r;return 0<n&&(n=1/Math.sqrt(n),e[0]=t[0]*n,e[1]=t[1]*n),e},t.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},t.cross=function(e,t,n){t=t[0]*n[1]-t[1]*n[0];return e[0]=e[1]=0,e[2]=t,e},t.lerp=function(e,t,n,r){var i=t[0],t=t[1];return e[0]=i+r*(n[0]-i),e[1]=t+r*(n[1]-t),e},t.random=function(e,t){t=t||1;var n=2*i.RANDOM()*Math.PI;return e[0]=Math.cos(n)*t,e[1]=Math.sin(n)*t,e},t.transformMat2=function(e,t,n){var r=t[0],t=t[1];return e[0]=n[0]*r+n[2]*t,e[1]=n[1]*r+n[3]*t,e},t.transformMat2d=function(e,t,n){var r=t[0],t=t[1];return e[0]=n[0]*r+n[2]*t+n[4],e[1]=n[1]*r+n[3]*t+n[5],e},t.transformMat3=function(e,t,n){var r=t[0],t=t[1];return e[0]=n[0]*r+n[3]*t+n[6],e[1]=n[1]*r+n[4]*t+n[7],e},t.transformMat4=function(e,t,n){var r=t[0],t=t[1];return e[0]=n[0]*r+n[4]*t+n[12],e[1]=n[1]*r+n[5]*t+n[13],e},t.rotate=function(e,t,n,r){var i=t[0]-n[0],t=t[1]-n[1],o=Math.sin(r),r=Math.cos(r);return e[0]=i*r-t*o+n[0],e[1]=i*o+t*r+n[1],e},t.angle=function(e,t){var n=e[0],e=e[1],r=t[0],t=t[1],i=n*n+e*e,o=r*r+t*t,n=(n*r+e*t)*(i=0<i?1/Math.sqrt(i):i)*(o=0<o?1/Math.sqrt(o):o);return 1<n?0:n<-1?Math.PI:Math.acos(n)},t.str=function(e){return"vec2("+e[0]+", "+e[1]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]},t.equals=function(e,t){var n=e[0],e=e[1],r=t[0],t=t[1];return Math.abs(n-r)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(r))&&Math.abs(e-t)<=i.EPSILON*Math.max(1,Math.abs(e),Math.abs(t))};var c,i=(e=>{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t})(n(0));function r(){var e=new i.ARRAY_TYPE(2);return i.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0),e}function o(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e}function a(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e}function s(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e}function l(e,t){var n=t[0]-e[0],t=t[1]-e[1];return Math.sqrt(n*n+t*t)}function u(e,t){var n=t[0]-e[0],t=t[1]-e[1];return n*n+t*t}function h(e){var t=e[0],e=e[1];return Math.sqrt(t*t+e*e)}function d(e){var t=e[0],e=e[1];return t*t+e*e}t.len=h,t.sub=o,t.mul=a,t.div=s,t.dist=l,t.sqrDist=u,t.sqrLen=d,t.forEach=(c=r(),function(e,t,n,r,i,o){var a,s=void 0;for(t=t||2,n=n||0,a=r?Math.min(r*t+n,e.length):e.length,s=n;s<a;s+=t)c[0]=e[s],c[1]=e[s+1],i(c,c,o),e[s]=c[0],e[s+1]=c[1];return e})},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.sqrLen=t.squaredLength=t.len=t.length=t.dot=t.mul=t.setReal=t.getReal=void 0,t.create=function(){var e=new g.ARRAY_TYPE(8);return g.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0),e[3]=1,e},t.clone=function(e){var t=new g.ARRAY_TYPE(8);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t},t.fromValues=function(e,t,n,r,i,o,a,s){var c=new g.ARRAY_TYPE(8);return c[0]=e,c[1]=t,c[2]=n,c[3]=r,c[4]=i,c[5]=o,c[6]=a,c[7]=s,c},t.fromRotationTranslationValues=function(e,t,n,r,i,o,a){var s=new g.ARRAY_TYPE(8),i=(s[0]=e,s[1]=t,s[2]=n,s[3]=r,.5*i),o=.5*o,a=.5*a;return s[4]=i*r+o*n-a*t,s[5]=o*r+a*e-i*n,s[6]=a*r+i*t-o*e,s[7]=-i*e-o*t-a*n,s},t.fromRotationTranslation=o,t.fromTranslation=function(e,t){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=.5*t[0],e[5]=.5*t[1],e[6]=.5*t[2],e[7]=0,e},t.fromRotation=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=0,e[5]=0,e[6]=0,e[7]=0,e},t.fromMat4=function(e,t){var n=f.create(),r=(i.getRotation(n,t),new g.ARRAY_TYPE(3));return i.getTranslation(r,t),o(e,n,r),e},t.copy=u,t.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e},t.set=function(e,t,n,r,i,o,a,s,c){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=o,e[5]=a,e[6]=s,e[7]=c,e},t.getDual=function(e,t){return e[0]=t[4],e[1]=t[5],e[2]=t[6],e[3]=t[7],e},t.setDual=function(e,t){return e[4]=t[0],e[5]=t[1],e[6]=t[2],e[7]=t[3],e},t.getTranslation=function(e,t){var n=t[4],r=t[5],i=t[6],o=t[7],a=-t[0],s=-t[1],c=-t[2],t=t[3];return e[0]=2*(n*t+o*a+r*c-i*s),e[1]=2*(r*t+o*s+i*a-n*c),e[2]=2*(i*t+o*c+n*s-r*a),e},t.translate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=.5*n[0],c=.5*n[1],n=.5*n[2],l=t[4],u=t[5],h=t[6],t=t[7];return e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=a*s+i*n-o*c+l,e[5]=a*c+o*s-r*n+u,e[6]=a*n+r*c-i*s+h,e[7]=-r*s-i*c-o*n+t,e},t.rotateX=function(e,t,n){var r=-t[0],i=-t[1],o=-t[2],a=t[3],s=t[4],c=t[5],l=t[6],u=t[7],h=s*a+u*r+c*o-l*i,d=c*a+u*i+l*r-s*o,p=l*a+u*o+s*i-c*r,u=u*a-s*r-c*i-l*o;return f.rotateX(e,t,n),r=e[0],e[4]=h*(a=e[3])+u*r+d*(o=e[2])-p*(i=e[1]),e[5]=d*a+u*i+p*r-h*o,e[6]=p*a+u*o+h*i-d*r,e[7]=u*a-h*r-d*i-p*o,e},t.rotateY=function(e,t,n){var r=-t[0],i=-t[1],o=-t[2],a=t[3],s=t[4],c=t[5],l=t[6],u=t[7],h=s*a+u*r+c*o-l*i,d=c*a+u*i+l*r-s*o,p=l*a+u*o+s*i-c*r,u=u*a-s*r-c*i-l*o;return f.rotateY(e,t,n),r=e[0],e[4]=h*(a=e[3])+u*r+d*(o=e[2])-p*(i=e[1]),e[5]=d*a+u*i+p*r-h*o,e[6]=p*a+u*o+h*i-d*r,e[7]=u*a-h*r-d*i-p*o,e},t.rotateZ=function(e,t,n){var r=-t[0],i=-t[1],o=-t[2],a=t[3],s=t[4],c=t[5],l=t[6],u=t[7],h=s*a+u*r+c*o-l*i,d=c*a+u*i+l*r-s*o,p=l*a+u*o+s*i-c*r,u=u*a-s*r-c*i-l*o;return f.rotateZ(e,t,n),r=e[0],e[4]=h*(a=e[3])+u*r+d*(o=e[2])-p*(i=e[1]),e[5]=d*a+u*i+p*r-h*o,e[6]=p*a+u*o+h*i-d*r,e[7]=u*a-h*r-d*i-p*o,e},t.rotateByQuatAppend=function(e,t,n){var r=n[0],i=n[1],o=n[2],n=n[3],a=t[0],s=t[1],c=t[2],l=t[3];return e[0]=a*n+l*r+s*o-c*i,e[1]=s*n+l*i+c*r-a*o,e[2]=c*n+l*o+a*i-s*r,e[3]=l*n-a*r-s*i-c*o,e[4]=(a=t[4])*n+(l=t[7])*r+(s=t[5])*o-(c=t[6])*i,e[5]=s*n+l*i+c*r-a*o,e[6]=c*n+l*o+a*i-s*r,e[7]=l*n-a*r-s*i-c*o,e},t.rotateByQuatPrepend=function(e,t,n){var r=t[0],i=t[1],o=t[2],t=t[3],a=n[0],s=n[1],c=n[2],l=n[3];return e[0]=r*l+t*a+i*c-o*s,e[1]=i*l+t*s+o*a-r*c,e[2]=o*l+t*c+r*s-i*a,e[3]=t*l-r*a-i*s-o*c,e[4]=r*(l=n[7])+t*(a=n[4])+i*(c=n[6])-o*(s=n[5]),e[5]=i*l+t*s+o*a-r*c,e[6]=o*l+t*c+r*s-i*a,e[7]=t*l-r*a-i*s-o*c,e},t.rotateAroundAxis=function(e,t,n,r){var i,o,a,s,c,l;return Math.abs(r)<g.EPSILON?u(e,t):(l=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]),r*=.5,i=(a=Math.sin(r))*n[0]/l,o=a*n[1]/l,a=a*n[2]/l,n=Math.cos(r),l=t[0],e[0]=l*n+(r=t[3])*i+(s=t[1])*a-(c=t[2])*o,e[1]=s*n+r*o+c*i-l*a,e[2]=c*n+r*a+l*o-s*i,e[3]=r*n-l*i-s*o-c*a,e[4]=(r=t[4])*n+(l=t[7])*i+(s=t[5])*a-(c=t[6])*o,e[5]=s*n+l*o+c*i-r*a,e[6]=c*n+l*a+r*o-s*i,e[7]=l*n-r*i-s*o-c*a,e)},t.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e},t.multiply=a,t.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e},t.lerp=function(e,t,n,r){var i=1-r;return s(t,n)<0&&(r=-r),e[0]=t[0]*i+n[0]*r,e[1]=t[1]*i+n[1]*r,e[2]=t[2]*i+n[2]*r,e[3]=t[3]*i+n[3]*r,e[4]=t[4]*i+n[4]*r,e[5]=t[5]*i+n[5]*r,e[6]=t[6]*i+n[6]*r,e[7]=t[7]*i+n[7]*r,e},t.invert=function(e,t){var n=h(t);return e[0]=-t[0]/n,e[1]=-t[1]/n,e[2]=-t[2]/n,e[3]=t[3]/n,e[4]=-t[4]/n,e[5]=-t[5]/n,e[6]=-t[6]/n,e[7]=t[7]/n,e},t.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e[4]=-t[4],e[5]=-t[5],e[6]=-t[6],e[7]=t[7],e},t.normalize=function(e,t){var n,r,i,o,a,s,c,l,u=h(t);return 0<u&&(u=Math.sqrt(u),l=(n=t[0]/u)*(a=t[4])+(r=t[1]/u)*(s=t[5])+(i=t[2]/u)*(c=t[6])+(o=t[3]/u)*(t=t[7]),e[0]=n,e[1]=r,e[2]=i,e[3]=o,e[4]=(a-n*l)/u,e[5]=(s-r*l)/u,e[6]=(c-i*l)/u,e[7]=(t-o*l)/u),e},t.str=function(e){return"quat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]},t.equals=function(e,t){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],c=e[6],e=e[7],l=t[0],u=t[1],h=t[2],d=t[3],p=t[4],f=t[5],m=t[6],t=t[7];return Math.abs(n-l)<=g.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(r-u)<=g.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(i-h)<=g.EPSILON*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(o-d)<=g.EPSILON*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(a-p)<=g.EPSILON*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(s-f)<=g.EPSILON*Math.max(1,Math.abs(s),Math.abs(f))&&Math.abs(c-m)<=g.EPSILON*Math.max(1,Math.abs(c),Math.abs(m))&&Math.abs(e-t)<=g.EPSILON*Math.max(1,Math.abs(e),Math.abs(t))};var g=r(n(0)),f=r(n(3)),i=r(n(4));function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e,t,n){var r=.5*n[0],i=.5*n[1],n=.5*n[2],o=t[0],a=t[1],s=t[2],t=t[3];return e[0]=o,e[1]=a,e[2]=s,e[3]=t,e[4]=r*t+i*s-n*a,e[5]=i*t+n*o-r*s,e[6]=n*t+r*a-i*o,e[7]=-r*o-i*a-n*s,e}function u(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function a(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=n[4],c=n[5],l=n[6],u=n[7],h=t[4],d=t[5],p=t[6],t=t[7],f=n[0],m=n[1],g=n[2],n=n[3];return e[0]=r*n+a*f+i*g-o*m,e[1]=i*n+a*m+o*f-r*g,e[2]=o*n+a*g+r*m-i*f,e[3]=a*n-r*f-i*m-o*g,e[4]=r*u+a*s+i*l-o*c+h*n+t*f+d*g-p*m,e[5]=i*u+a*c+o*s-r*l+d*n+t*m+p*f-h*g,e[6]=o*u+a*l+r*c-i*s+p*n+t*g+h*m-d*f,e[7]=a*u-r*s-i*c-o*l+t*n-h*f-d*m-p*g,e}t.getReal=f.copy,t.setReal=f.copy,t.mul=a;var s=t.dot=f.dot,n=t.length=f.length,h=(t.len=n,t.squaredLength=f.squaredLength);t.sqrLen=h},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=function(){var e=new d.ARRAY_TYPE(6);return d.ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0,e[4]=0,e[5]=0),e[0]=1,e[3]=1,e},t.clone=function(e){var t=new d.ARRAY_TYPE(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},t.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},t.fromValues=function(e,t,n,r,i,o){var a=new d.ARRAY_TYPE(6);return a[0]=e,a[1]=t,a[2]=n,a[3]=r,a[4]=i,a[5]=o,a},t.set=function(e,t,n,r,i,o,a){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=o,e[5]=a,e},t.invert=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],t=t[5],s=n*o-r*i;return s?(e[0]=o*(s=1/s),e[1]=-r*s,e[2]=-i*s,e[3]=n*s,e[4]=(i*t-o*a)*s,e[5]=(r*a-n*t)*s,e):null},t.determinant=function(e){return e[0]*e[3]-e[1]*e[2]},t.multiply=r,t.rotate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],t=t[5],c=Math.sin(n),n=Math.cos(n);return e[0]=r*n+o*c,e[1]=i*n+a*c,e[2]=r*-c+o*n,e[3]=i*-c+a*n,e[4]=s,e[5]=t,e},t.scale=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],t=t[5],c=n[0],n=n[1];return e[0]=r*c,e[1]=i*c,e[2]=o*n,e[3]=a*n,e[4]=s,e[5]=t,e},t.translate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],t=t[5],c=n[0],n=n[1];return e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=r*c+o*n+s,e[5]=i*c+a*n+t,e},t.fromRotation=function(e,t){var n=Math.sin(t),t=Math.cos(t);return e[0]=t,e[1]=n,e[2]=-n,e[3]=t,e[4]=0,e[5]=0,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e},t.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e},t.str=function(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+1)},t.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e},t.subtract=i,t.multiplyScalar=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e},t.multiplyScalarAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]},t.equals=function(e,t){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],e=e[5],s=t[0],c=t[1],l=t[2],u=t[3],h=t[4],t=t[5];return Math.abs(n-s)<=d.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-c)<=d.EPSILON*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(i-l)<=d.EPSILON*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(o-u)<=d.EPSILON*Math.max(1,Math.abs(o),Math.abs(u))&&Math.abs(a-h)<=d.EPSILON*Math.max(1,Math.abs(a),Math.abs(h))&&Math.abs(e-t)<=d.EPSILON*Math.max(1,Math.abs(e),Math.abs(t))};var d=(e=>{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t})(n(0));function r(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],t=t[5],c=n[0],l=n[1],u=n[2],h=n[3],d=n[4],n=n[5];return e[0]=r*c+o*l,e[1]=i*c+a*l,e[2]=r*u+o*h,e[3]=i*u+a*h,e[4]=r*d+o*n+s,e[5]=i*d+a*n+t,e}function i(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e}t.mul=r,t.sub=i},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=function(){var e=new c.ARRAY_TYPE(4);return c.ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},t.clone=function(e){var t=new c.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},t.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},t.fromValues=function(e,t,n,r){var i=new c.ARRAY_TYPE(4);return i[0]=e,i[1]=t,i[2]=n,i[3]=r,i},t.set=function(e,t,n,r,i){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e},t.transpose=function(e,t){var n;return e===t?(n=t[1],e[1]=t[2],e[2]=n):(e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3]),e},t.invert=function(e,t){var n=t[0],r=t[1],i=t[2],t=t[3],o=n*t-i*r;return o?(e[0]=t*(o=1/o),e[1]=-r*o,e[2]=-i*o,e[3]=n*o,e):null},t.adjoint=function(e,t){var n=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=n,e},t.determinant=function(e){return e[0]*e[3]-e[2]*e[1]},t.multiply=r,t.rotate=function(e,t,n){var r=t[0],i=t[1],o=t[2],t=t[3],a=Math.sin(n),n=Math.cos(n);return e[0]=r*n+o*a,e[1]=i*n+t*a,e[2]=r*-a+o*n,e[3]=i*-a+t*n,e},t.scale=function(e,t,n){var r=t[0],i=t[1],o=t[2],t=t[3],a=n[0],n=n[1];return e[0]=r*a,e[1]=i*a,e[2]=o*n,e[3]=t*n,e},t.fromRotation=function(e,t){var n=Math.sin(t),t=Math.cos(t);return e[0]=t,e[1]=n,e[2]=-n,e[3]=t,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e},t.str=function(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2))},t.LDU=function(e,t,n,r){return e[2]=r[2]/r[0],n[0]=r[0],n[1]=r[1],n[3]=r[3]-e[2]*n[1],[e,t,n]},t.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e},t.subtract=i,t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},t.equals=function(e,t){var n=e[0],r=e[1],i=e[2],e=e[3],o=t[0],a=t[1],s=t[2],t=t[3];return Math.abs(n-o)<=c.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-a)<=c.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-s)<=c.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(e-t)<=c.EPSILON*Math.max(1,Math.abs(e),Math.abs(t))},t.multiplyScalar=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e},t.multiplyScalarAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e};var c=(e=>{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t})(n(0));function r(e,t,n){var r=t[0],i=t[1],o=t[2],t=t[3],a=n[0],s=n[1],c=n[2],n=n[3];return e[0]=r*a+o*s,e[1]=i*a+t*s,e[2]=r*c+o*n,e[3]=i*c+t*n,e}function i(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e}t.mul=r,t.sub=i},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.vec4=t.vec3=t.vec2=t.quat2=t.quat=t.mat4=t.mat3=t.mat2d=t.mat2=t.glMatrix=void 0;var r=d(n(0)),i=d(n(9)),o=d(n(8)),a=d(n(5)),s=d(n(4)),c=d(n(3)),l=d(n(7)),u=d(n(6)),h=d(n(2)),n=d(n(1));function d(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}t.glMatrix=r,t.mat2=i,t.mat2d=o,t.mat3=a,t.mat4=s,t.quat=c,t.quat2=l,t.vec2=u,t.vec3=h,t.vec4=n}],r={},i.m=n,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=10);function i(e){var t;return(r[e]||(t=r[e]={i:e,l:!1,exports:{}},n[e].call(t.exports,t,t.exports,i),t.l=!0,t)).exports}var n,r}var i="undefined"!=typeof self?self:this;if("object"==typeof n&&"object"==typeof t)t.exports=r();else if("function"==typeof define&&define.amd)define([],r);else{var o,a=r();for(o in a)("object"==typeof n?n:i)[o]=a[o]}},{}],357:[function(e,t,n){t.exports=function(e){"string"==typeof e&&(e=[e]);for(var t=[].slice.call(arguments,1),n=[],r=0;r<e.length-1;r++)n.push(e[r],t[r]||"");return n.push(e[r]),n.join("")}},{}],358:[function(e,t,n){var i=e("./cross"),o=e("./normalize");t.exports=function(e,t,n){var r=[0,0,0];return i(r,e,t,n),o(r,r),r}},{"./cross":359,"./normalize":362}],359:[function(e,t,n){t.exports=function(e,t,n,r){var i=n[0]-t[0],o=n[1]-t[1],n=n[2]-t[2],a=r[0]-t[0],s=r[1]-t[1],r=r[2]-t[2];return e[0]=o*r-n*s,e[1]=n*a-i*r,e[2]=i*s-o*a,e}},{}],360:[function(e,t,n){var p=e("guf").normalizeArray,f=e("./calculate-normal");t.exports=function(e,t){for(var n,r,i,o=e,a=e[0].constructor,s=(a!==Array&&a!=Float32Array||(o=p(e)),t[0].constructor===Array?p(t):t),c=[],l=[],u=[],h=[],d=0;d<s.length;d+=3)i=3*s[d],n=3*s[d+1],r=3*s[d+2],l[0]=o[i],l[1]=o[1+i],l[2]=o[2+i],u[0]=o[n],u[1]=o[1+n],u[2]=o[2+n],h[0]=o[r],h[1]=o[1+r],h[2]=o[2+r],i=f(l,u,h),c[d]=i[0],c[d+1]=i[1],c[d+2]=i[2];return c}},{"./calculate-normal":358,guf:364}],361:[function(e,t,n){t.exports=function(e){for(var t=[],n=e.length,r=e[0].length,i=r<3,o=0;o<n;o++){for(var a=0;a<r;a++)t.push(e[o][a]);i&&t.push(0)}return t}},{}],362:[function(e,t,n){t.exports=function(e,t){var n=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);return e[0]=t[0]/n,e[1]=t[1]/n,e[2]=t[2]/n,e}},{}],363:[function(e,t,n){var w=e("./cross"),E=e("./normalize"),M=e("./normalize-array");t.exports=function(e,t){for(var n=e[0].constructor===Array?M(e):e,r=t[0].constructor===Array?M(t):t,i={},o=n.length/3,a=0;a<o;a++)i[a]=[];for(var s,c,l=r.length,a=0;a<l;a+=3)s=(y=a)+1,c=y+2,i[r[y]].push(a),i[r[s]].push(a),i[r[c]].push(a);for(var u=[],h=[0,0,0],d=[0,0,0],p=Object.keys(i),f=[0,0,0],m=[0,0,0],g=[0,0,0],a=0;a<p.length;a++){for(var t=i[p[a]],v=0;v<t.length;v++){var y,_=r[y=t[v]],x=r[y+1],b=r[y+2];f[0]=n[3*_],f[1]=n[3*_+1],f[2]=n[3*_+2],m[0]=n[3*x],m[1]=n[3*x+1],m[2]=n[3*x+2],g[0]=n[3*b],g[1]=n[3*b+1],g[2]=n[3*b+2],w(h,f,m,g),d[0]+=h[0],d[1]+=h[1],d[2]+=h[2]}E(d,d),u.push(d[0],d[1],d[2]),d[0]=0,d[1]=0,d[2]=0}return u}},{"./cross":359,"./normalize":362,"./normalize-array":361}],364:[function(e,t,n){n.normalizeArray=e("./guf/normalize-array"),n.faceNormals=e("./guf/face-normals"),n.vertexNormals=e("./guf/vertex-normals"),n.calculateNormal=e("./guf/calculate-normal"),n.cross=e("./guf/cross"),n.normalize=e("./guf/normalize")},{"./guf/calculate-normal":358,"./guf/cross":359,"./guf/face-normals":360,"./guf/normalize":362,"./guf/normalize-array":361,"./guf/vertex-normals":363}],365:[function(e,t,f){!function(p){!function(){function e(){this.init()}function t(e){e.src&&0!==e.src.length?this.init(e):console.error("An array of source files must be passed with any new Howl.")}var y,o,a,s,c,l,u,h,n,r,i,d;e.prototype={init:function(){var e=this||y;return e._counter=1e3,e._html5AudioPool=[],e.html5PoolSize=10,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.autoUnlock=!0,e._setup(),e},volume:function(e){var t=this||y;if(e=parseFloat(e),t.ctx||h(),void 0!==e&&0<=e&&e<=1){if(t._volume=e,!t._muted){t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e,y.ctx.currentTime);for(var n=0;n<t._howls.length;n++)if(!t._howls[n]._webAudio)for(var r=t._howls[n]._getSoundIds(),i=0;i<r.length;i++){var o=t._howls[n]._soundById(r[i]);o&&o._node&&(o._node.volume=o._volume*e)}}return t}return t._volume},mute:function(e){var t=this||y;t.ctx||h(),t._muted=e,t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e?0:t._volume,y.ctx.currentTime);for(var n=0;n<t._howls.length;n++)if(!t._howls[n]._webAudio)for(var r=t._howls[n]._getSoundIds(),i=0;i<r.length;i++){var o=t._howls[n]._soundById(r[i]);o&&o._node&&(o._node.muted=!!e||o._muted)}return t},stop:function(){for(var e=this||y,t=0;t<e._howls.length;t++)e._howls[t].stop();return e},unload:function(){for(var e=this||y,t=e._howls.length-1;0<=t;t--)e._howls[t].unload();return e.usingWebAudio&&e.ctx&&void 0!==e.ctx.close&&(e.ctx.close(),e.ctx=null,h()),e},codecs:function(e){return(this||y)._codecs[e.replace(/^x-/,"")]},_setup:function(){var t=this||y;if(t.state=t.ctx&&t.ctx.state||"suspended",t._autoSuspend(),!t.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(t._canPlayEvent="canplay")}catch(e){t.noAudio=!0}else t.noAudio=!0;try{(new Audio).muted&&(t.noAudio=!0)}catch(e){}return t.noAudio||t._setupCodecs(),t},_setupCodecs:function(){var e,t,n,r,i=this||y,o=null;try{o="undefined"!=typeof Audio?new Audio:null}catch(e){return i}return o&&"function"==typeof o.canPlayType&&(e=o.canPlayType("audio/mpeg;").replace(/^no$/,""),t=(t=(n=i._navigator?i._navigator.userAgent:"").match(/OPR\/(\d+)/g))&&parseInt(t[0].split("/")[1],10)<33,r=-1!==n.indexOf("Safari")&&-1===n.indexOf("Chrome"),n=n.match(/Version\/(.*?) /),r=r&&n&&parseInt(n[1],10)<15,i._codecs={mp3:!(t||!e&&!o.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!e,opus:!!o.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!o.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!o.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(o.canPlayType('audio/wav; codecs="1"')||o.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!o.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!o.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(o.canPlayType("audio/x-m4a;")||o.canPlayType("audio/m4a;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(o.canPlayType("audio/x-m4b;")||o.canPlayType("audio/m4b;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(o.canPlayType("audio/x-mp4;")||o.canPlayType("audio/mp4;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!(r||!o.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!(r||!o.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!o.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(o.canPlayType("audio/x-flac;")||o.canPlayType("audio/flac;")).replace(/^no$/,"")}),i},_unlockAudio:function(){var s,c=this||y;if(!c._audioUnlocked&&c.ctx)return c._audioUnlocked=!1,c.autoUnlock=!1,c._mobileUnloaded||44100===c.ctx.sampleRate||(c._mobileUnloaded=!0,c.unload()),c._scratchBuffer=c.ctx.createBuffer(1,1,22050),s=function(e){for(;c._html5AudioPool.length<c.html5PoolSize;)try{var t=new Audio;t._unlocked=!0,c._releaseHtml5Audio(t)}catch(e){c.noAudio=!0;break}for(var n=0;n<c._howls.length;n++)if(!c._howls[n]._webAudio)for(var r=c._howls[n]._getSoundIds(),i=0;i<r.length;i++){var o=c._howls[n]._soundById(r[i]);o&&o._node&&!o._node._unlocked&&(o._node._unlocked=!0,o._node.load())}c._autoResume();var a=c.ctx.createBufferSource();a.buffer=c._scratchBuffer,a.connect(c.ctx.destination),void 0===a.start?a.noteOn(0):a.start(0),"function"==typeof c.ctx.resume&&c.ctx.resume(),a.onended=function(){a.disconnect(0),c._audioUnlocked=!0,document.removeEventListener("touchstart",s,!0),document.removeEventListener("touchend",s,!0),document.removeEventListener("click",s,!0),document.removeEventListener("keydown",s,!0);for(var e=0;e<c._howls.length;e++)c._howls[e]._emit("unlock")}},document.addEventListener("touchstart",s,!0),document.addEventListener("touchend",s,!0),document.addEventListener("click",s,!0),document.addEventListener("keydown",s,!0),c},_obtainHtml5Audio:function(){var e=this||y;return e._html5AudioPool.length?e._html5AudioPool.pop():((e=(new Audio).play())&&"undefined"!=typeof Promise&&(e instanceof Promise||"function"==typeof e.then)&&e.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio)},_releaseHtml5Audio:function(e){var t=this||y;return e._unlocked&&t._html5AudioPool.push(e),t},_autoSuspend:function(){var t=this;if(t.autoSuspend&&t.ctx&&void 0!==t.ctx.suspend&&y.usingWebAudio){for(var e=0;e<t._howls.length;e++)if(t._howls[e]._webAudio)for(var n=0;n<t._howls[e]._sounds.length;n++)if(!t._howls[e]._sounds[n]._paused)return t;return t._suspendTimer&&clearTimeout(t._suspendTimer),t._suspendTimer=setTimeout(function(){var e;t.autoSuspend&&(t._suspendTimer=null,t.state="suspending",e=function(){t.state="suspended",t._resumeAfterSuspend&&(delete t._resumeAfterSuspend,t._autoResume())},t.ctx.suspend().then(e,e))},3e4),t}},_autoResume:function(){var t=this;if(t.ctx&&void 0!==t.ctx.resume&&y.usingWebAudio)return"running"===t.state&&"interrupted"!==t.ctx.state&&t._suspendTimer?(clearTimeout(t._suspendTimer),t._suspendTimer=null):"suspended"===t.state||"running"===t.state&&"interrupted"===t.ctx.state?(t.ctx.resume().then(function(){t.state="running";for(var e=0;e<t._howls.length;e++)t._howls[e]._emit("resume")}),t._suspendTimer&&(clearTimeout(t._suspendTimer),t._suspendTimer=null)):"suspending"===t.state&&(t._resumeAfterSuspend=!0),t}},y=new e,t.prototype={init:function(e){var t=this;return y.ctx||h(),t._autoplay=e.autoplay||!1,t._format="string"!=typeof e.format?e.format:[e.format],t._html5=e.html5||!1,t._muted=e.mute||!1,t._loop=e.loop||!1,t._pool=e.pool||5,t._preload="boolean"!=typeof e.preload&&"metadata"!==e.preload||e.preload,t._rate=e.rate||1,t._sprite=e.sprite||{},t._src="string"!=typeof e.src?e.src:[e.src],t._volume=void 0!==e.volume?e.volume:1,t._xhr={method:e.xhr&&e.xhr.method?e.xhr.method:"GET",headers:e.xhr&&e.xhr.headers?e.xhr.headers:null,withCredentials:!(!e.xhr||!e.xhr.withCredentials)&&e.xhr.withCredentials},t._duration=0,t._state="unloaded",t._sounds=[],t._endTimers={},t._queue=[],t._playLock=!1,t._onend=e.onend?[{fn:e.onend}]:[],t._onfade=e.onfade?[{fn:e.onfade}]:[],t._onload=e.onload?[{fn:e.onload}]:[],t._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],t._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],t._onpause=e.onpause?[{fn:e.onpause}]:[],t._onplay=e.onplay?[{fn:e.onplay}]:[],t._onstop=e.onstop?[{fn:e.onstop}]:[],t._onmute=e.onmute?[{fn:e.onmute}]:[],t._onvolume=e.onvolume?[{fn:e.onvolume}]:[],t._onrate=e.onrate?[{fn:e.onrate}]:[],t._onseek=e.onseek?[{fn:e.onseek}]:[],t._onunlock=e.onunlock?[{fn:e.onunlock}]:[],t._onresume=[],t._webAudio=y.usingWebAudio&&!t._html5,void 0!==y.ctx&&y.ctx&&y.autoUnlock&&y._unlockAudio(),y._howls.push(t),t._autoplay&&t._queue.push({event:"play",action:function(){t.play()}}),t._preload&&"none"!==t._preload&&t.load(),t},load:function(){var e=this,t=null;if(y.noAudio)e._emit("loaderror",null,"No audio support.");else{"string"==typeof e._src&&(e._src=[e._src]);for(var n,r,i=0;i<e._src.length;i++){if(e._format&&e._format[i])n=e._format[i];else{if("string"!=typeof(r=e._src[i])){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}n=(n=(n=/^data:audio\/([^;,]+);/i.exec(r))||/\.([^.]+)$/.exec(r.split("?",1)[0]))&&n[1].toLowerCase()}if(n||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),n&&y.codecs(n)){t=e._src[i];break}}if(t)return e._src=t,e._state="loading","https:"===window.location.protocol&&"http:"===t.slice(0,5)&&(e._html5=!0,e._webAudio=!1),new o(e),e._webAudio&&s(e),e;e._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(t,n){var r=this,e=null;if("number"==typeof t)e=t,t=null;else{if("string"==typeof t&&"loaded"===r._state&&!r._sprite[t])return null;if(void 0===t&&(t="__default",!r._playLock)){for(var i=0,o=0;o<r._sounds.length;o++)r._sounds[o]._paused&&!r._sounds[o]._ended&&(i++,e=r._sounds[o]._id);1===i?t=null:e=null}}var a,s=e?r._soundById(e):r._inactiveSound();if(!s)return null;if(e&&!t&&(t=s._sprite||"__default"),"loaded"!==r._state)return s._sprite=t,s._ended=!1,a=s._id,r._queue.push({event:"play",action:function(){r.play(a)}}),a;if(e&&!s._paused)return n||r._loadQueue("play"),s._id;r._webAudio&&y._autoResume();var c,l,u,h,d=Math.max(0,0<s._seek?s._seek:r._sprite[t][0]/1e3),p=Math.max(0,(r._sprite[t][0]+r._sprite[t][1])/1e3-d),f=1e3*p/Math.abs(s._rate),m=r._sprite[t][0]/1e3,g=(r._sprite[t][0]+r._sprite[t][1])/1e3,v=(s._sprite=t,s._ended=!1,function(){s._paused=!1,s._seek=d,s._start=m,s._stop=g,s._loop=!(!s._loop&&!r._sprite[t][2])});if(!(g<=d))return c=s._node,r._webAudio?(u=function(){r._playLock=!1,v(),r._refreshBuffer(s);var e=s._muted||r._muted?0:s._volume;c.gain.setValueAtTime(e,y.ctx.currentTime),s._playStart=y.ctx.currentTime,void 0===c.bufferSource.start?s._loop?c.bufferSource.noteGrainOn(0,d,86400):c.bufferSource.noteGrainOn(0,d,p):s._loop?c.bufferSource.start(0,d,86400):c.bufferSource.start(0,d,p),f!==1/0&&(r._endTimers[s._id]=setTimeout(r._ended.bind(r,s),f)),n||setTimeout(function(){r._emit("play",s._id),r._loadQueue()},0)},"running"===y.state&&"interrupted"!==y.ctx.state?u():(r._playLock=!0,r.once("resume",u),r._clearTimer(s._id))):(l=function(){c.currentTime=d,c.muted=s._muted||r._muted||y._muted||c.muted,c.volume=s._volume*y.volume(),c.playbackRate=s._rate;try{var e=c.play();e&&"undefined"!=typeof Promise&&(e instanceof Promise||"function"==typeof e.then)?(r._playLock=!0,v(),e.then(function(){r._playLock=!1,c._unlocked=!0,n?r._loadQueue():r._emit("play",s._id)}).catch(function(){r._playLock=!1,r._emit("playerror",s._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),s._ended=!0,s._paused=!0})):n||(r._playLock=!1,v(),r._emit("play",s._id)),c.playbackRate=s._rate,c.paused?r._emit("playerror",s._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."):"__default"!==t||s._loop?r._endTimers[s._id]=setTimeout(r._ended.bind(r,s),f):(r._endTimers[s._id]=function(){r._ended(s),c.removeEventListener("ended",r._endTimers[s._id],!1)},c.addEventListener("ended",r._endTimers[s._id],!1))}catch(e){r._emit("playerror",s._id,e)}},"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===c.src&&(c.src=r._src,c.load()),u=window&&window.ejecta||!c.readyState&&y._navigator.isCocoonJS,3<=c.readyState||u?l():(r._playLock=!0,r._state="loading",h=function(){r._state="loaded",l(),c.removeEventListener(y._canPlayEvent,h,!1)},c.addEventListener(y._canPlayEvent,h,!1),r._clearTimer(s._id))),s._id;r._ended(s)},pause:function(e){var t=this;if("loaded"!==t._state||t._playLock)t._queue.push({event:"pause",action:function(){t.pause(e)}});else for(var n=t._getSoundIds(e),r=0;r<n.length;r++){t._clearTimer(n[r]);var i=t._soundById(n[r]);if(i&&!i._paused&&(i._seek=t.seek(n[r]),i._rateSeek=0,i._paused=!0,t._stopFade(n[r]),i._node))if(t._webAudio){if(!i._node.bufferSource)continue;void 0===i._node.bufferSource.stop?i._node.bufferSource.noteOff(0):i._node.bufferSource.stop(0),t._cleanBuffer(i._node)}else isNaN(i._node.duration)&&i._node.duration!==1/0||i._node.pause();arguments[1]||t._emit("pause",i?i._id:null)}return t},stop:function(e,t){var n=this;if("loaded"!==n._state||n._playLock)n._queue.push({event:"stop",action:function(){n.stop(e)}});else for(var r=n._getSoundIds(e),i=0;i<r.length;i++){n._clearTimer(r[i]);var o=n._soundById(r[i]);o&&(o._seek=o._start||0,o._rateSeek=0,o._paused=!0,o._ended=!0,n._stopFade(r[i]),o._node&&(n._webAudio?o._node.bufferSource&&(void 0===o._node.bufferSource.stop?o._node.bufferSource.noteOff(0):o._node.bufferSource.stop(0),n._cleanBuffer(o._node)):isNaN(o._node.duration)&&o._node.duration!==1/0||(o._node.currentTime=o._start||0,o._node.pause(),o._node.duration===1/0&&n._clearSound(o._node))),t||n._emit("stop",o._id))}return n},mute:function(e,t){var n=this;if("loaded"!==n._state||n._playLock)n._queue.push({event:"mute",action:function(){n.mute(e,t)}});else{if(void 0===t){if("boolean"!=typeof e)return n._muted;n._muted=e}for(var r=n._getSoundIds(t),i=0;i<r.length;i++){var o=n._soundById(r[i]);o&&(o._muted=e,o._interval&&n._stopFade(o._id),n._webAudio&&o._node?o._node.gain.setValueAtTime(e?0:o._volume,y.ctx.currentTime):o._node&&(o._node.muted=!!y._muted||e),n._emit("mute",o._id))}}return n},volume:function(){var e,t,n=this,r=arguments;if(0===r.length)return n._volume;if(1===r.length||2===r.length&&void 0===r[1]?0<=n._getSoundIds().indexOf(r[0])?i=parseInt(r[0],10):e=parseFloat(r[0]):2<=r.length&&(e=parseFloat(r[0]),i=parseInt(r[1],10)),!(void 0!==e&&0<=e&&e<=1))return(t=i?n._soundById(i):n._sounds[0])?t._volume:0;if("loaded"!==n._state||n._playLock)n._queue.push({event:"volume",action:function(){n.volume.apply(n,r)}});else{void 0===i&&(n._volume=e);for(var i=n._getSoundIds(i),o=0;o<i.length;o++)(t=n._soundById(i[o]))&&(t._volume=e,r[2]||n._stopFade(i[o]),n._webAudio&&t._node&&!t._muted?t._node.gain.setValueAtTime(e,y.ctx.currentTime):t._node&&!t._muted&&(t._node.volume=e*y.volume()),n._emit("volume",t._id))}return n},fade:function(e,t,n,r){var i=this;if("loaded"!==i._state||i._playLock)i._queue.push({event:"fade",action:function(){i.fade(e,t,n,r)}});else{e=Math.min(Math.max(0,parseFloat(e)),1),t=Math.min(Math.max(0,parseFloat(t)),1),n=parseFloat(n),i.volume(e,r);for(var o=i._getSoundIds(r),a=0;a<o.length;a++){var s,c,l=i._soundById(o[a]);l&&(r||i._stopFade(o[a]),i._webAudio&&!l._muted&&(c=(s=y.ctx.currentTime)+n/1e3,l._volume=e,l._node.gain.setValueAtTime(e,s),l._node.gain.linearRampToValueAtTime(t,c)),i._startFadeInterval(l,e,t,n,o[a],void 0===r))}}return i},_startFadeInterval:function(t,n,r,i,e,o){var a=this,s=n,c=r-n,l=Math.abs(c/.01),l=Math.max(4,0<l?i/l:i),u=Date.now();t._fadeTo=r,t._interval=setInterval(function(){var e=(Date.now()-u)/i;u=Date.now(),s+=c*e,s=Math.round(100*s)/100,s=c<0?Math.max(r,s):Math.min(r,s),a._webAudio?t._volume=s:a.volume(s,t._id,!0),o&&(a._volume=s),(r<n&&s<=r||n<r&&r<=s)&&(clearInterval(t._interval),t._interval=null,t._fadeTo=null,a.volume(r,t._id),a._emit("fade",t._id))},l)},_stopFade:function(e){var t=this._soundById(e);return t&&t._interval&&(this._webAudio&&t._node.gain.cancelScheduledValues(y.ctx.currentTime),clearInterval(t._interval),t._interval=null,this.volume(t._fadeTo,e),t._fadeTo=null,this._emit("fade",e)),this},loop:function(){var e,t,n,r=this,i=arguments;if(0===i.length)return r._loop;if(1===i.length){if("boolean"!=typeof i[0])return!!(n=r._soundById(parseInt(i[0],10)))&&n._loop;r._loop=e=i[0]}else 2===i.length&&(e=i[0],t=parseInt(i[1],10));for(var o=r._getSoundIds(t),a=0;a<o.length;a++)(n=r._soundById(o[a]))&&(n._loop=e,r._webAudio)&&n._node&&n._node.bufferSource&&(n._node.bufferSource.loop=e)&&(n._node.bufferSource.loopStart=n._start||0,n._node.bufferSource.loopEnd=n._stop,r.playing(o[a]))&&(r.pause(o[a],!0),r.play(o[a],!0));return r},rate:function(){var e,t=this,n=arguments;if(0===n.length?o=t._sounds[0]._id:1===n.length?0<=t._getSoundIds().indexOf(n[0])?o=parseInt(n[0],10):e=parseFloat(n[0]):2===n.length&&(e=parseFloat(n[0]),o=parseInt(n[1],10)),"number"!=typeof e)return((i=t._soundById(o))||t)._rate;if("loaded"!==t._state||t._playLock)t._queue.push({event:"rate",action:function(){t.rate.apply(t,n)}});else{void 0===o&&(t._rate=e);for(var r,i,o=t._getSoundIds(o),a=0;a<o.length;a++)(i=t._soundById(o[a]))&&(t.playing(o[a])&&(i._rateSeek=t.seek(o[a]),i._playStart=t._webAudio?y.ctx.currentTime:i._playStart),i._rate=e,t._webAudio&&i._node&&i._node.bufferSource?i._node.bufferSource.playbackRate.setValueAtTime(e,y.ctx.currentTime):i._node&&(i._node.playbackRate=e),r=t.seek(o[a]),r=1e3*((t._sprite[i._sprite][0]+t._sprite[i._sprite][1])/1e3-r)/Math.abs(i._rate),!t._endTimers[o[a]]&&i._paused||(t._clearTimer(o[a]),t._endTimers[o[a]]=setTimeout(t._ended.bind(t,i),r)),t._emit("rate",i._id))}return t},seek:function(){var e,t,n=this,r=arguments;if(0===r.length?n._sounds.length&&(t=n._sounds[0]._id):1===r.length?0<=n._getSoundIds().indexOf(r[0])?t=parseInt(r[0],10):n._sounds.length&&(t=n._sounds[0]._id,e=parseFloat(r[0])):2===r.length&&(e=parseFloat(r[0]),t=parseInt(r[1],10)),void 0===t)return 0;if("number"!=typeof e||"loaded"===n._state&&!n._playLock){var i,o,a,s,c,l=n._soundById(t);if(l){if(!("number"==typeof e&&0<=e))return n._webAudio?(s=n.playing(t)?y.ctx.currentTime-l._playStart:0,c=l._rateSeek?l._rateSeek-l._seek:0,l._seek+(c+s*Math.abs(l._rate))):l._node.currentTime;(i=n.playing(t))&&n.pause(t,!0),l._seek=e,l._ended=!1,n._clearTimer(t),n._webAudio||!l._node||isNaN(l._node.duration)||(l._node.currentTime=e),o=function(){i&&n.play(t,!0),n._emit("seek",t)},i&&!n._webAudio?(a=function(){n._playLock?setTimeout(a,0):o()},setTimeout(a,0)):o()}}else n._queue.push({event:"seek",action:function(){n.seek.apply(n,r)}});return n},playing:function(e){if("number"==typeof e)return!!(e=this._soundById(e))&&!e._paused;for(var t=0;t<this._sounds.length;t++)if(!this._sounds[t]._paused)return!0;return!1},duration:function(e){var t=this._duration,e=this._soundById(e);return t=e?this._sprite[e._sprite][1]/1e3:t},state:function(){return this._state},unload:function(){for(var e=this,t=e._sounds,n=0;n<t.length;n++)t[n]._paused||e.stop(t[n]._id),e._webAudio||(e._clearSound(t[n]._node),t[n]._node.removeEventListener("error",t[n]._errorFn,!1),t[n]._node.removeEventListener(y._canPlayEvent,t[n]._loadFn,!1),t[n]._node.removeEventListener("ended",t[n]._endFn,!1),y._releaseHtml5Audio(t[n]._node)),delete t[n]._node,e._clearTimer(t[n]._id);for(var r=y._howls.indexOf(e),i=(0<=r&&y._howls.splice(r,1),!0),n=0;n<y._howls.length;n++)if(y._howls[n]._src===e._src||0<=e._src.indexOf(y._howls[n]._src)){i=!1;break}return a&&i&&delete a[e._src],y.noAudio=!1,e._state="unloaded",e._sounds=[],e=null},on:function(e,t,n,r){e=this["_on"+e];return"function"==typeof t&&e.push(r?{id:n,fn:t,once:r}:{id:n,fn:t}),this},off:function(e,t,n){var r=this["_on"+e],i=0;if("number"==typeof t&&(n=t,t=null),t||n)for(i=0;i<r.length;i++){var o=n===r[i].id;if(t===r[i].fn&&o||!t&&o){r.splice(i,1);break}}else if(e)this["_on"+e]=[];else for(var a=Object.keys(this),i=0;i<a.length;i++)0===a[i].indexOf("_on")&&Array.isArray(this[a[i]])&&(this[a[i]]=[]);return this},once:function(e,t,n){return this.on(e,t,n,1),this},_emit:function(e,t,n){for(var r=this["_on"+e],i=r.length-1;0<=i;i--)r[i].id&&r[i].id!==t&&"load"!==e||(setTimeout(function(e){e.call(this,t,n)}.bind(this,r[i].fn),0),r[i].once&&this.off(e,r[i].fn,r[i].id));return this._loadQueue(e),this},_loadQueue:function(e){var t;return 0<this._queue.length&&((t=this._queue[0]).event===e&&(this._queue.shift(),this._loadQueue()),e||t.action()),this},_ended:function(e){var t,n=this,r=e._sprite;return!n._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop?setTimeout(n._ended.bind(n,e),100):(r=!(!e._loop&&!n._sprite[r][2]),n._emit("end",e._id),!n._webAudio&&r&&n.stop(e._id,!0).play(e._id),n._webAudio&&r&&(n._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=y.ctx.currentTime,t=1e3*(e._stop-e._start)/Math.abs(e._rate),n._endTimers[e._id]=setTimeout(n._ended.bind(n,e),t)),n._webAudio&&!r&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,n._clearTimer(e._id),n._cleanBuffer(e._node),y._autoSuspend()),n._webAudio||r||n.stop(e._id,!0)),n},_clearTimer:function(e){var t;return this._endTimers[e]&&("function"!=typeof this._endTimers[e]?clearTimeout(this._endTimers[e]):(t=this._soundById(e))&&t._node&&t._node.removeEventListener("ended",this._endTimers[e],!1),delete this._endTimers[e]),this},_soundById:function(e){for(var t=0;t<this._sounds.length;t++)if(e===this._sounds[t]._id)return this._sounds[t];return null},_inactiveSound:function(){this._drain();for(var e=0;e<this._sounds.length;e++)if(this._sounds[e]._ended)return this._sounds[e].reset();return new o(this)},_drain:function(){var e=this,t=e._pool,n=0,r=0;if(!(e._sounds.length<t)){for(r=0;r<e._sounds.length;r++)e._sounds[r]._ended&&n++;for(r=e._sounds.length-1;0<=r;r--){if(n<=t)return;e._sounds[r]._ended&&(e._webAudio&&e._sounds[r]._node&&e._sounds[r]._node.disconnect(0),e._sounds.splice(r,1),n--)}}},_getSoundIds:function(e){if(void 0!==e)return[e];for(var t=[],n=0;n<this._sounds.length;n++)t.push(this._sounds[n]._id);return t},_refreshBuffer:function(e){return e._node.bufferSource=y.ctx.createBufferSource(),e._node.bufferSource.buffer=a[this._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop||0),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,y.ctx.currentTime),this},_cleanBuffer:function(e){var t=y._navigator&&0<=y._navigator.vendor.indexOf("Apple");if(e.bufferSource){if(y._scratchBuffer&&e.bufferSource&&(e.bufferSource.onended=null,e.bufferSource.disconnect(0),t))try{e.bufferSource.buffer=y._scratchBuffer}catch(e){}e.bufferSource=null}return this},_clearSound:function(e){/MSIE |Trident\//.test(y._navigator&&y._navigator.userAgent)||(e.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}},(o=function(e){this._parent=e,this.init()}).prototype={init:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++y._counter,t._sounds.push(e),e.create(),e},create:function(){var e=this,t=e._parent,n=y._muted||e._muted||e._parent._muted?0:e._volume;return t._webAudio?(e._node=void 0===y.ctx.createGain?y.ctx.createGainNode():y.ctx.createGain(),e._node.gain.setValueAtTime(n,y.ctx.currentTime),e._node.paused=!0,e._node.connect(y.masterGain)):y.noAudio||(e._node=y._obtainHtml5Audio(),e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(y._canPlayEvent,e._loadFn,!1),e._endFn=e._endListener.bind(e),e._node.addEventListener("ended",e._endFn,!1),e._node.src=t._src,e._node.preload=!0===t._preload?"auto":t._preload,e._node.volume=n*y.volume(),e._node.load()),e},reset:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++y._counter,e},_errorListener:function(){this._parent._emit("loaderror",this._id,this._node.error?this._node.error.code:0),this._node.removeEventListener("error",this._errorFn,!1)},_loadListener:function(){var e=this._parent;e._duration=Math.ceil(10*this._node.duration)/10,0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue()),this._node.removeEventListener(y._canPlayEvent,this._loadFn,!1)},_endListener:function(){var e=this._parent;e._duration===1/0&&(e._duration=Math.ceil(10*this._node.duration)/10,e._sprite.__default[1]===1/0&&(e._sprite.__default[1]=1e3*e._duration),e._ended(this)),this._node.removeEventListener("ended",this._endFn,!1)}},a={},s=function(t){var e=t._src;if(a[e])t._duration=a[e].duration,u(t);else if(/^data:[^;]+;base64,/.test(e)){for(var n=atob(e.split(",")[1]),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);l(r.buffer,t)}else{var o=new XMLHttpRequest;o.open(t._xhr.method,e,!0),o.withCredentials=t._xhr.withCredentials,o.responseType="arraybuffer",t._xhr.headers&&Object.keys(t._xhr.headers).forEach(function(e){o.setRequestHeader(e,t._xhr.headers[e])}),o.onload=function(){var e=(o.status+"")[0];"0"!==e&&"2"!==e&&"3"!==e?t._emit("loaderror",null,"Failed loading audio file with status: "+o.status+"."):l(o.response,t)},o.onerror=function(){t._webAudio&&(t._html5=!0,t._webAudio=!1,t._sounds=[],delete a[e],t.load())},c(o)}},c=function(t){try{t.send()}catch(e){t.onerror()}},l=function(e,t){function n(){t._emit("loaderror",null,"Decoding audio data failed.")}function r(e){e&&0<t._sounds.length?(a[t._src]=e,u(t,e)):n()}"undefined"!=typeof Promise&&1===y.ctx.decodeAudioData.length?y.ctx.decodeAudioData(e).then(r).catch(n):y.ctx.decodeAudioData(e,r,n)},u=function(e,t){t&&!e._duration&&(e._duration=t.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue())},h=function(){if(y.usingWebAudio){try{"undefined"!=typeof AudioContext?y.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?y.ctx=new webkitAudioContext:y.usingWebAudio=!1}catch(e){y.usingWebAudio=!1}y.ctx||(y.usingWebAudio=!1);var e=/iP(hone|od|ad)/.test(y._navigator&&y._navigator.platform),t=y._navigator&&y._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),t=t?parseInt(t[1],10):null;e&&t&&t<9&&(e=/safari/.test(y._navigator&&y._navigator.userAgent.toLowerCase()),y._navigator)&&!e&&(y.usingWebAudio=!1),y.usingWebAudio&&(y.masterGain=void 0===y.ctx.createGain?y.ctx.createGainNode():y.ctx.createGain(),y.masterGain.gain.setValueAtTime(y._muted?0:y._volume,y.ctx.currentTime),y.masterGain.connect(y.ctx.destination)),y._setup()}},"function"==typeof define&&define.amd&&define([],function(){return{Howler:y,Howl:t}}),void 0!==f&&(f.Howler=y,f.Howl=t),void 0!==p?(p.HowlerGlobal=e,p.Howler=y,p.Howl=t,p.Sound=o):"undefined"!=typeof window&&(window.HowlerGlobal=e,window.Howler=y,window.Howl=t,window.Sound=o),HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){if(this.ctx&&this.ctx.listener)for(var t=this._howls.length-1;0<=t;t--)this._howls[t].stereo(e);return this},HowlerGlobal.prototype.pos=function(e,t,n){var r=this;if(r.ctx&&r.ctx.listener){if(t="number"!=typeof t?r._pos[1]:t,n="number"!=typeof n?r._pos[2]:n,"number"!=typeof e)return r._pos;r._pos=[e,t,n],void 0!==r.ctx.listener.positionX?(r.ctx.listener.positionX.setTargetAtTime(r._pos[0],Howler.ctx.currentTime,.1),r.ctx.listener.positionY.setTargetAtTime(r._pos[1],Howler.ctx.currentTime,.1),r.ctx.listener.positionZ.setTargetAtTime(r._pos[2],Howler.ctx.currentTime,.1)):r.ctx.listener.setPosition(r._pos[0],r._pos[1],r._pos[2])}return r},HowlerGlobal.prototype.orientation=function(e,t,n,r,i,o){var a=this;if(a.ctx&&a.ctx.listener){var s=a._orientation;if(t="number"!=typeof t?s[1]:t,n="number"!=typeof n?s[2]:n,r="number"!=typeof r?s[3]:r,i="number"!=typeof i?s[4]:i,o="number"!=typeof o?s[5]:o,"number"!=typeof e)return s;a._orientation=[e,t,n,r,i,o],void 0!==a.ctx.listener.forwardX?(a.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),a.ctx.listener.forwardY.setTargetAtTime(t,Howler.ctx.currentTime,.1),a.ctx.listener.forwardZ.setTargetAtTime(n,Howler.ctx.currentTime,.1),a.ctx.listener.upX.setTargetAtTime(r,Howler.ctx.currentTime,.1),a.ctx.listener.upY.setTargetAtTime(i,Howler.ctx.currentTime,.1),a.ctx.listener.upZ.setTargetAtTime(o,Howler.ctx.currentTime,.1)):a.ctx.listener.setOrientation(e,t,n,r,i,o)}return a},Howl.prototype.init=(n=Howl.prototype.init,function(e){return this._orientation=e.orientation||[1,0,0],this._stereo=e.stereo||null,this._pos=e.pos||null,this._pannerAttr={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:360,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:360,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:0,distanceModel:void 0!==e.distanceModel?e.distanceModel:"inverse",maxDistance:void 0!==e.maxDistance?e.maxDistance:1e4,panningModel:void 0!==e.panningModel?e.panningModel:"HRTF",refDistance:void 0!==e.refDistance?e.refDistance:1,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:1},this._onstereo=e.onstereo?[{fn:e.onstereo}]:[],this._onpos=e.onpos?[{fn:e.onpos}]:[],this._onorientation=e.onorientation?[{fn:e.onorientation}]:[],n.call(this,e)}),Howl.prototype.stereo=function(e,t){var n=this;if(n._webAudio)if("loaded"!==n._state)n._queue.push({event:"stereo",action:function(){n.stereo(e,t)}});else{var r=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===t){if("number"!=typeof e)return n._stereo;n._stereo=e,n._pos=[e,0,0]}for(var i=n._getSoundIds(t),o=0;o<i.length;o++){var a=n._soundById(i[o]);if(a){if("number"!=typeof e)return a._stereo;a._stereo=e,a._pos=[e,0,0],a._node&&(a._pannerAttr.panningModel="equalpower",a._panner&&a._panner.pan||d(a,r),"spatial"==r?void 0!==a._panner.positionX?(a._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),a._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),a._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):a._panner.setPosition(e,0,0):a._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),n._emit("stereo",a._id)}}}return n},Howl.prototype.pos=function(e,t,n,r){var i=this;if(i._webAudio)if("loaded"!==i._state)i._queue.push({event:"pos",action:function(){i.pos(e,t,n,r)}});else{if(t="number"!=typeof t?0:t,n="number"!=typeof n?-.5:n,void 0===r){if("number"!=typeof e)return i._pos;i._pos=[e,t,n]}for(var o=i._getSoundIds(r),a=0;a<o.length;a++){var s=i._soundById(o[a]);if(s){if("number"!=typeof e)return s._pos;s._pos=[e,t,n],s._node&&(s._panner&&!s._panner.pan||d(s,"spatial"),void 0!==s._panner.positionX?(s._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),s._panner.positionY.setValueAtTime(t,Howler.ctx.currentTime),s._panner.positionZ.setValueAtTime(n,Howler.ctx.currentTime)):s._panner.setPosition(e,t,n)),i._emit("pos",s._id)}}}return i},Howl.prototype.orientation=function(e,t,n,r){var i=this;if(i._webAudio)if("loaded"!==i._state)i._queue.push({event:"orientation",action:function(){i.orientation(e,t,n,r)}});else{if(t="number"!=typeof t?i._orientation[1]:t,n="number"!=typeof n?i._orientation[2]:n,void 0===r){if("number"!=typeof e)return i._orientation;i._orientation=[e,t,n]}for(var o=i._getSoundIds(r),a=0;a<o.length;a++){var s=i._soundById(o[a]);if(s){if("number"!=typeof e)return s._orientation;s._orientation=[e,t,n],s._node&&(s._panner||(s._pos||(s._pos=i._pos||[0,0,-.5]),d(s,"spatial")),void 0!==s._panner.orientationX?(s._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),s._panner.orientationY.setValueAtTime(t,Howler.ctx.currentTime),s._panner.orientationZ.setValueAtTime(n,Howler.ctx.currentTime)):s._panner.setOrientation(e,t,n)),i._emit("orientation",s._id)}}}return i},Howl.prototype.pannerAttr=function(){var e,t,n=this,r=arguments;if(n._webAudio){if(0===r.length)return n._pannerAttr;if(1===r.length){if("object"!=typeof r[0])return((a=n._soundById(parseInt(r[0],10)))||n)._pannerAttr;e=r[0],void 0===t&&(e.pannerAttr||(e.pannerAttr={coneInnerAngle:e.coneInnerAngle,coneOuterAngle:e.coneOuterAngle,coneOuterGain:e.coneOuterGain,distanceModel:e.distanceModel,maxDistance:e.maxDistance,refDistance:e.refDistance,rolloffFactor:e.rolloffFactor,panningModel:e.panningModel}),n._pannerAttr={coneInnerAngle:void 0!==e.pannerAttr.coneInnerAngle?e.pannerAttr.coneInnerAngle:n._coneInnerAngle,coneOuterAngle:void 0!==e.pannerAttr.coneOuterAngle?e.pannerAttr.coneOuterAngle:n._coneOuterAngle,coneOuterGain:void 0!==e.pannerAttr.coneOuterGain?e.pannerAttr.coneOuterGain:n._coneOuterGain,distanceModel:void 0!==e.pannerAttr.distanceModel?e.pannerAttr.distanceModel:n._distanceModel,maxDistance:void 0!==e.pannerAttr.maxDistance?e.pannerAttr.maxDistance:n._maxDistance,refDistance:void 0!==e.pannerAttr.refDistance?e.pannerAttr.refDistance:n._refDistance,rolloffFactor:void 0!==e.pannerAttr.rolloffFactor?e.pannerAttr.rolloffFactor:n._rolloffFactor,panningModel:void 0!==e.pannerAttr.panningModel?e.pannerAttr.panningModel:n._panningModel})}else 2===r.length&&(e=r[0],t=parseInt(r[1],10));for(var i,o,a,s=n._getSoundIds(t),c=0;c<s.length;c++)(a=n._soundById(s[c]))&&(i=a._pannerAttr,i={coneInnerAngle:(void 0!==e.coneInnerAngle?e:i).coneInnerAngle,coneOuterAngle:(void 0!==e.coneOuterAngle?e:i).coneOuterAngle,coneOuterGain:(void 0!==e.coneOuterGain?e:i).coneOuterGain,distanceModel:(void 0!==e.distanceModel?e:i).distanceModel,maxDistance:(void 0!==e.maxDistance?e:i).maxDistance,refDistance:(void 0!==e.refDistance?e:i).refDistance,rolloffFactor:(void 0!==e.rolloffFactor?e:i).rolloffFactor,panningModel:(void 0!==e.panningModel?e:i).panningModel},(o=a._panner)||(a._pos||(a._pos=n._pos||[0,0,-.5]),d(a,"spatial"),o=a._panner),o.coneInnerAngle=i.coneInnerAngle,o.coneOuterAngle=i.coneOuterAngle,o.coneOuterGain=i.coneOuterGain,o.distanceModel=i.distanceModel,o.maxDistance=i.maxDistance,o.refDistance=i.refDistance,o.rolloffFactor=i.rolloffFactor,o.panningModel=i.panningModel)}return n},Sound.prototype.init=(r=Sound.prototype.init,function(){var e=this,t=e._parent;e._orientation=t._orientation,e._stereo=t._stereo,e._pos=t._pos,e._pannerAttr=t._pannerAttr,r.call(this),e._stereo?t.stereo(e._stereo):e._pos&&t.pos(e._pos[0],e._pos[1],e._pos[2],e._id)}),Sound.prototype.reset=(i=Sound.prototype.reset,function(){var e=this,t=e._parent;return e._orientation=t._orientation,e._stereo=t._stereo,e._pos=t._pos,e._pannerAttr=t._pannerAttr,e._stereo?t.stereo(e._stereo):e._pos?t.pos(e._pos[0],e._pos[1],e._pos[2],e._id):e._panner&&(e._panner.disconnect(0),e._panner=void 0,t._refreshBuffer(e)),i.call(this)}),d=function(e,t){"spatial"===(t=t||"spatial")?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,void 0!==e._panner.positionX?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),void 0!==e._panner.orientationX?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],366:[function(e,t,n){function i(r,i){var o=[],a=[];return null==i&&(i=function(e,t){return o[0]===t?"[Circular ~]":"[Circular ~."+a.slice(0,o.indexOf(t)).join(".")+"]"}),function(e,t){var n;return 0<o.length?(~(n=o.indexOf(this))?o.splice(n+1):o.push(this),~n?a.splice(n,1/0,e):a.push(e),~o.indexOf(t)&&(t=i.call(this,e,t))):o.push(t),null==r?t:r.call(this,e,t)}}(n=t.exports=function(e,t,n,r){return JSON.stringify(e,i(t,r),n)}).getSerialize=i},{}],367:[function(e,t,n){n.Edge=e("./mda/Core/Edge.js"),n.HalfEdge=e("./mda/Core/HalfEdge.js"),n.Vertex=e("./mda/Core/Vertex.js"),n.Face=e("./mda/Core/Face.js"),n.Mesh=e("./mda/Core/Mesh.js"),n.Integrity=e("./mda/Integrity/Integrity.js"),n.MeshIntegrity=e("./mda/Integrity/MeshIntegrity.js"),n.FaceIntegrity=e("./mda/Integrity/FaceIntegrity.js"),n.EdgeIntegrity=e("./mda/Integrity/EdgeIntegrity.js"),n.HalfEdgeIntegrity=e("./mda/Integrity/HalfEdgeIntegrity.js"),n.VertexIntegrity=e("./mda/Integrity/VertexIntegrity.js"),n.HalfEdgePrev=e("./mda/Queries/HalfEdgePrev.js"),n.EdgeVertices=e("./mda/Queries/EdgeVertices.js"),n.FaceHalfEdges=e("./mda/Queries/FaceHalfEdges.js"),n.FaceVertices=e("./mda/Queries/FaceVertices.js"),n.VertexFaces=e("./mda/Queries/VertexFaces.js"),n.VertexHalfEdges=e("./mda/Queries/VertexHalfEdges.js"),n.VertexNeighbors=e("./mda/Queries/VertexNeighbors.js"),n.MeshCentroid=e("./mda/Queries/MeshCentroid.js"),n.InsertVertexOperator=e("./mda/Operators/InsertVertex.js"),n.InsertEdgeOperator=e("./mda/Operators/InsertEdge.js"),n.DeleteEdgeOperator=e("./mda/Operators/DeleteEdge.js"),n.LoopOperator=e("./mda/Operators/Loop.js"),n.CatmullClarkOperator=e("./mda/Operators/CatmullClark.js"),n.QuadSubdivideOperator=e("./mda/Operators/QuadSubdivide.js"),n.TriangulateOperator=e("./mda/Operators/Triangulate.js"),n.ExtrudeOperator=e("./mda/Operators/Extrude.js"),n.PipeOperator=e("./mda/Operators/Pipe.js"),n.DuplicateOperator=e("./mda/Operators/Duplicate.js"),n.CombineOperator=e("./mda/Operators/Combine.js"),n.ScaleOperator=e("./mda/Operators/Scale.js"),n.MoveOperator=e("./mda/Operators/Move.js"),n.InvertOperator=e("./mda/Operators/Invert.js"),n.WireframeOperator=e("./mda/Operators/Wireframe.js"),n.CreateFaceOperator=e("./mda/Operators/CreateFace.js"),n.ProfileGenerator=e("./mda/Generators/Profile.js")},{"./mda/Core/Edge.js":368,"./mda/Core/Face.js":369,"./mda/Core/HalfEdge.js":370,"./mda/Core/Mesh.js":371,"./mda/Core/Vertex.js":372,"./mda/Generators/Profile.js":373,"./mda/Integrity/EdgeIntegrity.js":374,"./mda/Integrity/FaceIntegrity.js":375,"./mda/Integrity/HalfEdgeIntegrity.js":376,"./mda/Integrity/Integrity.js":377,"./mda/Integrity/MeshIntegrity.js":378,"./mda/Integrity/VertexIntegrity.js":379,"./mda/Operators/CatmullClark.js":380,"./mda/Operators/Combine.js":381,"./mda/Operators/CreateFace.js":382,"./mda/Operators/DeleteEdge.js":383,"./mda/Operators/Duplicate.js":384,"./mda/Operators/Extrude.js":385,"./mda/Operators/InsertEdge.js":386,"./mda/Operators/InsertVertex.js":387,"./mda/Operators/Invert.js":388,"./mda/Operators/Loop.js":389,"./mda/Operators/Move.js":390,"./mda/Operators/Pipe.js":391,"./mda/Operators/QuadSubdivide.js":392,"./mda/Operators/Scale.js":393,"./mda/Operators/Triangulate.js":394,"./mda/Operators/Wireframe.js":395,"./mda/Queries/EdgeVertices.js":396,"./mda/Queries/FaceHalfEdges.js":397,"./mda/Queries/FaceVertices.js":398,"./mda/Queries/HalfEdgePrev.js":399,"./mda/Queries/MeshCentroid.js":400,"./mda/Queries/VertexFaces.js":401,"./mda/Queries/VertexHalfEdges.js":402,"./mda/Queries/VertexNeighbors.js":403}],368:[function(e,t,n){function r(){this.halfEdge=void 0,this.index=-1}r.prototype.setIndex=function(e){this.index=e},r.prototype.getIndex=function(){return this.index},r.prototype.setHalfEdge=function(e){this.halfEdge=e},r.prototype.getHalfEdge=function(){return this.halfEdge},t.exports=r},{}],369:[function(e,t,n){function r(){this.halfEdge=void 0,this.index=-1}r.prototype.setIndex=function(e){this.index=e},r.prototype.getIndex=function(){return this.index},r.prototype.setHalfEdge=function(e){this.halfEdge=e},r.prototype.getHalfEdge=function(){return this.halfEdge},t.exports=r},{}],370:[function(e,t,n){function r(){this.nextHalfEdge=void 0,this.flipHalfEdge=void 0,this.vertex=void 0,this.edge=void 0,this.face=void 0}r.prototype.setVertex=function(e){this.vertex=e},r.prototype.getVertex=function(){return this.vertex},r.prototype.setFace=function(e){this.face=e},r.prototype.getFace=function(){return this.face},r.prototype.setEdge=function(e){this.edge=e},r.prototype.getEdge=function(){return this.edge},r.prototype.setNextHalfEdge=function(e){this.nextHalfEdge=e},r.prototype.getNextHalfEdge=function(){return this.nextHalfEdge},r.prototype.setFlipHalfEdge=function(e){this.flipHalfEdge=e},r.prototype.getFlipHalfEdge=function(){return this.flipHalfEdge},r.prototype.onBoundary=function(){return!this.getFlipHalfEdge()},t.exports=r},{}],371:[function(e,t,n){e("gl-matrix").vec3;var i=e("./Vertex"),h=e("./Edge"),g=e("./HalfEdge"),o=e("./Face");function r(){this.halfEdges=[],this.vertices=[],this.edges=[],this.faces=[],this.boundaries=[],this.positions=[],this.cells=[],this.edgeMap={}}r.prototype.getFaces=function(){return this.faces},r.prototype.getEdges=function(){return this.edges},r.prototype.getEdgeMap=function(){return this.edgeMap},r.prototype.getVertices=function(){return this.vertices},r.prototype.getHalfEdges=function(){return this.halfEdges},r.prototype.getEdgeKey=function(e,t){return e+"-"+t},r.prototype.getEdgeKeys=function(e,t){return[this.getEdgeKey(e,t),this.getEdgeKey(t,e)]},r.prototype.containsEdge=function(e,t){var n=this.edgeMap,e=this.getEdgeKeys(e,t);return void 0!==n[e[0]]&&void 0!==n[e[1]]},r.prototype.getEdge=function(e,t){var n=this.edgeMap,e=this.getEdgeKeys(e,t);if(void 0!==n[e[0]]&&void 0!==n[e[1]])return n[e[0]]},r.prototype.setPositions=function(e){for(var t=(this.positions=e).length,n=0;n<t;n++){var r=new i;r.setIndex(n),this.vertices.push(r)}},r.prototype.getPositions=function(){for(var e=[],t=this.vertices,n=this.positions,r=t.length,i=0;i<r;i++){var o=t[i].getIndex();e.push(n[o])}return e},r.prototype.setCells=function(e){this.cells=e.slice();for(var t=e.length,n=0;n<t;n++){var r=new o;r.setIndex(n),this.faces.push(r)}this.buildEdgeMap()},r.prototype.getCells=function(){for(var e=[],t=this.faces,n=(this.vertices,t.length),r=0;r<n;r++){var i=t[r],o=halfEdge=i.getHalfEdge(),a=[];do{var s=halfEdge.getVertex().getIndex()}while(a.push(s),(halfEdge=halfEdge.getNextHalfEdge())!=o);e.push(a)}return e},r.prototype.buildEdgeMap=function(){for(var e=this.cells,t=this.edges,n=this.edgeMap,r=e.length,i=0;i<r;i++)for(var o=e[i],a=o.length,s=0;s<a;s++){var c=o[s],l=o[(s+1)%a],u=c+"-"+l,l=l+"-"+c;void 0===n[u]&&void 0===n[l]&&((c=new h).setIndex(t.length),t.push(c),n[u]=c,n[l]=c)}},r.prototype.process=function(){for(var e=this.edgeMap,t=(this.edges,this.cells),n=this.vertices,r=this.faces,i=this.halfEdges,o=t.length,a=0;a<o;a++){for(var s=t[a],c=r[a],l=t[a].length,u=void 0,h=void 0,d=0;d<l;d++){var p=s[d],f=e[p+"-"+s[(d+1)%l]],p=n[p],m=new g;m.setVertex(p),m.setFace(c),m.setEdge(f),f.getHalfEdge()?(m.setFlipHalfEdge(f.getHalfEdge()),f.getHalfEdge().setFlipHalfEdge(m)):f.setHalfEdge(m),void 0!==u&&u.setNextHalfEdge(m),0===d&&(h=m),i.push(u=m),p.setHalfEdge(m)}c.setHalfEdge(h),u.setNextHalfEdge(h)}},t.exports=r},{"./Edge":368,"./Face":369,"./HalfEdge":370,"./Vertex":372,"gl-matrix":356}],372:[function(e,t,n){e("gl-matrix").vec3;function r(){this.halfEdge=void 0,this.index=-1}r.prototype.setIndex=function(e){this.index=e},r.prototype.getIndex=function(){return this.index},r.prototype.setHalfEdge=function(e){this.halfEdge=e},r.prototype.getHalfEdge=function(){return this.halfEdge},t.exports=r},{"gl-matrix":356}],373:[function(e,t,n){var c=e("./../Core/Mesh");t.exports=function(e){if(e.length<0||e[0].length<2)throw"profile must be a non-zero array of atleast 3 2D positions [ [ x0, y0 ], [ x1, y1 ], [ x2, y2 ] ]";for(var t=new c,n=[],r=[],i=[],o=e.length,a=0;a<o;a++)n.push([e[a][0],e[a][1],0]),r.push(a),i.push(o-1-a);var s=[r,i];return(t=new c).setPositions(n),t.setCells(s),t.process(),t}},{"./../Core/Mesh":371}],374:[function(e,t,n){t.exports=function(e){var t=!0;return-1===e.getIndex()&&(console.log("edge: ",e.getIndex()," does not have a proper index"),t=!1),void 0===e.getHalfEdge()&&(console.log("edge: ",e.getIndex()," does not have a half edge"),t=!1),t}},{}],375:[function(e,t,n){t.exports=function(e){var t=!0;return-1===e.getIndex()&&(console.log("face: ",e.getIndex()," does not have a proper index"),t=!1),void 0===e.getHalfEdge()&&(console.log("face: ",e.getIndex()," does not have a half edge"),t=!1),t}},{}],376:[function(e,t,n){e("./../Queries/HalfEdgePrev");t.exports=function(e){var t=!0;return void 0===e.getNextHalfEdge()&&(console.log("halfEdge: does not have a next half edge"),t=!1),void 0===e.getFlipHalfEdge()&&(console.log("halfEdge: does not have a flip half edge"),t=!1),void 0===e.getVertex()&&(console.log("halfEdge: does not have a valid vertex"),t=!1),void 0===e.getEdge()&&(console.log("halfEdge: does not have an edge"),t=!1),void 0===e.getFace()&&(console.log("halfEdge: does not have a face"),t=!1),t}},{"./../Queries/HalfEdgePrev":399}],377:[function(e,t,n){var o=e("./FaceIntegrity"),a=e("./EdgeIntegrity"),s=e("./VertexIntegrity"),c=e("./HalfEdgeIntegrity"),e={checkMesh:function(e){var t=!0;return this.checkFaces(e.getFaces())||(console.log("faces are messed up"),t=!1),this.checkEdges(e.getEdges())||(console.log("edges are messed up"),t=!1),this.checkVertices(e.getVertices())||(console.log("vertices are messed up"),t=!1),this.checkHalfEdges(e.getHalfEdges())||(console.log("half edges are messed up"),t=!1),console.log("mesh is valid!"),t},checkEdges:function(e){for(var t=!0,n=e.length,r=0;r<n;r++)var i=e[r],t=a(i);return t},checkFaces:function(e){for(var t=!0,n=e.length,r=0;r<n;r++)var i=e[r],t=o(i);return t},checkVertices:function(e){for(var t=!0,n=e.length,r=0;r<n;r++)var i=e[r],t=s(i);return t},checkHalfEdges:function(e){for(var t=!0,n=e.length,r=0;r<n;r++)var i=e[r],t=c(i);return t}};t.exports=e},{"./EdgeIntegrity":374,"./FaceIntegrity":375,"./HalfEdgeIntegrity":376,"./VertexIntegrity":379}],378:[function(e,t,n){var r=e("./Integrity");t.exports=function(e){var t=!0;return console.log("checking faces"),r.checkFaces(e.getFaces())||(console.log("faces are messed up"),t=!1),console.log("checking edges"),r.checkEdges(e.getEdges())||(console.log("edges are messed up"),t=!1),console.log("checking vertices"),r.checkVertices(e.getVertices())||(console.log("vertices are messed up"),t=!1),console.log("checking halfedges"),r.checkHalfEdges(e.getHalfEdges())||(console.log("half edges are messed up"),t=!1),console.log("mesh is valid!"),t}},{"./Integrity":377}],379:[function(e,t,n){t.exports=function(e){var t=!0;return-1===e.getIndex()&&(console.log("vertex : ",e.getIndex()," does not have a proper index"),t=!1),void 0===e.getHalfEdge()&&(console.log("vertex : ",e.getIndex()," does not have a half edge"),t=!1),t}},{}],380:[function(e,t,n){var B=e("./../Queries/VertexNeighbors"),V=e("./../Queries/FaceVertices"),G=(e("./../Queries/FaceHalfEdges"),e("./../Queries/VertexHalfEdges")),W=e("./InsertVertex"),q=e("./InsertEdge"),X=e("gl-matrix").vec3;t.exports=function(e){for(var t=[],n=e.positions,r=n.length,i=0;i<r;i++)t.push(X.clone(n[i]));X.create();for(var o=X.create(),a=(O=e.getVertices()).length,s={},i=0;i<32;i++){var c=3/(2*i),l=1/(4*i);s[i]=[1-c-l,c/i,l/i]}for(i=0;i<a;i++){var u=n[w=(I=O[i]).getIndex()],h=(C=G(I)).length,d=s[h];X.copy(o,u),X.scale(o,o,d[0]);for(var p=0;p<h;p++){var f=(A=C[p]).getNextHalfEdge(),m=n[f.getVertex().getIndex()];X.scaleAndAdd(o,o,m,d[1]);m=n[f.getNextHalfEdge().getVertex().getIndex()];X.scaleAndAdd(o,o,m,d[2])}X.copy(t[w],o)}for(var g={},v=e.getFaces(),y=v.length,i=0;i<y;i++){var _=v[i],x=V(_),a=x.length,b=X.create();g[_.getIndex()]=b;for(p=0;p<a;p++){var w,u=n[w=(I=x[p]).getIndex()];X.scaleAndAdd(b,b,u,.25)}}for(var E={},M=e.getEdges(),F=M.length,i=0;i<F;i++){var T=M[i],S=X.create();E[T.getIndex()]=S;var A,P=n[(A=T.getHalfEdge()).getVertex().getIndex()],P=(X.scaleAndAdd(S,S,P,.375),n[A.getNextHalfEdge().getNextHalfEdge().getVertex().getIndex()]),R=n[A.getNextHalfEdge().getNextHalfEdge().getNextHalfEdge().getVertex().getIndex()],P=(X.scaleAndAdd(S,S,P,1/16),X.scaleAndAdd(S,S,R,1/16),A.getFlipHalfEdge()),R=n[P.getVertex().getIndex()],R=(X.scaleAndAdd(S,S,R,.375),n[P.getNextHalfEdge().getNextHalfEdge().getVertex().getIndex()]),P=n[P.getNextHalfEdge().getNextHalfEdge().getNextHalfEdge().getVertex().getIndex()];X.scaleAndAdd(S,S,R,1/16),X.scaleAndAdd(S,S,P,1/16)}for(i=0;i<F;i++){var D=(T=M[i]).getIndex();W(e,T.getIndex(),E[D])}for(var L={},i=0;i<y;i++){L[(_=v[i]).getIndex()]=[];for(a=(O=V(_)).length,p=0;p<a;p++){var C,I=O[p];2==(C=B(I)).length&&L[_.getIndex()].push(I)}}for(var H=Object.keys(L),i=0;i<H.length;i++){var O,j=H[i],U=(O=L[j])[0],z=O[1],N=O[2],k=O[3],U=q(e,U.getIndex(),N.getIndex()),N=W(e,U.edge.getIndex(),g[j]);L[j].push(N),q(e,z.getIndex(),N.getIndex()),q(e,k.getIndex(),N.getIndex())}for(i=0;i<r;i++)X.copy(n[i],t[i])}},{"./../Queries/FaceHalfEdges":397,"./../Queries/FaceVertices":398,"./../Queries/VertexHalfEdges":402,"./../Queries/VertexNeighbors":403,"./InsertEdge":386,"./InsertVertex":387,"gl-matrix":356}],381:[function(e,t,n){e("./../Core/Mesh");var S=e("./../Core/Vertex"),A=e("./../Core/Edge"),P=e("./../Core/HalfEdge"),R=e("./../Core/Face"),L=(e("./../Queries/FaceHalfEdges"),e("gl-matrix").vec3);t.exports=function(e,t){for(var n=e.positions,r=(n.length,e.getVertices()),i=r.length,o=e.getFaces(),a=(o.length,e.getEdges()),s=(a.length,e.getEdgeMap()),c=t.positions,l=c.length,u=(t.getVertices().length,t.getCells()),h=u.length,d=0;d<l;d++){var p=new S,p=(p.setIndex(r.length),r.push(p),L.clone(c[d]));n.push(p)}for(d=0;d<h;d++){for(var f=u[d],m=f.length,g=new R,v=(g.setIndex(o.length),o.push(g),void 0),y=[],_=0;_<m;_++){var x=i+f[_],b=i+f[(_+1)%m],w=r[x],E=e.getEdge(x,b),M=!!E,T=new P;M?((M=E.getHalfEdge()).setFlipHalfEdge(T),T.setFlipHalfEdge(M)):((E=new A).setIndex(a.length),E.setHalfEdge(T),a.push(E),s[(M=e.getEdgeKeys(x,b))[0]]=E,s[M[1]]=E),T.setFace(g),T.setEdge(E),T.setVertex(w),v&&v.setNextHalfEdge(T),y.push(T),w.setHalfEdge(v=T)}g.setHalfEdge(v),v.setNextHalfEdge(y[0])}}},{"./../Core/Edge":368,"./../Core/Face":369,"./../Core/HalfEdge":370,"./../Core/Mesh":371,"./../Core/Vertex":372,"./../Queries/FaceHalfEdges":397,"gl-matrix":356}],382:[function(e,t,n){var v=e("./../Core/Edge"),y=e("./../Core/HalfEdge"),_=e("./../Core/Face");t.exports=function(e,t,n){for(var r,i=e.getEdgeMap(),o=e.getFaces(),a=e.getHalfEdges(),s=e.getEdges(),c=(n||(n=new _).setIndex(o.length),t.length),l=[],u=0;u<c;u++){var h,d=t[u],p=t[(u+1)%c],f=d.getIndex(),p=p.getIndex(),m=new y,g=e.getEdge(f,p);g?(h=g.getHalfEdge()).getVertex()==d?m=h:(m.setFlipHalfEdge(h),h.setFlipHalfEdge(m)):(g=new v,h=e.getEdgeKeys(f,p),g.setIndex(s.length),s.push(g),g.setHalfEdge(m),i[h[0]]=g,i[h[1]]=g),m.setEdge(g),m.setFace(n),m.setVertex(d),r&&r.setNextHalfEdge(m),d.setHalfEdge(m),l.push(m),r=m,a.push(m)}return n.setHalfEdge(l[0]),r.setNextHalfEdge(l[0]),n}},{"./../Core/Edge":368,"./../Core/Face":369,"./../Core/HalfEdge":370}],383:[function(e,t,n){e("./../Core/Face"),e("./../Core/Edge"),e("./../Core/HalfEdge");var m=e("./../Queries/HalfEdgePrev");t.exports=function(e,t){for(var n=e.getEdges(),r=n[t].getHalfEdge(),i=m(r),o=r.getNextHalfEdge(),a=r.getVertex(),s=r.getFace(),r=r.getFlipHalfEdge(),c=m(r),l=r.getNextHalfEdge(),u=r.getVertex(),r=r.getFace(),h=(s.setHalfEdge(o),i.setNextHalfEdge(l),a.setHalfEdge(l),c.setNextHalfEdge(o),u.setHalfEdge(o),e.getFaces()),d=(h.splice(r.getIndex(),1),h.length),p=0;p<d;p++)h[p].setIndex(p);n.splice(t,1);for(var f=n.length,p=0;p<f;p++)n[p].setIndex(p);s=e.getEdgeKeys(a.getIndex(),u.getIndex()),i=e.getEdgeMap();delete i[s[0]],delete i[s[1]]}},{"./../Core/Edge":368,"./../Core/Face":369,"./../Core/HalfEdge":370,"./../Queries/HalfEdgePrev":399}],384:[function(e,t,n){var a=e("./../Core/Mesh"),s=e("gl-matrix").vec3;t.exports=function(e){for(var t=new a,n=[],r=e.getPositions(),i=r.length,o=0;o<i;o++)n.push(s.clone(r[o]));return t.setPositions(n),t.setCells(e.getCells()),t.process(),t}},{"./../Core/Mesh":371,"gl-matrix":356}],385:[function(e,t,n){var Y=e("./../Core/Vertex"),Q=e("./../Core/Edge"),Z=e("./../Core/HalfEdge"),J=e("./../Core/Face"),K=e("./../Queries/FaceHalfEdges"),$=(e("./../Queries/MeshCentroid"),e("guf").calculateNormal),ee=e("cga").expandPolygon2,te=e("gl-matrix").vec3,ne=e("gl-matrix").quat,re=te.fromValues(0,0,1);t.exports=function(e,t,n,F){for(var D=e.getVertices(),r=e.getHalfEdges(),i=e.getEdges(),o=e.getEdgeMap(),a=e.getFaces(),s=e.positions,c=a[t],l=K(c),H=l.length,u=[],h=0;h<H;h++){var d=(w=(L=l[h]).getVertex()).getIndex();u.push(w)}for(var U=u.length,t=s[u[0].getIndex()],z=s[u[1].getIndex()],k=s[u[2].getIndex()],t=$(t,z,k),p=ne.create(),f=(ne.rotationTo(p,t,re),[]),m=[],B=[],g=0,v=0;v<U;v++){var d=(w=u[v]).getIndex(),y=te.clone(s[d]);te.transformQuat(y,y,p),g=y[2],m.push([y[0],y[1]]),B.push(d),f.push(new Y)}ne.rotationTo(p,re,t);var _=ee(m,-(F||1e-5)),x=_.length,V=[],G=[],b=[];g+=null!=n?n:0;for(h=0;h<x;h++){var w,E=_[h],E=te.fromValues(E[0],E[1],g);te.transformQuat(E,E,p),V.push(E),(w=f[h]).setIndex(s.length),s.push(E),D.push(w)}for(var M=void 0,T=void 0,h=0;h<x;h++){var S=c,A=f[h],P=f[(h+1)%x],R=new Q,L=new Z,C=new Z,P=(L.setFlipHalfEdge(C),L.setEdge(R),L.setVertex(A),L.setFace(S),r.push(L),C.setFlipHalfEdge(L),C.setEdge(R),C.setVertex(P),r.push(C),R.setIndex(i.length),R.setHalfEdge(L),i.push(R),e.getEdgeKeys(A.getIndex(),P.getIndex()));o[P[0]]=R,o[P[1]]=R,A.setHalfEdge(L),G.push(R),b.push(L),M&&(M.setNextHalfEdge(L),C.setNextHalfEdge(T)),M=L,T=C}for(var C=(L=b[0]).getFlipHalfEdge(),I=(M.setNextHalfEdge(L),C.setNextHalfEdge(T),c.setHalfEdge(L),[]),O=[],W=void 0,M=void 0,h=0;h<x;h++){var A=f[h],q=u[h],j=A.getHalfEdge().getFlipHalfEdge(),X=l[h],N=h-1,N=l[N<0?x+N:N],S=new J,R=new Q,L=new Z,C=new Z;L.setFlipHalfEdge(C),L.setNextHalfEdge(X),L.setEdge(R),L.setVertex(A),L.setFace(S),C.setFlipHalfEdge(L),C.setNextHalfEdge(j.getNextHalfEdge()),C.setEdge(R),C.setVertex(q),C.setFace(W),R.setIndex(i.length),i.push(R),R.setHalfEdge(L),S.setIndex(a.length),S.setHalfEdge(L),a.push(S),I.push(S),q.setHalfEdge(C),j.setNextHalfEdge(L),j.setFace(S),X.setFace(S),N.setNextHalfEdge(C),O.push(L),W=S}return(C=(L=O[0]).getFlipHalfEdge()).setFace(I[I.length-1]),c}},{"./../Core/Edge":368,"./../Core/Face":369,"./../Core/HalfEdge":370,"./../Core/Vertex":372,"./../Queries/FaceHalfEdges":397,"./../Queries/MeshCentroid":400,cga:25,"gl-matrix":356,guf:364}],386:[function(e,t,n){var b=e("./../Core/Face"),w=e("./../Core/Edge"),E=e("./../Core/HalfEdge"),M=e("./../Queries/HalfEdgePrev"),T=e("./../Queries/VertexHalfEdges");function S(e,t){for(var n=e;e.setFace(t),(e=e.getNextHalfEdge())!=n;);}t.exports=function(e,t,n){if(t===n)throw"illegal edge inseration: "+t+" , "+n;var r=e.getEdges(),i=e.getHalfEdges(),o=e.getEdgeMap(),a=e.getVertices(),s=e.getFaces(),c=e.getEdge(t,n);if(!c){for(var l,u,h,d,c=a[t],a=a[n],p=((e,t)=>{for(var n={},r=T(e),i=r.length,o=T(t),a=o.length,s=0;s<i;s++)for(var c=r[s].getFace(),l=0;l<a;l++){var u=o[l].getFace();c.getIndex()===u.getIndex()&&(n[c.getIndex()]=u)}return Object.keys(n)})(c,a),f=p.length,m=0;m<f;m++){var g=s[p[m]],v=g.getHalfEdge(),y=v;do{var _=y.getVertex().getIndex()}while(_===t&&(l=y),_===n&&(h=y),(y=y.getNextHalfEdge())!=v);if(null!=h||null!=l)break;l=h=void 0}if(u=M(h),d=M(l),void 0===l||void 0===u||void 0===h||void 0===d)throw"error finding neighboring half edges when inserting edge";var x=new w,e=(x.setIndex(r.length),e.getEdgeKeys(t,n)),o=(o[e[0]]=x,o[e[1]]=x,r.push(x),new b),e=(o.setIndex(s.length),s.push(o),new E),r=new E;return e.setNextHalfEdge(l),e.setFlipHalfEdge(r),e.setVertex(a),e.setEdge(x),e.setFace(g),i.push(e),r.setNextHalfEdge(h),r.setFlipHalfEdge(e),r.setVertex(c),r.setEdge(x),r.setFace(o),i.push(r),x.setHalfEdge(e),g.setHalfEdge(e),o.setHalfEdge(r),d.setNextHalfEdge(r),u.setNextHalfEdge(e),S(r,o),S(e,g),{edge:x,face:o}}}},{"./../Core/Edge":368,"./../Core/Face":369,"./../Core/HalfEdge":370,"./../Queries/HalfEdgePrev":399,"./../Queries/VertexHalfEdges":402}],387:[function(e,t,n){e("./../Core/Face");var b=e("./../Core/Edge"),w=e("./../Core/Vertex"),E=e("./../Core/HalfEdge"),M=e("gl-matrix").vec3;t.exports=function(e,t,n){var r=e.getEdges(),i=e.getHalfEdges(),o=e.getEdgeMap(),a=e.getVertices(),e=e.positions,t=r[t],s=t.getHalfEdge(),c=s.getFace(),l=s.getNextHalfEdge(),u=s.getFlipHalfEdge(),h=s.getVertex().getIndex(),d=e[h],p=l.getVertex().getIndex(),f=e[p],m=new b,g=new w,v=new E,y=new E,_=e.length,x=M.create();void 0!==n?M.copy(x,n):(M.add(x,d,f),M.scale(x,x,.5)),g.setIndex(_),g.setHalfEdge(v),e.push(x),a.push(g),v.setVertex(g),v.setFace(c),v.setNextHalfEdge(l),v.setFlipHalfEdge(u),v.setEdge(m),s.setNextHalfEdge(v),s.setFlipHalfEdge(y);n=p+"-"+h,delete o[h+"-"+p],delete o[n],d=h+"-"+_,f=_+"-"+h,o[d]=t,o[f]=t,m.setIndex(r.length),r.push(m),m.setHalfEdge(v),e=_+"-"+p,x=p+"-"+_,o[e]=m,o[x]=m,a=u.getFace(),c=u.getNextHalfEdge();return u.setNextHalfEdge(y),u.setFlipHalfEdge(v),u.setEdge(m),y.setNextHalfEdge(c),y.setFlipHalfEdge(s),y.setVertex(g),y.setEdge(t),y.setFace(a),i.push(y),g}},{"./../Core/Edge":368,"./../Core/Face":369,"./../Core/HalfEdge":370,"./../Core/Vertex":372,"gl-matrix":356}],388:[function(e,t,n){e("./../Core/Mesh");var h=e("./../Queries/FaceHalfEdges"),d=e("./../Queries/FaceVertices");e("gl-matrix").vec3;t.exports=function(e){for(var t=e.getFaces(),n=t.length,r=0;r<n;r++)for(var i=h(t[r]),o=d(t[r]),a=i.length,s=0;s<a;s++){var c=s,l=(s+1)%a,u=(o[c],o[l]),c=i[c];i[l].setNextHalfEdge(c),c.setVertex(u),u.setHalfEdge(c)}}},{"./../Core/Mesh":371,"./../Queries/FaceHalfEdges":397,"./../Queries/FaceVertices":398,"gl-matrix":356}],389:[function(e,t,n){var R=e("gl-matrix").vec3,L=e("./../Queries/FaceVertices"),C=e("./../Queries/VertexNeighbors"),I=e("./InsertVertex"),O=e("./InsertEdge");t.exports=function(e){for(var t=e.positions,n=t.length,r=[],i=0;i<n;i++)r.push(R.create());for(var o,a=(T=e.getVertices()).length,i=0;i<a;i++){var s=T[i],c=s.getIndex(),l=t[c],u=r[c],h=C(s),d=h.length;3===d?o=3/16:3<d&&(o=(5/8-Math.pow(.375+.25*Math.cos(2*Math.PI/d),2))/d),R.scaleAndAdd(u,u,l,1-d*o);for(var p=0;p<d;p++){var f=t[h[p].getIndex()];R.scaleAndAdd(u,u,f,o)}}for(var m=e.getEdges(),g=m.length,v=[],u=R.create(),i=0;i<g;i++){R.set(u,0,0,0);var y=m[i],_=y.getHalfEdge(),x=_.getFlipHalfEdge(),b=_.getNextHalfEdge().getNextHalfEdge(),w=x.getNextHalfEdge().getNextHalfEdge(),_=_.getVertex(),x=x.getVertex(),b=b.getVertex(),w=w.getVertex(),_=t[_.getIndex()],x=t[x.getIndex()],b=t[b.getIndex()],w=t[w.getIndex()];R.scaleAndAdd(u,u,_,.375),R.scaleAndAdd(u,u,x,.375),R.scaleAndAdd(u,u,b,.125),R.scaleAndAdd(u,u,w,.125),v.push(I(e,y.getIndex(),u))}for(var E=e.getFaces(),M=E.length,i=0;i<M;i++){var T,S=E[i],a=(T=L(S)).length,S=T[1],A=T[3],P=T[5];O(e,S.getIndex(),A.getIndex());O(e,A.getIndex(),P.getIndex()),O(e,P.getIndex(),S.getIndex())}for(i=0;i<n;i++)R.copy(t[i],r[i])}},{"./../Queries/FaceVertices":398,"./../Queries/VertexNeighbors":403,"./InsertEdge":386,"./InsertVertex":387,"gl-matrix":356}],390:[function(e,t,n){e("./../Core/Mesh");var a=e("gl-matrix").vec3,s=a.create();t.exports=function(e,t){a.set(s,0,0,0);for(var n=e.positions,r=n.length,i=0;i<r;i++){var o=n[i];a.subtract(o,o,t)}}},{"./../Core/Mesh":371,"gl-matrix":356}],391:[function(e,t,n){e("./../Core/Vertex"),e("./../Core/Edge"),e("./../Core/HalfEdge"),e("./../Core/Face");var m=e("./../Queries/FaceHalfEdges"),g=e("./../Queries/FaceVertices"),v=(e("./../Queries/HalfEdgePrev"),e("./CreateFace"));t.exports=function(e,t,n,r){var i=e.getFaces(),t=i[t],o=(m(t),g(t)),a=o.length,n=i[n],s=(m(n),g(n));if(a!=s.length)throw"faces do not have the same number of vertices, can not create pipe";for(var c=[t,n],l=null!=r?r:2,u=0;u<a;u++){var h=u-l,d=(u+1)%a-l,p=c[u],f=!!p,h=v(e,[o[(h=a<=h?h%a:h)<0?a+h:h],o[(d=a<=d?d%a:d)<0?a+d:d],s[a-(u+1)],s[(a-u)%a]],p);f||i.push(h)}}},{"./../Core/Edge":368,"./../Core/Face":369,"./../Core/HalfEdge":370,"./../Core/Vertex":372,"./../Queries/FaceHalfEdges":397,"./../Queries/FaceVertices":398,"./../Queries/HalfEdgePrev":399,"./CreateFace":382}],392:[function(e,t,n){e("gl-matrix").vec3;var _=e("./../Queries/VertexNeighbors"),x=e("./../Queries/FaceVertices"),b=e("./InsertVertex"),w=e("./InsertEdge");t.exports=function(e){for(var t=e.getEdges(),n=t.length,r={},i=0;i<n;i++){var o=t[i];b(e,o.getIndex())}for(var a=e.getFaces(),s=a.length,i=0;i<s;i++){var c=a[i];r[c.getIndex()]=[];for(var l=(p=x(c)).length,u=0;u<l;u++){var h=p[u];2==_(h).length&&r[c.getIndex()].push(h)}}for(var d=Object.keys(r),i=0;i<d.length;i++){var p,f=d[i],m=(p=r[f])[0],g=p[1],v=p[2],y=p[3],m=w(e,m.getIndex(),v.getIndex()),v=b(e,m.edge.getIndex());r[f].push(v),w(e,g.getIndex(),v.getIndex()),w(e,y.getIndex(),v.getIndex())}}},{"./../Queries/FaceVertices":398,"./../Queries/VertexNeighbors":403,"./InsertEdge":386,"./InsertVertex":387,"gl-matrix":356}],393:[function(e,t,n){var s=e("./../Queries/MeshCentroid"),c=e("gl-matrix").vec3,l=c.create();t.exports=function(e,t){t.constructor!=Array&&(t=[t,t,t]),c.set(l,0,0,0);for(var n=s(e),r=e.positions,i=r.length,o=0;o<i;o++){var a=r[o];c.subtract(a,a,n),c.multiply(a,a,t),c.add(a,a,n)}}},{"./../Queries/MeshCentroid":400,"gl-matrix":356}],394:[function(e,t,n){var w=e("./../Queries/FaceVertices"),E=e("guf").calculateNormal,M=e("cga").triangulatePolygon2,T=e("gl-matrix").vec3,S=e("gl-matrix").quat,A=e("./InsertEdge");t.exports=function(e){for(var t=e.positions,n=e.getFaces(),r=n.length,i=T.fromValues(0,0,1),o=0;o<r;o++){var a=n[o],s=w(a),c=s.length;if(3!==c){for(var a=t[s[0].getIndex()],l=t[s[1].getIndex()],u=t[s[2].getIndex()],a=E(a,l,u),h=S.create(),d=(S.rotationTo(h,a,i),[]),p=[],f=0;f<c;f++){var m=s[f].getIndex(),g=T.clone(t[m]);T.transformQuat(g,g,h),d.push([g[0],g[1]]),p.push(m)}for(var v=M(d),y=v.length,_=0;_<y;_++){var x=v[_],b=p[x[1]];A(e,b,p[x[2]])}}}}},{"./../Queries/FaceVertices":398,"./InsertEdge":386,cga:25,"gl-matrix":356,guf:364}],395:[function(e,t,n){var z=e("./../Core/Vertex"),k=(e("./../Queries/FaceHalfEdges"),e("./../Queries/FaceVertices")),B=e("./../Queries/VertexHalfEdges"),V=e("./CreateFace"),G=e("guf").cross,W=e("guf").calculateNormal,q=e("cga").expandPolygon2,X=e("gl-matrix").vec3,Y=e("gl-matrix").quat,Q=X.create(),Z=X.create(),J=(X.create(),X.create(),X.fromValues(0,0,1));t.exports=function(e,t,n){var r=e.positions,i=e.getVertices(),o=i.length,a=e.getFaces(),F=a.length;t=null!=t?t:1,n=null!=n?n:t;for(var s=0;s<o;s++){var c=r[(R=i[s]).getIndex()],l=B(R),u=l.length;X.set(Q,0,0,0);for(var h=0;h<u;h++){var d=l[h],p=l[(h+1)%u],d=d.getNextHalfEdge(),p=p.getNextHalfEdge(),f=d.getVertex(),m=p.getVertex(),d=r[f.getIndex()],p=r[m.getIndex()];G(Z,d,c,p),X.add(Q,Q,Z)}X.normalize(Q,Q),X.scale(Q,Q,n);var g=X.create();X.add(g,c,Q),(R=new z).setIndex(i.length),i.push(R),r.push(g)}for(var v=0;v<F;v++){for(var y=a[v],_=k(y),x=_.length,f=r[_[0].getIndex()],m=r[_[1].getIndex()],b=r[_[2].getIndex()],w=W(f,m,b),E=Y.create(),M=(Y.rotationTo(E,w,J),[]),T=[],S=0,h=0;h<x;h++){var A=(R=_[h]).getIndex(),A=X.clone(r[A]);X.transformQuat(A,A,E),S=A[2],T.push([A[0],A[1]]),M.push(new z)}Y.rotationTo(E,J,w);for(var P=q(T,-t),D=P.length,s=0;s<D;s++){var R,L=P[s],L=X.fromValues(L[0],L[1],S);X.transformQuat(L,L,E),(R=M[s]).setIndex(i.length),r.push(L),i.push(R)}for(var H=[y],s=0;s<x;s++){var C,I=s,O=(s+1)%x,f=_[I],m=_[O],j=i[f.getIndex()+o],N=i[m.getIndex()+o],b=M[O],O=M[I],I=H[s],U=null==I;0<n?(C=V(e,[f,m,b,O],I),a.push(V(e,[j,O,b,N]))):(C=V(e,[O,b,m,f],I),a.push(V(e,[N,b,O,j]))),U&&a.push(C)}}}},{"./../Core/Vertex":372,"./../Queries/FaceHalfEdges":397,"./../Queries/FaceVertices":398,"./../Queries/VertexHalfEdges":402,"./CreateFace":382,cga:25,"gl-matrix":356,guf:364}],396:[function(e,t,n){t.exports=function(e){var t=[],e=e.getHalfEdge();return t.push(e.getVertex()),e=e.getFlipHalfEdge(),t.push(e.getVertex()),t}},{}],397:[function(e,t,n){t.exports=function(e){for(var t=he=e.getHalfEdge(),n=[];n.push(he),(he=he.getNextHalfEdge())!=t;);return n}},{}],398:[function(e,t,n){t.exports=function(e){for(var t=he=e.getHalfEdge(),n=[];n.push(he.getVertex()),(he=he.getNextHalfEdge())!=t;);return n}},{}],399:[function(e,t,n){t.exports=function(e){for(var t=e;e.getNextHalfEdge()!=t;)e=e.getNextHalfEdge();return e}},{}],400:[function(e,t,n){var o=e("gl-matrix").vec3;t.exports=function(e){for(var t=o.create(),n=e.positions,r=n.length,i=0;i<r;i++)o.add(t,t,n[i]);return o.scale(t,t,1/r),t}},{"gl-matrix":356}],401:[function(e,t,n){t.exports=function(e){for(var t=originalHalfEdge=he=e.getHalfEdge(),n=[];he.getNextHalfEdge()===t?(n.push(he.getFace()),t=he=he.getFlipHalfEdge()):he=he.getNextHalfEdge(),he!=originalHalfEdge;);return n}},{}],402:[function(e,t,n){t.exports=function(e){for(var t=originalHalfEdge=he=e.getHalfEdge(),n=[];he.getNextHalfEdge()===t?(t=he=he.getFlipHalfEdge(),n.push(he)):he=he.getNextHalfEdge(),he!=originalHalfEdge;);return n}},{}],403:[function(e,t,n){t.exports=function(e){for(var t=originalHalfEdge=he=e.getHalfEdge(),n=[];he.getNextHalfEdge()===t?(n.push(he.getVertex()),t=he=he.getFlipHalfEdge()):he=he.getNextHalfEdge(),he!=originalHalfEdge;);return n}},{}],404:[function(e,t,n){var r,i,t=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}try{r="function"==typeof setTimeout?setTimeout:o}catch(e){r=o}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(e){i=a}function s(t){if(r===setTimeout)return setTimeout(t,0);if((r===o||!r)&&setTimeout)return(r=setTimeout)(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}var c,l=[],u=!1,h=-1;function d(){u&&c&&(u=!1,c.length?l=c.concat(l):h=-1,l.length)&&p()}function p(){if(!u){for(var e=s(d),t=(u=!0,l.length);t;){for(c=l,l=[];++h<t;)c&&c[h].run();h=-1,t=l.length}c=null,u=!1,!function(t){if(i===clearTimeout)return clearTimeout(t);if((i===a||!i)&&clearTimeout)return(i=clearTimeout)(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}t.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new f(e,t)),1!==l.length||u||s(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=m,t.addListener=m,t.once=m,t.off=m,t.removeListener=m,t.removeAllListeners=m,t.emit=m,t.prependListener=m,t.prependOnceListener=m,t.listeners=function(e){return[]},t.binding=function(e){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(e){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},{}],405:[function(e,t,n){function h(){var r=4022871197;return function(e){if(e){e=e.toString();for(var t=0;t<e.length;t++){var n=.02519603282416938*(r+=e.charCodeAt(t));r=(n=(n-(r=n>>>0))*r)>>>0,r+=4294967296*(n-=r)}return 2.3283064365386963e-10*(r>>>0)}r=4022871197}}function r(e){for(var t,n=48,r=1,i=n,o=new Array(n),a=0,s=new h,c=0;c<n;c++)o[c]=s(Math.random());function l(e){return Math.floor(e*(u()+11102230246251565e-32*(2097152*u()|0)))}var u=function(){++i>=n&&(i=0);var e=1768863*o[i]+2.3283064365386963e-10*r;return o[i]=e-(r=0|e)};return l.string=function(e){for(var t="",n=0;n<e;n++)t+=String.fromCharCode(33+l(94));return t},l.cleanString=function(e){return e=(e=(e=e.replace(/(^\s*)|(\s*$)/gi,"")).replace(/[\x00-\x1F]/gi,"")).replace(/\n /,"\n")},l.hashString=function(e){for(e=l.cleanString(e),s(e),c=0;c<e.length;c++)for(a=e.charCodeAt(c),t=0;t<n;t++)o[t]-=s(a),o[t]<0&&(o[t]+=1)},l.seed=function(e){"string"!=typeof(e=null==e?Math.random():e)&&(e=d(e,function(e,t){return"function"==typeof t?t.toString():t})),l.initState(),l.hashString(e)},l.addEntropy=function(){var e=[];for(c=0;c<arguments.length;c++)e.push(arguments[c]);!function(){var e=Array.prototype.slice.call(arguments);for(c=0;c<e.length;c++)for(t=0;t<n;t++)o[t]-=s(e[c]),o[t]<0&&(o[t]+=1)}(a+++(new Date).getTime()+e.join("")+Math.random())},l.initState=function(){for(s(),c=0;c<n;c++)o[c]=s(" ");r=1,i=n},l.done=function(){s=null},void 0!==e&&l.seed(e),(l.range=l).random=function(){return l(Number.MAX_VALUE-1)/Number.MAX_VALUE},l.floatBetween=function(e,t){return l.random()*(t-e)+e},l.intBetween=function(e,t){return Math.floor(l.random()*(t-e+1))+e},l}var d=e("json-stringify-safe");r.create=function(e){return new r(e)},t.exports=r},{"json-stringify-safe":366}],406:[function(e,R,t){!function(P){!function(){function o(e,t,n,r){var i,o,a,s,t=t&&t.prototype instanceof l?t:l,t=Object.create(t.prototype),r=new u(r||[]);return t._invoke=(i=e,o=n,a=r,s=f,function(e,t){if(s===g)throw new Error("Generator is already running");if(s===v){if("throw"===e)throw t;return h()}for(a.method=e,a.arg=t;;){var n=a.delegate;if(n){n=function e(t,n){var r=t.iterator[n.method];if(r===p){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=p,e(t,n),"throw"===n.method))return y;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}r=c(r,t.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,y;r=r.arg;if(!r)return n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y;{if(!r.done)return r;n[t.resultName]=r.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=p)}n.delegate=null;return y}(n,a);if(n){if(n===y)continue;return n}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(s===f)throw s=v,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s=g;n=c(i,o,a);if("normal"===n.type){if(s=a.done?v:m,n.arg!==y)return{value:n.arg,done:a.done}}else"throw"===n.type&&(s=v,a.method="throw",a.arg=n.arg)}}),t}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}function l(){}function t(){}function n(){}function e(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function a(o){function a(e,t,n,r){var i,e=c(o[e],o,t);if("throw"!==e.type)return(t=(i=e.arg).value)&&"object"==typeof t&&w.call(t,"__await")?Promise.resolve(t.__await).then(function(e){a("next",e,n,r)},function(e){a("throw",e,n,r)}):Promise.resolve(t).then(function(e){i.value=e,n(i)},r);r(e.arg)}var t;"object"==typeof d.process&&d.process.domain&&(a=d.process.domain.bind(a)),this._invoke=function(n,r){function e(){return new Promise(function(e,t){a(n,r,e,t)})}return t=t?t.then(e,e):e()}}function r(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function s(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function u(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(r,this),this.reset(!0)}function i(t){if(t){var n,e=t[M];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return n=-1,(e=function e(){for(;++n<t.length;)if(w.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=p,e.done=!0,e}).next=e}return{next:h}}function h(){return{value:p,done:!0}}var d,p,f,m,g,v,y,_,x,b,w,E,M,T,S,A;d="object"==typeof P?P:"object"==typeof window?window:"object"==typeof self?self:this,b=Object.prototype,w=b.hasOwnProperty,E="function"==typeof Symbol?Symbol:{},M=E.iterator||"@@iterator",T=E.asyncIterator||"@@asyncIterator",S=E.toStringTag||"@@toStringTag",E="object"==typeof R,(A=d.regeneratorRuntime)?E&&(R.exports=A):((A=d.regeneratorRuntime=E?R.exports:{}).wrap=o,f="suspendedStart",m="suspendedYield",g="executing",v="completed",y={},(E={})[M]=function(){return this},(_=(_=Object.getPrototypeOf)&&_(_(i([]))))&&_!==b&&w.call(_,M)&&(E=_),x=n.prototype=l.prototype=Object.create(E),(t.prototype=x.constructor=n).constructor=t,n[S]=t.displayName="GeneratorFunction",A.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===t||"GeneratorFunction"===(e.displayName||e.name))},A.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,n):(e.__proto__=n,S in e||(e[S]="GeneratorFunction")),e.prototype=Object.create(x),e},A.awrap=function(e){return{__await:e}},e(a.prototype),a.prototype[T]=function(){return this},A.AsyncIterator=a,A.async=function(e,t,n,r){var i=new a(o(e,t,n,r));return A.isGeneratorFunction(t)?i:i.next().then(function(e){return e.done?e.value:i.next()})},e(x),x[S]="Generator",x[M]=function(){return this},x.toString=function(){return"[object Generator]"},A.keys=function(n){var e,r=[];for(e in n)r.push(e);return r.reverse(),function e(){for(;r.length;){var t=r.pop();if(t in n)return e.value=t,e.done=!1,e}return e.done=!0,e}},A.values=i,u.prototype={constructor:u,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=p,this.done=!1,this.delegate=null,this.method="next",this.arg=p,this.tryEntries.forEach(s),!e)for(var t in this)"t"===t.charAt(0)&&w.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=p)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var r=this;function e(e,t){return o.type="throw",o.arg=n,r.next=e,t&&(r.method="next",r.arg=p),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var i=this.tryEntries[t],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var a=w.call(i,"catchLoc"),s=w.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;0<=n;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&w.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}var o=(i=i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc?null:i)?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),s(n),y}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n,r,i=this.tryEntries[t];if(i.tryLoc===e)return"throw"===(n=i.completion).type&&(r=n.arg,s(i)),r}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:i(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=p),y}})}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],407:[function(e,t,n){var r,i;r=this,i=function(e){function l(){}void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}),void 0===Math.sign&&(Math.sign=function(e){return e<0?-1:0<e?1:+e}),"name"in Function.prototype==!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t}),Object.assign(l.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)},hasEventListener:function(e,t){var n;return void 0!==this._listeners&&void 0!==(n=this._listeners)[e]&&-1!==n[e].indexOf(t)},removeEventListener:function(e,t){var n;void 0!==this._listeners&&void 0!==(e=this._listeners[e])&&-1!==(n=e.indexOf(t))&&e.splice(n,1)},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var n=t.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,e)}}}});var h,p,M,T,L,C,I,O,j,N,i,F,D,H,U,z,k,B,V,G,W,q,X,Y=0,Q=1,J=2,K=1,$=2,ee=0,ne=1,re=2,ie=0,oe=1,ae=2,se=3,ce=4,le=5,ue=100,he=101,me=102,ge=103,ve=104,ye=200,_e=201,xe=202,be=203,we=204,Ee=205,Me=206,Te=207,Se=208,Oe=209,je=210,Ne=0,Fe=1,De=2,He=3,Ue=4,ze=5,ke=6,Be=7,Ve=0,Ge=1,We=2,qe=0,Xe=1,Ye=2,Qe=3,Ze=4,Je=301,Ke=302,$e=303,et=304,tt=305,nt=306,rt=307,it=1e3,S=1001,ot=1002,P=1003,at=1004,st=1005,A=1006,ct=1007,lt=1008,ut=1009,ht=1010,dt=1011,pt=1012,ft=1013,mt=1014,gt=1015,vt=1016,yt=1017,_t=1018,xt=1019,bt=1020,wt=1021,Et=1022,Mt=1023,Tt=1024,St=1025,At=Mt,Pt=1026,Rt=1027,Lt=2001,Ct=2002,It=2003,Ot=2004,jt=2100,Nt=2101,Ft=2102,Dt=2103,Ht=2151,Ut=0,zt=3e3,kt=3001,Bt=3007,Vt=3002,Gt=3004,Wt=3005,qt=3006,Xt=3200,Yt=3201,Ae={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:(p="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),M=0,function(){for(var e="",t=0;t<36;t++)8===t||13===t||18===t||23===t?e+="-":14===t?e+="4":(M<=2&&(M=33554432+16777216*Math.random()|0),h=15&M,M>>=4,e+=p[19===t?3&h|8:h]);return e}),clamp:function(e,t,n){return Math.max(t,Math.min(n,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)},lerp:function(e,t,n){return(1-n)*e+n*t},smoothstep:function(e,t,n){return e<=t?0:n<=e?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:n<=e?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*Ae.DEG2RAD},radToDeg:function(e){return e*Ae.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}};function de(e,t){this.x=e||0,this.y=t||0}function Pe(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function u(e,t,n,r){this._x=e||0,this._y=t||0,this._z=n||0,this._w=void 0!==r?r:1}function Re(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0}function R(){this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.defineProperties(de.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),Object.assign(de.prototype,{isVector2:!0,set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.x=e,this.y=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){var t=this.x,n=this.y,e=e.elements;return this.x=e[0]*t+e[3]*n+e[6],this.y=e[1]*t+e[4]*n+e[7],this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},clampScalar:(T=new de,L=new de,function(e,t){return T.set(e,e),L.set(t,t),this.clamp(T,L)}),clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var e=Math.atan2(this.y,this.x);return e<0&&(e+=2*Math.PI),e},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,e=this.y-e.y;return t*t+e*e},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return this.x=e[t=void 0===t?0:t],this.y=e[t+1],this},toArray:function(e,t){return(e=void 0===e?[]:e)[t=void 0===t?0:t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(e,t){var n=Math.cos(t),t=Math.sin(t),r=this.x-e.x,i=this.y-e.y;return this.x=r*n-i*t+e.x,this.y=r*t+i*n+e.y,this}}),Object.assign(Pe.prototype,{isMatrix4:!0,set:function(e,t,n,r,i,o,a,s,c,l,u,h,d,p,f,m){var g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=r,g[1]=i,g[5]=o,g[9]=a,g[13]=s,g[2]=c,g[6]=l,g[10]=u,g[14]=h,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new Pe).fromArray(this.elements)},copy:function(e){var t=this.elements,e=e.elements;return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],this},copyPosition:function(e){var t=this.elements,e=e.elements;return t[12]=e[12],t[13]=e[13],t[14]=e[14],this},extractBasis:function(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this},extractRotation:(F=new Re,function(e){var t=this.elements,n=e.elements,r=1/F.setFromMatrixColumn(e,0).length(),i=1/F.setFromMatrixColumn(e,1).length(),e=1/F.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[8]=n[8]*e,t[9]=n[9]*e,t[10]=n[10]*e,this}),makeRotationFromEuler:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t,n,r,i,o,a,s,c,l,u,h,d,p=this.elements,f=e.x,m=e.y,g=e.z,v=Math.cos(f),f=Math.sin(f),y=Math.cos(m),m=Math.sin(m),_=Math.cos(g),g=Math.sin(g);return"XYZ"===e.order?(o=v*_,a=v*g,s=f*_,c=f*g,p[0]=y*_,p[4]=-y*g,p[8]=m,p[1]=a+s*m,p[5]=o-c*m,p[9]=-f*y,p[2]=c-o*m,p[6]=s+a*m,p[10]=v*y):"YXZ"===e.order?(n=y*g,r=m*_,p[0]=(t=y*_)+(i=m*g)*f,p[4]=r*f-n,p[8]=v*m,p[1]=v*g,p[5]=v*_,p[9]=-f,p[2]=n*f-r,p[6]=i+t*f,p[10]=v*y):"ZXY"===e.order?(n=y*g,r=m*_,p[0]=(t=y*_)-(i=m*g)*f,p[4]=-v*g,p[8]=r+n*f,p[1]=n+r*f,p[5]=v*_,p[9]=i-t*f,p[2]=-v*m,p[6]=f,p[10]=v*y):"ZYX"===e.order?(o=v*_,a=v*g,s=f*_,c=f*g,p[0]=y*_,p[4]=s*m-a,p[8]=o*m+c,p[1]=y*g,p[5]=c*m+o,p[9]=a*m-s,p[2]=-m,p[6]=f*y,p[10]=v*y):"YZX"===e.order?(l=v*y,u=v*m,h=f*y,d=f*m,p[0]=y*_,p[4]=d-l*g,p[8]=h*g+u,p[1]=g,p[5]=v*_,p[9]=-f*_,p[2]=-m*_,p[6]=u*g+h,p[10]=l-d*g):"XZY"===e.order&&(l=v*y,u=v*m,h=f*y,d=f*m,p[0]=y*_,p[4]=-g,p[8]=m*_,p[1]=l*g+d,p[5]=v*_,p[9]=u*g-h,p[2]=h*g-u,p[6]=f*_,p[10]=d*g+l),p[3]=0,p[7]=0,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,this},makeRotationFromQuaternion:function(e){var t=this.elements,n=e._x,r=e._y,i=e._z,e=e._w,o=n+n,a=r+r,s=i+i,c=n*o,l=n*a,n=n*s,u=r*a,r=r*s,i=i*s,o=e*o,a=e*a,e=e*s;return t[0]=1-(u+i),t[4]=l-e,t[8]=n+a,t[1]=l+e,t[5]=1-(c+i),t[9]=r-o,t[2]=n-a,t[6]=r+o,t[10]=1-(c+u),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},lookAt:(j=new Re,N=new Re,i=new Re,function(e,t,n){var r=this.elements;return i.subVectors(e,t),0===i.lengthSq()&&(i.z=1),i.normalize(),j.crossVectors(n,i),0===j.lengthSq()&&(1===Math.abs(n.z)?i.x+=1e-4:i.z+=1e-4,i.normalize(),j.crossVectors(n,i)),j.normalize(),N.crossVectors(i,j),r[0]=j.x,r[4]=N.x,r[8]=i.x,r[1]=j.y,r[5]=N.y,r[9]=i.y,r[2]=j.z,r[6]=N.z,r[10]=i.z,this}),multiply:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var e=e.elements,t=t.elements,n=this.elements,r=e[0],i=e[4],o=e[8],a=e[12],s=e[1],c=e[5],l=e[9],u=e[13],h=e[2],d=e[6],p=e[10],f=e[14],m=e[3],g=e[7],v=e[11],e=e[15],y=t[0],_=t[4],x=t[8],b=t[12],w=t[1],E=t[5],M=t[9],T=t[13],S=t[2],A=t[6],P=t[10],R=t[14],L=t[3],C=t[7],I=t[11],t=t[15];return n[0]=r*y+i*w+o*S+a*L,n[4]=r*_+i*E+o*A+a*C,n[8]=r*x+i*M+o*P+a*I,n[12]=r*b+i*T+o*R+a*t,n[1]=s*y+c*w+l*S+u*L,n[5]=s*_+c*E+l*A+u*C,n[9]=s*x+c*M+l*P+u*I,n[13]=s*b+c*T+l*R+u*t,n[2]=h*y+d*w+p*S+f*L,n[6]=h*_+d*E+p*A+f*C,n[10]=h*x+d*M+p*P+f*I,n[14]=h*b+d*T+p*R+f*t,n[3]=m*y+g*w+v*S+e*L,n[7]=m*_+g*E+v*A+e*C,n[11]=m*x+g*M+v*P+e*I,n[15]=m*b+g*T+v*R+e*t,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},applyToBufferAttribute:(O=new Re,function(e){for(var t=0,n=e.count;t<n;t++)O.x=e.getX(t),O.y=e.getY(t),O.z=e.getZ(t),O.applyMatrix4(this),e.setXYZ(t,O.x,O.y,O.z);return e}),determinant:function(){var e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],o=e[1],a=e[5],s=e[9],c=e[13],l=e[2],u=e[6],h=e[10],d=e[14];return e[3]*(+i*s*u-r*c*u-i*a*h+n*c*h+r*a*d-n*s*d)+e[7]*(+t*s*d-t*c*h+i*o*h-r*o*d+r*c*l-i*s*l)+e[11]*(+t*c*u-t*a*d-i*o*u+n*o*d+i*a*l-n*c*l)+e[15]*(-r*a*l-t*s*u+t*a*h+r*o*u-n*o*h+n*s*l)},transpose:function(){var e=this.elements,t=e[1];return e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(e){var t=this.elements;return t[12]=e.x,t[13]=e.y,t[14]=e.z,this},getInverse:function(e,t){var n=this.elements,e=e.elements,r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],c=e[5],l=e[6],u=e[7],h=e[8],d=e[9],p=e[10],f=e[11],m=e[12],g=e[13],v=e[14],e=e[15],y=d*v*u-g*p*u+g*l*f-c*v*f-d*l*e+c*p*e,_=m*p*u-h*v*u-m*l*f+s*v*f+h*l*e-s*p*e,x=h*g*u-m*d*u+m*c*f-s*g*f-h*c*e+s*d*e,b=m*d*l-h*g*l-m*c*p+s*g*p+h*c*v-s*d*v,w=r*y+i*_+o*x+a*b;if(0==w){var E="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(E);return console.warn(E),this.identity()}t=1/w;return n[0]=y*t,n[1]=(g*p*a-d*v*a-g*o*f+i*v*f+d*o*e-i*p*e)*t,n[2]=(c*v*a-g*l*a+g*o*u-i*v*u-c*o*e+i*l*e)*t,n[3]=(d*l*a-c*p*a-d*o*u+i*p*u+c*o*f-i*l*f)*t,n[4]=_*t,n[5]=(h*v*a-m*p*a+m*o*f-r*v*f-h*o*e+r*p*e)*t,n[6]=(m*l*a-s*v*a-m*o*u+r*v*u+s*o*e-r*l*e)*t,n[7]=(s*p*a-h*l*a+h*o*u-r*p*u-s*o*f+r*l*f)*t,n[8]=x*t,n[9]=(m*d*a-h*g*a-m*i*f+r*g*f+h*i*e-r*d*e)*t,n[10]=(s*g*a-m*c*a+m*i*u-r*g*u-s*i*e+r*c*e)*t,n[11]=(h*c*a-s*d*a-h*i*u+r*d*u+s*i*f-r*c*f)*t,n[12]=b*t,n[13]=(h*g*o-m*d*o+m*i*p-r*g*p-h*i*v+r*d*v)*t,n[14]=(m*c*o-s*g*o-m*i*l+r*g*l+s*i*v-r*c*v)*t,n[15]=(s*d*o-h*c*o+h*i*l-r*d*l-s*i*p+r*c*p)*t,this},scale:function(e){var t=this.elements,n=e.x,r=e.y,e=e.z;return t[0]*=n,t[4]*=r,t[8]*=e,t[1]*=n,t[5]*=r,t[9]*=e,t[2]*=n,t[6]*=r,t[10]*=e,t[3]*=n,t[7]*=r,t[11]*=e,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];return Math.sqrt(Math.max(t,e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))},makeTranslation:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),e=Math.sin(e);return this.set(1,0,0,0,0,t,-e,0,0,e,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),e=Math.sin(e);return this.set(t,0,e,0,0,1,0,0,-e,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),e=Math.sin(e);return this.set(t,-e,0,0,e,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var n=Math.cos(t),t=Math.sin(t),r=1-n,i=e.x,o=e.y,e=e.z,a=r*i,s=r*o;return this.set(a*i+n,a*o-t*e,a*e+t*o,0,a*o+t*e,s*o+n,s*e-t*i,0,a*e-t*o,s*e+t*i,r*e*e+n,0,0,0,0,1),this},makeScale:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(e,t,n){return this.set(1,t,n,0,e,1,n,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,n){return this.makeRotationFromQuaternion(t),this.scale(n),this.setPosition(e),this},decompose:(C=new Re,I=new Pe,function(e,t,n){var r=this.elements,i=C.set(r[0],r[1],r[2]).length(),o=C.set(r[4],r[5],r[6]).length(),a=C.set(r[8],r[9],r[10]).length(),e=(this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],I.copy(this),1/i),r=1/o,s=1/a;return I.elements[0]*=e,I.elements[1]*=e,I.elements[2]*=e,I.elements[4]*=r,I.elements[5]*=r,I.elements[6]*=r,I.elements[8]*=s,I.elements[9]*=s,I.elements[10]*=s,t.setFromRotationMatrix(I),n.x=i,n.y=o,n.z=a,this}),makePerspective:function(e,t,n,r,i,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements,s=2*i/(n-r),c=(t+e)/(t-e),n=(n+r)/(n-r),r=-(o+i)/(o-i),o=-2*o*i/(o-i);return a[0]=2*i/(t-e),a[4]=0,a[8]=c,a[12]=0,a[1]=0,a[5]=s,a[9]=n,a[13]=0,a[2]=0,a[6]=0,a[10]=r,a[14]=o,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(e,t,n,r,i,o){var a=this.elements,s=1/(t-e),c=1/(n-r),l=1/(o-i),t=(t+e)*s,e=(n+r)*c,n=(o+i)*l;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-t,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-e,a[2]=0,a[6]=0,a[10]=-2*l,a[14]=-n,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(e){for(var t=this.elements,n=e.elements,r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var n=0;n<16;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){var n=this.elements;return(e=void 0===e?[]:e)[t=void 0===t?0:t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}),Object.assign(u,{slerp:function(e,t,n,r){return n.copy(e).slerp(t,r)},slerpFlat:function(e,t,n,r,i,o,a){var s,c,l,u=n[r+0],h=n[r+1],d=n[r+2],n=n[r+3],r=i[o+0],p=i[o+1],f=i[o+2],i=i[o+3];n===i&&u===r&&h===p&&d===f||(o=1-a,s=0<=(c=u*r+h*p+d*f+n*i)?1:-1,(l=1-c*c)>Number.EPSILON&&(l=Math.sqrt(l),c=Math.atan2(l,c*s),o=Math.sin(o*c)/l,a=Math.sin(a*c)/l),u=u*o+r*(c=a*s),h=h*o+p*c,d=d*o+f*c,n=n*o+i*c,o===1-a&&(u*=l=1/Math.sqrt(u*u+h*h+d*d+n*n),h*=l,d*=l,n*=l)),e[t]=u,e[t+1]=h,e[t+2]=d,e[t+3]=n}}),Object.defineProperties(u.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this.onChangeCallback()}}}),Object.assign(u.prototype,{set:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this.onChangeCallback(),this},setFromEuler:function(e,t){var n,r,i,o,a,s,c;if(e&&e.isEuler)return a=e._x,s=e._y,n=e._z,e=e.order,o=Math.cos,c=Math.sin,r=o(a/2),i=o(s/2),o=o(n/2),a=c(a/2),s=c(s/2),c=c(n/2),"XYZ"===e?(this._x=a*i*o+r*s*c,this._y=r*s*o-a*i*c,this._z=r*i*c+a*s*o,this._w=r*i*o-a*s*c):"YXZ"===e?(this._x=a*i*o+r*s*c,this._y=r*s*o-a*i*c,this._z=r*i*c-a*s*o,this._w=r*i*o+a*s*c):"ZXY"===e?(this._x=a*i*o-r*s*c,this._y=r*s*o+a*i*c,this._z=r*i*c+a*s*o,this._w=r*i*o-a*s*c):"ZYX"===e?(this._x=a*i*o-r*s*c,this._y=r*s*o+a*i*c,this._z=r*i*c-a*s*o,this._w=r*i*o+a*s*c):"YZX"===e?(this._x=a*i*o+r*s*c,this._y=r*s*o+a*i*c,this._z=r*i*c-a*s*o,this._w=r*i*o-a*s*c):"XZY"===e&&(this._x=a*i*o-r*s*c,this._y=r*s*o-a*i*c,this._z=r*i*c+a*s*o,this._w=r*i*o+a*s*c),!1!==t&&this.onChangeCallback(),this;throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.")},setFromAxisAngle:function(e,t){var t=t/2,n=Math.sin(t);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(t),this.onChangeCallback(),this},setFromRotationMatrix:function(e){var t,e=e.elements,n=e[0],r=e[4],i=e[8],o=e[1],a=e[5],s=e[9],c=e[2],l=e[6],e=e[10],u=n+a+e;return 0<u?(t=.5/Math.sqrt(u+1),this._w=.25/t,this._x=(l-s)*t,this._y=(i-c)*t,this._z=(o-r)*t):a<n&&e<n?(t=2*Math.sqrt(1+n-a-e),this._w=(l-s)/t,this._x=.25*t,this._y=(r+o)/t,this._z=(i+c)/t):e<a?(t=2*Math.sqrt(1+a-n-e),this._w=(i-c)/t,this._x=(r+o)/t,this._y=.25*t,this._z=(s+l)/t):(t=2*Math.sqrt(1+e-n-a),this._w=(o-r)/t,this._x=(i+c)/t,this._y=(s+l)/t,this._z=.25*t),this.onChangeCallback(),this},setFromUnitVectors:(H=new Re,function(e,t){return void 0===H&&(H=new Re),(D=e.dot(t)+1)<1e-6?(D=0,Math.abs(e.x)>Math.abs(e.z)?H.set(-e.y,e.x,0):H.set(0,-e.z,e.y)):H.crossVectors(e,t),this._x=H.x,this._y=H.y,this._z=H.z,this._w=D,this.normalize()}),inverse:function(){return this.conjugate().normalize()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(this._x=this._x*(e=1/e),this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this.onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){var n=e._x,r=e._y,i=e._z,e=e._w,o=t._x,a=t._y,s=t._z,t=t._w;return this._x=n*t+e*o+r*s-i*a,this._y=r*t+e*a+i*o-n*s,this._z=i*t+e*s+n*a-r*o,this._w=e*t-n*o-r*a-i*s,this.onChangeCallback(),this},slerp:function(e,t){if(0!==t){if(1===t)return this.copy(e);var n,r=this._x,i=this._y,o=this._z,a=this._w,s=a*e._w+r*e._x+i*e._y+o*e._z;s<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,s=-s):this.copy(e),1<=s?(this._w=a,this._x=r,this._y=i,this._z=o):(e=Math.sqrt(1-s*s),Math.abs(e)<.001?(this._w=.5*(a+this._w),this._x=.5*(r+this._x),this._y=.5*(i+this._y),this._z=.5*(o+this._z)):(s=Math.atan2(e,s),n=Math.sin((1-t)*s)/e,t=Math.sin(t*s)/e,this._w=a*n+this._w*t,this._x=r*n+this._x*t,this._y=i*n+this._y*t,this._z=o*n+this._z*t,this.onChangeCallback()))}return this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return this._x=e[t=void 0===t?0:t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this.onChangeCallback(),this},toArray:function(e,t){return(e=void 0===e?[]:e)[t=void 0===t?0:t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(Re.prototype,{isVector3:!0,set:function(e,t,n){return this.x=e,this.y=t,this.z=n,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:(q=new u,function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(q.setFromEuler(e))}),applyAxisAngle:(W=new u,function(e,t){return this.applyQuaternion(W.setFromAxisAngle(e,t))}),applyMatrix3:function(e){var t=this.x,n=this.y,r=this.z,e=e.elements;return this.x=e[0]*t+e[3]*n+e[6]*r,this.y=e[1]*t+e[4]*n+e[7]*r,this.z=e[2]*t+e[5]*n+e[8]*r,this},applyMatrix4:function(e){var t=this.x,n=this.y,r=this.z,e=e.elements,i=1/(e[3]*t+e[7]*n+e[11]*r+e[15]);return this.x=(e[0]*t+e[4]*n+e[8]*r+e[12])*i,this.y=(e[1]*t+e[5]*n+e[9]*r+e[13])*i,this.z=(e[2]*t+e[6]*n+e[10]*r+e[14])*i,this},applyQuaternion:function(e){var t=this.x,n=this.y,r=this.z,i=e.x,o=e.y,a=e.z,e=e.w,s=e*t+o*r-a*n,c=e*n+a*t-i*r,l=e*r+i*n-o*t,t=-i*t-o*n-a*r;return this.x=s*e+t*-i+c*-a-l*-o,this.y=c*e+t*-o+l*-i-s*-a,this.z=l*e+t*-a+s*-o-c*-i,this},project:(G=new Pe,function(e){return G.multiplyMatrices(e.projectionMatrix,G.getInverse(e.matrixWorld)),this.applyMatrix4(G)}),unproject:(V=new Pe,function(e){return V.multiplyMatrices(e.matrixWorld,V.getInverse(e.projectionMatrix)),this.applyMatrix4(V)}),transformDirection:function(e){var t=this.x,n=this.y,r=this.z,e=e.elements;return this.x=e[0]*t+e[4]*n+e[8]*r,this.y=e[1]*t+e[5]*n+e[9]*r,this.z=e[2]*t+e[6]*n+e[10]*r,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},clampScalar:(k=new Re,B=new Re,function(e,t){return k.set(e,e,e),B.set(t,t,t),this.clamp(k,B)}),clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},cross:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)},crossVectors:function(e,t){var n=e.x,r=e.y,e=e.z,i=t.x,o=t.y,t=t.z;return this.x=r*t-e*o,this.y=e*i-n*t,this.z=n*o-r*i,this},projectOnVector:function(e){var t=e.dot(this)/e.lengthSq();return this.copy(e).multiplyScalar(t)},projectOnPlane:(z=new Re,function(e){return z.copy(this).projectOnVector(e),this.sub(z)}),reflect:(U=new Re,function(e){return this.sub(U.copy(e).multiplyScalar(2*this.dot(e)))}),angleTo:function(e){e=this.dot(e)/Math.sqrt(this.lengthSq()*e.lengthSq());return Math.acos(Ae.clamp(e,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y,e=this.z-e.z;return t*t+n*n+e*e},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){var t=Math.sin(e.phi)*e.radius;return this.x=t*Math.sin(e.theta),this.y=Math.cos(e.phi)*e.radius,this.z=t*Math.cos(e.theta),this},setFromCylindrical:function(e){return this.x=e.radius*Math.sin(e.theta),this.y=e.y,this.z=e.radius*Math.cos(e.theta),this},setFromMatrixPosition:function(e){e=e.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),e=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=e,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,4*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return this.x=e[t=void 0===t?0:t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return(e=void 0===e?[]:e)[t=void 0===t?0:t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}}),Object.assign(R.prototype,{isMatrix3:!0,set:function(e,t,n,r,i,o,a,s,c){var l=this.elements;return l[0]=e,l[1]=r,l[2]=a,l[3]=t,l[4]=i,l[5]=s,l[6]=n,l[7]=o,l[8]=c,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(e){var t=this.elements,e=e.elements;return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],this},setFromMatrix4:function(e){e=e.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},applyToBufferAttribute:(X=new Re,function(e){for(var t=0,n=e.count;t<n;t++)X.x=e.getX(t),X.y=e.getY(t),X.z=e.getZ(t),X.applyMatrix3(this),e.setXYZ(t,X.x,X.y,X.z);return e}),multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var e=e.elements,t=t.elements,n=this.elements,r=e[0],i=e[3],o=e[6],a=e[1],s=e[4],c=e[7],l=e[2],u=e[5],e=e[8],h=t[0],d=t[3],p=t[6],f=t[1],m=t[4],g=t[7],v=t[2],y=t[5],t=t[8];return n[0]=r*h+i*f+o*v,n[3]=r*d+i*m+o*y,n[6]=r*p+i*g+o*t,n[1]=a*h+s*f+c*v,n[4]=a*d+s*m+c*y,n[7]=a*p+s*g+c*t,n[2]=l*h+u*f+e*v,n[5]=l*d+u*m+e*y,n[8]=l*p+u*g+e*t,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],c=e[7],e=e[8];return t*o*e-t*a*c-n*i*e+n*a*s+r*i*c-r*o*s},getInverse:function(e,t){e&&e.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var e=e.elements,n=this.elements,r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],c=e[5],l=e[6],u=e[7],e=e[8],h=e*s-c*u,d=c*l-e*a,p=u*a-s*l,f=r*h+i*d+o*p;if(0==f){var m="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(m);return console.warn(m),this.identity()}t=1/f;return n[0]=h*t,n[1]=(o*u-e*i)*t,n[2]=(c*i-o*s)*t,n[3]=d*t,n[4]=(e*r-o*l)*t,n[5]=(o*a-c*r)*t,n[6]=p*t,n[7]=(i*l-u*r)*t,n[8]=(s*r-i*a)*t,this},transpose:function(){var e=this.elements,t=e[1];return e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},setUvTransform:function(e,t,n,r,i,o,a){var s=Math.cos(i),i=Math.sin(i);this.set(n*s,n*i,-n*(s*o+i*a)+o+e,-r*i,r*s,-r*(-i*o+s*a)+a+t,0,0,1)},scale:function(e,t){var n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this},rotate:function(e){var t=Math.cos(e),e=Math.sin(e),n=this.elements,r=n[0],i=n[3],o=n[6],a=n[1],s=n[4],c=n[7];return n[0]=t*r+e*a,n[3]=t*i+e*s,n[6]=t*o+e*c,n[1]=-e*r+t*a,n[4]=-e*i+t*s,n[7]=-e*o+t*c,this},translate:function(e,t){var n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this},equals:function(e){for(var t=this.elements,n=e.elements,r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var n=0;n<9;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){var n=this.elements;return(e=void 0===e?[]:e)[t=void 0===t?0:t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}});var Qt,Zt,Jt=0;function d(e,t,n,r,i,o,a,s,c,l){Object.defineProperty(this,"id",{value:Jt++}),this.uuid=Ae.generateUUID(),this.name="",this.image=void 0!==e?e:d.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==t?t:d.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:S,this.wrapT=void 0!==r?r:S,this.magFilter=void 0!==i?i:A,this.minFilter=void 0!==o?o:lt,this.anisotropy=void 0!==c?c:1,this.format=void 0!==a?a:Mt,this.type=void 0!==s?s:ut,this.offset=new de(0,0),this.repeat=new de(1,1),this.center=new de(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new R,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==l?l:zt,this.version=0,this.onUpdate=null}function Le(e,t,n,r){this.x=e||0,this.y=t||0,this.z=n||0,this.w=void 0!==r?r:1}function Kt(e,t,n){this.uuid=Ae.generateUUID(),this.width=e,this.height=t,this.scissor=new Le(0,0,e,t),this.scissorTest=!1,this.viewport=new Le(0,0,e,t),void 0===(n=n||{}).minFilter&&(n.minFilter=A),this.texture=new d(void 0,void 0,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}function $t(e,t,n){Kt.call(this,e,t,n),this.activeCubeFace=0,this.activeMipMapLevel=0}function en(e,t,n,r,i,o,a,s,c,l,u,h){d.call(this,null,o,a,s,c,l,r,i,u,h),this.image={data:e,width:t,height:n},this.magFilter=void 0!==c?c:P,this.minFilter=void 0!==l?l:P,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function tn(e,t,n,r,i,o,a,s,c,l){d.call(this,e=void 0!==e?e:[],t=void 0!==t?t:Je,n,r,i,o,a,s,c,l),this.flipY=!1}d.DEFAULT_IMAGE=void 0,d.DEFAULT_MAPPING=300,Object.defineProperty(d.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(d.prototype,l.prototype,{constructor:d,isTexture:!0,clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){var t,n,r,i,o,a=void 0===e||"string"==typeof e;return a||void 0===e.textures[this.uuid]?(t={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY},void 0!==this.image&&(void 0===(n=this.image).uuid&&(n.uuid=Ae.generateUUID()),a||void 0!==e.images[n.uuid]||(e.images[n.uuid]={uuid:n.uuid,url:((r=n)instanceof HTMLCanvasElement?i=r:((i=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).width=r.width,i.height=r.height,o=i.getContext("2d"),r instanceof ImageData?o.putImageData(r,0,0):o.drawImage(r,0,0,r.width,r.height)),2048<i.width||2048<i.height?i.toDataURL("image/jpeg",.6):i.toDataURL("image/png"))}),t.image=n.uuid),a||(e.textures[this.uuid]=t),t):e.textures[this.uuid]},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(300===this.mapping){if(e.applyMatrix3(this.matrix),e.x<0||1<e.x)switch(this.wrapS){case it:e.x=e.x-Math.floor(e.x);break;case S:e.x=e.x<0?0:1;break;case ot:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||1<e.y)switch(this.wrapT){case it:e.y=e.y-Math.floor(e.y);break;case S:e.y=e.y<0?0:1;break;case ot:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}this.flipY&&(e.y=1-e.y)}}}),Object.assign(Le.prototype,{isVector4:!0,set:function(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,n=this.y,r=this.z,i=this.w,e=e.elements;return this.x=e[0]*t+e[4]*n+e[8]*r+e[12]*i,this.y=e[1]*t+e[5]*n+e[9]*r+e[13]*i,this.z=e[2]*t+e[6]*n+e[10]*r+e[14]*i,this.w=e[3]*t+e[7]*n+e[11]*r+e[15]*i,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,n,r,i,o,a,s,c,l,u,e=e.elements,h=e[0],d=e[4],p=e[8],f=e[1],m=e[5],g=e[9],v=e[2],y=e[6],e=e[10];return Math.abs(d-f)<.01&&Math.abs(p-v)<.01&&Math.abs(g-y)<.01?Math.abs(d+f)<.1&&Math.abs(p+v)<.1&&Math.abs(g+y)<.1&&Math.abs(h+m+e-3)<.1?this.set(1,0,0,0):(i=Math.PI,a=(e+1)/2,s=(d+f)/4,c=(p+v)/4,l=(g+y)/4,(o=(m+1)/2)<(u=(h+1)/2)&&a<u?r=u<.01?(t=0,n=.707106781):(n=s/(t=Math.sqrt(u)),c/t):a<o?r=o<.01?(n=0,t=.707106781):(t=s/(n=Math.sqrt(o)),l/n):a<.01?(n=t=.707106781,r=0):(t=c/(r=Math.sqrt(a)),n=l/r),this.set(t,n,r,i)):(u=Math.sqrt((y-g)*(y-g)+(p-v)*(p-v)+(f-d)*(f-d)),Math.abs(u)<.001&&(u=1),this.x=(y-g)/u,this.y=(p-v)/u,this.z=(f-d)/u,this.w=Math.acos((h+m+e-1)/2)),this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},clampScalar:function(e,t){return void 0===Qt&&(Qt=new Le,Zt=new Le),Qt.set(e,e,e,e),Zt.set(t,t,t,t),this.clamp(Qt,Zt)},clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return this.x=e[t=void 0===t?0:t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return(e=void 0===e?[]:e)[t=void 0===t?0:t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}}),Object.assign(Kt.prototype,l.prototype,{isWebGLRenderTarget:!0,setSize:function(e,t){this.width===e&&this.height===t||(this.width=e,this.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),(($t.prototype=Object.create(Kt.prototype)).constructor=$t).prototype.isWebGLRenderTargetCube=!0,((en.prototype=Object.create(d.prototype)).constructor=en).prototype.isDataTexture=!0,((tn.prototype=Object.create(d.prototype)).constructor=tn).prototype.isCubeTexture=!0,Object.defineProperty(tn.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}});var nn=new d,rn=new tn;function on(){this.seq=[],this.map={}}var an=[],sn=[],cn=new Float32Array(16),ln=new Float32Array(9);function un(e,t,n){var r=e[0];if(r<=0||0<r)return e;var i=t*n,o=an[i];if(void 0===o&&(o=new Float32Array(i),an[i]=o),0!==t){r.toArray(o,0);for(var a=1,s=0;a!==t;++a)e[a].toArray(o,s+=n)}return o}function hn(e,t){var n=sn[t];void 0===n&&(n=new Int32Array(t),sn[t]=n);for(var r=0;r!==t;++r)n[r]=e.allocTextureUnit();return n}function dn(e,t){e.uniform1f(this.addr,t)}function pn(e,t){e.uniform1i(this.addr,t)}function fn(e,t){void 0===t.x?e.uniform2fv(this.addr,t):e.uniform2f(this.addr,t.x,t.y)}function mn(e,t){void 0!==t.x?e.uniform3f(this.addr,t.x,t.y,t.z):void 0!==t.r?e.uniform3f(this.addr,t.r,t.g,t.b):e.uniform3fv(this.addr,t)}function gn(e,t){void 0===t.x?e.uniform4fv(this.addr,t):e.uniform4f(this.addr,t.x,t.y,t.z,t.w)}function vn(e,t){e.uniformMatrix2fv(this.addr,!1,t.elements||t)}function yn(e,t){void 0===t.elements?e.uniformMatrix3fv(this.addr,!1,t):(ln.set(t.elements),e.uniformMatrix3fv(this.addr,!1,ln))}function _n(e,t){void 0===t.elements?e.uniformMatrix4fv(this.addr,!1,t):(cn.set(t.elements),e.uniformMatrix4fv(this.addr,!1,cn))}function xn(e,t,n){var r=n.allocTextureUnit();e.uniform1i(this.addr,r),n.setTexture2D(t||nn,r)}function bn(e,t,n){var r=n.allocTextureUnit();e.uniform1i(this.addr,r),n.setTextureCube(t||rn,r)}function wn(e,t){e.uniform2iv(this.addr,t)}function En(e,t){e.uniform3iv(this.addr,t)}function Mn(e,t){e.uniform4iv(this.addr,t)}function Tn(e,t){e.uniform1fv(this.addr,t)}function Sn(e,t){e.uniform1iv(this.addr,t)}function An(e,t){e.uniform2fv(this.addr,un(t,this.size,2))}function Pn(e,t){e.uniform3fv(this.addr,un(t,this.size,3))}function Rn(e,t){e.uniform4fv(this.addr,un(t,this.size,4))}function Ln(e,t){e.uniformMatrix2fv(this.addr,!1,un(t,this.size,4))}function Cn(e,t){e.uniformMatrix3fv(this.addr,!1,un(t,this.size,9))}function In(e,t){e.uniformMatrix4fv(this.addr,!1,un(t,this.size,16))}function On(e,t,n){var r=t.length,i=hn(n,r);e.uniform1iv(this.addr,i);for(var o=0;o!==r;++o)n.setTexture2D(t[o]||nn,i[o])}function jn(e,t,n){var r=t.length,i=hn(n,r);e.uniform1iv(this.addr,i);for(var o=0;o!==r;++o)n.setTextureCube(t[o]||rn,i[o])}function Nn(e,t,n){this.id=e,this.addr=n,this.setValue=(e=>{switch(e){case 5126:return dn;case 35664:return fn;case 35665:return mn;case 35666:return gn;case 35674:return vn;case 35675:return yn;case 35676:return _n;case 35678:case 36198:return xn;case 35680:return bn;case 5124:case 35670:return pn;case 35667:case 35671:return wn;case 35668:case 35672:return En;case 35669:case 35673:return Mn}})(t.type)}function Fn(e,t,n){this.id=e,this.addr=n,this.size=t.size,this.setValue=(e=>{switch(e){case 5126:return Tn;case 35664:return An;case 35665:return Pn;case 35666:return Rn;case 35674:return Ln;case 35675:return Cn;case 35676:return In;case 35678:return On;case 35680:return jn;case 5124:case 35670:return Sn;case 35667:case 35671:return wn;case 35668:case 35672:return En;case 35669:case 35673:return Mn}})(t.type)}function Dn(e){this.id=e,on.call(this)}Dn.prototype.setValue=function(e,t){for(var n=this.seq,r=0,i=n.length;r!==i;++r){var o=n[r];o.setValue(e,t[o.id])}};var Hn=/([\w\d_]+)(\])?(\[|\.)?/g;function Un(e,t){e.seq.push(t),e.map[t.id]=t}function zn(e,t,n){on.call(this),this.renderer=n;for(var r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),i=0;i<r;++i){var o=e.getActiveUniform(t,i),a=o.name,a=e.getUniformLocation(t,a),s=(m=f=p=d=h=u=l=c=s=void 0,o),c=a,l=this,u=s.name,h=u.length;for(Hn.lastIndex=0;;){var d=Hn.exec(u),p=Hn.lastIndex,f=d[1],m=d[3];if("]"===d[2]&&(f|=0),void 0===m||"["===m&&p+2===h){Un(l,new(void 0===m?Nn:Fn)(f,s,c));break}d=l.map[f];void 0===d&&Un(l,d=new Dn(f)),l=d}}}zn.prototype.setValue=function(e,t,n){t=this.map[t];void 0!==t&&t.setValue(e,n,this.renderer)},zn.prototype.setOptional=function(e,t,n){t=t[n];void 0!==t&&this.setValue(e,n,t)},zn.upload=function(e,t,n,r){for(var i=0,o=t.length;i!==o;++i){var a=t[i],s=n[a.id];!1!==s.needsUpdate&&a.setValue(e,s.value,r)}},zn.seqWithValue=function(e,t){for(var n=[],r=0,i=e.length;r!==i;++r){var o=e[r];o.id in t&&n.push(o)}return n};var kn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function pe(e,t,n){return void 0===t&&void 0===n?this.set(e):this.setRGB(e,t,n)}function Bn(e,t,n){return n<0&&(n+=1),1<n&&--n,n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}Object.assign(pe.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setScalar:function(e){return this.r=e,this.g=e,this.b=e,this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function(e,t,n){return this.r=e,this.g=t,this.b=n,this},setHSL:function(e,t,n){return e=Ae.euclideanModulo(e,1),t=Ae.clamp(t,0,1),n=Ae.clamp(n,0,1),0===t?this.r=this.g=this.b=n:(this.r=Bn(t=2*n-(n=n<=.5?n*(1+t):n+t-n*t),n,e+1/3),this.g=Bn(t,n,e),this.b=Bn(t,n,e-1/3)),this},setStyle:function(t){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var r,i,o,a,s=n[1],c=n[2];switch(s){case"rgb":case"rgba":if(r=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(c))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,e(r[5]),this;if(r=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(c))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,e(r[5]),this;break;case"hsl":case"hsla":if(r=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(c))return i=parseFloat(r[1])/360,o=parseInt(r[2],10)/100,a=parseInt(r[3],10)/100,e(r[5]),this.setHSL(i,o,a)}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(t)){var l,s=(l=n[1]).length;if(3===s)return this.r=parseInt(l.charAt(0)+l.charAt(0),16)/255,this.g=parseInt(l.charAt(1)+l.charAt(1),16)/255,this.b=parseInt(l.charAt(2)+l.charAt(2),16)/255,this;if(6===s)return this.r=parseInt(l.charAt(0)+l.charAt(1),16)/255,this.g=parseInt(l.charAt(2)+l.charAt(3),16)/255,this.b=parseInt(l.charAt(4)+l.charAt(5),16)/255,this}return t&&0<t.length&&(void 0!==(l=kn[t])?this.setHex(l):console.warn("THREE.Color: Unknown color "+t)),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return void 0===t&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){t=0<(t=void 0===t?2:t)?1/t:1;return this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},convertGammaToLinear:function(){var e=this.r,t=this.g,n=this.b;return this.r=e*e,this.g=t*t,this.b=n*n,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){var t,e=e||{h:0,s:0,l:0},n=this.r,r=this.g,i=this.b,o=Math.max(n,r,i),a=Math.min(n,r,i),s=(a+o)/2;if(a===o)l=t=0;else{var c=o-a,l=s<=.5?c/(o+a):c/(2-o-a);switch(o){case n:t=(r-i)/c+(r<i?6:0);break;case r:t=(i-n)/c+2;break;case i:t=(n-r)/c+4}t/=6}return e.h=t,e.s=l,e.l=s,e},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(e,t,n){var r=this.getHSL();return r.h+=e,r.s+=t,r.l+=n,this.setHSL(r.h,r.s,r.l),this},add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){return this.r=e[t=void 0===t?0:t],this.g=e[t+1],this.b=e[t+2],this},toArray:function(e,t){return(e=void 0===e?[]:e)[t=void 0===t?0:t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},toJSON:function(){return this.getHex()}});var Vn,Gn,Ce={common:{diffuse:{value:new pe(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new R},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new de(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new pe(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new pe(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new R}}},Ie={merge:function(e){for(var t={},n=0;n<e.length;n++){var r,i=this.clone(e[n]);for(r in i)t[r]=i[r]}return t},clone:function(e){var t,n={};for(t in e)for(var r in n[t]={},e[t]){var i=e[t][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?n[t][r]=i.clone():Array.isArray(i)?n[t][r]=i.slice():n[t][r]=i}return n}},E={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"\nvec3 transformed = vec3( position );\n",beginnormal_vertex:"\nvec3 objectNormal = vec3( normal );\n",bsdfs:"float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t}\n\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat theta = acos( dot( N, V ) );\n\tvec2 uv = vec2(\n\t\tsqrt( saturate( roughness ) ),\n\t\tsaturate( theta / ( 0.5 * PI ) ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.86267 + (0.49788 + 0.01436 * y ) * y;\n\tfloat b = 3.45068 + (4.18814 + y) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = (x > 0.0) ? v : 0.5 * inversesqrt( 1.0 - x * x ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tvec3 result = vec3( LTC_ClippedSphereFormFactor( vectorFormFactor ) );\n\treturn result;\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; ++ i ) {\n\t\tvec4 plane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t\t\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; ++ i ) {\n\t\t\tvec4 plane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t\n\t#endif\n#endif\n",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\n",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",defaultnormal_vertex:"vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",encodings_fragment:"  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM            = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat D      = max( maxRange / maxRGB, 1.0 );\n\tD            = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract(Le);\n\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max(vRGB, 0.0), 1.0 );\n}\n",envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",fog_vertex:"\n#ifdef USE_FOG\nfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n  varying float fogDepth;\n#endif\n",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif\n",gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",lights_pars:"uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltcMat;\tuniform sampler2D ltcMag;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tfloat norm = texture2D( ltcMag, uv ).a;\n\t\tvec4 t = texture2D( ltcMat, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3(   1,   0, t.y ),\n\t\t\tvec3(   0, t.z,   0 ),\n\t\t\tvec3( t.w,   0, t.x )\n\t\t);\n\t\treflectedLight.directSpecular += lightColor * material.specularColor * norm * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",lights_template:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, 8 );\n\t#endif\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tvec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\n\t#ifndef STANDARD\n\t\tvec3 clearCoatRadiance = getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), 8 );\n\t#else\n\t\tvec3 clearCoatRadiance = vec3( 0.0 );\n\t#endif\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif\n",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",map_particle_fragment:"#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif\n",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif\n",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",normal_fragment:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n#endif\n#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",project_vertex:"vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n",dithering_fragment:"#if defined( DITHERING )\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif\n",dithering_pars_fragment:"#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif\n",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif\n",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif\n",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",tonemapping_pars_fragment:"#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\n",uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif\n",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",cube_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}\n",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}\n",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}\n",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",equirect_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}\n",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}\n",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n"},Wn={basic:{uniforms:Ie.merge([Ce.common,Ce.specularmap,Ce.envmap,Ce.aomap,Ce.lightmap,Ce.fog]),vertexShader:E.meshbasic_vert,fragmentShader:E.meshbasic_frag},lambert:{uniforms:Ie.merge([Ce.common,Ce.specularmap,Ce.envmap,Ce.aomap,Ce.lightmap,Ce.emissivemap,Ce.fog,Ce.lights,{emissive:{value:new pe(0)}}]),vertexShader:E.meshlambert_vert,fragmentShader:E.meshlambert_frag},phong:{uniforms:Ie.merge([Ce.common,Ce.specularmap,Ce.envmap,Ce.aomap,Ce.lightmap,Ce.emissivemap,Ce.bumpmap,Ce.normalmap,Ce.displacementmap,Ce.gradientmap,Ce.fog,Ce.lights,{emissive:{value:new pe(0)},specular:{value:new pe(1118481)},shininess:{value:30}}]),vertexShader:E.meshphong_vert,fragmentShader:E.meshphong_frag},standard:{uniforms:Ie.merge([Ce.common,Ce.envmap,Ce.aomap,Ce.lightmap,Ce.emissivemap,Ce.bumpmap,Ce.normalmap,Ce.displacementmap,Ce.roughnessmap,Ce.metalnessmap,Ce.fog,Ce.lights,{emissive:{value:new pe(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:E.meshphysical_vert,fragmentShader:E.meshphysical_frag},points:{uniforms:Ie.merge([Ce.points,Ce.fog]),vertexShader:E.points_vert,fragmentShader:E.points_frag},dashed:{uniforms:Ie.merge([Ce.common,Ce.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:E.linedashed_vert,fragmentShader:E.linedashed_frag},depth:{uniforms:Ie.merge([Ce.common,Ce.displacementmap]),vertexShader:E.depth_vert,fragmentShader:E.depth_frag},normal:{uniforms:Ie.merge([Ce.common,Ce.bumpmap,Ce.normalmap,Ce.displacementmap,{opacity:{value:1}}]),vertexShader:E.normal_vert,fragmentShader:E.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:E.cube_vert,fragmentShader:E.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:E.equirect_vert,fragmentShader:E.equirect_frag},distanceRGBA:{uniforms:Ie.merge([Ce.common,Ce.displacementmap,{referencePosition:{value:new Re},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:E.distanceRGBA_vert,fragmentShader:E.distanceRGBA_frag},shadow:{uniforms:Ie.merge([Ce.lights,Ce.fog,{color:{value:new pe(0)},opacity:{value:1}}]),vertexShader:E.shadow_vert,fragmentShader:E.shadow_frag}};function qn(e,t){this.min=void 0!==e?e:new de(1/0,1/0),this.max=void 0!==t?t:new de(-1/0,-1/0)}function Xn(e,_,x,b,o){var w,E,a,M,T,S,A,P;function R(){var e,t,n,r=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),i=new Uint16Array([0,1,2,0,2,3]);w=_.createBuffer(),E=_.createBuffer(),_.bindBuffer(_.ARRAY_BUFFER,w),_.bufferData(_.ARRAY_BUFFER,r,_.STATIC_DRAW),_.bindBuffer(_.ELEMENT_ARRAY_BUFFER,E),_.bufferData(_.ELEMENT_ARRAY_BUFFER,i,_.STATIC_DRAW),A=_.createTexture(),P=_.createTexture(),x.bindTexture(_.TEXTURE_2D,A),_.texImage2D(_.TEXTURE_2D,0,_.RGB,16,16,0,_.RGB,_.UNSIGNED_BYTE,null),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,_.CLAMP_TO_EDGE),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,_.CLAMP_TO_EDGE),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,_.NEAREST),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,_.NEAREST),x.bindTexture(_.TEXTURE_2D,P),_.texImage2D(_.TEXTURE_2D,0,_.RGBA,16,16,0,_.RGBA,_.UNSIGNED_BYTE,null),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,_.CLAMP_TO_EDGE),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,_.CLAMP_TO_EDGE),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,_.NEAREST),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,_.NEAREST),a={vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","uniform sampler2D occlusionMap;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","\tvUV = uv;","\tvec2 pos = position;","\tif ( renderType == 2 ) {","\t\tvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","\t\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","\t\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","\t\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","\t\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","\t\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","\t\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","\t\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","\t\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","\t\tvVisibility =        visibility.r / 9.0;","\t\tvVisibility *= 1.0 - visibility.g / 9.0;","\t\tvVisibility *=       visibility.b / 9.0;","\t\tvVisibility *= 1.0 - visibility.a / 9.0;","\t\tpos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","\t\tpos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","\t}","\tgl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["uniform lowp int renderType;","uniform sampler2D map;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","\tif ( renderType == 0 ) {","\t\tgl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );","\t} else if ( renderType == 1 ) {","\t\tgl_FragColor = texture2D( map, vUV );","\t} else {","\t\tvec4 texture = texture2D( map, vUV );","\t\ttexture.a *= opacity * vVisibility;","\t\tgl_FragColor = texture;","\t\tgl_FragColor.rgb *= color;","\t}","}"].join("\n")},r=a,i=_.createProgram(),e=_.createShader(_.FRAGMENT_SHADER),t=_.createShader(_.VERTEX_SHADER),n="precision "+o.precision+" float;\n",_.shaderSource(e,n+r.fragmentShader),_.shaderSource(t,n+r.vertexShader),_.compileShader(e),_.compileShader(t),_.attachShader(i,e),_.attachShader(i,t),_.linkProgram(i),M=i,T={vertex:_.getAttribLocation(M,"position"),uv:_.getAttribLocation(M,"uv")},S={renderType:_.getUniformLocation(M,"renderType"),map:_.getUniformLocation(M,"map"),occlusionMap:_.getUniformLocation(M,"occlusionMap"),opacity:_.getUniformLocation(M,"opacity"),color:_.getUniformLocation(M,"color"),scale:_.getUniformLocation(M,"scale"),rotation:_.getUniformLocation(M,"rotation"),screenPosition:_.getUniformLocation(M,"screenPosition")}}this.render=function(e,t,n,r){if(0!==e.length){var i=new Re,o=r.w/r.z,a=.5*r.z,s=.5*r.w,c=16/r.w,l=new de(c*o,c),u=new Re(1,1,0),h=new de(1,1),d=new qn;d.min.set(r.x,r.y),d.max.set(r.x+(r.z-16),r.y+(r.w-16)),void 0===M&&R(),x.useProgram(M),x.initAttributes(),x.enableAttribute(T.vertex),x.enableAttribute(T.uv),x.disableUnusedAttributes(),_.uniform1i(S.occlusionMap,0),_.uniform1i(S.map,1),_.bindBuffer(_.ARRAY_BUFFER,w),_.vertexAttribPointer(T.vertex,2,_.FLOAT,!1,16,0),_.vertexAttribPointer(T.uv,2,_.FLOAT,!1,16,8),_.bindBuffer(_.ELEMENT_ARRAY_BUFFER,E),x.disable(_.CULL_FACE),x.buffers.depth.setMask(!1);for(var p=0,f=e.length;p<f;p++){c=16/r.w,l.set(c*o,c);var m=e[p];if(i.set(m.matrixWorld.elements[12],m.matrixWorld.elements[13],m.matrixWorld.elements[14]),i.applyMatrix4(n.matrixWorldInverse),i.applyMatrix4(n.projectionMatrix),u.copy(i),h.x=r.x+u.x*a+a-8,h.y=r.y+u.y*s+s-8,!0===d.containsPoint(h)){x.activeTexture(_.TEXTURE0),x.bindTexture(_.TEXTURE_2D,null),x.activeTexture(_.TEXTURE1),x.bindTexture(_.TEXTURE_2D,A),_.copyTexImage2D(_.TEXTURE_2D,0,_.RGB,h.x,h.y,16,16,0),_.uniform1i(S.renderType,0),_.uniform2f(S.scale,l.x,l.y),_.uniform3f(S.screenPosition,u.x,u.y,u.z),x.disable(_.BLEND),x.enable(_.DEPTH_TEST),_.drawElements(_.TRIANGLES,6,_.UNSIGNED_SHORT,0),x.activeTexture(_.TEXTURE0),x.bindTexture(_.TEXTURE_2D,P),_.copyTexImage2D(_.TEXTURE_2D,0,_.RGBA,h.x,h.y,16,16,0),_.uniform1i(S.renderType,1),x.disable(_.DEPTH_TEST),x.activeTexture(_.TEXTURE1),x.bindTexture(_.TEXTURE_2D,A),_.drawElements(_.TRIANGLES,6,_.UNSIGNED_SHORT,0),m.positionScreen.copy(u),m.customUpdateCallback?m.customUpdateCallback(m):m.updateLensFlares(),_.uniform1i(S.renderType,2),x.enable(_.BLEND);for(var g=0,v=m.lensFlares.length;g<v;g++){var y=m.lensFlares[g];.001<y.opacity&&.001<y.scale&&(u.x=y.x,u.y=y.y,u.z=y.z,c=y.size*y.scale/r.w,l.x=c*o,l.y=c,_.uniform3f(S.screenPosition,u.x,u.y,u.z),_.uniform2f(S.scale,l.x,l.y),_.uniform1f(S.rotation,y.rotation),_.uniform1f(S.opacity,y.opacity),_.uniform3f(S.color,y.color.r,y.color.g,y.color.b),x.setBlending(y.blending,y.blendEquation,y.blendSrc,y.blendDst),b.setTexture2D(y.texture,1),_.drawElements(_.TRIANGLES,6,_.UNSIGNED_SHORT,0))}}}x.enable(_.CULL_FACE),x.enable(_.DEPTH_TEST),x.buffers.depth.setMask(!0),x.reset()}}}function Yn(e,t,n,r,i,o,a,s,c){d.call(this,e,t,n,r,i,o,a,s,c),this.needsUpdate=!0}function Qn(d,p,f,m,r){var g,v,y,_,x,b,w=new Re,E=new u,M=new Re;function T(){var e=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),t=new Uint16Array([0,1,2,0,2,3]),t=(g=p.createBuffer(),v=p.createBuffer(),p.bindBuffer(p.ARRAY_BUFFER,g),p.bufferData(p.ARRAY_BUFFER,e,p.STATIC_DRAW),p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,v),p.bufferData(p.ELEMENT_ARRAY_BUFFER,t,p.STATIC_DRAW),e=p.createProgram(),t=p.createShader(p.VERTEX_SHADER),n=p.createShader(p.FRAGMENT_SHADER),p.shaderSource(t,["precision "+r.precision+" float;","#define SHADER_NAME SpriteMaterial","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float fogDepth;","void main() {","\tvUV = uvOffset + uv * uvScale;","\tvec2 alignedPosition = position * scale;","\tvec2 rotatedPosition;","\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","\tvec4 mvPosition;","\tmvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","\tmvPosition.xy += rotatedPosition;","\tgl_Position = projectionMatrix * mvPosition;","\tfogDepth = - mvPosition.z;","}"].join("\n")),p.shaderSource(n,["precision "+r.precision+" float;","#define SHADER_NAME SpriteMaterial","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","varying float fogDepth;","void main() {","\tvec4 texture = texture2D( map, vUV );","\tgl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","\tif ( gl_FragColor.a < alphaTest ) discard;","\tif ( fogType > 0 ) {","\t\tfloat fogFactor = 0.0;","\t\tif ( fogType == 1 ) {","\t\t\tfogFactor = smoothstep( fogNear, fogFar, fogDepth );","\t\t} else {","\t\t\tconst float LOG2 = 1.442695;","\t\t\tfogFactor = exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 );","\t\t\tfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","\t\t}","\t\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );","\t}","}"].join("\n")),p.compileShader(t),p.compileShader(n),p.attachShader(e,t),p.attachShader(e,n),p.linkProgram(e),y=e,_={position:p.getAttribLocation(y,"position"),uv:p.getAttribLocation(y,"uv")},x={uvOffset:p.getUniformLocation(y,"uvOffset"),uvScale:p.getUniformLocation(y,"uvScale"),rotation:p.getUniformLocation(y,"rotation"),scale:p.getUniformLocation(y,"scale"),color:p.getUniformLocation(y,"color"),map:p.getUniformLocation(y,"map"),opacity:p.getUniformLocation(y,"opacity"),modelViewMatrix:p.getUniformLocation(y,"modelViewMatrix"),projectionMatrix:p.getUniformLocation(y,"projectionMatrix"),fogType:p.getUniformLocation(y,"fogType"),fogDensity:p.getUniformLocation(y,"fogDensity"),fogNear:p.getUniformLocation(y,"fogNear"),fogFar:p.getUniformLocation(y,"fogFar"),fogColor:p.getUniformLocation(y,"fogColor"),fogDepth:p.getUniformLocation(y,"fogDepth"),alphaTest:p.getUniformLocation(y,"alphaTest")},document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),n=(t.width=8,t.height=8,t.getContext("2d"));n.fillStyle="white",n.fillRect(0,0,8,8),b=new Yn(t)}function S(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:t.id-e.id}this.render=function(e,t,n){if(0!==e.length){void 0===y&&T(),f.useProgram(y),f.initAttributes(),f.enableAttribute(_.position),f.enableAttribute(_.uv),f.disableUnusedAttributes(),f.disable(p.CULL_FACE),f.enable(p.BLEND),p.bindBuffer(p.ARRAY_BUFFER,g),p.vertexAttribPointer(_.position,2,p.FLOAT,!1,16,0),p.vertexAttribPointer(_.uv,2,p.FLOAT,!1,16,8),p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,v),p.uniformMatrix4fv(x.projectionMatrix,!1,n.projectionMatrix.elements),f.activeTexture(p.TEXTURE0),p.uniform1i(x.map,0);var r=0,i=0,o=t.fog;o?(p.uniform3f(x.fogColor,o.color.r,o.color.g,o.color.b),o.isFog?(p.uniform1f(x.fogNear,o.near),p.uniform1f(x.fogFar,o.far),p.uniform1i(x.fogType,1),i=r=1):o.isFogExp2&&(p.uniform1f(x.fogDensity,o.density),p.uniform1i(x.fogType,2),i=r=2)):(p.uniform1i(x.fogType,0),i=r=0);for(var a=0,s=e.length;a<s;a++)(l=e[a]).modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,l.matrixWorld),l.z=-l.modelViewMatrix.elements[14];e.sort(S);for(var c=[],a=0,s=e.length;a<s;a++){var l,u,h=(l=e[a]).material;!1!==h.visible&&(l.onBeforeRender(d,t,n,void 0,h,void 0),p.uniform1f(x.alphaTest,h.alphaTest),p.uniformMatrix4fv(x.modelViewMatrix,!1,l.modelViewMatrix.elements),l.matrixWorld.decompose(w,E,M),c[0]=M.x,c[1]=M.y,u=0,r!==(u=t.fog&&h.fog?i:u)&&(p.uniform1i(x.fogType,u),r=u),null!==h.map?(p.uniform2f(x.uvOffset,h.map.offset.x,h.map.offset.y),p.uniform2f(x.uvScale,h.map.repeat.x,h.map.repeat.y)):(p.uniform2f(x.uvOffset,0,0),p.uniform2f(x.uvScale,1,1)),p.uniform1f(x.opacity,h.opacity),p.uniform3f(x.color,h.color.r,h.color.g,h.color.b),p.uniform1f(x.rotation,h.rotation),p.uniform2fv(x.scale,c),f.setBlending(h.blending,h.blendEquation,h.blendSrc,h.blendDst,h.blendEquationAlpha,h.blendSrcAlpha,h.blendDstAlpha,h.premultipliedAlpha),f.buffers.depth.setTest(h.depthTest),f.buffers.depth.setMask(h.depthWrite),f.buffers.color.setMask(h.colorWrite),m.setTexture2D(h.map||b,0),p.drawElements(p.TRIANGLES,6,p.UNSIGNED_SHORT,0),l.onAfterRender(d,t,n,void 0,h,void 0))}f.enable(p.CULL_FACE),f.reset()}}}Wn.physical={uniforms:Ie.merge([Wn.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:E.meshphysical_vert,fragmentShader:E.meshphysical_frag},Object.assign(qn.prototype,{set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:(Gn=new de,function(e,t){t=Gn.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(t),this.max.copy(e).add(t),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){e=e||new de;return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){e=e||new de;return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){return(t||new de).set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){return(t||new de).copy(e).clamp(this.min,this.max)},distanceToPoint:(Vn=new de,function(e){return Vn.copy(e).clamp(this.min,this.max).sub(e).length()}),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),(Yn.prototype=Object.create(d.prototype)).constructor=Yn;var Zn,Jn,Kn,$n,er,tr,nr,rr,ir,or,ar,sr,cr,lr,ur,hr,dr,pr,fr,mr,gr,vr=0;function t(){Object.defineProperty(this,"id",{value:vr++}),this.uuid=Ae.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=oe,this.side=ee,this.flatShading=!1,this.vertexColors=0,this.opacity=1,this.transparent=!1,this.blendSrc=we,this.blendDst=Ee,this.blendEquation=ue,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=He,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this.userData={},this.needsUpdate=!0}function yr(e){t.call(this),this.type="MeshDepthMaterial",this.depthPacking=Xt,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(e)}function _r(e){t.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new Re,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.lights=!1,this.setValues(e)}function xr(e,t){this.min=void 0!==e?e:new Re(1/0,1/0,1/0),this.max=void 0!==t?t:new Re(-1/0,-1/0,-1/0)}function br(e){var t=e.geometry;if(void 0!==t)if(t.isGeometry){var n=t.vertices;for(tr=0,nr=n.length;tr<nr;tr++)rr.copy(n[tr]),rr.applyMatrix4(e.matrixWorld),er.expandByPoint(rr)}else if(t.isBufferGeometry){var r=t.attributes.position;if(void 0!==r)for(tr=0,nr=r.count;tr<nr;tr++)rr.fromBufferAttribute(r,tr).applyMatrix4(e.matrixWorld),er.expandByPoint(rr)}}function wr(e,t){this.center=void 0!==e?e:new Re,this.radius=void 0!==t?t:0}function Er(e,t){this.normal=void 0!==e?e:new Re(1,0,0),this.constant=void 0!==t?t:0}function Mr(e,t,n,r,i,o){this.planes=[void 0!==e?e:new Er,void 0!==t?t:new Er,void 0!==n?n:new Er,void 0!==r?r:new Er,void 0!==i?i:new Er,void 0!==o?o:new Er]}function Tr(v,y,e){for(var _=new Mr,m=new Pe,g=new de,x=new de(e,e),b=new Re,w=new Re,u=1,h=2,t=1+(u|h),d=new Array(t),p=new Array(t),f={},E=[new Re(1,0,0),new Re(-1,0,0),new Re(0,0,1),new Re(0,0,-1),new Re(0,1,0),new Re(0,-1,0)],M=[new Re(0,1,0),new Re(0,1,0),new Re(0,1,0),new Re(0,1,0),new Re(0,0,1),new Re(0,0,-1)],T=[new Le,new Le,new Le,new Le,new Le,new Le],n=0;n!==t;++n){var r=0!=(n&u),i=0!=(n&h),o=new yr({depthPacking:Yt,morphTargets:r,skinning:i}),o=(d[n]=o,new _r({morphTargets:r,skinning:i}));p[n]=o}var S=this;function A(e,t,n,r,i,o){var a=e.geometry,s=null,c=d,l=e.customDepthMaterial,l=(n&&(c=p,l=e.customDistanceMaterial),s=l||(l=!1,t.morphTargets&&(a&&a.isBufferGeometry?l=a.morphAttributes&&a.morphAttributes.position&&0<a.morphAttributes.position.length:a&&a.isGeometry&&(l=a.morphTargets&&0<a.morphTargets.length)),e.isSkinnedMesh&&!1===t.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",e),a=e.isSkinnedMesh&&t.skinning,e=0,l&&(e|=u),a&&(e|=h),c[e]),v.localClippingEnabled&&!0===t.clipShadows&&0!==t.clippingPlanes.length&&(l=s.uuid,a=t.uuid,void 0===(c=f[l])&&(f[l]=c={}),void 0===(e=c[a])&&(e=s.clone(),c[a]=e),s=e),s.visible=t.visible,s.wireframe=t.wireframe,t.side);return S.renderSingleSided&&l==re&&(l=ee),S.renderReverseSided&&(l===ee?l=ne:l===ne&&(l=ee)),s.side=l,s.clipShadows=t.clipShadows,s.clippingPlanes=t.clippingPlanes,s.clipIntersection=t.clipIntersection,s.wireframeLinewidth=t.wireframeLinewidth,s.linewidth=t.linewidth,n&&s.isMeshDistanceMaterial&&(s.referencePosition.copy(r),s.nearDistance=i,s.farDistance=o),s}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=K,this.renderReverseSided=!0,this.renderSingleSided=!0,this.render=function(e,t,n){if(!1!==S.enabled&&(!1!==S.autoUpdate||!1!==S.needsUpdate)&&0!==e.length){var r,i=v.context,o=v.state;o.disable(i.BLEND),o.buffers.color.setClear(1,1,1,1),o.buffers.depth.setTest(!0),o.setScissorTest(!1);for(var a=0,s=e.length;a<s;a++){var c=e[a],l=c.shadow,u=c&&c.isPointLight;if(void 0===l)console.warn("THREE.WebGLShadowMap:",c,"has no shadow.");else{var h=l.camera,d=(g.copy(l.mapSize),g.min(x),u&&(d=g.x,p=g.y,T[0].set(2*d,p,d,p),T[1].set(0,p,d,p),T[2].set(3*d,p,d,p),T[3].set(d,p,d,p),T[4].set(3*d,0,d,p),T[5].set(d,0,d,p),g.x*=4,g.y*=2),null===l.map&&(l.map=new Kt(g.x,g.y,{minFilter:P,magFilter:P,format:Mt}),l.map.texture.name=c.name+".shadowMap",h.updateProjectionMatrix()),l.isSpotLightShadow&&l.update(c),l.map),p=l.matrix;w.setFromMatrixPosition(c.matrixWorld),h.position.copy(w),u?(r=6,p.makeTranslation(-w.x,-w.y,-w.z)):(r=1,b.setFromMatrixPosition(c.target.matrixWorld),h.lookAt(b),h.updateMatrixWorld(),p.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),p.multiply(h.projectionMatrix),p.multiply(h.matrixWorldInverse)),v.setRenderTarget(d),v.clear();for(var f=0;f<r;f++)u&&(b.copy(h.position),b.add(E[f]),h.up.copy(M[f]),h.lookAt(b),h.updateMatrixWorld(),o.viewport(T[f])),m.multiplyMatrices(h.projectionMatrix,h.matrixWorldInverse),_.setFromMatrix(m),!function e(t,n,r,i){if(!1===t.visible)return;var o=t.layers.test(n.layers);if(o&&(t.isMesh||t.isLine||t.isPoints)&&t.castShadow&&(!t.frustumCulled||_.intersectsObject(t))){t.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,t.matrixWorld);var a=y.update(t),s=t.material;if(Array.isArray(s))for(var c=a.groups,l=0,u=c.length;l<u;l++){var h,d=c[l],p=s[d.materialIndex];p&&p.visible&&(h=A(t,p,i,w,r.near,r.far),v.renderBufferDirect(r,null,a,h,t,d))}else s.visible&&(h=A(t,s,i,w,r.near,r.far),v.renderBufferDirect(r,null,a,h,t,null))}var f=t.children;for(var m=0,g=f.length;m<g;m++)e(f[m],n,r,i)}(t,n,h,u)}}S.needsUpdate=!1}}}function Sr(c){var l={};return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),l[e.uuid]},remove:function(e){e.isInterleavedBufferAttribute&&(e=e.data);var t=l[e.uuid];t&&(c.deleteBuffer(t.buffer),delete l[e.uuid])},update:function(e,t){e.isInterleavedBufferAttribute&&(e=e.data);var n,r,i,o,a,s=l[e.uuid];void 0===s?l[e.uuid]=(r=t,i=(n=e).array,o=n.dynamic?c.DYNAMIC_DRAW:c.STATIC_DRAW,a=c.createBuffer(),c.bindBuffer(r,a),c.bufferData(r,i,o),n.onUploadCallback(),r=c.FLOAT,i instanceof Float32Array?r=c.FLOAT:i instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):i instanceof Uint16Array?r=c.UNSIGNED_SHORT:i instanceof Int16Array?r=c.SHORT:i instanceof Uint32Array?r=c.UNSIGNED_INT:i instanceof Int32Array?r=c.INT:i instanceof Int8Array?r=c.BYTE:i instanceof Uint8Array&&(r=c.UNSIGNED_BYTE),{buffer:a,type:r,bytesPerElement:i.BYTES_PER_ELEMENT,version:n.version}):s.version<e.version&&(o=s.buffer,a=t,i=(r=e).array,n=r.updateRange,c.bindBuffer(a,o),!1===r.dynamic?c.bufferData(a,i,c.STATIC_DRAW):-1===n.count?c.bufferSubData(a,0,i):0===n.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(c.bufferSubData(a,n.offset*i.BYTES_PER_ELEMENT,i.subarray(n.offset,n.offset+n.count)),n.count=-1),s.version=e.version)}}}function Ar(e,t,n,r){this._x=e||0,this._y=t||0,this._z=n||0,this._order=r||Ar.DefaultOrder}function Pr(){this.mask=1}Object.assign(t.prototype,l.prototype,{isMaterial:!0,onBeforeCompile:function(){},setValues:function(e){if(void 0!==e)for(var t in e){var n,r=e[t];void 0===r?console.warn("THREE.Material: '"+t+"' parameter is undefined."):"shading"===t?(console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===r):void 0===(n=this[t])?console.warn("THREE."+this.type+": '"+t+"' is not a property of this material."):n&&n.isColor?n.set(r):n&&n.isVector3&&r&&r.isVector3?n.copy(r):this[t]="overdraw"===t?Number(r):r}},toJSON:function(e){var t=void 0===e||"string"==typeof e,n=(t&&(e={textures:{},images:{}}),{metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}});function r(e){var t,n=[];for(t in e){var r=e[t];delete r.metadata,n.push(r)}return n}return n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearCoat&&(n.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(n.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,n.reflectivity=this.reflectivity),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==oe&&(n.blending=this.blending),!0===this.flatShading&&(n.flatShading=this.flatShading),this.side!==ee&&(n.side=this.side),0!==this.vertexColors&&(n.vertexColors=this.vertexColors),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,0!==this.rotation&&(n.rotation=this.rotation),1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),0<this.alphaTest&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),1<this.wireframeLinewidth&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.skinning&&(n.skinning=!0),!1===this.visible&&(n.visible=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t&&(t=r(e.textures),e=r(e.images),0<t.length&&(n.textures=t),0<e.length)&&(n.images=e),n},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.lights=e.lights,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.overdraw=e.overdraw,this.visible=e.visible,this.userData=JSON.parse(JSON.stringify(e.userData)),this.clipShadows=e.clipShadows,this.clipIntersection=e.clipIntersection;var t=e.clippingPlanes,n=null;if(null!==t)for(var r=t.length,n=new Array(r),i=0;i!==r;++i)n[i]=t[i].clone();return this.clippingPlanes=n,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),((yr.prototype=Object.create(t.prototype)).constructor=yr).prototype.isMeshDepthMaterial=!0,yr.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},((_r.prototype=Object.create(t.prototype)).constructor=_r).prototype.isMeshDistanceMaterial=!0,_r.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this},Object.assign(xr.prototype,{isBox3:!0,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromArray:function(e){for(var t=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,c=e.length;s<c;s+=3){var l=e[s],u=e[s+1],h=e[s+2];l<t&&(t=l),u<n&&(n=u),h<r&&(r=h),i<l&&(i=l),o<u&&(o=u),a<h&&(a=h)}return this.min.set(t,n,r),this.max.set(i,o,a),this},setFromBufferAttribute:function(e){for(var t=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,c=e.count;s<c;s++){var l=e.getX(s),u=e.getY(s),h=e.getZ(s);l<t&&(t=l),u<n&&(n=u),h<r&&(r=h),i<l&&(i=l),o<u&&(o=u),a<h&&(a=h)}return this.min.set(t,n,r),this.max.set(i,o,a),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:(ir=new Re,function(e,t){t=ir.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(t),this.max.copy(e).add(t),this}),setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){e=e||new Re;return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){e=e||new Re;return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:(rr=new Re,function(e){return er=this,e.updateMatrixWorld(!0),e.traverse(br),this}),containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return(t||new Re).set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:($n=new Re,function(e){return this.clampPoint(e.center,$n),$n.distanceToSquared(e.center)<=e.radius*e.radius}),intersectsPlane:function(e){var t,n=0<e.normal.x?(t=e.normal.x*this.min.x,e.normal.x*this.max.x):(t=e.normal.x*this.max.x,e.normal.x*this.min.x);return 0<e.normal.y?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),0<e.normal.z?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=e.constant&&n>=e.constant},clampPoint:function(e,t){return(t||new Re).copy(e).clamp(this.min,this.max)},distanceToPoint:(Kn=new Re,function(e){return Kn.copy(e).clamp(this.min,this.max).sub(e).length()}),getBoundingSphere:(Jn=new Re,function(e){e=e||new wr;return this.getCenter(e.center),e.radius=.5*this.getSize(Jn).length(),e}),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:(Zn=[new Re,new Re,new Re,new Re,new Re,new Re,new Re,new Re],function(e){return this.isEmpty()||(Zn[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Zn[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Zn[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Zn[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Zn[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Zn[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Zn[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Zn[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Zn)),this}),translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),Object.assign(wr.prototype,{set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:(or=new xr,function(e,t){for(var n=this.center,r=(void 0!==t?n.copy(t):or.setFromPoints(e).getCenter(n),0),i=0,o=e.length;i<o;i++)r=Math.max(r,n.distanceToSquared(e[i]));return this.radius=Math.sqrt(r),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,t){var n=this.center.distanceToSquared(e),t=t||new Re;return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t},getBoundingBox:function(e){e=e||new xr;return e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}}),Object.assign(Er.prototype,{set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:(lr=new Re,ur=new Re,function(e,t,n){n=lr.subVectors(n,t).cross(ur.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(n,e),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return(t||new Re).copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:(cr=new Re,function(e,t){var t=t||new Re,n=e.delta(cr),r=this.normal.dot(n);return 0===r?0===this.distanceToPoint(e.start)?t.copy(e.start):void 0:(r=-(e.start.dot(this.normal)+this.constant)/r)<0||1<r?void 0:t.copy(n).multiplyScalar(r).add(e.start)}),intersectsLine:function(e){var t=this.distanceToPoint(e.start),e=this.distanceToPoint(e.end);return t<0&&0<e||e<0&&0<t},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return(e||new Re).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:(ar=new Re,sr=new R,function(e,t){t=t||sr.getNormalMatrix(e),e=this.coplanarPoint(ar).applyMatrix4(e),t=this.normal.applyMatrix3(t).normalize();return this.constant=-e.dot(t),this}),translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}}),Object.assign(Mr.prototype,{set:function(e,t,n,r,i,o){var a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(r),a[4].copy(i),a[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){for(var t=this.planes,n=0;n<6;n++)t[n].copy(e.planes[n]);return this},setFromMatrix:function(e){var t=this.planes,e=e.elements,n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],c=e[6],l=e[7],u=e[8],h=e[9],d=e[10],p=e[11],f=e[12],m=e[13],g=e[14],e=e[15];return t[0].setComponents(o-n,l-a,p-u,e-f).normalize(),t[1].setComponents(o+n,l+a,p+u,e+f).normalize(),t[2].setComponents(o+r,l+s,p+h,e+m).normalize(),t[3].setComponents(o-r,l-s,p-h,e-m).normalize(),t[4].setComponents(o-i,l-c,p-d,e-g).normalize(),t[5].setComponents(o+i,l+c,p+d,e+g).normalize(),this},intersectsObject:(fr=new wr,function(e){var t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),fr.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(fr)}),intersectsSprite:(pr=new wr,function(e){return pr.center.set(0,0,0),pr.radius=.7071067811865476,pr.applyMatrix4(e.matrixWorld),this.intersectsSphere(pr)}),intersectsSphere:function(e){for(var t=this.planes,n=e.center,r=-e.radius,i=0;i<6;i++)if(t[i].distanceToPoint(n)<r)return!1;return!0},intersectsBox:(hr=new Re,dr=new Re,function(e){for(var t=this.planes,n=0;n<6;n++){var r=t[n],i=(hr.x=(0<r.normal.x?e.min:e.max).x,dr.x=(0<r.normal.x?e.max:e.min).x,hr.y=(0<r.normal.y?e.min:e.max).y,dr.y=(0<r.normal.y?e.max:e.min).y,hr.z=(0<r.normal.z?e.min:e.max).z,dr.z=(0<r.normal.z?e.max:e.min).z,r.distanceToPoint(hr)),r=r.distanceToPoint(dr);if(i<0&&r<0)return!1}return!0}),containsPoint:function(e){for(var t=this.planes,n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}}),Ar.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Ar.DefaultOrder="XYZ",Object.defineProperties(Ar.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this.onChangeCallback()}}}),Object.assign(Ar.prototype,{isEuler:!0,set:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._order=r||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this.onChangeCallback(),this},setFromRotationMatrix:function(e,t,n){var r=Ae.clamp,e=e.elements,i=e[0],o=e[4],a=e[8],s=e[1],c=e[5],l=e[9],u=e[2],h=e[6],e=e[10];return"XYZ"===(t=t||this._order)?(this._y=Math.asin(r(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(-l,e),this._z=Math.atan2(-o,i)):(this._x=Math.atan2(h,c),this._z=0)):"YXZ"===t?(this._x=Math.asin(-r(l,-1,1)),Math.abs(l)<.99999?(this._y=Math.atan2(a,e),this._z=Math.atan2(s,c)):(this._y=Math.atan2(-u,i),this._z=0)):"ZXY"===t?(this._x=Math.asin(r(h,-1,1)),Math.abs(h)<.99999?(this._y=Math.atan2(-u,e),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(s,i))):"ZYX"===t?(this._y=Math.asin(-r(u,-1,1)),Math.abs(u)<.99999?(this._x=Math.atan2(h,e),this._z=Math.atan2(s,i)):(this._x=0,this._z=Math.atan2(-o,c))):"YZX"===t?(this._z=Math.asin(r(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(-l,c),this._y=Math.atan2(-u,i)):(this._x=0,this._y=Math.atan2(a,e))):"XZY"===t?(this._z=Math.asin(-r(o,-1,1)),Math.abs(o)<.99999?(this._x=Math.atan2(h,c),this._y=Math.atan2(a,i)):(this._x=Math.atan2(-l,e),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,!1!==n&&this.onChangeCallback(),this},setFromQuaternion:(gr=new Pe,function(e,t,n){return gr.makeRotationFromQuaternion(e),this.setFromRotationMatrix(gr,t,n)}),setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:(mr=new u,function(e){return mr.setFromEuler(this),this.setFromQuaternion(mr,e)}),equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this.onChangeCallback(),this},toArray:function(e,t){return(e=void 0===e?[]:e)[t=void 0===t?0:t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new Re(this._x,this._y,this._z)},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(Pr.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask|=1<<e|0},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},test:function(e){return 0!=(this.mask&e.mask)}});var Rr,Lr,Cr,Ir,Or,jr,Nr,Fr,Dr,Hr,Ur,zr,kr,Br,Vr,Gr,Wr,qr,Xr,Yr=0;function f(){Object.defineProperty(this,"id",{value:Yr++}),this.uuid=Ae.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=f.DefaultUp.clone();var e=new Re,t=new Ar,n=new u,r=new Re(1,1,1);t.onChange(function(){n.setFromEuler(t,!1)}),n.onChange(function(){t.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{enumerable:!0,value:e},rotation:{enumerable:!0,value:t},quaternion:{enumerable:!0,value:n},scale:{enumerable:!0,value:r},modelViewMatrix:{value:new Pe},normalMatrix:{value:new R}}),this.matrix=new Pe,this.matrixWorld=new Pe,this.matrixAutoUpdate=f.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Pr,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function Qr(){f.call(this),this.type="Camera",this.matrixWorldInverse=new Pe,this.projectionMatrix=new Pe}function Zr(e,t,n,r,i,o){Qr.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=void 0!==i?i:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}function Jr(e,t,n,r,i,o){this.a=e,this.b=t,this.c=n,this.normal=r&&r.isVector3?r:new Re,this.vertexNormals=Array.isArray(r)?r:[],this.color=i&&i.isColor?i:new pe,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=void 0!==o?o:0}f.DefaultUp=new Re(0,1,0),f.DefaultMatrixAutoUpdate=!0,Object.assign(f.prototype,l.prototype,{isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(e){this.matrix.multiplyMatrices(e,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:(qr=new u,function(e,t){return qr.setFromAxisAngle(e,t),this.quaternion.multiply(qr),this}),rotateOnWorldAxis:(Wr=new u,function(e,t){return Wr.setFromAxisAngle(e,t),this.quaternion.premultiply(Wr),this}),rotateX:(Gr=new Re(1,0,0),function(e){return this.rotateOnAxis(Gr,e)}),rotateY:(Vr=new Re(0,1,0),function(e){return this.rotateOnAxis(Vr,e)}),rotateZ:(Br=new Re(0,0,1),function(e){return this.rotateOnAxis(Br,e)}),translateOnAxis:(kr=new Re,function(e,t){return kr.copy(e).applyQuaternion(this.quaternion),this.position.add(kr.multiplyScalar(t)),this}),translateX:(zr=new Re(1,0,0),function(e){return this.translateOnAxis(zr,e)}),translateY:(Ur=new Re(0,1,0),function(e){return this.translateOnAxis(Ur,e)}),translateZ:(Hr=new Re(0,0,1),function(e){return this.translateOnAxis(Hr,e)}),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:(Dr=new Pe,function(e){return e.applyMatrix4(Dr.getInverse(this.matrixWorld))}),lookAt:(Nr=new Pe,Fr=new Re,function(e,t,n){e.isVector3?Fr.copy(e):Fr.set(e,t,n),this.isCamera?Nr.lookAt(this.position,Fr,this.up):Nr.lookAt(Fr,this.position,this.up),this.quaternion.setFromRotationMatrix(Nr)}),add:function(e){if(1<arguments.length)for(var t=0;t<arguments.length;t++)this.add(arguments[t]);else e===this?console.error("THREE.Object3D.add: object can't be added as a child of itself.",e):e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,e.dispatchEvent({type:"added"}),this.children.push(e)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e);return this},remove:function(e){if(1<arguments.length)for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);else{var n=this.children.indexOf(e);-1!==n&&(e.parent=null,e.dispatchEvent({type:"removed"}),this.children.splice(n,1))}return this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n].getObjectByProperty(e,t);if(void 0!==i)return i}},getWorldPosition:function(e){e=e||new Re;return this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:(Or=new Re,jr=new Re,function(e){e=e||new u;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(Or,e,jr),e}),getWorldRotation:(Ir=new u,function(e){e=e||new Ar;return this.getWorldQuaternion(Ir),e.setFromQuaternion(Ir,this.rotation.order,!1)}),getWorldScale:(Lr=new Re,Cr=new u,function(e){e=e||new Re;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(Lr,Cr,e),e}),getWorldDirection:(Rr=new u,function(e){e=e||new Re;return this.getWorldQuaternion(Rr),e.set(0,0,1).applyQuaternion(Rr)}),raycast:function(){},traverse:function(e){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),e=!(this.matrixWorldNeedsUpdate=!1));for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)},toJSON:function(n){var e,t,r,i=void 0===n||"string"==typeof n,o={},a=(i&&(n={geometries:{},materials:{},textures:{},images:{}},o.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"}),{});function s(e,t){return void 0===e[t.uuid]&&(e[t.uuid]=t.toJSON(n)),t.uuid}if(a.uuid=this.uuid,a.type=this.type,""!==this.name&&(a.name=this.name),!0===this.castShadow&&(a.castShadow=!0),!0===this.receiveShadow&&(a.receiveShadow=!0),!1===this.visible&&(a.visible=!1),"{}"!==JSON.stringify(this.userData)&&(a.userData=this.userData),a.matrix=this.matrix.toArray(),void 0!==this.geometry&&(a.geometry=s(n.geometries,this.geometry)),void 0!==this.material)if(Array.isArray(this.material)){for(var c=[],l=0,u=this.material.length;l<u;l++)c.push(s(n.materials,this.material[l]));a.material=c}else a.material=s(n.materials,this.material);if(0<this.children.length){a.children=[];for(l=0;l<this.children.length;l++)a.children.push(this.children[l].toJSON(n).object)}return i&&(i=h(n.geometries),e=h(n.materials),t=h(n.textures),r=h(n.images),0<i.length&&(o.geometries=i),0<e.length&&(o.materials=e),0<t.length&&(o.textures=t),0<r.length)&&(o.images=r),o.object=a,o;function h(e){var t,n=[];for(t in e){var r=e[t];delete r.metadata,n.push(r)}return n}},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e,t){if(void 0===t&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var n=0;n<e.children.length;n++){var r=e.children[n];this.add(r.clone())}return this}}),Qr.prototype=Object.assign(Object.create(f.prototype),{constructor:Qr,isCamera:!0,copy:function(e,t){return f.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this},getWorldDirection:(Xr=new u,function(e){e=e||new Re;return this.getWorldQuaternion(Xr),e.set(0,0,-1).applyQuaternion(Xr)}),updateMatrixWorld:function(e){f.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),Zr.prototype=Object.assign(Object.create(Qr.prototype),{constructor:Zr,isOrthographicCamera:!0,copy:function(e,t){return Qr.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this},setViewOffset:function(e,t,n,r,i,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e,t,n,r=(this.right-this.left)/(2*this.zoom),i=(this.top-this.bottom)/(2*this.zoom),o=(this.right+this.left)/2,a=(this.top+this.bottom)/2,s=o-r,o=o+r,r=a+i,a=a-i;null!==this.view&&this.view.enabled&&(i=this.zoom/(this.view.width/this.view.fullWidth),e=this.zoom/(this.view.height/this.view.fullHeight),t=(this.right-this.left)/this.view.width,n=(this.top-this.bottom)/this.view.height,o=(s+=t*(this.view.offsetX/i))+t*(this.view.width/i),a=(r-=n*(this.view.offsetY/e))-n*(this.view.height/e)),this.projectionMatrix.makeOrthographic(s,o,r,a,this.near,this.far)},toJSON:function(e){e=f.prototype.toJSON.call(this,e);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}),Object.assign(Jr.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,n=e.vertexNormals.length;t<n;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(t=0,n=e.vertexColors.length;t<n;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}});var Kr,$r,ei,ti,ni,ri,ii=0;function fe(){Object.defineProperty(this,"id",{value:ii+=2}),this.uuid=Ae.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function b(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.uuid=Ae.generateUUID(),this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===n,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function oi(e,t,n){b.call(this,new Int8Array(e),t,n)}function ai(e,t,n){b.call(this,new Uint8Array(e),t,n)}function si(e,t,n){b.call(this,new Uint8ClampedArray(e),t,n)}function ci(e,t,n){b.call(this,new Int16Array(e),t,n)}function li(e,t,n){b.call(this,new Uint16Array(e),t,n)}function ui(e,t,n){b.call(this,new Int32Array(e),t,n)}function hi(e,t,n){b.call(this,new Uint32Array(e),t,n)}function te(e,t,n){b.call(this,new Float32Array(e),t,n)}function di(e,t,n){b.call(this,new Float64Array(e),t,n)}function pi(){this.indices=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function fi(e){if(0===e.length)return-1/0;for(var t=e[0],n=1,r=e.length;n<r;++n)e[n]>t&&(t=e[n]);return t}Object.assign(fe.prototype,l.prototype,{isGeometry:!0,applyMatrix:function(e){for(var t=(new R).getNormalMatrix(e),n=0,r=this.vertices.length;n<r;n++)this.vertices[n].applyMatrix4(e);for(n=0,r=this.faces.length;n<r;n++){var i=this.faces[n];i.normal.applyMatrix3(t).normalize();for(var o=0,a=i.vertexNormals.length;o<a;o++)i.vertexNormals[o].applyMatrix3(t).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:(ri=new Pe,function(e){return ri.makeRotationX(e),this.applyMatrix(ri),this}),rotateY:(ni=new Pe,function(e){return ni.makeRotationY(e),this.applyMatrix(ni),this}),rotateZ:(ti=new Pe,function(e){return ti.makeRotationZ(e),this.applyMatrix(ti),this}),translate:(ei=new Pe,function(e,t,n){return ei.makeTranslation(e,t,n),this.applyMatrix(ei),this}),scale:($r=new Pe,function(e,t,n){return $r.makeScale(e,t,n),this.applyMatrix($r),this}),lookAt:(Kr=new f,function(e){Kr.lookAt(e),Kr.updateMatrix(),this.applyMatrix(Kr.matrix)}),fromBufferGeometry:function(e){for(var i=this,t=null!==e.index?e.index.array:void 0,n=e.attributes,r=n.position.array,o=void 0!==n.normal?n.normal.array:void 0,a=void 0!==n.color?n.color.array:void 0,s=void 0!==n.uv?n.uv.array:void 0,c=void 0!==n.uv2?n.uv2.array:void 0,l=(void 0!==c&&(this.faceVertexUvs[1]=[]),[]),u=[],h=[],d=0,p=0;d<r.length;d+=3,p+=2)i.vertices.push(new Re(r[d],r[d+1],r[d+2])),void 0!==o&&l.push(new Re(o[d],o[d+1],o[d+2])),void 0!==a&&i.colors.push(new pe(a[d],a[d+1],a[d+2])),void 0!==s&&u.push(new de(s[p],s[p+1])),void 0!==c&&h.push(new de(c[p],c[p+1]));function f(e,t,n,r){r=new Jr(e,t,n,void 0!==o?[l[e].clone(),l[t].clone(),l[n].clone()]:[],void 0!==a?[i.colors[e].clone(),i.colors[t].clone(),i.colors[n].clone()]:[],r);i.faces.push(r),void 0!==s&&i.faceVertexUvs[0].push([u[e].clone(),u[t].clone(),u[n].clone()]),void 0!==c&&i.faceVertexUvs[1].push([h[e].clone(),h[t].clone(),h[n].clone()])}var m=e.groups;if(0<m.length)for(d=0;d<m.length;d++)for(var g=m[d],v=g.start,p=v,y=v+g.count;p<y;p+=3)void 0!==t?f(t[p],t[p+1],t[p+2],g.materialIndex):f(p,p+1,p+2,g.materialIndex);else if(void 0!==t)for(d=0;d<t.length;d+=3)f(t[d],t[d+1],t[d+2]);else for(d=0;d<r.length/3;d+=3)f(d,d+1,d+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var e=this.boundingBox.getCenter().negate();return this.translate(e.x,e.y,e.z),e},normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,t=this.boundingSphere.radius,t=0===t?1:1/t,n=new Pe;return n.set(t,0,0,-t*e.x,0,t,0,-t*e.y,0,0,t,-t*e.z,0,0,0,1),this.applyMatrix(n),this},computeFaceNormals:function(){for(var e=new Re,t=new Re,n=0,r=this.faces.length;n<r;n++){var i=this.faces[n],o=this.vertices[i.a],a=this.vertices[i.b],s=this.vertices[i.c];e.subVectors(s,a),t.subVectors(o,a),e.cross(t),e.normalize(),i.normal.copy(e)}},computeVertexNormals:function(e){var t,n,r;for(void 0===e&&(e=!0),r=new Array(this.vertices.length),t=0,n=this.vertices.length;t<n;t++)r[t]=new Re;if(e)for(var i,o,a,s=new Re,c=new Re,l=0,u=this.faces.length;l<u;l++)h=this.faces[l],i=this.vertices[h.a],o=this.vertices[h.b],a=this.vertices[h.c],s.subVectors(a,o),c.subVectors(i,o),s.cross(c),r[h.a].add(s),r[h.b].add(s),r[h.c].add(s);else for(this.computeFaceNormals(),l=0,u=this.faces.length;l<u;l++)r[(h=this.faces[l]).a].add(h.normal),r[h.b].add(h.normal),r[h.c].add(h.normal);for(t=0,n=this.vertices.length;t<n;t++)r[t].normalize();for(l=0,u=this.faces.length;l<u;l++){var h,d=(h=this.faces[l]).vertexNormals;3===d.length?(d[0].copy(r[h.a]),d[1].copy(r[h.b]),d[2].copy(r[h.c])):(d[0]=r[h.a].clone(),d[1]=r[h.b].clone(),d[2]=r[h.c].clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var e,t;for(this.computeFaceNormals(),e=0,t=this.faces.length;e<t;e++){var n,r=(n=this.faces[e]).vertexNormals;3===r.length?(r[0].copy(n.normal),r[1].copy(n.normal),r[2].copy(n.normal)):(r[0]=n.normal.clone(),r[1]=n.normal.clone(),r[2]=n.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var e,t,n;for(a=0,s=this.faces.length;a<s;a++)for((n=this.faces[a]).__originalFaceNormal?n.__originalFaceNormal.copy(n.normal):n.__originalFaceNormal=n.normal.clone(),n.__originalVertexNormals||(n.__originalVertexNormals=[]),e=0,t=n.vertexNormals.length;e<t;e++)n.__originalVertexNormals[e]?n.__originalVertexNormals[e].copy(n.vertexNormals[e]):n.__originalVertexNormals[e]=n.vertexNormals[e].clone();var r=new fe;for(r.faces=this.faces,e=0,t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];for(var i=this.morphNormals[e].faceNormals,o=this.morphNormals[e].vertexNormals,a=0,s=this.faces.length;a<s;a++)c=new Re,l={a:new Re,b:new Re,c:new Re},i.push(c),o.push(l)}var c,l,u=this.morphNormals[e];for(r.vertices=this.morphTargets[e].vertices,r.computeFaceNormals(),r.computeVertexNormals(),a=0,s=this.faces.length;a<s;a++)n=this.faces[a],c=u.faceNormals[a],l=u.vertexNormals[a],c.copy(n.normal),l.a.copy(n.vertexNormals[0]),l.b.copy(n.vertexNormals[1]),l.c.copy(n.vertexNormals[2])}for(a=0,s=this.faces.length;a<s;a++)(n=this.faces[a]).normal=n.__originalFaceNormal,n.vertexNormals=n.__originalVertexNormals},computeLineDistances:function(){for(var e=0,t=this.vertices,n=0,r=t.length;n<r;n++)0<n&&(e+=t[n].distanceTo(t[n-1])),this.lineDistances[n]=e},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new xr),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new wr),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,n){if(e&&e.isGeometry){var r,i=this.vertices.length,o=this.vertices,a=e.vertices,s=this.faces,c=e.faces,l=this.faceVertexUvs[0],u=e.faceVertexUvs[0],h=this.colors,d=e.colors;void 0===n&&(n=0),void 0!==t&&(r=(new R).getNormalMatrix(t));for(var p=0,f=a.length;p<f;p++){var m=a[p].clone();void 0!==t&&m.applyMatrix4(t),o.push(m)}for(p=0,f=d.length;p<f;p++)h.push(d[p].clone());for(p=0,f=c.length;p<f;p++){var g,v,y=c[p],_=y.vertexNormals,x=y.vertexColors,b=new Jr(y.a+i,y.b+i,y.c+i);b.normal.copy(y.normal),void 0!==r&&b.normal.applyMatrix3(r).normalize();for(var w=0,E=_.length;w<E;w++)g=_[w].clone(),void 0!==r&&g.applyMatrix3(r).normalize(),b.vertexNormals.push(g);b.color.copy(y.color);for(w=0,E=x.length;w<E;w++)v=x[w],b.vertexColors.push(v.clone());b.materialIndex=y.materialIndex+n,s.push(b)}for(p=0,f=u.length;p<f;p++){var M=u[p],T=[];if(void 0!==M){for(w=0,E=M.length;w<E;w++)T.push(M[w].clone());l.push(T)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e)},mergeMesh:function(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)},mergeVertices:function(){for(var e,t,n,r,i={},o=[],a=[],s=Math.pow(10,4),c=0,l=this.vertices.length;c<l;c++)e=this.vertices[c],void 0===i[e=Math.round(e.x*s)+"_"+Math.round(e.y*s)+"_"+Math.round(e.z*s)]?(i[e]=c,o.push(this.vertices[c]),a[c]=o.length-1):a[c]=a[i[e]];var u=[];for(c=0,l=this.faces.length;c<l;c++){(t=this.faces[c]).a=a[t.a],t.b=a[t.b],t.c=a[t.c];for(var h=[t.a,t.b,t.c],d=0;d<3;d++)if(h[d]===h[(d+1)%3]){u.push(c);break}}for(c=u.length-1;0<=c;c--){var p=u[c];for(this.faces.splice(p,1),n=0,r=this.faceVertexUvs.length;n<r;n++)this.faceVertexUvs[n].splice(p,1)}var f=this.vertices.length-o.length;return this.vertices=o,f},setFromPoints:function(e){this.vertices=[];for(var t=0,n=e.length;t<n;t++){var r=e[t];this.vertices.push(new Re(r.x,r.y,r.z||0))}return this},sortFacesByMaterialIndex:function(){for(var e=this.faces,t=e.length,n=0;n<t;n++)e[n]._id=n;e.sort(function(e,t){return e.materialIndex-t.materialIndex});var r,i,o=this.faceVertexUvs[0],a=this.faceVertexUvs[1];o&&o.length===t&&(r=[]),a&&a.length===t&&(i=[]);for(n=0;n<t;n++){var s=e[n]._id;r&&r.push(o[s]),i&&i.push(a[s])}r&&(this.faceVertexUvs[0]=r),i&&(this.faceVertexUvs[1]=i)},toJSON:function(){var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t,n=this.parameters;for(t in n)void 0!==n[t]&&(e[t]=n[t])}else{for(var r=[],i=0;i<this.vertices.length;i++){var o=this.vertices[i];r.push(o.x,o.y,o.z)}for(var a=[],s=[],c={},l=[],u={},h=[],d={},i=0;i<this.faces.length;i++){var p,f=this.faces[i],m=void 0!==this.faceVertexUvs[0][i],g=0<f.normal.length(),v=0<f.vertexNormals.length,y=1!==f.color.r||1!==f.color.g||1!==f.color.b,_=0<f.vertexColors.length;p=x(2,3,m),p=x(p,4,g),p=x(p,5,v),p=x(p,6,y),p=x(p,7,_),a.push(p),a.push(f.a,f.b,f.c),a.push(f.materialIndex),m&&(p=this.faceVertexUvs[0][i],a.push(E(p[0]),E(p[1]),E(p[2]))),g&&a.push(b(f.normal)),v&&(m=f.vertexNormals,a.push(b(m[0]),b(m[1]),b(m[2]))),y&&a.push(w(f.color)),_&&(p=f.vertexColors,a.push(w(p[0]),w(p[1]),w(p[2])))}e.data={},e.data.vertices=r,e.data.normals=s,0<l.length&&(e.data.colors=l),0<h.length&&(e.data.uvs=[h]),e.data.faces=a}return e;function x(e,t,n){return n?e|1<<t:e&~(1<<t)}function b(e){var t=e.x.toString()+e.y.toString()+e.z.toString();return void 0===c[t]&&(c[t]=s.length/3,s.push(e.x,e.y,e.z)),c[t]}function w(e){var t=e.r.toString()+e.g.toString()+e.b.toString();return void 0===u[t]&&(u[t]=l.length,l.push(e.getHex())),u[t]}function E(e){var t=e.x.toString()+e.y.toString();return void 0===d[t]&&(d[t]=h.length/2,h.push(e.x,e.y)),d[t]}},clone:function(){return(new fe).copy(this)},copy:function(e){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;for(var t,n,r=e.vertices,i=0,o=r.length;i<o;i++)this.vertices.push(r[i].clone());var a=e.colors;for(i=0,o=a.length;i<o;i++)this.colors.push(a[i].clone());var s=e.faces;for(i=0,o=s.length;i<o;i++)this.faces.push(s[i].clone());for(i=0,o=e.faceVertexUvs.length;i<o;i++){var c=e.faceVertexUvs[i];for(void 0===this.faceVertexUvs[i]&&(this.faceVertexUvs[i]=[]),t=0,n=c.length;t<n;t++){for(var l=c[t],u=[],h=0,d=l.length;h<d;h++){var p=l[h];u.push(p.clone())}this.faceVertexUvs[i].push(u)}}var f=e.morphTargets;for(i=0,o=f.length;i<o;i++){var m={};if(m.name=f[i].name,void 0!==f[i].vertices)for(m.vertices=[],t=0,n=f[i].vertices.length;t<n;t++)m.vertices.push(f[i].vertices[t].clone());if(void 0!==f[i].normals)for(m.normals=[],t=0,n=f[i].normals.length;t<n;t++)m.normals.push(f[i].normals[t].clone());this.morphTargets.push(m)}var g=e.morphNormals;for(i=0,o=g.length;i<o;i++){var v={};if(void 0!==g[i].vertexNormals)for(v.vertexNormals=[],t=0,n=g[i].vertexNormals.length;t<n;t++){var y=g[i].vertexNormals[t],_={};_.a=y.a.clone(),_.b=y.b.clone(),_.c=y.c.clone(),v.vertexNormals.push(_)}if(void 0!==g[i].faceNormals)for(v.faceNormals=[],t=0,n=g[i].faceNormals.length;t<n;t++)v.faceNormals.push(g[i].faceNormals[t].clone());this.morphNormals.push(v)}var x=e.skinWeights;for(i=0,o=x.length;i<o;i++)this.skinWeights.push(x[i].clone());var b=e.skinIndices;for(i=0,o=b.length;i<o;i++)this.skinIndices.push(b[i].clone());var w=e.lineDistances;for(i=0,o=w.length;i<o;i++)this.lineDistances.push(w[i]);var E=e.boundingBox,E=(null!==E&&(this.boundingBox=E.clone()),e.boundingSphere);return null!==E&&(this.boundingSphere=E.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(b.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(b.prototype,{isBufferAttribute:!0,setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==e?e.length/this.itemSize:0,this.array=e},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.dynamic=e.dynamic,this},copyAt:function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(var r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),o=new pe),t[n++]=o.r,t[n++]=o.g,t[n++]=o.b}return this},copyIndicesArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var o=e[r];t[n++]=o.a,t[n++]=o.b,t[n++]=o.c}return this},copyVector2sArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),o=new de),t[n++]=o.x,t[n++]=o.y}return this},copyVector3sArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),o=new Re),t[n++]=o.x,t[n++]=o.y,t[n++]=o.z}return this},copyVector4sArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),o=new Le),t[n++]=o.x,t[n++]=o.y,t[n++]=o.z,t[n++]=o.w}return this},set:function(e,t){return this.array.set(e,t=void 0===t?0:t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this},setXYZ:function(e,t,n,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this},setXYZW:function(e,t,n,r,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),(oi.prototype=Object.create(b.prototype)).constructor=oi,(ai.prototype=Object.create(b.prototype)).constructor=ai,(si.prototype=Object.create(b.prototype)).constructor=si,(ci.prototype=Object.create(b.prototype)).constructor=ci,li.prototype=Object.create(b.prototype),li.prototype.constructor=li,(ui.prototype=Object.create(b.prototype)).constructor=ui,hi.prototype=Object.create(b.prototype),hi.prototype.constructor=hi,(te.prototype=Object.create(b.prototype)).constructor=te,(di.prototype=Object.create(b.prototype)).constructor=di,Object.assign(pi.prototype,{computeGroups:function(e){for(var t,n=[],r=void 0,i=e.faces,o=0;o<i.length;o++){var a=i[o];a.materialIndex!==r&&(r=a.materialIndex,void 0!==t&&(t.count=3*o-t.start,n.push(t)),t={start:3*o,materialIndex:r})}void 0!==t&&(t.count=3*o-t.start,n.push(t)),this.groups=n},fromGeometry:function(e){var t=e.faces,n=e.vertices,r=e.faceVertexUvs,i=r[0]&&0<r[0].length,o=r[1]&&0<r[1].length,a=e.morphTargets,s=a.length;if(0<s){for(var c=[],l=0;l<s;l++)c[l]=[];this.morphTargets.position=c}var u=e.morphNormals,h=u.length;if(0<h){for(var d=[],l=0;l<h;l++)d[l]=[];this.morphTargets.normal=d}for(var p=e.skinIndices,f=e.skinWeights,m=p.length===n.length,g=f.length===n.length,l=0;l<t.length;l++){var v,y=t[l],_=(this.vertices.push(n[y.a],n[y.b],n[y.c]),y.vertexNormals),_=(3===_.length?this.normals.push(_[0],_[1],_[2]):(_=y.normal,this.normals.push(_,_,_)),y.vertexColors);3===_.length?this.colors.push(_[0],_[1],_[2]):(_=y.color,this.colors.push(_,_,_)),!0===i&&(void 0!==(v=r[0][l])?this.uvs.push(v[0],v[1],v[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",l),this.uvs.push(new de,new de,new de))),!0===o&&(void 0!==(v=r[1][l])?this.uvs2.push(v[0],v[1],v[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",l),this.uvs2.push(new de,new de,new de)));for(var x=0;x<s;x++){var b=a[x].vertices;c[x].push(b[y.a],b[y.b],b[y.c])}for(x=0;x<h;x++){var w=u[x].vertexNormals[l];d[x].push(w.a,w.b,w.c)}m&&this.skinIndices.push(p[y.a],p[y.b],p[y.c]),g&&this.skinWeights.push(f[y.a],f[y.b],f[y.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this}});var mi,gi,vi,yi,_i,xi,bi,wi,Ei,Mi,Ti,Si,Ai,Pi,Ri,Li,Ci,Ii,Oi,ji,Ni,Fi,Di,Hi,Ui,zi,ki,Bi,Vi,Gi,Wi,qi,Xi,Yi,Qi,Zi,Ji,Ki,$i,eo,to,no,ro,io,oo,ao,so,co,lo=1;function Z(){Object.defineProperty(this,"id",{value:lo+=2}),this.uuid=Ae.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0}}function uo(e,t,n,r,i,o){fe.call(this),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:i,depthSegments:o},this.fromBufferGeometry(new ho(e,t,n,r,i,o)),this.mergeVertices()}function ho(e,t,n,r,i,o){Z.call(this),this.type="BoxBufferGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:i,depthSegments:o};var P=this,R=(e=e||1,t=t||1,n=n||1,r=Math.floor(r)||1,i=Math.floor(i)||1,o=Math.floor(o)||1,[]),L=[],C=[],I=[],O=0,j=0;function a(e,t,n,r,i,o,a,s,c,l,u){for(var h=o/c,d=a/l,p=o/2,f=a/2,m=s/2,g=c+1,v=l+1,y=0,_=0,x=new Re,b=0;b<v;b++)for(var w=b*d-f,E=0;E<g;E++)x[e]=(E*h-p)*r,x[t]=w*i,x[n]=m,L.push(x.x,x.y,x.z),x[e]=0,x[t]=0,x[n]=0<s?1:-1,C.push(x.x,x.y,x.z),I.push(E/c),I.push(1-b/l),y+=1;for(b=0;b<l;b++)for(E=0;E<c;E++){var M=O+E+g*b,T=O+E+g*(b+1),S=O+(E+1)+g*(b+1),A=O+(E+1)+g*b;R.push(M,T,A),R.push(T,S,A),_+=6}P.addGroup(j,_,u),j+=_,O+=y}a("z","y","x",-1,-1,n,t,e,o,i,0),a("z","y","x",1,-1,n,t,-e,o,i,1),a("x","z","y",1,1,e,n,t,r,o,2),a("x","z","y",1,-1,e,n,-t,r,o,3),a("x","y","z",1,-1,e,t,n,r,i,4),a("x","y","z",-1,-1,e,t,-n,r,i,5),this.setIndex(R),this.addAttribute("position",new te(L,3)),this.addAttribute("normal",new te(C,3)),this.addAttribute("uv",new te(I,2))}function po(e,t,n,r){fe.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r},this.fromBufferGeometry(new fo(e,t,n,r)),this.mergeVertices()}function fo(e,t,n,r){Z.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};for(var i=(e=e||1)/2,o=(t=t||1)/2,a=Math.floor(n)||1,s=Math.floor(r)||1,c=a+1,l=s+1,u=e/a,h=t/s,d=[],p=[],f=[],m=[],g=0;g<l;g++)for(var v=g*h-o,y=0;y<c;y++)p.push(y*u-i,-v,0),f.push(0,0,1),m.push(y/a),m.push(1-g/s);for(g=0;g<s;g++)for(y=0;y<a;y++){var _=y+c*(g+1),x=y+1+c*(g+1),b=y+1+c*g;d.push(y+c*g,_,b),d.push(_,x,b)}this.setIndex(d),this.addAttribute("position",new te(p,3)),this.addAttribute("normal",new te(f,3)),this.addAttribute("uv",new te(m,2))}function mo(e){t.call(this),this.type="MeshBasicMaterial",this.color=new pe(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ve,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(e)}function go(e){t.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},(this.index0AttributeName=void 0)!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function vo(e,t){this.origin=void 0!==e?e:new Re,this.direction=void 0!==t?t:new Re}function yo(e,t){this.start=void 0!==e?e:new Re,this.end=void 0!==t?t:new Re}function _o(e,t,n){this.a=void 0!==e?e:new Re,this.b=void 0!==t?t:new Re,this.c=void 0!==n?n:new Re}function m(e,t){f.call(this),this.type="Mesh",this.geometry=void 0!==e?e:new Z,this.material=void 0!==t?t:new mo({color:16777215*Math.random()}),this.drawMode=Ut,this.updateMorphTargets()}function xo(e,t,n,r,i,o,a){return _o.barycoordFromPoint(e,t,n,r,ao),i.multiplyScalar(ao.x),o.multiplyScalar(ao.y),a.multiplyScalar(ao.z),i.add(o).add(a),i.clone()}function bo(e,t,n,r,i,o,a,s){r=t.side===ne?r.intersectTriangle(a,o,i,!0,s):r.intersectTriangle(i,o,a,t.side!==re,s);if(null===r)return null;co.copy(s),co.applyMatrix4(e.matrixWorld);i=n.ray.origin.distanceTo(co);return i<n.near||i>n.far?null:{distance:i,point:co.clone(),object:e}}function wo(e,t,n,r,i,o,a,s){Ji.fromBufferAttribute(r,o),Ki.fromBufferAttribute(r,a),$i.fromBufferAttribute(r,s);r=bo(e,e.material,t,n,Ji,Ki,$i,so);return r&&(i&&(ro.fromBufferAttribute(i,o),io.fromBufferAttribute(i,a),oo.fromBufferAttribute(i,s),r.uv=xo(so,Ji,Ki,$i,ro,io,oo)),r.face=new Jr(o,a,s,_o.normal(Ji,Ki,$i)),r.faceIndex=o),r}function Eo(i,n,o,r){var a,s,c,l=new pe(0),u=0;function h(e,t){n.buffers.color.setClear(e.r,e.g,e.b,t,r)}return{getClearColor:function(){return l},setClearColor:function(e,t){l.set(e),h(l,u=void 0!==t?t:1)},getClearAlpha:function(){return u},setClearAlpha:function(e){h(l,u=e)},render:function(e,t,n,r){null===(t=t.background)?h(l,u):t&&t.isColor&&(h(t,1),r=!0),(i.autoClear||r)&&i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil),t&&t.isCubeTexture?(void 0===c&&((c=new m(new ho(1,1,1),new go({uniforms:Wn.cube.uniforms,vertexShader:Wn.cube.vertexShader,fragmentShader:Wn.cube.fragmentShader,side:ne,depthTest:!0,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),c.geometry.removeAttribute("uv"),c.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},o.update(c.geometry)),c.material.uniforms.tCube.value=t,e.push(c,c.geometry,c.material,0,null)):t&&t.isTexture&&(void 0===a&&(a=new Zr(-1,1,1,-1,0,1),s=new m(new fo(2,2),new mo({depthTest:!1,depthWrite:!1,fog:!1})),o.update(s.geometry)),s.material.map=t,i.renderBufferDirect(a,null,s.geometry,s.material,s,null))}}}function Mo(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program&&t.program&&e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function To(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function So(){var a=[],s=0,c=[],l=[];return{opaque:c,transparent:l,init:function(){s=0,l.length=c.length=0},push:function(e,t,n,r,i){var o=a[s];void 0===o?(o={id:e.id,object:e,geometry:t,material:n,program:n.program,renderOrder:e.renderOrder,z:r,group:i},a[s]=o):(o.id=e.id,o.object=e,o.geometry=t,o.material=n,o.program=n.program,o.renderOrder=e.renderOrder,o.z=r,o.group=i),(!0===n.transparent?l:c).push(o),s++},sort:function(){1<c.length&&c.sort(Mo),1<l.length&&l.sort(To)}}}function Ao(){var n={};return{get:function(e,t){return e=e.id+","+t.id,void 0===(t=n[e])&&(t=new So,n[e]=t),t},dispose:function(){n={}}}}function Po(e,t){return Math.abs(t[1])-Math.abs(e[1])}function Ro(p){var f={},m=new Float32Array(8);return{update:function(e,t,n,r){var i=e.morphTargetInfluences,o=i.length;if(void 0===(a=f[t.id])){for(var a=[],s=0;s<o;s++)a[s]=[s,0];f[t.id]=a}for(var c=n.morphTargets&&t.morphAttributes.position,l=n.morphNormals&&t.morphAttributes.normal,s=0;s<o;s++)0!==(u=a[s])[1]&&(c&&t.removeAttribute("morphTarget"+s),l)&&t.removeAttribute("morphNormal"+s);for(s=0;s<o;s++)(u=a[s])[0]=s,u[1]=i[s];a.sort(Po);for(var u,s=0;s<8;s++){if(u=a[s]){var h=u[0],d=u[1];if(d){c&&t.addAttribute("morphTarget"+s,c[h]),l&&t.addAttribute("morphNormal"+s,l[h]),m[s]=d;continue}}m[s]=0}r.getUniforms().setValue(p,"morphTargetInfluences",m)}}}function Lo(i,o,a){var s,c,l;this.setMode=function(e){s=e},this.setIndex=function(e){c=e.type,l=e.bytesPerElement},this.render=function(e,t){i.drawElements(s,t,c,e*l),a.calls++,a.vertices+=t,s===i.TRIANGLES?a.faces+=t/3:s===i.POINTS&&(a.points+=t)},this.renderInstances=function(e,t,n){var r=o.get("ANGLE_instanced_arrays");null===r?console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays."):(r.drawElementsInstancedANGLE(s,n,c,t*l,e.maxInstancedCount),a.calls++,a.vertices+=n*e.maxInstancedCount,s===i.TRIANGLES?a.faces+=e.maxInstancedCount*n/3:s===i.POINTS&&(a.points+=e.maxInstancedCount*n))}}function Co(o,a,s){var c;this.setMode=function(e){c=e},this.render=function(e,t){o.drawArrays(c,e,t),s.calls++,s.vertices+=t,c===o.TRIANGLES?s.faces+=t/3:c===o.POINTS&&(s.points+=t)},this.renderInstances=function(e,t,n){var r,i=a.get("ANGLE_instanced_arrays");null===i?console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays."):((r=e.attributes.position).isInterleavedBufferAttribute?(n=r.data.count,i.drawArraysInstancedANGLE(c,0,n,e.maxInstancedCount)):i.drawArraysInstancedANGLE(c,t,n,e.maxInstancedCount),s.calls++,s.vertices+=n*e.maxInstancedCount,c===o.TRIANGLES?s.faces+=e.maxInstancedCount*n/3:c===o.POINTS&&(s.points+=e.maxInstancedCount*n))}}function Io(h,d,i){var o={},p={};function a(e){var t,e=e.target,n=o[e.id];for(t in null!==n.index&&d.remove(n.index),n.attributes)d.remove(n.attributes[t]);e.removeEventListener("dispose",a),delete o[e.id];var r=p[e.id];r&&(d.remove(r),delete p[e.id]),(r=p[n.id])&&(d.remove(r),delete p[n.id]),i.geometries--}return{get:function(e,t){var n=o[t.id];return n||(t.addEventListener("dispose",a),t.isBufferGeometry?n=t:t.isGeometry&&(void 0===t._bufferGeometry&&(t._bufferGeometry=(new Z).setFromObject(e)),n=t._bufferGeometry),o[t.id]=n,i.geometries++),n},update:function(e){var t=e.index,n=e.attributes;for(r in null!==t&&d.update(t,h.ELEMENT_ARRAY_BUFFER),n)d.update(n[r],h.ARRAY_BUFFER);var r,i=e.morphAttributes;for(r in i)for(var o=i[r],a=0,s=o.length;a<s;a++)d.update(o[a],h.ARRAY_BUFFER)},getWireframeAttribute:function(e){var t=p[e.id];if(!t){var n=[],r=e.index,i=e.attributes;if(null!==r)for(var o=0,a=(u=r.array).length;o<a;o+=3){var s=u[o+0],c=u[o+1],l=u[o+2];n.push(s,c,c,l,l,s)}else for(var u,o=0,a=(u=i.position.array).length/3-1;o<a;o+=3){s=o+0,c=o+1,l=o+2;n.push(s,c,c,l,l,s)}t=new(65535<fi(n)?hi:li)(n,1),d.update(t,h.ELEMENT_ARRAY_BUFFER),p[e.id]=t}return t}}}function Oo(){var n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];var t;switch(e.type){case"DirectionalLight":t={direction:new Re,color:new pe,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new de};break;case"SpotLight":t={position:new Re,direction:new Re,color:new pe,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new de};break;case"PointLight":t={position:new Re,color:new pe,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new de,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":t={direction:new Re,skyColor:new pe,groundColor:new pe};break;case"RectAreaLight":t={color:new pe,position:new Re,halfWidth:new Re,halfHeight:new Re}}return n[e.id]=t}}}function jo(){var b=new Oo,w={hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},E=new Re,M=new Pe,T=new Pe;return{setup:function(e,t,n){for(var r=0,i=0,o=0,a=0,s=0,c=0,l=0,u=0,h=n.matrixWorldInverse,d=0,p=e.length;d<p;d++){var f,m,g=e[d],v=g.color,y=g.intensity,_=g.distance,x=g.shadow&&g.shadow.map?g.shadow.map.texture:null;g.isAmbientLight?(r+=v.r*y,i+=v.g*y,o+=v.b*y):g.isDirectionalLight?((m=b.get(g)).color.copy(g.color).multiplyScalar(g.intensity),m.direction.setFromMatrixPosition(g.matrixWorld),E.setFromMatrixPosition(g.target.matrixWorld),m.direction.sub(E),m.direction.transformDirection(h),m.shadow=g.castShadow,g.castShadow&&(f=g.shadow,m.shadowBias=f.bias,m.shadowRadius=f.radius,m.shadowMapSize=f.mapSize),w.directionalShadowMap[a]=x,w.directionalShadowMatrix[a]=g.shadow.matrix,w.directional[a]=m,a++):g.isSpotLight?((m=b.get(g)).position.setFromMatrixPosition(g.matrixWorld),m.position.applyMatrix4(h),m.color.copy(v).multiplyScalar(y),m.distance=_,m.direction.setFromMatrixPosition(g.matrixWorld),E.setFromMatrixPosition(g.target.matrixWorld),m.direction.sub(E),m.direction.transformDirection(h),m.coneCos=Math.cos(g.angle),m.penumbraCos=Math.cos(g.angle*(1-g.penumbra)),m.decay=0===g.distance?0:g.decay,m.shadow=g.castShadow,g.castShadow&&(f=g.shadow,m.shadowBias=f.bias,m.shadowRadius=f.radius,m.shadowMapSize=f.mapSize),w.spotShadowMap[c]=x,w.spotShadowMatrix[c]=g.shadow.matrix,w.spot[c]=m,c++):g.isRectAreaLight?((m=b.get(g)).color.copy(v).multiplyScalar(y/(g.width*g.height)),m.position.setFromMatrixPosition(g.matrixWorld),m.position.applyMatrix4(h),T.identity(),M.copy(g.matrixWorld),M.premultiply(h),T.extractRotation(M),m.halfWidth.set(.5*g.width,0,0),m.halfHeight.set(0,.5*g.height,0),m.halfWidth.applyMatrix4(T),m.halfHeight.applyMatrix4(T),w.rectArea[l]=m,l++):g.isPointLight?((m=b.get(g)).position.setFromMatrixPosition(g.matrixWorld),m.position.applyMatrix4(h),m.color.copy(g.color).multiplyScalar(g.intensity),m.distance=g.distance,m.decay=0===g.distance?0:g.decay,m.shadow=g.castShadow,g.castShadow&&(f=g.shadow,m.shadowBias=f.bias,m.shadowRadius=f.radius,m.shadowMapSize=f.mapSize,m.shadowCameraNear=f.camera.near,m.shadowCameraFar=f.camera.far),w.pointShadowMap[s]=x,w.pointShadowMatrix[s]=g.shadow.matrix,w.point[s]=m,s++):g.isHemisphereLight&&((m=b.get(g)).direction.setFromMatrixPosition(g.matrixWorld),m.direction.transformDirection(h),m.direction.normalize(),m.skyColor.copy(g.color).multiplyScalar(y),m.groundColor.copy(g.groundColor).multiplyScalar(y),w.hemi[u]=m,u++)}w.ambient[0]=r,w.ambient[1]=i,w.ambient[2]=o,w.directional.length=a,w.spot.length=c,w.rectArea.length=l,w.point.length=s,w.hemi.length=u,w.hash=a+","+s+","+c+","+l+","+u+","+t.length},state:w}}function No(i,o){var a={};return{update:function(e){var t=o.frame,n=e.geometry,r=i.get(e,n);return a[r.id]!==t&&(n.isGeometry&&r.updateFromObject(e),i.update(r),a[r.id]=t),r},clear:function(){a={}}}}function Fo(e,t,n){var r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),!1===e.getShaderParameter(r,e.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==e.getShaderInfoLog(r)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",t===e.VERTEX_SHADER?"vertex":"fragment",e.getShaderInfoLog(r),(e=>{for(var t=e.split("\n"),n=0;n<t.length;n++)t[n]=n+1+": "+t[n];return t.join("\n")})(n)),r}Object.assign(Z.prototype,l.prototype,{isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){Array.isArray(e)?this.index=new(65535<fi(e)?hi:li)(e,1):this.index=e},addAttribute:function(e,t){if(t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute){if("index"!==e)return this.attributes[e]=t,this;console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t)}else console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.addAttribute(e,new b(t,arguments[2]))},getAttribute:function(e){return this.attributes[e]},removeAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,n){this.groups.push({start:e,count:t,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix:function(e){var t=this.attributes.position,t=(void 0!==t&&(e.applyToBufferAttribute(t),t.needsUpdate=!0),this.attributes.normal);return void 0!==t&&((new R).getNormalMatrix(e).applyToBufferAttribute(t),t.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:(Ei=new Pe,function(e){return Ei.makeRotationX(e),this.applyMatrix(Ei),this}),rotateY:(wi=new Pe,function(e){return wi.makeRotationY(e),this.applyMatrix(wi),this}),rotateZ:(bi=new Pe,function(e){return bi.makeRotationZ(e),this.applyMatrix(bi),this}),translate:(xi=new Pe,function(e,t,n){return xi.makeTranslation(e,t,n),this.applyMatrix(xi),this}),scale:(_i=new Pe,function(e,t,n){return _i.makeScale(e,t,n),this.applyMatrix(_i),this}),lookAt:(yi=new f,function(e){yi.lookAt(e),yi.updateMatrix(),this.applyMatrix(yi.matrix)}),center:function(){this.computeBoundingBox();var e=this.boundingBox.getCenter().negate();return this.translate(e.x,e.y,e.z),e},setFromObject:function(e){var t,n,r=e.geometry;return e.isPoints||e.isLine?(n=new te(3*r.vertices.length,3),t=new te(3*r.colors.length,3),this.addAttribute("position",n.copyVector3sArray(r.vertices)),this.addAttribute("color",t.copyColorsArray(r.colors)),r.lineDistances&&r.lineDistances.length===r.vertices.length&&(n=new te(r.lineDistances.length,1),this.addAttribute("lineDistance",n.copyArray(r.lineDistances))),null!==r.boundingSphere&&(this.boundingSphere=r.boundingSphere.clone()),null!==r.boundingBox&&(this.boundingBox=r.boundingBox.clone())):e.isMesh&&r&&r.isGeometry&&this.fromGeometry(r),this},setFromPoints:function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];t.push(i.x,i.y,i.z||0)}return this.addAttribute("position",new te(t,3)),this},updateFromObject:function(e){var t,n=e.geometry;if(e.isMesh){var r=n.__directGeometry;if(!0===n.elementsNeedUpdate&&(r=void 0,n.elementsNeedUpdate=!1),void 0===r)return this.fromGeometry(n);r.verticesNeedUpdate=n.verticesNeedUpdate,r.normalsNeedUpdate=n.normalsNeedUpdate,r.colorsNeedUpdate=n.colorsNeedUpdate,r.uvsNeedUpdate=n.uvsNeedUpdate,r.groupsNeedUpdate=n.groupsNeedUpdate,n.verticesNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.groupsNeedUpdate=!1,n=r}return!0===n.verticesNeedUpdate&&(void 0!==(t=this.attributes.position)&&(t.copyVector3sArray(n.vertices),t.needsUpdate=!0),n.verticesNeedUpdate=!1),!0===n.normalsNeedUpdate&&(void 0!==(t=this.attributes.normal)&&(t.copyVector3sArray(n.normals),t.needsUpdate=!0),n.normalsNeedUpdate=!1),!0===n.colorsNeedUpdate&&(void 0!==(t=this.attributes.color)&&(t.copyColorsArray(n.colors),t.needsUpdate=!0),n.colorsNeedUpdate=!1),n.uvsNeedUpdate&&(void 0!==(t=this.attributes.uv)&&(t.copyVector2sArray(n.uvs),t.needsUpdate=!0),n.uvsNeedUpdate=!1),n.lineDistancesNeedUpdate&&(void 0!==(t=this.attributes.lineDistance)&&(t.copyArray(n.lineDistances),t.needsUpdate=!0),n.lineDistancesNeedUpdate=!1),n.groupsNeedUpdate&&(n.computeGroups(e.geometry),this.groups=n.groups,n.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=(new pi).fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var t,n=new Float32Array(3*e.vertices.length);for(t in this.addAttribute("position",new b(n,3).copyVector3sArray(e.vertices)),0<e.normals.length&&(n=new Float32Array(3*e.normals.length),this.addAttribute("normal",new b(n,3).copyVector3sArray(e.normals))),0<e.colors.length&&(n=new Float32Array(3*e.colors.length),this.addAttribute("color",new b(n,3).copyColorsArray(e.colors))),0<e.uvs.length&&(n=new Float32Array(2*e.uvs.length),this.addAttribute("uv",new b(n,2).copyVector2sArray(e.uvs))),0<e.uvs2.length&&(n=new Float32Array(2*e.uvs2.length),this.addAttribute("uv2",new b(n,2).copyVector2sArray(e.uvs2))),0<e.indices.length&&(n=new(65535<fi(e.indices)?Uint32Array:Uint16Array)(3*e.indices.length),this.setIndex(new b(n,1).copyIndicesArray(e.indices))),this.groups=e.groups,e.morphTargets){for(var r=[],i=e.morphTargets[t],o=0,a=i.length;o<a;o++){var s=i[o],c=new te(3*s.length,3);r.push(c.copyVector3sArray(s))}this.morphAttributes[t]=r}return 0<e.skinIndices.length&&(n=new te(4*e.skinIndices.length,4),this.addAttribute("skinIndex",n.copyVector4sArray(e.skinIndices))),0<e.skinWeights.length&&(n=new te(4*e.skinWeights.length,4),this.addAttribute("skinWeight",n.copyVector4sArray(e.skinWeights))),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new xr);var e=this.attributes.position;void 0!==e?this.boundingBox.setFromBufferAttribute(e):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:(gi=new xr,vi=new Re,function(){null===this.boundingSphere&&(this.boundingSphere=new wr);var e=this.attributes.position;if(e){for(var t=this.boundingSphere.center,n=(gi.setFromBufferAttribute(e),gi.getCenter(t),0),r=0,i=e.count;r<i;r++)vi.x=e.getX(r),vi.y=e.getY(r),vi.z=e.getZ(r),n=Math.max(n,t.distanceToSquared(vi));this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}),computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,t=this.attributes,n=this.groups;if(t.position){var r=t.position.array;if(void 0===t.normal)this.addAttribute("normal",new b(new Float32Array(r.length),3));else for(var i=t.normal.array,o=0,a=i.length;o<a;o++)i[o]=0;var s,c,l,u=t.normal.array,h=new Re,d=new Re,p=new Re,f=new Re,m=new Re;if(e){var g=e.array;0===n.length&&this.addGroup(0,g.length);for(var v=0,y=n.length;v<y;++v)for(var _=n[v],x=_.start,o=x,a=x+_.count;o<a;o+=3)s=3*g[o+0],c=3*g[o+1],l=3*g[o+2],h.fromArray(r,s),d.fromArray(r,c),p.fromArray(r,l),f.subVectors(p,d),m.subVectors(h,d),f.cross(m),u[s]+=f.x,u[1+s]+=f.y,u[2+s]+=f.z,u[c]+=f.x,u[1+c]+=f.y,u[2+c]+=f.z,u[l]+=f.x,u[1+l]+=f.y,u[2+l]+=f.z}else for(o=0,a=r.length;o<a;o+=9)h.fromArray(r,o),d.fromArray(r,o+3),p.fromArray(r,o+6),f.subVectors(p,d),m.subVectors(h,d),f.cross(m),u[o]=f.x,u[o+1]=f.y,u[o+2]=f.z,u[o+3]=f.x,u[o+4]=f.y,u[o+5]=f.z,u[o+6]=f.x,u[o+7]=f.y,u[o+8]=f.z;this.normalizeNormals(),t.normal.needsUpdate=!0}},merge:function(e,t){if(e&&e.isBufferGeometry){void 0===t&&(t=0);var n,r=this.attributes;for(n in r)if(void 0!==e.attributes[n])for(var i=r[n].array,o=e.attributes[n],a=o.array,s=0,c=o.itemSize*t;s<a.length;s++,c++)i[c]=a[s];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},normalizeNormals:(mi=new Re,function(){for(var e=this.attributes.normal,t=0,n=e.count;t<n;t++)mi.x=e.getX(t),mi.y=e.getY(t),mi.z=e.getZ(t),mi.normalize(),e.setXYZ(t,mi.x,mi.y,mi.z)}),toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var e,t=new Z,n=this.index.array,r=this.attributes;for(e in r){for(var i=r[e],o=i.array,a=i.itemSize,s=new o.constructor(n.length*a),c=0,l=0,u=0,h=n.length;u<h;u++)for(var c=n[u]*a,d=0;d<a;d++)s[l++]=o[c++];t.addAttribute(e,new b(s,a))}return t},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t=this.parameters;for(n in t)void 0!==t[n]&&(e[n]=t[n])}else{e.data={attributes:{}};var n,r=this.index,i=(null!==r&&(a=Array.prototype.slice.call(r.array),e.data.index={type:r.array.constructor.name,array:a}),this.attributes);for(n in i){var o=i[n],a=Array.prototype.slice.call(o.array);e.data.attributes[n]={itemSize:o.itemSize,type:o.array.constructor.name,array:a,normalized:o.normalized}}r=this.groups,r=(0<r.length&&(e.data.groups=JSON.parse(JSON.stringify(r))),this.boundingSphere);null!==r&&(e.data.boundingSphere={center:r.center.toArray(),radius:r.radius})}return e},clone:function(){return(new Z).copy(this)},copy:function(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var t,n=e.index,r=(null!==n&&this.setIndex(n.clone()),e.attributes);for(t in r){var i=r[t];this.addAttribute(t,i.clone())}var o=e.morphAttributes;for(t in o){for(var a=[],s=o[t],c=0,l=s.length;c<l;c++)a.push(s[c].clone());this.morphAttributes[t]=a}var u=e.groups;for(c=0,l=u.length;c<l;c++){var h=u[c];this.addGroup(h.start,h.count,h.materialIndex)}n=e.boundingBox,null!==n&&(this.boundingBox=n.clone()),n=e.boundingSphere;return null!==n&&(this.boundingSphere=n.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),(uo.prototype=Object.create(fe.prototype)).constructor=uo,(ho.prototype=Object.create(Z.prototype)).constructor=ho,(po.prototype=Object.create(fe.prototype)).constructor=po,(fo.prototype=Object.create(Z.prototype)).constructor=fo,((mo.prototype=Object.create(t.prototype)).constructor=mo).prototype.isMeshBasicMaterial=!0,mo.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this},((go.prototype=Object.create(t.prototype)).constructor=go).prototype.isShaderMaterial=!0,go.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Ie.clone(e.uniforms),this.defines=e.defines,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=e.extensions,this},go.prototype.toJSON=function(e){e=t.prototype.toJSON.call(this,e);return e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e},Object.assign(vo.prototype,{set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return(t||new Re).copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:(ji=new Re,function(e){return this.origin.copy(this.at(e,ji)),this}),closestPointToPoint:function(e,t){t=t||new Re,t.subVectors(e,this.origin),e=t.dot(this.direction);return e<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(e).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:(Oi=new Re,function(e){var t=Oi.subVectors(e,this.origin).dot(this.direction);return(t<0?this.origin:(Oi.copy(this.direction).multiplyScalar(t).add(this.origin),Oi)).distanceToSquared(e)}),distanceSqToSegment:(Li=new Re,Ci=new Re,Ii=new Re,function(e,t,n,r){Li.copy(e).add(t).multiplyScalar(.5),Ci.copy(t).sub(e).normalize(),Ii.copy(this.origin).sub(Li);var i,o,a,e=.5*e.distanceTo(t),t=-this.direction.dot(Ci),s=Ii.dot(this.direction),c=-Ii.dot(Ci),l=Ii.lengthSq(),u=Math.abs(1-t*t);return u=0<u?(o=t*s-c,a=e*u,0<=(i=t*c-s)?-a<=o?o<=a?(i*=u=1/u)*(i+t*(o*=u)+2*s)+o*(t*i+o+2*c)+l:(o=e,-(i=Math.max(0,-(t*o+s)))*i+o*(o+2*c)+l):(o=-e,-(i=Math.max(0,-(t*o+s)))*i+o*(o+2*c)+l):o<=-a?-(i=Math.max(0,-(-t*e+s)))*i+(o=0<i?-e:Math.min(Math.max(-e,-c),e))*(o+2*c)+l:o<=a?(i=0,(o=Math.min(Math.max(-e,-c),e))*(o+2*c)+l):-(i=Math.max(0,-(t*e+s)))*i+(o=0<i?e:Math.min(Math.max(-e,-c),e))*(o+2*c)+l):(o=0<t?-e:e,-(i=Math.max(0,-(t*o+s)))*i+o*(o+2*c)+l),n&&n.copy(this.direction).multiplyScalar(i).add(this.origin),r&&r.copy(Ci).multiplyScalar(o).add(Li),u}),intersectSphere:(Ri=new Re,function(e,t){Ri.subVectors(e.center,this.origin);var n=Ri.dot(this.direction),r=Ri.dot(Ri)-n*n,e=e.radius*e.radius;return e<r||(r=n+(e=Math.sqrt(e-r)),(n=n-e)<0&&r<0)?null:n<0?this.at(r,t):this.at(n,t)}),intersectsSphere:function(e){return this.distanceToPoint(e.center)<=e.radius},distanceToPlane:function(e){var t=e.normal.dot(this.direction);return 0===t?0===e.distanceToPoint(this.origin)?0:null:0<=(e=-(this.origin.dot(e.normal)+e.constant)/t)?e:null},intersectPlane:function(e,t){e=this.distanceToPlane(e);return null===e?null:this.at(e,t)},intersectsPlane:function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0},intersectBox:function(e,t){var n,r,i,o=1/this.direction.x,a=1/this.direction.y,s=1/this.direction.z,c=this.origin,o=0<=o?(n=(e.min.x-c.x)*o,(e.max.x-c.x)*o):(n=(e.max.x-c.x)*o,(e.min.x-c.x)*o),a=0<=a?(i=(e.min.y-c.y)*a,(e.max.y-c.y)*a):(i=(e.max.y-c.y)*a,(e.min.y-c.y)*a);return a<n||o<i||((n<i||n!=n)&&(n=i),(a<o||o!=o)&&(o=a),(i=0<=s?(r=(e.min.z-c.z)*s,(e.max.z-c.z)*s):(r=(e.max.z-c.z)*s,(e.min.z-c.z)*s))<n)||o<r||((n<r||n!=n)&&(n=r),(o=i<o||o!=o?i:o)<0)?null:this.at(0<=n?n:o,t)},intersectsBox:(Pi=new Re,function(e){return null!==this.intersectBox(e,Pi)}),intersectTriangle:(Mi=new Re,Ti=new Re,Si=new Re,Ai=new Re,function(e,t,n,r,i){Ti.subVectors(t,e),Si.subVectors(n,e),Ai.crossVectors(Ti,Si);var o,t=this.direction.dot(Ai);if(0<t){if(r)return null;o=1}else{if(!(t<0))return null;o=-1,t=-t}Mi.subVectors(this.origin,e);n=o*this.direction.dot(Si.crossVectors(Mi,Si));return n<0||(r=o*this.direction.dot(Ti.cross(Mi)))<0||t<n+r||(e=-o*Mi.dot(Ai))<0?null:this.at(e/t,i)}),applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}}),Object.assign(yo.prototype,{set:function(e,t){return this.start.copy(e),this.end.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){return(e||new Re).addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return(e||new Re).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){t=t||new Re;return this.delta(t).multiplyScalar(e).add(this.start)},closestPointToPointParameter:(Ni=new Re,Fi=new Re,function(e,t){Ni.subVectors(e,this.start),Fi.subVectors(this.end,this.start);e=Fi.dot(Fi),e=Fi.dot(Ni)/e;return e=t?Ae.clamp(e,0,1):e}),closestPointToPoint:function(e,t,n){e=this.closestPointToPointParameter(e,t),t=n||new Re;return this.delta(t).multiplyScalar(e).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}}),Object.assign(_o,{normal:(ki=new Re,function(e,t,n,r){r=r||new Re,r.subVectors(n,t),ki.subVectors(e,t),r.cross(ki),n=r.lengthSq();return 0<n?r.multiplyScalar(1/Math.sqrt(n)):r.set(0,0,0)}),barycoordFromPoint:(Hi=new Re,Ui=new Re,zi=new Re,function(e,t,n,r,i){Hi.subVectors(r,t),Ui.subVectors(n,t),zi.subVectors(e,t);var r=Hi.dot(Hi),n=Hi.dot(Ui),e=Hi.dot(zi),t=Ui.dot(Ui),o=Ui.dot(zi),a=r*t-n*n,i=i||new Re;return 0==a?i.set(-2,-1,-1):i.set(1-(t=(t*e-n*o)*(i=1/a))-(a=(r*o-n*e)*i),a,t)}),containsPoint:(Di=new Re,function(e,t,n,r){e=_o.barycoordFromPoint(e,t,n,r,Di);return 0<=e.x&&0<=e.y&&e.x+e.y<=1})}),Object.assign(_o.prototype,{set:function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this},setFromPointsAndIndices:function(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},area:(qi=new Re,Xi=new Re,function(){return qi.subVectors(this.c,this.b),Xi.subVectors(this.a,this.b),.5*qi.cross(Xi).length()}),midpoint:function(e){return(e||new Re).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(e){return _o.normal(this.a,this.b,this.c,e)},plane:function(e){return(e||new Er).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(e,t){return _o.barycoordFromPoint(e,this.a,this.b,this.c,t)},containsPoint:function(e){return _o.containsPoint(e,this.a,this.b,this.c)},closestPointToPoint:(Bi=new Er,Vi=[new yo,new yo,new yo],Gi=new Re,Wi=new Re,function(e,t){var n=t||new Re,r=1/0;if(Bi.setFromCoplanarPoints(this.a,this.b,this.c),Bi.projectPoint(e,Gi),!0===this.containsPoint(Gi))n.copy(Gi);else{Vi[0].set(this.a,this.b),Vi[1].set(this.b,this.c),Vi[2].set(this.c,this.a);for(var i=0;i<Vi.length;i++){Vi[i].closestPointToPoint(Gi,!0,Wi);var o=Gi.distanceToSquared(Wi);o<r&&(r=o,n.copy(Wi))}}return n}),equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}),m.prototype=Object.assign(Object.create(f.prototype),{constructor:m,isMesh:!0,setDrawMode:function(e){this.drawMode=e},copy:function(e){return f.prototype.copy.call(this,e),this.drawMode=e.drawMode,void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this},updateMorphTargets:function(){var e,t,n,r=this.geometry;if(r.isBufferGeometry){var i=r.morphAttributes,o=Object.keys(i);if(0<o.length){var a=i[o[0]];if(void 0!==a)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=a.length;e<t;e++)n=a[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}else{var s=r.morphTargets;if(void 0!==s&&0<s.length)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=s.length;e<t;e++)n=s[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}},raycast:(Yi=new Pe,Qi=new vo,Zi=new wr,Ji=new Re,Ki=new Re,$i=new Re,eo=new Re,to=new Re,no=new Re,ro=new de,io=new de,oo=new de,ao=new Re,so=new Re,co=new Re,function(e,t){var n=this.geometry,r=this.material,i=this.matrixWorld;if(void 0!==r&&(null===n.boundingSphere&&n.computeBoundingSphere(),Zi.copy(n.boundingSphere),Zi.applyMatrix4(i),!1!==e.ray.intersectsSphere(Zi)&&(Yi.getInverse(i),Qi.copy(e.ray).applyMatrix4(Yi),null===n.boundingBox||!1!==Qi.intersectsBox(n.boundingBox))))if(n.isBufferGeometry){var o,a,s,c,l,u=n.index,h=n.attributes.position,d=n.attributes.uv;if(null!==u)for(c=0,l=u.count;c<l;c+=3)o=u.getX(c),a=u.getX(c+1),s=u.getX(c+2),(w=wo(this,e,Qi,h,d,o,a,s))&&(w.faceIndex=Math.floor(c/3),t.push(w));else if(void 0!==h)for(c=0,l=h.count;c<l;c+=3)(w=wo(this,e,Qi,h,d,o=c,a=c+1,s=c+2))&&(w.index=o,t.push(w))}else if(n.isGeometry){var p,f,m,g,v=Array.isArray(r),y=n.vertices,_=n.faces,i=n.faceVertexUvs[0];0<i.length&&(g=i);for(var x=0,b=_.length;x<b;x++){var w,E=_[x],M=v?r[E.materialIndex]:r;if(void 0!==M){if(p=y[E.a],f=y[E.b],m=y[E.c],!0===M.morphTargets){var T=n.morphTargets,S=this.morphTargetInfluences;Ji.set(0,0,0),Ki.set(0,0,0),$i.set(0,0,0);for(var A=0,P=T.length;A<P;A++){var R,L=S[A];0!==L&&(R=T[A].vertices,Ji.addScaledVector(eo.subVectors(R[E.a],p),L),Ki.addScaledVector(to.subVectors(R[E.b],f),L),$i.addScaledVector(no.subVectors(R[E.c],m),L))}Ji.add(p),Ki.add(f),$i.add(m),p=Ji,f=Ki,m=$i}(w=bo(this,M,e,Qi,p,f,m,so))&&(g&&g[x]&&(M=g[x],ro.copy(M[0]),io.copy(M[1]),oo.copy(M[2]),w.uv=xo(so,p,f,m,ro,io,oo)),w.face=E,w.faceIndex=x,t.push(w))}}}}),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Do,Ho,Uo,zo,ko,Bo,Vo,Go,Wo,qo,Xo,Yo,Qo,Zo,Jo=0;function Ko(e){switch(e){case zt:return["Linear","( value )"];case kt:return["sRGB","( value )"];case Vt:return["RGBE","( value )"];case Gt:return["RGBM","( value, 7.0 )"];case Wt:return["RGBM","( value, 16.0 )"];case qt:return["RGBD","( value, 256.0 )"];case Bt:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+e)}}function $o(e,t){t=Ko(t);return"vec4 "+e+"( vec4 value ) { return "+t[0]+"ToLinear"+t[1]+"; }"}function ea(e){return""!==e}function ta(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights)}function na(e){return e.replace(/^[ \t]*#include +<([\w\d.]+)>/gm,function(e,t){var n=E[t];if(void 0===n)throw new Error("Can not resolve #include <"+t+">");return na(n)})}function ra(e){return e.replace(/for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(e,t,n,r){for(var i="",o=parseInt(t);o<parseInt(n);o++)i+=r.replace(/\[ i \]/g,"[ "+o+" ]");return i})}function ia(e,t,n,r,i,o){var a=e.context,s=r.defines,c=i.vertexShader,l=i.fragmentShader,u="SHADOWMAP_TYPE_BASIC",h=(o.shadowMapType===K?u="SHADOWMAP_TYPE_PCF":o.shadowMapType===$&&(u="SHADOWMAP_TYPE_PCF_SOFT"),"ENVMAP_TYPE_CUBE"),d="ENVMAP_MODE_REFLECTION",p="ENVMAP_BLENDING_MULTIPLY";if(o.envMap){switch(r.envMap.mapping){case Je:case Ke:h="ENVMAP_TYPE_CUBE";break;case nt:case rt:h="ENVMAP_TYPE_CUBE_UV";break;case $e:case et:h="ENVMAP_TYPE_EQUIREC";break;case tt:h="ENVMAP_TYPE_SPHERE"}switch(r.envMap.mapping){case Ke:case et:d="ENVMAP_MODE_REFRACTION"}switch(r.combine){case Ve:p="ENVMAP_BLENDING_MULTIPLY";break;case Ge:p="ENVMAP_BLENDING_MIX";break;case We:p="ENVMAP_BLENDING_ADD"}}var f,m,g,v,y=0<e.gammaFactor?e.gammaFactor:1,_=(x=o,w=t,[(_=(_=r.extensions)||{}).derivatives||x.envMapCubeUV||x.bumpMap||x.normalMap||x.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(_.fragDepth||x.logarithmicDepthBuffer)&&w.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",_.drawBuffers&&w.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(_.shaderTextureLOD||x.envMap)&&w.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(ea).join("\n")),x=(e=>{var t,n=[];for(t in e){var r=e[t];!1!==r&&n.push("#define "+t+" "+r)}return n.join("\n")})(s),b=a.createProgram(),_=(r.isRawShaderMaterial?(0<(f=[x].filter(ea).join("\n")).length&&(f+="\n"),0<(m=[_,x].filter(ea).join("\n")).length&&(m+="\n")):(f=["precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+i.name,x,o.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+y,"#define MAX_BONES "+o.maxBones,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+d:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.displacementMap&&o.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexColors?"#define USE_COLOR":"",o.flatShading?"#define FLAT_SHADED":"",o.skinning?"#define USE_SKINNING":"",o.useVertexTexture?"#define BONE_TEXTURE":"",o.morphTargets?"#define USE_MORPHTARGETS":"",o.morphNormals&&!1===o.flatShading?"#define USE_MORPHNORMALS":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+o.numClippingPlanes,o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+u:"",o.sizeAttenuation?"#define USE_SIZEATTENUATION":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&t.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(ea).join("\n"),m=[_,"precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+i.name,x,o.alphaTest?"#define ALPHATEST "+o.alphaTest:"","#define GAMMA_FACTOR "+y,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+h:"",o.envMap?"#define "+d:"",o.envMap?"#define "+p:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexColors?"#define USE_COLOR":"",o.gradientMap?"#define USE_GRADIENTMAP":"",o.flatShading?"#define FLAT_SHADED":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+o.numClippingPlanes,"#define UNION_CLIPPING_PLANES "+(o.numClippingPlanes-o.numClipIntersection),o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+u:"",o.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",o.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&t.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",o.envMap&&t.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",o.toneMapping!==qe?"#define TONE_MAPPING":"",o.toneMapping!==qe?E.tonemapping_pars_fragment:"",o.toneMapping!==qe?((e,t)=>{var n;switch(t){case Xe:n="Linear";break;case Ye:n="Reinhard";break;case Qe:n="Uncharted2";break;case Ze:n="OptimizedCineon";break;default:throw new Error("unsupported toneMapping: "+t)}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"})("toneMapping",o.toneMapping):"",o.dithering?"#define DITHERING":"",o.outputEncoding||o.mapEncoding||o.envMapEncoding||o.emissiveMapEncoding?E.encodings_pars_fragment:"",o.mapEncoding?$o("mapTexelToLinear",o.mapEncoding):"",o.envMapEncoding?$o("envMapTexelToLinear",o.envMapEncoding):"",o.emissiveMapEncoding?$o("emissiveMapTexelToLinear",o.emissiveMapEncoding):"",o.outputEncoding?(w="linearToOutputTexel",s=Ko(s=o.outputEncoding),"vec4 "+w+"( vec4 value ) { return LinearTo"+s[0]+s[1]+"; }"):"",o.depthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(ea).join("\n")),c=ta(c=na(c),o),l=ta(l=na(l),o),r.isShaderMaterial||(c=ra(c),l=ra(l)),f+c),i=m+l,x=Fo(a,a.VERTEX_SHADER,_),y=Fo(a,a.FRAGMENT_SHADER,i),u=(a.attachShader(b,x),a.attachShader(b,y),void 0!==r.index0AttributeName?a.bindAttribLocation(b,0,r.index0AttributeName):!0===o.morphTargets&&a.bindAttribLocation(b,0,"position"),a.linkProgram(b),a.getProgramInfoLog(b)),t=a.getShaderInfoLog(x),w=a.getShaderInfoLog(y),s=!0,c=!0;return!1===a.getProgramParameter(b,a.LINK_STATUS)?(s=!1,console.error("THREE.WebGLProgram: shader error: ",a.getError(),"gl.VALIDATE_STATUS",a.getProgramParameter(b,a.VALIDATE_STATUS),"gl.getProgramInfoLog",u,t,w)):""!==u?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",u):""!==t&&""!==w||(c=!1),c&&(this.diagnostics={runnable:s,material:r,programLog:u,vertexShader:{log:t,prefix:f},fragmentShader:{log:w,prefix:m}}),a.deleteShader(x),a.deleteShader(y),this.getUniforms=function(){return g=void 0===g?new zn(a,b,e):g},this.getAttributes=function(){return v=void 0===v?((e,t)=>{for(var n={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),i=0;i<r;i++){var o=e.getActiveAttrib(t,i).name;n[o]=e.getAttribLocation(t,o)}return n})(a,b):v},this.destroy=function(){a.deleteProgram(b),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.id=Jo++,this.code=n,this.usedTimes=1,this.program=b,this.vertexShader=x,this.fragmentShader=y,this}function oa(h,c,d){var l=[],p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow"},o=["precision","supportsVertexTextures","map","mapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering"];function f(e,t){var n;return e?e.isTexture?n=e.encoding:e.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),n=e.texture.encoding):n=zt,n=n===zt&&t?Bt:n}this.getParameters=function(e,t,n,r,i,o,a){var s=p[e.type],c=a.isSkinnedMesh?(c=(c=a).skeleton.bones,d.floatVertexTextures?1024:(l=d.maxVertexUniforms,l=Math.floor((l-20)/4),(l=Math.min(l,c.length))<c.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+c.length+" bones. This GPU supports "+l+"."),0):l)):0,l=d.precision,u=(null!==e.precision&&(l=d.getMaxPrecision(e.precision))!==e.precision&&console.warn("THREE.WebGLProgram.getParameters:",e.precision,"not supported, using",l,"instead."),h.getRenderTarget());return{shaderID:s,precision:l,supportsVertexTextures:d.vertexTextures,outputEncoding:f(u?u.texture:null,h.gammaOutput),map:!!e.map,mapEncoding:f(e.map,h.gammaInput),envMap:!!e.envMap,envMapMode:e.envMap&&e.envMap.mapping,envMapEncoding:f(e.envMap,h.gammaInput),envMapCubeUV:!!e.envMap&&(e.envMap.mapping===nt||e.envMap.mapping===rt),lightMap:!!e.lightMap,aoMap:!!e.aoMap,emissiveMap:!!e.emissiveMap,emissiveMapEncoding:f(e.emissiveMap,h.gammaInput),bumpMap:!!e.bumpMap,normalMap:!!e.normalMap,displacementMap:!!e.displacementMap,roughnessMap:!!e.roughnessMap,metalnessMap:!!e.metalnessMap,specularMap:!!e.specularMap,alphaMap:!!e.alphaMap,gradientMap:!!e.gradientMap,combine:e.combine,vertexColors:e.vertexColors,fog:!!r,useFog:e.fog,fogExp:r&&r.isFogExp2,flatShading:e.flatShading,sizeAttenuation:e.sizeAttenuation,logarithmicDepthBuffer:d.logarithmicDepthBuffer,skinning:e.skinning&&0<c,maxBones:c,useVertexTexture:d.floatVertexTextures,morphTargets:e.morphTargets,morphNormals:e.morphNormals,maxMorphTargets:h.maxMorphTargets,maxMorphNormals:h.maxMorphNormals,numDirLights:t.directional.length,numPointLights:t.point.length,numSpotLights:t.spot.length,numRectAreaLights:t.rectArea.length,numHemiLights:t.hemi.length,numClippingPlanes:i,numClipIntersection:o,dithering:e.dithering,shadowMapEnabled:h.shadowMap.enabled&&a.receiveShadow&&0<n.length,shadowMapType:h.shadowMap.type,toneMapping:h.toneMapping,physicallyCorrectLights:h.physicallyCorrectLights,premultipliedAlpha:e.premultipliedAlpha,alphaTest:e.alphaTest,doubleSided:e.side===re,flipSided:e.side===ne,depthPacking:void 0!==e.depthPacking&&e.depthPacking}},this.getProgramCode=function(e,t){var n=[];if(t.shaderID?n.push(t.shaderID):(n.push(e.fragmentShader),n.push(e.vertexShader)),void 0!==e.defines)for(var r in e.defines)n.push(r),n.push(e.defines[r]);for(var i=0;i<o.length;i++)n.push(t[o[i]]);return n.push(e.onBeforeCompile.toString()),n.push(h.gammaOutput),n.join()},this.acquireProgram=function(e,t,n,r){for(var i,o=0,a=l.length;o<a;o++){var s=l[o];if(s.code===r){++(i=s).usedTimes;break}}return void 0===i&&(i=new ia(h,c,r,e,t,n),l.push(i)),i},this.releaseProgram=function(e){var t;0==--e.usedTimes&&(t=l.indexOf(e),l[t]=l[l.length-1],l.pop(),e.destroy())},this.programs=l}function aa(f,r,m,g,v,y,_){var x="undefined"!=typeof WebGL2RenderingContext&&f instanceof window.WebGL2RenderingContext;function b(e,t){var n;return e.width>t||e.height>t?(t=t/Math.max(e.width,e.height),(n=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).width=Math.floor(e.width*t),n.height=Math.floor(e.height*t),n.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,n.width,n.height),console.warn("THREE.WebGLRenderer: image is too big ("+e.width+"x"+e.height+"). Resized to "+n.width+"x"+n.height,e),n):e}function w(e){return Ae.isPowerOfTwo(e.width)&&Ae.isPowerOfTwo(e.height)}function E(e,t){return e.generateMipmaps&&t&&e.minFilter!==P&&e.minFilter!==A}function i(e){return e===P||e===at||e===st?f.NEAREST:f.LINEAR}function M(e){e=e.target;e.removeEventListener("dispose",M),(e=>{var t=g.get(e);if(e.image&&t.__image__webglTextureCube)f.deleteTexture(t.__image__webglTextureCube);else{if(void 0===t.__webglInit)return;f.deleteTexture(t.__webglTexture)}g.remove(e)})(e),_.textures--}function a(e){var e=e.target,t=(e.removeEventListener("dispose",a),g.get(e)),n=g.get(e.texture);if(e){if(void 0!==n.__webglTexture&&f.deleteTexture(n.__webglTexture),e.depthTexture&&e.depthTexture.dispose(),e.isWebGLRenderTargetCube)for(var r=0;r<6;r++)f.deleteFramebuffer(t.__webglFramebuffer[r]),t.__webglDepthbuffer&&f.deleteRenderbuffer(t.__webglDepthbuffer[r]);else f.deleteFramebuffer(t.__webglFramebuffer),t.__webglDepthbuffer&&f.deleteRenderbuffer(t.__webglDepthbuffer);g.remove(e.texture),g.remove(e)}_.textures--}function s(e,t){var n=g.get(e);if(0<e.version&&n.__version!==e.version){var r=e.image;if(void 0===r)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",e);else{if(!1!==r.complete){var r=n,i=e,o=t,a=(void 0===r.__webglInit&&(r.__webglInit=!0,i.addEventListener("dispose",M),r.__webglTexture=f.createTexture(),_.textures++),m.activeTexture(f.TEXTURE0+o),m.bindTexture(f.TEXTURE_2D,r.__webglTexture),f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,i.flipY),f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.premultiplyAlpha),f.pixelStorei(f.UNPACK_ALIGNMENT,i.unpackAlignment),o=b(i.image,v.maxTextureSize),(e=>e.wrapS!==S||e.wrapT!==S||e.minFilter!==P&&e.minFilter!==A)(i)&&!1===w(o)&&(o=(e=>{var t;return e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof ImageBitmap?((t=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).width=Ae.floorPowerOfTwo(e.width),t.height=Ae.floorPowerOfTwo(e.height),t.getContext("2d").drawImage(e,0,0,t.width,t.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+e.width+"x"+e.height+"). Resized to "+t.width+"x"+t.height,e),t):e})(o)),w(o)),s=y.convert(i.format),c=y.convert(i.type);T(f.TEXTURE_2D,i,a);var l,u=i.mipmaps;if(i.isDepthTexture){var h=f.DEPTH_COMPONENT;if(i.type===gt){if(!x)throw new Error("Float Depth Texture only supported in WebGL2.0");h=f.DEPTH_COMPONENT32F}else x&&(h=f.DEPTH_COMPONENT16);i.format===Pt&&h===f.DEPTH_COMPONENT&&i.type!==pt&&i.type!==mt&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),i.type=pt,c=y.convert(i.type)),i.format===Rt&&(h=f.DEPTH_STENCIL,i.type!==bt)&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),i.type=bt,c=y.convert(i.type)),m.texImage2D(f.TEXTURE_2D,0,h,o.width,o.height,0,s,c,null)}else if(i.isDataTexture)if(0<u.length&&a){for(var d=0,p=u.length;d<p;d++)l=u[d],m.texImage2D(f.TEXTURE_2D,d,s,l.width,l.height,0,s,c,l.data);i.generateMipmaps=!1}else m.texImage2D(f.TEXTURE_2D,0,s,o.width,o.height,0,s,c,o.data);else if(i.isCompressedTexture)for(d=0,p=u.length;d<p;d++)l=u[d],i.format!==Mt&&i.format!==Et?-1<m.getCompressedTextureFormats().indexOf(s)?m.compressedTexImage2D(f.TEXTURE_2D,d,s,l.width,l.height,0,l.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):m.texImage2D(f.TEXTURE_2D,d,s,l.width,l.height,0,s,c,l.data);else if(0<u.length&&a){for(d=0,p=u.length;d<p;d++)l=u[d],m.texImage2D(f.TEXTURE_2D,d,s,s,c,l);i.generateMipmaps=!1}else m.texImage2D(f.TEXTURE_2D,0,s,s,c,o);return E(i,a)&&f.generateMipmap(f.TEXTURE_2D),r.__version=i.version,void(i.onUpdate&&i.onUpdate(i))}console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",e)}}m.activeTexture(f.TEXTURE0+t),m.bindTexture(f.TEXTURE_2D,n.__webglTexture)}function T(e,t,n){n?(f.texParameteri(e,f.TEXTURE_WRAP_S,y.convert(t.wrapS)),f.texParameteri(e,f.TEXTURE_WRAP_T,y.convert(t.wrapT)),f.texParameteri(e,f.TEXTURE_MAG_FILTER,y.convert(t.magFilter)),f.texParameteri(e,f.TEXTURE_MIN_FILTER,y.convert(t.minFilter))):(f.texParameteri(e,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(e,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),t.wrapS===S&&t.wrapT===S||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",t),f.texParameteri(e,f.TEXTURE_MAG_FILTER,i(t.magFilter)),f.texParameteri(e,f.TEXTURE_MIN_FILTER,i(t.minFilter)),t.minFilter!==P&&t.minFilter!==A&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",t)),!(n=r.get("EXT_texture_filter_anisotropic"))||t.type===gt&&null===r.get("OES_texture_float_linear")||t.type===vt&&null===r.get("OES_texture_half_float_linear")||(1<t.anisotropy||g.get(t).__currentAnisotropy)&&(f.texParameterf(e,n.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t.anisotropy,v.getMaxAnisotropy())),g.get(t).__currentAnisotropy=t.anisotropy)}function c(e,t,n,r){var i=y.convert(t.texture.format),o=y.convert(t.texture.type);m.texImage2D(r,0,i,t.width,t.height,0,i,o,null),f.bindFramebuffer(f.FRAMEBUFFER,e),f.framebufferTexture2D(f.FRAMEBUFFER,n,r,g.get(t.texture).__webglTexture,0),f.bindFramebuffer(f.FRAMEBUFFER,null)}function l(e,t){f.bindRenderbuffer(f.RENDERBUFFER,e),t.depthBuffer&&!t.stencilBuffer?(f.renderbufferStorage(f.RENDERBUFFER,f.DEPTH_COMPONENT16,t.width,t.height),f.framebufferRenderbuffer(f.FRAMEBUFFER,f.DEPTH_ATTACHMENT,f.RENDERBUFFER,e)):t.depthBuffer&&t.stencilBuffer?(f.renderbufferStorage(f.RENDERBUFFER,f.DEPTH_STENCIL,t.width,t.height),f.framebufferRenderbuffer(f.FRAMEBUFFER,f.DEPTH_STENCIL_ATTACHMENT,f.RENDERBUFFER,e)):f.renderbufferStorage(f.RENDERBUFFER,f.RGBA4,t.width,t.height),f.bindRenderbuffer(f.RENDERBUFFER,null)}function u(e){var t=g.get(e),n=!0===e.isWebGLRenderTargetCube;if(e.depthTexture){if(n)throw new Error("target.depthTexture not supported in Cube render targets");var r=t.__webglFramebuffer,i=e;if(i&&i.isWebGLRenderTargetCube)throw new Error("Depth Texture with cube render targets is not supported");if(f.bindFramebuffer(f.FRAMEBUFFER,r),!i.depthTexture||!i.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");if(g.get(i.depthTexture).__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),s(i.depthTexture,0),r=g.get(i.depthTexture).__webglTexture,i.depthTexture.format===Pt)f.framebufferTexture2D(f.FRAMEBUFFER,f.DEPTH_ATTACHMENT,f.TEXTURE_2D,r,0);else{if(i.depthTexture.format!==Rt)throw new Error("Unknown depthTexture format");f.framebufferTexture2D(f.FRAMEBUFFER,f.DEPTH_STENCIL_ATTACHMENT,f.TEXTURE_2D,r,0)}}else if(n){t.__webglDepthbuffer=[];for(var o=0;o<6;o++)f.bindFramebuffer(f.FRAMEBUFFER,t.__webglFramebuffer[o]),t.__webglDepthbuffer[o]=f.createRenderbuffer(),l(t.__webglDepthbuffer[o],e)}else f.bindFramebuffer(f.FRAMEBUFFER,t.__webglFramebuffer),t.__webglDepthbuffer=f.createRenderbuffer(),l(t.__webglDepthbuffer,e);f.bindFramebuffer(f.FRAMEBUFFER,null)}this.setTexture2D=s,this.setTextureCube=function(e,t){var n=g.get(e);if(6===e.image.length)if(0<e.version&&n.__version!==e.version){n.__image__webglTextureCube||(e.addEventListener("dispose",M),n.__image__webglTextureCube=f.createTexture(),_.textures++),m.activeTexture(f.TEXTURE0+t),m.bindTexture(f.TEXTURE_CUBE_MAP,n.__image__webglTextureCube),f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,e.flipY);for(var r=e&&e.isCompressedTexture,i=e.image[0]&&e.image[0].isDataTexture,o=[],a=0;a<6;a++)o[a]=r||i?i?e.image[a].image:e.image[a]:b(e.image[a],v.maxCubemapSize);var s=w(o[0]),c=y.convert(e.format),l=y.convert(e.type);T(f.TEXTURE_CUBE_MAP,e,s);for(a=0;a<6;a++)if(r)for(var u,h=o[a].mipmaps,d=0,p=h.length;d<p;d++)u=h[d],e.format!==Mt&&e.format!==Et?-1<m.getCompressedTextureFormats().indexOf(c)?m.compressedTexImage2D(f.TEXTURE_CUBE_MAP_POSITIVE_X+a,d,c,u.width,u.height,0,u.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):m.texImage2D(f.TEXTURE_CUBE_MAP_POSITIVE_X+a,d,c,u.width,u.height,0,c,l,u.data);else i?m.texImage2D(f.TEXTURE_CUBE_MAP_POSITIVE_X+a,0,c,o[a].width,o[a].height,0,c,l,o[a].data):m.texImage2D(f.TEXTURE_CUBE_MAP_POSITIVE_X+a,0,c,c,l,o[a]);E(e,s)&&f.generateMipmap(f.TEXTURE_CUBE_MAP),n.__version=e.version,e.onUpdate&&e.onUpdate(e)}else m.activeTexture(f.TEXTURE0+t),m.bindTexture(f.TEXTURE_CUBE_MAP,n.__image__webglTextureCube)},this.setTextureCubeDynamic=function(e,t){m.activeTexture(f.TEXTURE0+t),m.bindTexture(f.TEXTURE_CUBE_MAP,g.get(e).__webglTexture)},this.setupRenderTarget=function(e){var t=g.get(e),n=g.get(e.texture),r=(e.addEventListener("dispose",a),n.__webglTexture=f.createTexture(),_.textures++,!0===e.isWebGLRenderTargetCube),i=w(e);if(r){t.__webglFramebuffer=[];for(var o=0;o<6;o++)t.__webglFramebuffer[o]=f.createFramebuffer()}else t.__webglFramebuffer=f.createFramebuffer();if(r){m.bindTexture(f.TEXTURE_CUBE_MAP,n.__webglTexture),T(f.TEXTURE_CUBE_MAP,e.texture,i);for(o=0;o<6;o++)c(t.__webglFramebuffer[o],e,f.COLOR_ATTACHMENT0,f.TEXTURE_CUBE_MAP_POSITIVE_X+o);E(e.texture,i)&&f.generateMipmap(f.TEXTURE_CUBE_MAP),m.bindTexture(f.TEXTURE_CUBE_MAP,null)}else m.bindTexture(f.TEXTURE_2D,n.__webglTexture),T(f.TEXTURE_2D,e.texture,i),c(t.__webglFramebuffer,e,f.COLOR_ATTACHMENT0,f.TEXTURE_2D),E(e.texture,i)&&f.generateMipmap(f.TEXTURE_2D),m.bindTexture(f.TEXTURE_2D,null);e.depthBuffer&&u(e)},this.updateRenderTargetMipmap=function(e){var t=e.texture;E(t,w(e))&&(e=e.isWebGLRenderTargetCube?f.TEXTURE_CUBE_MAP:f.TEXTURE_2D,t=g.get(t).__webglTexture,m.bindTexture(e,t),f.generateMipmap(e),m.bindTexture(e,null))}}function sa(){var n={};return{get:function(e){var e=e.uuid,t=n[e];return void 0===t&&(n[e]=t={}),t},remove:function(e){delete n[e.uuid]},clear:function(){n={}}}}function ca(u,n,c){var t=new function(){var t=!1,o=new Le,n=null,a=new Le(0,0,0,0);return{setMask:function(e){n===e||t||(u.colorMask(e,e,e,e),n=e)},setLocked:function(e){t=e},setClear:function(e,t,n,r,i){!0===i&&(e*=r,t*=r,n*=r),o.set(e,t,n,r),!1===a.equals(o)&&(u.clearColor(e,t,n,r),a.copy(o))},reset:function(){t=!1,n=null,a.set(-1,0,0,0)}}},r=new function(){var t=!1,n=null,r=null,i=null;return{setTest:function(e){(e?I:O)(u.DEPTH_TEST)},setMask:function(e){n===e||t||(u.depthMask(e),n=e)},setFunc:function(e){if(r!==e){if(e)switch(e){case Ne:u.depthFunc(u.NEVER);break;case Fe:u.depthFunc(u.ALWAYS);break;case De:u.depthFunc(u.LESS);break;case He:u.depthFunc(u.LEQUAL);break;case Ue:u.depthFunc(u.EQUAL);break;case ze:u.depthFunc(u.GEQUAL);break;case ke:u.depthFunc(u.GREATER);break;case Be:u.depthFunc(u.NOTEQUAL);break;default:u.depthFunc(u.LEQUAL)}else u.depthFunc(u.LEQUAL);r=e}},setLocked:function(e){t=e},setClear:function(e){i!==e&&(u.clearDepth(e),i=e)},reset:function(){t=!1,i=r=n=null}}},i=new function(){var t=!1,n=null,r=null,i=null,o=null,a=null,s=null,c=null,l=null;return{setTest:function(e){(e?I:O)(u.STENCIL_TEST)},setMask:function(e){n===e||t||(u.stencilMask(e),n=e)},setFunc:function(e,t,n){r===e&&i===t&&o===n||(u.stencilFunc(e,t,n),r=e,i=t,o=n)},setOp:function(e,t,n){a===e&&s===t&&c===n||(u.stencilOp(e,t,n),a=e,s=t,c=n)},setLocked:function(e){t=e},setClear:function(e){l!==e&&(u.clearStencil(e),l=e)},reset:function(){t=!1,l=c=s=a=o=i=r=n=null}}},e=u.getParameter(u.MAX_VERTEX_ATTRIBS),o=new Uint8Array(e),a=new Uint8Array(e),s=new Uint8Array(e),l={},h=null,d=null,p=null,f=null,m=null,g=null,v=null,y=null,_=null,x=!1,b=null,w=null,E=null,M=null,T=null,F=u.getParameter(u.MAX_COMBINED_TEXTURE_IMAGE_UNITS),e=parseFloat(/^WebGL\ ([0-9])/.exec(u.getParameter(u.VERSION))[1]),D=1<=parseFloat(e),S=null,A={},P=new Le,R=new Le;function L(e,t,n){var r=new Uint8Array(4),i=u.createTexture();u.bindTexture(e,i),u.texParameteri(e,u.TEXTURE_MIN_FILTER,u.NEAREST),u.texParameteri(e,u.TEXTURE_MAG_FILTER,u.NEAREST);for(var o=0;o<n;o++)u.texImage2D(t+o,0,u.RGBA,1,1,0,u.RGBA,u.UNSIGNED_BYTE,r);return i}var C={};function I(e){!0!==l[e]&&(u.enable(e),l[e]=!0)}function O(e){!1!==l[e]&&(u.disable(e),l[e]=!1)}function j(e,t,n,r,i,o,a,s){if((e!==ie?I:O)(u.BLEND),e!==le){if(e!==p||s!==x)switch(e){case ae:s?(u.blendEquationSeparate(u.FUNC_ADD,u.FUNC_ADD),u.blendFuncSeparate(u.ONE,u.ONE,u.ONE,u.ONE)):(u.blendEquation(u.FUNC_ADD),u.blendFunc(u.SRC_ALPHA,u.ONE));break;case se:s?(u.blendEquationSeparate(u.FUNC_ADD,u.FUNC_ADD),u.blendFuncSeparate(u.ZERO,u.ZERO,u.ONE_MINUS_SRC_COLOR,u.ONE_MINUS_SRC_ALPHA)):(u.blendEquation(u.FUNC_ADD),u.blendFunc(u.ZERO,u.ONE_MINUS_SRC_COLOR));break;case ce:s?(u.blendEquationSeparate(u.FUNC_ADD,u.FUNC_ADD),u.blendFuncSeparate(u.ZERO,u.SRC_COLOR,u.ZERO,u.SRC_ALPHA)):(u.blendEquation(u.FUNC_ADD),u.blendFunc(u.ZERO,u.SRC_COLOR));break;default:s?(u.blendEquationSeparate(u.FUNC_ADD,u.FUNC_ADD),u.blendFuncSeparate(u.ONE,u.ONE_MINUS_SRC_ALPHA,u.ONE,u.ONE_MINUS_SRC_ALPHA)):(u.blendEquationSeparate(u.FUNC_ADD,u.FUNC_ADD),u.blendFuncSeparate(u.SRC_ALPHA,u.ONE_MINUS_SRC_ALPHA,u.ONE,u.ONE_MINUS_SRC_ALPHA))}_=y=v=g=m=f=null}else i=i||t,o=o||n,a=a||r,t===f&&i===v||(u.blendEquationSeparate(c.convert(t),c.convert(i)),f=t,v=i),n===m&&r===g&&o===y&&a===_||(u.blendFuncSeparate(c.convert(n),c.convert(r),c.convert(o),c.convert(a)),m=n,g=r,y=o,_=a);p=e,x=s}function N(e){b!==e&&(e?u.frontFace(u.CW):u.frontFace(u.CCW),b=e)}function H(e){e!==Y?(I(u.CULL_FACE),e!==w&&(e===Q?u.cullFace(u.BACK):e===J?u.cullFace(u.FRONT):u.cullFace(u.FRONT_AND_BACK))):O(u.CULL_FACE),w=e}function U(e,t,n){e?(I(u.POLYGON_OFFSET_FILL),M===t&&T===n||(u.polygonOffset(t,n),M=t,T=n)):O(u.POLYGON_OFFSET_FILL)}function z(e){void 0===e&&(e=u.TEXTURE0+F-1),S!==e&&(u.activeTexture(e),S=e)}return C[u.TEXTURE_2D]=L(u.TEXTURE_2D,u.TEXTURE_2D,1),C[u.TEXTURE_CUBE_MAP]=L(u.TEXTURE_CUBE_MAP,u.TEXTURE_CUBE_MAP_POSITIVE_X,6),t.setClear(0,0,0,1),r.setClear(1),i.setClear(0),I(u.DEPTH_TEST),r.setFunc(He),N(!1),H(Q),I(u.CULL_FACE),I(u.BLEND),j(oe),{buffers:{color:t,depth:r,stencil:i},initAttributes:function(){for(var e=0,t=o.length;e<t;e++)o[e]=0},enableAttribute:function(e){o[e]=1,0===a[e]&&(u.enableVertexAttribArray(e),a[e]=1),0!==s[e]&&(n.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(e,0),s[e]=0)},enableAttributeAndDivisor:function(e,t){o[e]=1,0===a[e]&&(u.enableVertexAttribArray(e),a[e]=1),s[e]!==t&&(n.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(e,t),s[e]=t)},disableUnusedAttributes:function(){for(var e=0,t=a.length;e!==t;++e)a[e]!==o[e]&&(u.disableVertexAttribArray(e),a[e]=0)},enable:I,disable:O,getCompressedTextureFormats:function(){if(null===h&&(h=[],n.get("WEBGL_compressed_texture_pvrtc")||n.get("WEBGL_compressed_texture_s3tc")||n.get("WEBGL_compressed_texture_etc1")))for(var e=u.getParameter(u.COMPRESSED_TEXTURE_FORMATS),t=0;t<e.length;t++)h.push(e[t]);return h},useProgram:function(e){return d!==e&&(u.useProgram(e),d=e,!0)},setBlending:j,setMaterial:function(e){(e.side===re?O:I)(u.CULL_FACE),N(e.side===ne),!0===e.transparent?j(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha):j(ie),r.setFunc(e.depthFunc),r.setTest(e.depthTest),r.setMask(e.depthWrite),t.setMask(e.colorWrite),U(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)},setFlipSided:N,setCullFace:H,setLineWidth:function(e){e!==E&&(D&&u.lineWidth(e),E=e)},setPolygonOffset:U,setScissorTest:function(e){(e?I:O)(u.SCISSOR_TEST)},activeTexture:z,bindTexture:function(e,t){null===S&&z();var n=A[S];void 0===n&&(A[S]=n={type:void 0,texture:void 0}),n.type===e&&n.texture===t||(u.bindTexture(e,t||C[e]),n.type=e,n.texture=t)},compressedTexImage2D:function(){try{u.compressedTexImage2D.apply(u,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{u.texImage2D.apply(u,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(e){!1===P.equals(e)&&(u.scissor(e.x,e.y,e.z,e.w),P.copy(e))},viewport:function(e){!1===R.equals(e)&&(u.viewport(e.x,e.y,e.z,e.w),R.copy(e))},reset:function(){for(var e=0;e<a.length;e++)1===a[e]&&(u.disableVertexAttribArray(e),a[e]=0);l={},A={},w=b=p=d=S=h=null,t.reset(),r.reset(),i.reset()}}}function la(t,n,e){var r;function i(e){if("highp"===e){if(0<t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision&&0<t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision)return"highp";e="mediump"}return"mediump"===e&&0<t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision&&0<t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision?"mediump":"lowp"}var o=void 0!==e.precision?e.precision:"highp",a=i(o),a=(a!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",a,"instead."),o=a),!0===e.logarithmicDepthBuffer),e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),s=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),c=t.getParameter(t.MAX_TEXTURE_SIZE),l=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),u=t.getParameter(t.MAX_VERTEX_ATTRIBS),h=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),d=t.getParameter(t.MAX_VARYING_VECTORS),p=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),f=0<s,m=!!n.get("OES_texture_float");return{getMaxAnisotropy:function(){var e;return void 0===r&&(e=n.get("EXT_texture_filter_anisotropic"),r=null!==e?t.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0),r},getMaxPrecision:i,precision:o,logarithmicDepthBuffer:a,maxTextures:e,maxVertexTextures:s,maxTextureSize:c,maxCubemapSize:l,maxAttributes:u,maxVertexUniforms:h,maxVaryings:d,maxFragmentUniforms:p,vertexTextures:f,floatFragmentTextures:m,floatVertexTextures:f&&m}}function g(e,t,n,r){Qr.call(this),this.type="PerspectiveCamera",this.fov=void 0!==e?e:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==r?r:2e3,this.focus=10,this.aspect=void 0!==t?t:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function ua(e){g.call(this),this.cameras=e||[]}function ha(n){var r,i,o=this,a=null,s=null,c=("undefined"!=typeof window&&"VRFrameData"in window&&(s=new window.VRFrameData),new Pe),l=new Pe,u=new Pe,h=new g,d=(h.bounds=new Le(0,0,.5,1),h.layers.enable(1),new g),p=(d.bounds=new Le(.5,0,.5,1),d.layers.enable(2),new ua([h,d]));function e(){var e,t;null!==a&&a.isPresenting?(e=(t=a.getEyeParameters("left")).renderWidth,t=t.renderHeight,i=n.getPixelRatio(),r=n.getSize(),n.setDrawingBufferSize(2*e,t,1)):o.enabled&&n.setDrawingBufferSize(r.width,r.height,i)}p.layers.enable(1),p.layers.enable(2),"undefined"!=typeof window&&window.addEventListener("vrdisplaypresentchange",e,!1),this.enabled=!1,this.standing=!1,this.getDevice=function(){return a},this.setDevice=function(e){void 0!==e&&(a=e)},this.getCamera=function(e){if(null===a)return e;a.depthNear=e.near,a.depthFar=e.far,a.getFrameData(s);var t=s.pose,t=(null!==t.position?e.position.fromArray(t.position):e.position.set(0,0,0),null!==t.orientation&&e.quaternion.fromArray(t.orientation),e.updateMatrixWorld(),a.stageParameters);if(this.standing&&t&&(l.fromArray(t.sittingToStandingTransform),u.getInverse(l),e.matrixWorld.multiply(l),e.matrixWorldInverse.multiply(u)),!1===a.isPresenting)return e;h.near=e.near,d.near=e.near,h.far=e.far,d.far=e.far,p.matrixWorld.copy(e.matrixWorld),p.matrixWorldInverse.copy(e.matrixWorldInverse),h.matrixWorldInverse.fromArray(s.leftViewMatrix),d.matrixWorldInverse.fromArray(s.rightViewMatrix),this.standing&&t&&(h.matrixWorldInverse.multiply(u),d.matrixWorldInverse.multiply(u));t=e.parent,null!==t&&(c.getInverse(t.matrixWorld),h.matrixWorldInverse.multiply(c),d.matrixWorldInverse.multiply(c)),h.matrixWorld.getInverse(h.matrixWorldInverse),d.matrixWorld.getInverse(d.matrixWorldInverse),h.projectionMatrix.fromArray(s.leftProjectionMatrix),d.projectionMatrix.fromArray(s.rightProjectionMatrix),p.projectionMatrix.copy(h.projectionMatrix),e=a.getLayers();return e.length&&(null!==(t=e[0]).leftBounds&&4===t.leftBounds.length&&h.bounds.fromArray(t.leftBounds),null!==t.rightBounds)&&4===t.rightBounds.length&&d.bounds.fromArray(t.rightBounds),p},this.getStandingMatrix=function(){return l},this.submitFrame=function(){a&&a.isPresenting&&a.submitFrame()},this.dispose=function(){"undefined"!=typeof window&&window.removeEventListener("vrdisplaypresentchange",e)}}function da(n){var r={};return{get:function(e){if(void 0!==r[e])return r[e];var t;switch(e){case"WEBGL_depth_texture":t=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":t=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":t=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":t=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":t=n.getExtension("WEBGL_compressed_texture_etc1");break;default:t=n.getExtension(e)}return null===t&&console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),r[e]=t}}}function pa(){var l=this,u=null,h=0,d=!1,p=!1,f=new Er,m=new R,g={value:null,needsUpdate:!1};function v(){g.value!==u&&(g.value=u,g.needsUpdate=0<h),l.numPlanes=h,l.numIntersection=0}function y(e,t,n,r){var i=null!==e?e.length:0,o=null;if(0!==i){if(o=g.value,!0!==r||null===o){var r=n+4*i,a=t.matrixWorldInverse;m.getNormalMatrix(a),(null===o||o.length<r)&&(o=new Float32Array(r));for(var s=0,c=n;s!==i;++s,c+=4)f.copy(e[s]).applyMatrix4(a,m),f.normal.toArray(o,c),o[c+3]=f.constant}g.value=o,g.needsUpdate=!0}return l.numPlanes=i,o}this.uniform=g,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t,n){var r=0!==e.length||t||0!==h||d;return d=t,u=y(e,n,0),h=e.length,r},this.beginShadows=function(){p=!0,y(null)},this.endShadows=function(){p=!1,v()},this.setState=function(e,t,n,r,i,o){if(!d||null===e||0===e.length||p&&!n)p?y(null):v();else{var n=p?0:h,a=4*n,s=i.clippingState||null;g.value=s;for(var s=y(e,r,a,o),c=0;c!==a;++c)s[c]=u[c];i.clippingState=s,this.numIntersection=t?this.numPlanes:0,this.numPlanes+=n}}}function fa(n,r){return{convert:function(e){var t;if(e===it)return n.REPEAT;if(e===S)return n.CLAMP_TO_EDGE;if(e===ot)return n.MIRRORED_REPEAT;if(e===P)return n.NEAREST;if(e===at)return n.NEAREST_MIPMAP_NEAREST;if(e===st)return n.NEAREST_MIPMAP_LINEAR;if(e===A)return n.LINEAR;if(e===ct)return n.LINEAR_MIPMAP_NEAREST;if(e===lt)return n.LINEAR_MIPMAP_LINEAR;if(e===ut)return n.UNSIGNED_BYTE;if(e===yt)return n.UNSIGNED_SHORT_4_4_4_4;if(e===_t)return n.UNSIGNED_SHORT_5_5_5_1;if(e===xt)return n.UNSIGNED_SHORT_5_6_5;if(e===ht)return n.BYTE;if(e===dt)return n.SHORT;if(e===pt)return n.UNSIGNED_SHORT;if(e===ft)return n.INT;if(e===mt)return n.UNSIGNED_INT;if(e===gt)return n.FLOAT;if(e===vt&&null!==(t=r.get("OES_texture_half_float")))return t.HALF_FLOAT_OES;if(e===wt)return n.ALPHA;if(e===Et)return n.RGB;if(e===Mt)return n.RGBA;if(e===Tt)return n.LUMINANCE;if(e===St)return n.LUMINANCE_ALPHA;if(e===Pt)return n.DEPTH_COMPONENT;if(e===Rt)return n.DEPTH_STENCIL;if(e===ue)return n.FUNC_ADD;if(e===he)return n.FUNC_SUBTRACT;if(e===me)return n.FUNC_REVERSE_SUBTRACT;if(e===ye)return n.ZERO;if(e===_e)return n.ONE;if(e===xe)return n.SRC_COLOR;if(e===be)return n.ONE_MINUS_SRC_COLOR;if(e===we)return n.SRC_ALPHA;if(e===Ee)return n.ONE_MINUS_SRC_ALPHA;if(e===Me)return n.DST_ALPHA;if(e===Te)return n.ONE_MINUS_DST_ALPHA;if(e===Se)return n.DST_COLOR;if(e===Oe)return n.ONE_MINUS_DST_COLOR;if(e===je)return n.SRC_ALPHA_SATURATE;if((e===Lt||e===Ct||e===It||e===Ot)&&null!==(t=r.get("WEBGL_compressed_texture_s3tc"))){if(e===Lt)return t.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===Ct)return t.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===It)return t.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===Ot)return t.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((e===jt||e===Nt||e===Ft||e===Dt)&&null!==(t=r.get("WEBGL_compressed_texture_pvrtc"))){if(e===jt)return t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===Nt)return t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===Ft)return t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===Dt)return t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(e===Ht&&null!==(t=r.get("WEBGL_compressed_texture_etc1")))return t.COMPRESSED_RGB_ETC1_WEBGL;if((e===ge||e===ve)&&null!==(t=r.get("EXT_blend_minmax"))){if(e===ge)return t.MIN_EXT;if(e===ve)return t.MAX_EXT}return e===bt&&null!==(t=r.get("WEBGL_depth_texture"))?t.UNSIGNED_INT_24_8_WEBGL:0}}}function ma(e){console.log("THREE.WebGLRenderer","88");var P,m,R,g,a,L,C,U,v,l,s,c,z,k,B,V,G,h,i=void 0!==(e=e||{}).canvas?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),t=void 0!==e.context?e.context:null,n=void 0!==e.alpha&&e.alpha,r=void 0===e.depth||e.depth,W=void 0===e.stencil||e.stencil,q=void 0!==e.antialias&&e.antialias,X=void 0===e.premultipliedAlpha||e.premultipliedAlpha,Y=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,p=[],f=[],y=null,Q=[],Z=[],_=(this.domElement=i,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=Xe,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4,this),J=!1,K=null,d=null,x=-1,I="",b=null,w=null,E=new Le,o=new Le,$=null,ee=0,M=i.width,T=i.height,S=1,u=new Le(0,0,M,T),A=new Le(0,0,M,T),te=!1,ne=new Mr,O=new pa,re=!1,ie=!1,oe=new Pe,j=new Re,ae={geometries:0,textures:0},N={frame:0,calls:0,vertices:0,faces:0,points:0};function se(){return null===K?S:1}this.info={render:N,memory:ae,programs:null};try{var F,ce={alpha:n,depth:r,stencil:W,antialias:q,premultipliedAlpha:X,preserveDrawingBuffer:Y};if(null===(F=t||i.getContext("webgl",ce)||i.getContext("experimental-webgl",ce)))throw null!==i.getContext("webgl")?"Error creating WebGL context with your selected attributes.":"Error creating WebGL context.";void 0===F.getShaderPrecisionFormat&&(F.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}}),i.addEventListener("webglcontextlost",he,!1),i.addEventListener("webglcontextrestored",de,!1)}catch(e){console.error("THREE.WebGLRenderer: "+e)}function le(){(P=new da(F)).get("WEBGL_depth_texture"),P.get("OES_texture_float"),P.get("OES_texture_float_linear"),P.get("OES_texture_half_float"),P.get("OES_texture_half_float_linear"),P.get("OES_standard_derivatives"),P.get("OES_element_index_uint"),P.get("ANGLE_instanced_arrays"),h=new fa(F,P),m=new la(F,P,e),(R=new ca(F,P,h)).scissor(o.copy(A).multiplyScalar(S)),R.viewport(E.copy(u).multiplyScalar(S)),g=new sa,a=new aa(F,P,R,g,m,h,ae),L=new Sr(F),C=new Io(F,L,ae),U=new No(C,N),z=new Ro(F),l=new oa(_,P,m),v=new jo,s=new Ao,c=new Eo(_,R,C,X),k=new Co(F,P,N),B=new Lo(F,P,N),V=new Xn(0,F,R,a,m),G=new Qn(_,F,R,a,m),_.info.programs=l.programs,_.context=F,_.capabilities=m,_.extensions=P,_.properties=g,_.renderLists=s,_.state=R}le();var D=new ha(_),ue=(this.vr=D,new Tr(_,U,m.maxTextureSize));function he(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),J=!0}function de(){console.log("THREE.WebGLRenderer: Context Restored."),J=!1,le()}function pe(e){var e=e.target;e.removeEventListener("dispose",pe),fe(e=e),g.remove(e)}function fe(e){var t=g.get(e).program;(e.program=void 0)!==t&&l.releaseProgram(t)}this.shadowMap=ue,this.getContext=function(){return F},this.getContextAttributes=function(){return F.getContextAttributes()},this.forceContextLoss=function(){var e=P.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=P.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return S},this.setPixelRatio=function(e){void 0!==e&&(S=e,this.setSize(M,T,!1))},this.getSize=function(){return{width:M,height:T}},this.setSize=function(e,t,n){var r=D.getDevice();r&&r.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(M=e,T=t,i.width=e*S,i.height=t*S,!1!==n&&(i.style.width=e+"px",i.style.height=t+"px"),this.setViewport(0,0,e,t))},this.getDrawingBufferSize=function(){return{width:M*S,height:T*S}},this.setDrawingBufferSize=function(e,t,n){M=e,T=t,S=n,i.width=e*n,i.height=t*n,this.setViewport(0,0,e,t)},this.setViewport=function(e,t,n,r){u.set(e,T-t-r,n,r),R.viewport(E.copy(u).multiplyScalar(S))},this.setScissor=function(e,t,n,r){A.set(e,T-t-r,n,r),R.scissor(o.copy(A).multiplyScalar(S))},this.setScissorTest=function(e){R.setScissorTest(te=e)},this.getClearColor=function(){return c.getClearColor()},this.setClearColor=function(){c.setClearColor.apply(c,arguments)},this.getClearAlpha=function(){return c.getClearAlpha()},this.setClearAlpha=function(){c.setClearAlpha.apply(c,arguments)},this.clear=function(e,t,n){var r=0;void 0!==e&&!e||(r|=F.COLOR_BUFFER_BIT),void 0!==t&&!t||(r|=F.DEPTH_BUFFER_BIT),void 0!==n&&!n||(r|=F.STENCIL_BUFFER_BIT),F.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(e,t,n,r){this.setRenderTarget(e),this.clear(t,n,r)},this.dispose=function(){i.removeEventListener("webglcontextlost",he,!1),i.removeEventListener("webglcontextrestored",de,!1),s.dispose(),D.dispose()},this.renderBufferImmediate=function(e,t,n){R.initAttributes();var r=g.get(e),t=(e.hasPositions&&!r.position&&(r.position=F.createBuffer()),e.hasNormals&&!r.normal&&(r.normal=F.createBuffer()),e.hasUvs&&!r.uv&&(r.uv=F.createBuffer()),e.hasColors&&!r.color&&(r.color=F.createBuffer()),t.getAttributes());if(e.hasPositions&&(F.bindBuffer(F.ARRAY_BUFFER,r.position),F.bufferData(F.ARRAY_BUFFER,e.positionArray,F.DYNAMIC_DRAW),R.enableAttribute(t.position),F.vertexAttribPointer(t.position,3,F.FLOAT,!1,0,0)),e.hasNormals){if(F.bindBuffer(F.ARRAY_BUFFER,r.normal),!n.isMeshPhongMaterial&&!n.isMeshStandardMaterial&&!n.isMeshNormalMaterial&&!0===n.flatShading)for(var i=0,o=3*e.count;i<o;i+=9){var a=e.normalArray,s=(a[i+0]+a[i+3]+a[i+6])/3,c=(a[i+1]+a[i+4]+a[i+7])/3,l=(a[i+2]+a[i+5]+a[i+8])/3;a[i+0]=s,a[i+1]=c,a[i+2]=l,a[i+3]=s,a[i+4]=c,a[i+5]=l,a[i+6]=s,a[i+7]=c,a[i+8]=l}F.bufferData(F.ARRAY_BUFFER,e.normalArray,F.DYNAMIC_DRAW),R.enableAttribute(t.normal),F.vertexAttribPointer(t.normal,3,F.FLOAT,!1,0,0)}e.hasUvs&&n.map&&(F.bindBuffer(F.ARRAY_BUFFER,r.uv),F.bufferData(F.ARRAY_BUFFER,e.uvArray,F.DYNAMIC_DRAW),R.enableAttribute(t.uv),F.vertexAttribPointer(t.uv,2,F.FLOAT,!1,0,0)),e.hasColors&&0!==n.vertexColors&&(F.bindBuffer(F.ARRAY_BUFFER,r.color),F.bufferData(F.ARRAY_BUFFER,e.colorArray,F.DYNAMIC_DRAW),R.enableAttribute(t.color),F.vertexAttribPointer(t.color,3,F.FLOAT,!1,0,0)),R.disableUnusedAttributes(),F.drawArrays(F.TRIANGLES,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,n,r,i,o){R.setMaterial(r);var e=Me(e,t,r,i),t=n.id+"_"+e.id+"_"+(!0===r.wireframe),a=!1,t=(t!==I&&(I=t,a=!0),i.morphTargetInfluences&&(z.update(i,n,r,e),a=!0),n.index),s=n.attributes.position,c=1,l=(!0===r.wireframe&&(t=C.getWireframeAttribute(n),c=2),k);if(null!==t&&(A=L.get(t),(l=B).setIndex(A)),a){var a=r,u=n,h=void 0;if(u&&u.isInstancedBufferGeometry&&null===P.get("ANGLE_instanced_arrays"))console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{void 0===h&&(h=0),R.initAttributes();var d,p=u.attributes,f=e.getAttributes(),m=a.defaultAttributeValues;for(d in f){var g=f[d];if(0<=g){var v=p[d];if(void 0!==v){var y,_,x,b,w,E=v.normalized,M=v.itemSize,T=L.get(v);void 0!==T&&(y=T.buffer,_=T.type,T=T.bytesPerElement,v.isInterleavedBufferAttribute?(x=v.data,b=x.stride,w=v.offset,x&&x.isInstancedInterleavedBuffer?(R.enableAttributeAndDivisor(g,x.meshPerAttribute),void 0===u.maxInstancedCount&&(u.maxInstancedCount=x.meshPerAttribute*x.count)):R.enableAttribute(g),F.bindBuffer(F.ARRAY_BUFFER,y),F.vertexAttribPointer(g,M,_,E,b*T,(h*b+w)*T)):(v.isInstancedBufferAttribute?(R.enableAttributeAndDivisor(g,v.meshPerAttribute),void 0===u.maxInstancedCount&&(u.maxInstancedCount=v.meshPerAttribute*v.count)):R.enableAttribute(g),F.bindBuffer(F.ARRAY_BUFFER,y),F.vertexAttribPointer(g,M,_,E,0,h*M*T)))}else if(void 0!==m){var S=m[d];if(void 0!==S)switch(S.length){case 2:F.vertexAttrib2fv(g,S);break;case 3:F.vertexAttrib3fv(g,S);break;case 4:F.vertexAttrib4fv(g,S);break;default:F.vertexAttrib1fv(g,S)}}}}R.disableUnusedAttributes()}null!==t&&F.bindBuffer(F.ELEMENT_ARRAY_BUFFER,A.buffer)}var e=0,a=(null!==t?e=t.count:void 0!==s&&(e=s.count),n.drawRange.start*c),A=n.drawRange.count*c,t=null!==o?o.start*c:0,s=null!==o?o.count*c:1/0,o=Math.max(a,t),c=Math.min(e,a+A,t+s)-1,e=Math.max(0,c-o+1);if(0!==e){if(i.isMesh)if(!0===r.wireframe)R.setLineWidth(r.wireframeLinewidth*se()),l.setMode(F.LINES);else switch(i.drawMode){case Ut:l.setMode(F.TRIANGLES);break;case 1:l.setMode(F.TRIANGLE_STRIP);break;case 2:l.setMode(F.TRIANGLE_FAN)}else i.isLine?(a=r.linewidth,R.setLineWidth((a=void 0===a?1:a)*se()),i.isLineSegments?l.setMode(F.LINES):i.isLineLoop?l.setMode(F.LINE_LOOP):l.setMode(F.LINE_STRIP)):i.isPoints&&l.setMode(F.POINTS);n&&n.isInstancedBufferGeometry?0<n.maxInstancedCount&&l.renderInstances(n,o,e):l.render(o,e)}};var me,ge,ve,ye=!(this.compile=function(n,e){p.length=0,f.length=0,n.traverse(function(e){e.isLight&&(p.push(e),e.castShadow)&&f.push(e)}),v.setup(p,f,e),n.traverse(function(e){if(e.material)if(Array.isArray(e.material))for(var t=0;t<e.material.length;t++)Ee(e.material[t],n.fog,e);else Ee(e.material,n.fog,e)})}),_e=null;function xe(e){null!==_e&&_e(e);e=D.getDevice();(e&&e.isPresenting?e:window).requestAnimationFrame(xe)}function be(e,t,n,r){for(var i=0,o=e.length;i<o;i++){var a=e[i],s=a.object,c=a.geometry,l=void 0===r?a.material:r,u=a.group;if(n.isArrayCamera)for(var h=(w=n).cameras,d=0,p=h.length;d<p;d++){var f,m,g,v,y=h[d];s.layers.test(y.layers)&&(f=(v=y.bounds).x*M,m=v.y*T,g=v.z*M,v=v.w*T,R.viewport(E.set(f,m,g,v).multiplyScalar(S)),we(s,t,y,c,l,u))}else w=null,we(s,t,n,c,l,u)}}function we(e,t,n,r,i,o){var a,s,c;e.onBeforeRender(_,t,n,r,i,o),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.isImmediateRenderObject?(R.setMaterial(i),a=Me(n,t.fog,i,e),I="",s=a,c=i,e.render(function(e){_.renderBufferImmediate(e,s,c)})):_.renderBufferDirect(n,t.fog,r,i,e,o),e.onAfterRender(_,t,n,r,i,o)}function Ee(e,t,n){var r=g.get(e),n=l.getParameters(e,v.state,f,t,O.numPlanes,O.numIntersection,n),i=l.getProgramCode(e,n),o=r.program,a=!0;if(void 0===o)e.addEventListener("dispose",pe);else if(o.code!==i)fe(e);else{if(void 0!==n.shaderID)return;a=!1}a&&(n.shaderID?(a=Wn[n.shaderID],r.shader={name:e.type,uniforms:Ie.clone(a.uniforms),vertexShader:a.vertexShader,fragmentShader:a.fragmentShader}):r.shader={name:e.type,uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader},e.onBeforeCompile(r.shader),o=l.acquireProgram(e,r.shader,n,i),r.program=o,e.program=o);var s=o.getAttributes();if(e.morphTargets)for(var c=e.numSupportedMorphTargets=0;c<_.maxMorphTargets;c++)0<=s["morphTarget"+c]&&e.numSupportedMorphTargets++;if(e.morphNormals)for(c=e.numSupportedMorphNormals=0;c<_.maxMorphNormals;c++)0<=s["morphNormal"+c]&&e.numSupportedMorphNormals++;a=r.shader.uniforms,(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(r.numClippingPlanes=O.numPlanes,r.numIntersection=O.numIntersection,a.clippingPlanes=O.uniform),r.fog=t,r.lightsHash=v.state.hash,e.lights&&(a.ambientLightColor.value=v.state.ambient,a.directionalLights.value=v.state.directional,a.spotLights.value=v.state.spot,a.rectAreaLights.value=v.state.rectArea,a.pointLights.value=v.state.point,a.hemisphereLights.value=v.state.hemi,a.directionalShadowMap.value=v.state.directionalShadowMap,a.directionalShadowMatrix.value=v.state.directionalShadowMatrix,a.spotShadowMap.value=v.state.spotShadowMap,a.spotShadowMatrix.value=v.state.spotShadowMatrix,a.pointShadowMap.value=v.state.pointShadowMap,a.pointShadowMatrix.value=v.state.pointShadowMatrix),n=r.program.getUniforms(),i=zn.seqWithValue(n.seq,a);r.uniformsList=i}function Me(e,t,n,r){ee=0;var i,o,a,s,c=g.get(n),l=(re&&(ie||e!==b)&&(l=e===b&&n.id===x,O.setState(n.clippingPlanes,n.clipIntersection,n.clipShadows,e,c,l)),!1===n.needsUpdate&&(void 0===c.program||n.fog&&c.fog!==t||n.lights&&c.lightsHash!==v.state.hash||void 0!==c.numClippingPlanes&&(c.numClippingPlanes!==O.numPlanes||c.numIntersection!==O.numIntersection))&&(n.needsUpdate=!0),n.needsUpdate&&(Ee(n,t,r),n.needsUpdate=!1),!1),u=!1,h=!1,d=c.program,p=d.getUniforms(),f=c.shader.uniforms;return R.useProgram(d.program)&&(h=u=l=!0),n.id!==x&&(x=n.id,u=!0),(l||e!==b)&&(p.setValue(F,"projectionMatrix",e.projectionMatrix),m.logarithmicDepthBuffer&&p.setValue(F,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),b!==(w||e)&&(b=w||e,h=u=!0),(n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshStandardMaterial||n.envMap)&&void 0!==(l=p.map.cameraPosition)&&l.setValue(F,j.setFromMatrixPosition(e.matrixWorld)),n.isMeshPhongMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.skinning)&&p.setValue(F,"viewMatrix",e.matrixWorldInverse),n.skinning&&(p.setOptional(F,r,"bindMatrix"),p.setOptional(F,r,"bindMatrixInverse"),l=r.skeleton)&&(e=l.bones,m.floatVertexTextures?(void 0===l.boneTexture&&(e=Math.sqrt(4*e.length),e=Ae.ceilPowerOfTwo(e),e=Math.max(e,4),(s=new Float32Array(e*e*4)).set(l.boneMatrices),a=new en(s,e,e,Mt,gt),l.boneMatrices=s,l.boneTexture=a,l.boneTextureSize=e),p.setValue(F,"boneTexture",l.boneTexture),p.setValue(F,"boneTextureSize",l.boneTextureSize)):p.setOptional(F,l,"boneMatrices")),u&&(p.setValue(F,"toneMappingExposure",_.toneMappingExposure),p.setValue(F,"toneMappingWhitePoint",_.toneMappingWhitePoint),n.lights&&(s=h,(a=f).ambientLightColor.needsUpdate=s,a.directionalLights.needsUpdate=s,a.pointLights.needsUpdate=s,a.spotLights.needsUpdate=s,a.rectAreaLights.needsUpdate=s,a.hemisphereLights.needsUpdate=s),t&&n.fog&&(e=t,(l=f).fogColor.value=e.color,e.isFog?(l.fogNear.value=e.near,l.fogFar.value=e.far):e.isFogExp2&&(l.fogDensity.value=e.density)),n.isMeshBasicMaterial?H(f,n):n.isMeshLambertMaterial?(H(f,n),u=f,(h=n).emissiveMap&&(u.emissiveMap.value=h.emissiveMap)):n.isMeshPhongMaterial?(H(f,n),n.isMeshToonMaterial?(Te(t=f,e=n),e.gradientMap&&(t.gradientMap.value=e.gradientMap)):Te(f,n)):n.isMeshStandardMaterial?(H(f,n),n.isMeshPhysicalMaterial?(u=n,(h=f).clearCoat.value=u.clearCoat,h.clearCoatRoughness.value=u.clearCoatRoughness,Se(h,u)):Se(f,n)):n.isMeshDepthMaterial?(H(f,n),t=f,(e=n).displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)):n.isMeshDistanceMaterial?(H(f,n),h=f,(u=n).displacementMap&&(h.displacementMap.value=u.displacementMap,h.displacementScale.value=u.displacementScale,h.displacementBias.value=u.displacementBias),h.referencePosition.value.copy(u.referencePosition),h.nearDistance.value=u.nearDistance,h.farDistance.value=u.farDistance):n.isMeshNormalMaterial?(H(f,n),t=f,(e=n).bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)):n.isLineBasicMaterial?(h=n,(u=f).diffuse.value=h.color,u.opacity.value=h.opacity,n.isLineDashedMaterial&&(t=n,(e=f).dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale)):n.isPointsMaterial?(u=n,(h=f).diffuse.value=u.color,h.opacity.value=u.opacity,h.size.value=u.size*S,h.scale.value=.5*T,h.map.value=u.map,null!==u.map&&(!0===u.map.matrixAutoUpdate&&(e=u.map.offset,t=u.map.repeat,i=u.map.rotation,o=u.map.center,u.map.matrix.setUvTransform(e.x,e.y,t.x,t.y,i,o.x,o.y)),h.uvTransform.value.copy(u.map.matrix))):n.isShadowMaterial&&(f.color.value=n.color,f.opacity.value=n.opacity),void 0!==f.ltcMat&&(f.ltcMat.value=Ce.LTC_MAT_TEXTURE),void 0!==f.ltcMag&&(f.ltcMag.value=Ce.LTC_MAG_TEXTURE),zn.upload(F,c.uniformsList,f,_)),p.setValue(F,"modelViewMatrix",r.modelViewMatrix),p.setValue(F,"normalMatrix",r.normalMatrix),p.setValue(F,"modelMatrix",r.matrixWorld),d}function H(e,t){var n,r,i,o;e.opacity.value=t.opacity,t.color&&(e.diffuse.value=t.color),t.emissive&&e.emissive.value.copy(t.emissive).multiplyScalar(t.emissiveIntensity),t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.specularMap&&(e.specularMap.value=t.specularMap),t.envMap&&(e.envMap.value=t.envMap,e.flipEnvMap.value=t.envMap&&t.envMap.isCubeTexture?-1:1,e.reflectivity.value=t.reflectivity,e.refractionRatio.value=t.refractionRatio),t.lightMap&&(e.lightMap.value=t.lightMap,e.lightMapIntensity.value=t.lightMapIntensity),t.aoMap&&(e.aoMap.value=t.aoMap,e.aoMapIntensity.value=t.aoMapIntensity),t.map?n=t.map:t.specularMap?n=t.specularMap:t.displacementMap?n=t.displacementMap:t.normalMap?n=t.normalMap:t.bumpMap?n=t.bumpMap:t.roughnessMap?n=t.roughnessMap:t.metalnessMap?n=t.metalnessMap:t.alphaMap?n=t.alphaMap:t.emissiveMap&&(n=t.emissiveMap),void 0!==n&&(!0===(n=n.isWebGLRenderTarget?n.texture:n).matrixAutoUpdate&&(t=n.offset,r=n.repeat,i=n.rotation,o=n.center,n.matrix.setUvTransform(t.x,t.y,r.x,r.y,i,o.x,o.y)),e.uvTransform.value.copy(n.matrix))}function Te(e,t){e.specular.value=t.specular,e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale)),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}function Se(e,t){e.roughness.value=t.roughness,e.metalness.value=t.metalness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap),t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale)),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}this.animate=function(e){_e=e,ye||(((e=D.getDevice())&&e.isPresenting?e:window).requestAnimationFrame(xe),ye=!0)},this.render=function(e,t,n,r){var i,o;t&&t.isCamera?J||(I="",x=-1,!(b=null)===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),D.enabled&&(t=D.getCamera(t)),oe.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),ne.setFromMatrix(oe),p.length=0,f.length=0,Q.length=0,Z.length=0,ie=this.localClippingEnabled,re=O.init(this.clippingPlanes,ie,t),(y=s.get(e,t)).init(),function e(t,n,r){if(!1===t.visible)return;var i=t.layers.test(n.layers);if(i)if(t.isLight)p.push(t),t.castShadow&&f.push(t);else if(t.isSprite)t.frustumCulled&&!ne.intersectsSprite(t)||Q.push(t);else if(t.isLensFlare)Z.push(t);else if(t.isImmediateRenderObject)r&&j.setFromMatrixPosition(t.matrixWorld).applyMatrix4(oe),y.push(t,null,t.material,j.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.update(),!t.frustumCulled||ne.intersectsObject(t))){r&&j.setFromMatrixPosition(t.matrixWorld).applyMatrix4(oe);var o=U.update(t),a=t.material;if(Array.isArray(a))for(var s=o.groups,c=0,l=s.length;c<l;c++){var u=s[c],h=a[u.materialIndex];h&&h.visible&&y.push(t,o,h,j.z,u)}else a.visible&&y.push(t,o,a,j.z,null)}var d=t.children;for(c=0,l=d.length;c<l;c++)e(d[c],n,r)}(e,t,_.sortObjects),!0===_.sortObjects&&y.sort(),re&&O.beginShadows(),ue.render(f,e,t),v.setup(p,f,t),re&&O.endShadows(),N.frame++,N.calls=0,N.vertices=0,N.faces=0,N.points=0,this.setRenderTarget(n=void 0===n?null:n),c.render(y,e,t,r),r=y.opaque,i=y.transparent,e.overrideMaterial?(o=e.overrideMaterial,r.length&&be(r,e,t,o),i.length&&be(i,e,t,o)):(r.length&&be(r,e,t),i.length&&be(i,e,t)),G.render(Q,e,t),V.render(Z,e,t,E),n&&a.updateRenderTargetMipmap(n),R.buffers.depth.setTest(!0),R.buffers.depth.setMask(!0),R.buffers.color.setMask(!0),R.setPolygonOffset(!1),D.enabled&&D.submitFrame()):console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFaceCulling=function(e,t){R.setCullFace(e),R.setFlipSided(0===t)},this.allocTextureUnit=function(){var e=ee;return e>=m.maxTextures&&console.warn("THREE.WebGLRenderer: Trying to use "+e+" texture units while this GPU supports only "+m.maxTextures),ee+=1,e},this.setTexture2D=(me=!1,function(e,t){e&&e.isWebGLRenderTarget&&(me||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),me=!0),e=e.texture),a.setTexture2D(e,t)}),this.setTexture=(ge=!1,function(e,t){ge||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),ge=!0),a.setTexture2D(e,t)}),this.setTextureCube=(ve=!1,function(e,t){e&&e.isWebGLRenderTargetCube&&(ve||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),ve=!0),e=e.texture),e&&e.isCubeTexture||Array.isArray(e.image)&&6===e.image.length?a.setTextureCube(e,t):a.setTextureCubeDynamic(e,t)}),this.getRenderTarget=function(){return K},this.setRenderTarget=function(e){(K=e)&&void 0===g.get(e).__webglFramebuffer&&a.setupRenderTarget(e);var t,n=null,r=!1;$=e?(t=g.get(e).__webglFramebuffer,e.isWebGLRenderTargetCube?(n=t[e.activeCubeFace],r=!0):n=t,E.copy(e.viewport),o.copy(e.scissor),e.scissorTest):(E.copy(u).multiplyScalar(S),o.copy(A).multiplyScalar(S),te),d!==n&&(F.bindFramebuffer(F.FRAMEBUFFER,n),d=n),R.viewport(E),R.scissor(o),R.setScissorTest($),r&&(t=g.get(e.texture),F.framebufferTexture2D(F.FRAMEBUFFER,F.COLOR_ATTACHMENT0,F.TEXTURE_CUBE_MAP_POSITIVE_X+e.activeCubeFace,t.__webglTexture,e.activeMipMapLevel))},this.readRenderTargetPixels=function(e,t,n,r,i,o){if(e&&e.isWebGLRenderTarget){var a=g.get(e).__webglFramebuffer;if(a){var s=!1;a!==d&&(F.bindFramebuffer(F.FRAMEBUFFER,a),s=!0);try{var c=e.texture,l=c.format,u=c.type;l!==Mt&&h.convert(l)!==F.getParameter(F.IMPLEMENTATION_COLOR_READ_FORMAT)?console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format."):u===ut||h.convert(u)===F.getParameter(F.IMPLEMENTATION_COLOR_READ_TYPE)||u===gt&&(P.get("OES_texture_float")||P.get("WEBGL_color_buffer_float"))||u===vt&&P.get("EXT_color_buffer_half_float")?F.checkFramebufferStatus(F.FRAMEBUFFER)===F.FRAMEBUFFER_COMPLETE?0<=t&&t<=e.width-r&&0<=n&&n<=e.height-i&&F.readPixels(t,n,r,i,h.convert(l),h.convert(u),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.")}finally{s&&F.bindFramebuffer(F.FRAMEBUFFER,d)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")}}function ga(e,t){this.name="",this.color=new pe(e),this.density=void 0!==t?t:25e-5}function va(e,t,n){this.name="",this.color=new pe(e),this.near=void 0!==t?t:1,this.far=void 0!==n?n:1e3}function ya(){f.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}function _a(e,t,n,r,i){f.call(this),this.lensFlares=[],this.positionScreen=new Re,(this.customUpdateCallback=void 0)!==e&&this.add(e,t,n,r,i)}function xa(e){t.call(this),this.type="SpriteMaterial",this.color=new pe(16777215),this.map=null,this.rotation=0,this.fog=!1,this.lights=!1,this.setValues(e)}function ba(e){f.call(this),this.type="Sprite",this.material=void 0!==e?e:new xa}function wa(){f.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function Ea(e,t){if(this.bones=(e=e||[]).slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new Pe)}}function Ma(){f.call(this),this.type="Bone"}function Ta(e,t){m.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Pe,this.bindMatrixInverse=new Pe;e=new Ea(this.initBones());this.bind(e,this.matrixWorld),this.normalizeSkinWeights()}function v(e){t.call(this),this.type="LineBasicMaterial",this.color=new pe(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(e)}function y(e,t,n){if(1===n)return console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new _(e,t);f.call(this),this.type="Line",this.geometry=void 0!==e?e:new Z,this.material=void 0!==t?t:new v({color:16777215*Math.random()})}function _(e,t){y.call(this,e,t),this.type="LineSegments"}function Sa(e,t){y.call(this,e,t),this.type="LineLoop"}function Aa(e){t.call(this),this.type="PointsMaterial",this.color=new pe(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.lights=!1,this.setValues(e)}function Pa(e,t){f.call(this),this.type="Points",this.geometry=void 0!==e?e:new Z,this.material=void 0!==t?t:new Aa({color:16777215*Math.random()})}function Ra(){f.call(this),this.type="Group"}function La(e,t,n,r,i,o,a,s,c){d.call(this,e,t,n,r,i,o,a,s,c),this.generateMipmaps=!1;var l=this;requestAnimationFrame(function e(){var t=l.image;t.readyState>=t.HAVE_CURRENT_DATA&&(l.needsUpdate=!0),requestAnimationFrame(e)})}function Ca(e,t,n,r,i,o,a,s,c,l,u,h){d.call(this,null,o,a,s,c,l,r,i,u,h),this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}function Ia(e,t,n,r,i,o,a,s,c,l){if((l=void 0!==l?l:Pt)!==Pt&&l!==Rt)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");d.call(this,null,r,i,o,a,s,l,n=void 0===(n=void 0===n&&l===Pt?pt:n)&&l===Rt?bt:n,c),this.image={width:e,height:t},this.magFilter=void 0!==a?a:P,this.minFilter=void 0!==s?s:P,this.flipY=!1,this.generateMipmaps=!1}function Oa(e){Z.call(this),this.type="WireframeGeometry";var t,n,r,i,o,a,s=[],c=[0,0],l={},u=["a","b","c"];if(e&&e.isGeometry){for(var h=e.faces,d=0,p=h.length;d<p;d++)for(var f=h[d],m=0;m<3;m++)i=f[u[m]],o=f[u[(m+1)%3]],c[0]=Math.min(i,o),c[1]=Math.max(i,o),void 0===l[a=c[0]+","+c[1]]&&(l[a]={index1:c[0],index2:c[1]});for(a in l)x=e.vertices[(r=l[a]).index1],s.push(x.x,x.y,x.z),x=e.vertices[r.index2],s.push(x.x,x.y,x.z)}else if(e&&e.isBufferGeometry){var g,v,y,_,x=new Re;if(null!==e.index){for(g=e.attributes.position,v=e.index,n=(y=(t=0)===(y=e.groups).length?[{start:0,count:v.count,materialIndex:0}]:y).length;t<n;++t)for(p=(d=(_=y[t]).start)+_.count;d<p;d+=3)for(m=0;m<3;m++)i=v.getX(d+m),o=v.getX(d+(m+1)%3),c[0]=Math.min(i,o),c[1]=Math.max(i,o),void 0===l[a=c[0]+","+c[1]]&&(l[a]={index1:c[0],index2:c[1]});for(a in l)x.fromBufferAttribute(g,(r=l[a]).index1),s.push(x.x,x.y,x.z),x.fromBufferAttribute(g,r.index2),s.push(x.x,x.y,x.z)}else for(d=0,p=(g=e.attributes.position).count/3;d<p;d++)for(m=0;m<3;m++)x.fromBufferAttribute(g,3*d+m),s.push(x.x,x.y,x.z),x.fromBufferAttribute(g,3*d+(m+1)%3),s.push(x.x,x.y,x.z)}this.addAttribute("position",new te(s,3))}function ja(e,t,n){fe.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:n},this.fromBufferGeometry(new Na(e,t,n)),this.mergeVertices()}function Na(e,t,n){Z.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:t,stacks:n};for(var r=[],i=[],o=[],a=[],s=new Re,c=new Re,l=new Re,u=new Re,h=new Re,d=t+1,p=0;p<=n;p++)for(var f=p/n,m=0;m<=t;m++){var g=m/t,c=e(g,f,c);i.push(c.x,c.y,c.z),0<=g-1e-5?(l=e(g-1e-5,f,l),u.subVectors(c,l)):(l=e(1e-5+g,f,l),u.subVectors(l,c)),0<=f-1e-5?(l=e(g,f-1e-5,l),h.subVectors(c,l)):(l=e(g,1e-5+f,l),h.subVectors(l,c)),s.crossVectors(u,h).normalize(),o.push(s.x,s.y,s.z),a.push(g,f)}for(p=0;p<n;p++)for(m=0;m<t;m++){var v=p*d+m+1,y=(p+1)*d+m+1,_=(p+1)*d+m;r.push(p*d+m,v,_),r.push(v,y,_)}this.setIndex(r),this.addAttribute("position",new te(i,3)),this.addAttribute("normal",new te(o,3)),this.addAttribute("uv",new te(a,2))}function Fa(e,t,n,r){fe.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r},this.fromBufferGeometry(new o(e,t,n,r)),this.mergeVertices()}function o(n,e,t,r){Z.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:n,indices:e,radius:t,detail:r},t=t||1;for(var i=[],o=[],F=r=r||0,a=new Re,s=new Re,c=new Re,l=0;l<e.length;l+=3){j(e[l+0],a),j(e[l+1],s),j(e[l+2],c),y=v=U=g=p=d=m=f=H=h=D=u=void 0;var u=a,D=s,h=c,H=F,d,p,f=Math.pow(2,H),m=[];for(d=0;d<=f;d++){m[d]=[];var g=u.clone().lerp(h,d/f),U=D.clone().lerp(h,d/f),v=f-d;for(p=0;p<=v;p++)m[d][p]=0===p&&d===f?g:g.clone().lerp(U,p/v)}for(d=0;d<f;d++)for(p=0;p<2*(f-d)-1;p++){var y=Math.floor(p/2);p%2==0?(O(m[d][y+1]),O(m[d+1][y]),O(m[d][y])):(O(m[d][y+1]),O(m[d+1][y+1]),O(m[d+1][y]))}}for(var z=t,_=new Re,x=0;x<i.length;x+=3)_.x=i[x+0],_.y=i[x+1],_.z=i[x+2],_.normalize().multiplyScalar(z),i[x+0]=_.x,i[x+1]=_.y,i[x+2]=_.z;for(var b=new Re,w=0;w<i.length;w+=3){b.x=i[w+0],b.y=i[w+1],b.z=i[w+2];var k=Q(b)/2/Math.PI+.5,B=(e=>Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z)))(b)/Math.PI+.5;o.push(k,1-B)}for(var E=new Re,M=new Re,T=new Re,V=new Re,G=new de,W=new de,q=new de,S=0,A=0;S<i.length;S+=9,A+=6){E.set(i[S+0],i[S+1],i[S+2]),M.set(i[S+3],i[S+4],i[S+5]),T.set(i[S+6],i[S+7],i[S+8]),G.set(o[A+0],o[A+1]),W.set(o[A+2],o[A+3]),q.set(o[A+4],o[A+5]),V.copy(E).add(M).add(T).divideScalar(3);var P=Q(V);N(G,A+0,E,P),N(W,A+2,M,P),N(q,A+4,T,P)}for(var R=0;R<o.length;R+=6){var L=o[R+0],C=o[R+2],I=o[R+4],X=Math.max(L,C,I),Y=Math.min(L,C,I);.9<X&&Y<.1&&(L<.2&&(o[R+0]+=1),C<.2&&(o[R+2]+=1),I<.2)&&(o[R+4]+=1)}function O(e){i.push(e.x,e.y,e.z)}function j(e,t){e*=3;t.x=n[0+e],t.y=n[1+e],t.z=n[2+e]}function N(e,t,n,r){r<0&&1===e.x&&(o[t]=e.x-1),0===n.x&&0===n.z&&(o[t]=r/2/Math.PI+.5)}function Q(e){return Math.atan2(e.z,-e.x)}this.addAttribute("position",new te(i,3)),this.addAttribute("normal",new te(i.slice(),3)),this.addAttribute("uv",new te(o,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}function Da(e,t){fe.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Ha(e,t)),this.mergeVertices()}function Ha(e,t){o.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Ua(e,t){fe.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new za(e,t)),this.mergeVertices()}function za(e,t){o.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:t}}function ka(e,t){fe.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Ba(e,t)),this.mergeVertices()}function Ba(e,t){var n=(1+Math.sqrt(5))/2;o.call(this,[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Va(e,t){fe.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Ga(e,t)),this.mergeVertices()}function Ga(e,t){var n=(1+Math.sqrt(5))/2,r=1/n;o.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Wa(e,t,n,r,i,o){fe.call(this),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:i},void 0!==o&&console.warn("THREE.TubeGeometry: taper has been removed.");o=new qa(e,t,n,r,i);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals,this.fromBufferGeometry(o),this.mergeVertices()}function qa(o,a,s,c,e){Z.call(this),this.type="TubeBufferGeometry",this.parameters={path:o,tubularSegments:a,radius:s,radialSegments:c,closed:e},a=a||64,s=s||1,c=c||8,e=e||!1;var t,l,u=o.computeFrenetFrames(a,e),h=(this.tangents=u.tangents,this.normals=u.normals,this.binormals=u.binormals,new Re),d=new Re,n=new de,p=new Re,f=[],m=[],r=[],i=[];for(t=0;t<a;t++)x(t);for(x(!1===e?a:0),t=0;t<=a;t++)for(l=0;l<=c;l++)n.x=t/a,n.y=l/c,r.push(n.x,n.y);for(l=1;l<=a;l++)for(t=1;t<=c;t++){var g=(c+1)*(l-1)+(t-1),v=(c+1)*l+(t-1),y=(c+1)*l+t,_=(c+1)*(l-1)+t;i.push(g,v,_),i.push(v,y,_)}function x(e){p=o.getPointAt(e/a,p);var t=u.normals[e],n=u.binormals[e];for(l=0;l<=c;l++){var r=l/c*Math.PI*2,i=Math.sin(r),r=-Math.cos(r);d.x=r*t.x+i*n.x,d.y=r*t.y+i*n.y,d.z=r*t.z+i*n.z,d.normalize(),m.push(d.x,d.y,d.z),h.x=p.x+s*d.x,h.y=p.y+s*d.y,h.z=p.z+s*d.z,f.push(h.x,h.y,h.z)}}this.setIndex(i),this.addAttribute("position",new te(f,3)),this.addAttribute("normal",new te(m,3)),this.addAttribute("uv",new te(r,2))}function Xa(e,t,n,r,i,o,a){fe.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:i,q:o},void 0!==a&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Ya(e,t,n,r,i,o)),this.mergeVertices()}function Ya(e,t,n,r,i,o){Z.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:i,q:o},e=e||1,t=t||.4,n=Math.floor(n)||64,r=Math.floor(r)||8,i=i||2,o=o||3;for(var a,s=[],c=[],l=[],u=[],h=new Re,d=new Re,p=new Re,f=new Re,m=new Re,g=new Re,v=new Re,y=0;y<=n;++y){var _=y/n*i*Math.PI*2;for(T(_,i,o,e,p),T(.01+_,i,o,e,f),g.subVectors(f,p),v.addVectors(f,p),m.crossVectors(g,v),v.crossVectors(m,g),m.normalize(),v.normalize(),a=0;a<=r;++a){var x=a/r*Math.PI*2,b=-t*Math.cos(x),x=t*Math.sin(x);h.x=p.x+(b*v.x+x*m.x),h.y=p.y+(b*v.y+x*m.y),h.z=p.z+(b*v.z+x*m.z),c.push(h.x,h.y,h.z),d.subVectors(h,p).normalize(),l.push(d.x,d.y,d.z),u.push(y/n),u.push(a/r)}}for(a=1;a<=n;a++)for(y=1;y<=r;y++){var w=(r+1)*a+(y-1),E=(r+1)*a+y,M=(r+1)*(a-1)+y;s.push((r+1)*(a-1)+(y-1),w,M),s.push(w,E,M)}function T(e,t,n,r,i){var o=Math.cos(e),a=Math.sin(e),n=n/t*e,t=Math.cos(n);i.x=r*(2+t)*.5*o,i.y=r*(2+t)*a*.5,i.z=r*Math.sin(n)*.5}this.setIndex(s),this.addAttribute("position",new te(c,3)),this.addAttribute("normal",new te(l,3)),this.addAttribute("uv",new te(u,2))}function Qa(e,t,n,r,i){fe.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:i},this.fromBufferGeometry(new Za(e,t,n,r,i)),this.mergeVertices()}function Za(e,t,n,r,i){Z.call(this),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:i},e=e||1,t=t||.4,n=Math.floor(n)||8,r=Math.floor(r)||6,i=i||2*Math.PI;for(var o,a=[],s=[],c=[],l=[],u=new Re,h=new Re,d=new Re,p=0;p<=n;p++)for(o=0;o<=r;o++){var f=o/r*i,m=p/n*Math.PI*2;h.x=(e+t*Math.cos(m))*Math.cos(f),h.y=(e+t*Math.cos(m))*Math.sin(f),h.z=t*Math.sin(m),s.push(h.x,h.y,h.z),u.x=e*Math.cos(f),u.y=e*Math.sin(f),d.subVectors(h,u).normalize(),c.push(d.x,d.y,d.z),l.push(o/r),l.push(p/n)}for(p=1;p<=n;p++)for(o=1;o<=r;o++){var g=(r+1)*(p-1)+o-1,v=(r+1)*(p-1)+o,y=(r+1)*p+o;a.push((r+1)*p+o-1,g,y),a.push(g,v,y)}this.setIndex(a),this.addAttribute("position",new te(s,3)),this.addAttribute("normal",new te(c,3)),this.addAttribute("uv",new te(l,2))}g.prototype=Object.assign(Object.create(Qr.prototype),{constructor:g,isPerspectiveCamera:!0,copy:function(e,t){return Qr.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){e=.5*this.getFilmHeight()/e;this.fov=2*Ae.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*Ae.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*Ae.RAD2DEG*Math.atan(Math.tan(.5*Ae.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,n,r,i,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e,t=this.near,n=t*Math.tan(.5*Ae.DEG2RAD*this.fov)/this.zoom,r=2*n,i=this.aspect*r,o=-.5*i,a=this.view,s=(null!==this.view&&this.view.enabled&&(s=a.fullWidth,e=a.fullHeight,o+=a.offsetX*i/s,n-=a.offsetY*r/e,i*=a.width/s,r*=a.height/e),this.filmOffset);0!==s&&(o+=t*s/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+i,n,n-r,t,this.far)},toJSON:function(e){e=f.prototype.toJSON.call(this,e);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}),ua.prototype=Object.assign(Object.create(g.prototype),{constructor:ua,isArrayCamera:!0}),ga.prototype.isFogExp2=!0,ga.prototype.clone=function(){return new ga(this.color.getHex(),this.density)},ga.prototype.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},va.prototype.isFog=!0,va.prototype.clone=function(){return new va(this.color.getHex(),this.near,this.far)},va.prototype.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},ya.prototype=Object.assign(Object.create(f.prototype),{constructor:ya,copy:function(e,t){return f.prototype.copy.call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){var t=f.prototype.toJSON.call(this,e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}),_a.prototype=Object.assign(Object.create(f.prototype),{constructor:_a,isLensFlare:!0,copy:function(e){f.prototype.copy.call(this,e),this.positionScreen.copy(e.positionScreen),this.customUpdateCallback=e.customUpdateCallback;for(var t=0,n=e.lensFlares.length;t<n;t++)this.lensFlares.push(e.lensFlares[t]);return this},add:function(e,t,n,r,i,o){void 0===t&&(t=-1),void 0===n&&(n=0),void 0===o&&(o=1),void 0===i&&(i=new pe(16777215)),void 0===r&&(r=oe),n=Math.min(n,Math.max(0,n)),this.lensFlares.push({texture:e,size:t,distance:n,x:0,y:0,z:0,scale:1,rotation:0,opacity:o,color:i,blending:r})},updateLensFlares:function(){for(var e,t=this.lensFlares.length,n=2*-this.positionScreen.x,r=2*-this.positionScreen.y,i=0;i<t;i++)(e=this.lensFlares[i]).x=this.positionScreen.x+n*e.distance,e.y=this.positionScreen.y+r*e.distance,e.wantedRotation=e.x*Math.PI*.25,e.rotation+=.25*(e.wantedRotation-e.rotation)}}),((xa.prototype=Object.create(t.prototype)).constructor=xa).prototype.isSpriteMaterial=!0,xa.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.rotation=e.rotation,this},ba.prototype=Object.assign(Object.create(f.prototype),{constructor:ba,isSprite:!0,raycast:(Do=new Re,Ho=new Re,Uo=new Re,function(e,t){Ho.setFromMatrixPosition(this.matrixWorld),e.ray.closestPointToPoint(Ho,Do),Uo.setFromMatrixScale(this.matrixWorld);var n=Uo.x*Uo.y/4;Ho.distanceToSquared(Do)>n||(n=e.ray.origin.distanceTo(Do))<e.near||n>e.far||t.push({distance:n,point:Do.clone(),face:null,object:this})}),clone:function(){return new this.constructor(this.material).copy(this)}}),wa.prototype=Object.assign(Object.create(f.prototype),{constructor:wa,copy:function(e){f.prototype.copy.call(this,e,!1);for(var t=e.levels,n=0,r=t.length;n<r;n++){var i=t[n];this.addLevel(i.object.clone(),i.distance)}return this},addLevel:function(e,t){void 0===t&&(t=0),t=Math.abs(t);for(var n=this.levels,r=0;r<n.length&&!(t<n[r].distance);r++);n.splice(r,0,{distance:t,object:e}),this.add(e)},getObjectForDistance:function(e){for(var t=this.levels,n=1,r=t.length;n<r&&!(e<t[n].distance);n++);return t[n-1].object},raycast:(Bo=new Re,function(e,t){Bo.setFromMatrixPosition(this.matrixWorld);var n=e.ray.origin.distanceTo(Bo);this.getObjectForDistance(n).raycast(e,t)}),update:(zo=new Re,ko=new Re,function(e){var t=this.levels;if(1<t.length){zo.setFromMatrixPosition(e.matrixWorld),ko.setFromMatrixPosition(this.matrixWorld);var n=zo.distanceTo(ko);t[0].object.visible=!0;for(var r=1,i=t.length;r<i&&n>=t[r].distance;r++)t[r-1].object.visible=!1,t[r].object.visible=!0;for(;r<i;r++)t[r].object.visible=!1}}),toJSON:function(e){for(var t=f.prototype.toJSON.call(this,e),n=(t.object.levels=[],this.levels),r=0,i=n.length;r<i;r++){var o=n[r];t.object.levels.push({object:o.object.uuid,distance:o.distance})}return t}}),Object.assign(Ea.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,t=this.bones.length;e<t;e++){var n=new Pe;this.bones[e]&&n.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(n)}},pose:function(){for(var e,t=0,n=this.bones.length;t<n;t++)(e=this.bones[t])&&e.matrixWorld.getInverse(this.boneInverses[t]);for(t=0,n=this.bones.length;t<n;t++)(e=this.bones[t])&&(e.parent&&e.parent.isBone?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},update:(Vo=new Pe,Go=new Pe,function(){for(var e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture,i=0,o=e.length;i<o;i++){var a=e[i]?e[i].matrixWorld:Go;Vo.multiplyMatrices(a,t[i]),Vo.toArray(n,16*i)}void 0!==r&&(r.needsUpdate=!0)}),clone:function(){return new Ea(this.bones,this.boneInverses)}}),Ma.prototype=Object.assign(Object.create(f.prototype),{constructor:Ma,isBone:!0}),Ta.prototype=Object.assign(Object.create(m.prototype),{constructor:Ta,isSkinnedMesh:!0,initBones:function(){var e,t,n,r,i=[];if(this.geometry&&void 0!==this.geometry.bones){for(n=0,r=this.geometry.bones.length;n<r;n++)t=this.geometry.bones[n],e=new Ma,i.push(e),e.name=t.name,e.position.fromArray(t.pos),e.quaternion.fromArray(t.rotq),void 0!==t.scl&&e.scale.fromArray(t.scl);for(n=0,r=this.geometry.bones.length;n<r;n++)(-1!==(t=this.geometry.bones[n]).parent&&null!==t.parent&&void 0!==i[t.parent]?i[t.parent]:this).add(i[n])}return this.updateMatrixWorld(!0),i},bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){if(this.geometry&&this.geometry.isGeometry)for(i=0;i<this.geometry.skinWeights.length;i++){var e,t=this.geometry.skinWeights[i];(e=1/t.manhattanLength())!==1/0?t.multiplyScalar(e):t.set(1,0,0,0)}else if(this.geometry&&this.geometry.isBufferGeometry)for(var n=new Le,r=this.geometry.attributes.skinWeight,i=0;i<r.count;i++)n.x=r.getX(i),n.y=r.getY(i),n.z=r.getZ(i),n.w=r.getW(i),(e=1/n.manhattanLength())!==1/0?n.multiplyScalar(e):n.set(1,0,0,0),r.setXYZW(i,n.x,n.y,n.z,n.w)},updateMatrixWorld:function(e){m.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),((v.prototype=Object.create(t.prototype)).constructor=v).prototype.isLineBasicMaterial=!0,v.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this},y.prototype=Object.assign(Object.create(f.prototype),{constructor:y,isLine:!0,raycast:(Wo=new Pe,qo=new vo,Xo=new wr,function(e,t){var n=e.linePrecision,r=n*n,n=this.geometry,i=this.matrixWorld;if(null===n.boundingSphere&&n.computeBoundingSphere(),Xo.copy(n.boundingSphere),Xo.applyMatrix4(i),!1!==e.ray.intersectsSphere(Xo)){Wo.getInverse(i),qo.copy(e.ray).applyMatrix4(Wo);var o=new Re,a=new Re,s=new Re,c=new Re,l=this&&this.isLineSegments?2:1;if(n.isBufferGeometry){var i=n.index,u=n.attributes.position.array;if(null!==i)for(var h=i.array,d=0,p=h.length-1;d<p;d+=l){var f=h[d],m=h[d+1];o.fromArray(u,3*f),a.fromArray(u,3*m),r<qo.distanceSqToSegment(o,a,c,s)||(c.applyMatrix4(this.matrixWorld),(g=e.ray.origin.distanceTo(c))<e.near)||g>e.far||t.push({distance:g,point:s.clone().applyMatrix4(this.matrixWorld),index:d,face:null,faceIndex:null,object:this})}else for(d=0,p=u.length/3-1;d<p;d+=l)o.fromArray(u,3*d),a.fromArray(u,3*d+3),r<qo.distanceSqToSegment(o,a,c,s)||(c.applyMatrix4(this.matrixWorld),(g=e.ray.origin.distanceTo(c))<e.near)||g>e.far||t.push({distance:g,point:s.clone().applyMatrix4(this.matrixWorld),index:d,face:null,faceIndex:null,object:this})}else if(n.isGeometry)for(var g,v=n.vertices,y=v.length,d=0;d<y-1;d+=l)r<qo.distanceSqToSegment(v[d],v[d+1],c,s)||(c.applyMatrix4(this.matrixWorld),(g=e.ray.origin.distanceTo(c))<e.near)||g>e.far||t.push({distance:g,point:s.clone().applyMatrix4(this.matrixWorld),index:d,face:null,faceIndex:null,object:this})}}),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),_.prototype=Object.assign(Object.create(y.prototype),{constructor:_,isLineSegments:!0}),Sa.prototype=Object.assign(Object.create(y.prototype),{constructor:Sa,isLineLoop:!0}),((Aa.prototype=Object.create(t.prototype)).constructor=Aa).prototype.isPointsMaterial=!0,Aa.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this},Pa.prototype=Object.assign(Object.create(f.prototype),{constructor:Pa,isPoints:!0,raycast:(Yo=new Pe,Qo=new vo,Zo=new wr,function(i,o){var a=this,e=this.geometry,s=this.matrixWorld,t=i.params.Points.threshold;if(null===e.boundingSphere&&e.computeBoundingSphere(),Zo.copy(e.boundingSphere),Zo.applyMatrix4(s),Zo.radius+=t,!1!==i.ray.intersectsSphere(Zo)){Yo.getInverse(s),Qo.copy(i.ray).applyMatrix4(Yo);var t=t/((this.scale.x+this.scale.y+this.scale.z)/3),c=t*t,n=new Re;if(e.isBufferGeometry){var t=e.index,r=e.attributes.position.array;if(null!==t)for(var l=t.array,u=0,h=l.length;u<h;u++){var d=l[u];n.fromArray(r,3*d),m(n,d)}else for(var u=0,p=r.length/3;u<p;u++)n.fromArray(r,3*u),m(n,u)}else for(var f=e.vertices,u=0,p=f.length;u<p;u++)m(f[u],u)}function m(e,t){var n,r=Qo.distanceSqToPoint(e);r<c&&((e=Qo.closestPointToPoint(e)).applyMatrix4(s),(n=i.ray.origin.distanceTo(e))<i.near||n>i.far||o.push({distance:n,distanceToRay:Math.sqrt(r),point:e.clone(),index:t,face:null,object:a}))}}),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Ra.prototype=Object.assign(Object.create(f.prototype),{constructor:Ra}),(La.prototype=Object.create(d.prototype)).constructor=La,((Ca.prototype=Object.create(d.prototype)).constructor=Ca).prototype.isCompressedTexture=!0,((Ia.prototype=Object.create(d.prototype)).constructor=Ia).prototype.isDepthTexture=!0,(Oa.prototype=Object.create(Z.prototype)).constructor=Oa,(ja.prototype=Object.create(fe.prototype)).constructor=ja,(Na.prototype=Object.create(Z.prototype)).constructor=Na,(Fa.prototype=Object.create(fe.prototype)).constructor=Fa,(o.prototype=Object.create(Z.prototype)).constructor=o,(Da.prototype=Object.create(fe.prototype)).constructor=Da,(Ha.prototype=Object.create(o.prototype)).constructor=Ha,(Ua.prototype=Object.create(fe.prototype)).constructor=Ua,(za.prototype=Object.create(o.prototype)).constructor=za,(ka.prototype=Object.create(fe.prototype)).constructor=ka,(Ba.prototype=Object.create(o.prototype)).constructor=Ba,(Va.prototype=Object.create(fe.prototype)).constructor=Va,(Ga.prototype=Object.create(o.prototype)).constructor=Ga,(Wa.prototype=Object.create(fe.prototype)).constructor=Wa,(qa.prototype=Object.create(Z.prototype)).constructor=qa,(Xa.prototype=Object.create(fe.prototype)).constructor=Xa,(Ya.prototype=Object.create(Z.prototype)).constructor=Ya,(Qa.prototype=Object.create(fe.prototype)).constructor=Qa,(Za.prototype=Object.create(Z.prototype)).constructor=Za;var Ja={area:function(e){for(var t=e.length,n=0,r=t-1,i=0;i<t;r=i++)n+=e[r].x*e[i].y-e[i].x*e[r].y;return.5*n},triangulate:function(e,t){var n=e.length;if(n<3)return null;var r,i,o=[],a=[],s=[];if(0<Ja.area(e))for(d=0;d<n;d++)a[d]=d;else for(d=0;d<n;d++)a[d]=n-1-d;for(var c,l,u=n,h=2*u,d=u-1;2<u;){if(h--<=0)return console.warn("THREE.ShapeUtils: Unable to triangulate polygon! in triangulate()"),t?s:o;if(((e,t,n,r,i,o)=>{var a,s,c=e[o[t]].x,l=e[o[t]].y,u=e[o[n]].x,h=e[o[n]].y,d=e[o[r]].x,p=e[o[r]].y;if(!((u-c)*(p-l)-(h-l)*(d-c)<=0)){for(var f=d-u,m=p-h,g=c-d,v=l-p,y=u-c,_=h-l,x=0;x<i;x++)if(a=e[o[x]].x,s=e[o[x]].y,!(a===c&&s===l||a===u&&s===h||a===d&&s===p)&&f*(s-h)-m*(a-u)>=-Number.EPSILON&&g*(s-p)-v*(a-d)>=-Number.EPSILON&&y*(s-l)-_*(a-c)>=-Number.EPSILON)return;return 1}})(e,r=u<=(r=d)?0:r,d=u<=(d=r+1)?0:d,i=u<=(i=d+1)?0:i,u,a)){for(o.push([e[a[r]],e[a[d]],e[a[i]]]),s.push([a[r],a[d],a[i]]),l=(c=d)+1;l<u;c++,l++)a[c]=a[l];h=2*--u}}return t?s:o},triangulateShape:function(e,t){function n(e){var t=e.length;2<t&&e[t-1].equals(e[0])&&e.pop()}function b(e,t,n){return e.x!==t.x?e.x<t.x?e.x<=n.x&&n.x<=t.x:t.x<=n.x&&n.x<=e.x:e.y<t.y?e.y<=n.y&&n.y<=t.y:t.y<=n.y&&n.y<=e.y}function x(e,t,n,r,i){var o,a,s,c,l,u,h,d,p=t.x-e.x,f=t.y-e.y,m=r.x-n.x,g=r.y-n.y,v=e.x-n.x,y=e.y-n.y,_=f*m-p*g,x=f*v-p*y;if(Math.abs(_)>Number.EPSILON){if(0<_){if(x<0||_<x)return[];if((d=g*v-m*y)<0||_<d)return[]}else{if(0<x||x<_)return[];if(0<(d=g*v-m*y)||d<_)return[]}return 0===d?!i||0!=x&&x!=_?[e]:[]:d===_?!i||0!=x&&x!=_?[t]:[]:0==x?[n]:x==_?[r]:[{x:e.x+(d=d/_)*p,y:e.y+d*f}]}return 0!=x||g*v!=m*y?[]:(_=0==m&&0==g,(d=0==p&&0==f)&&_?e.x!==n.x||e.y!==n.y?[]:[e]:d?b(n,r,e)?[e]:[]:_?b(e,t,n)?[n]:[]:(x=0!=p?(c=(a=e.x<t.x?(s=(o=e).x,t):(s=(o=t).x,e)).x,(u=n.x<r.x?(h=(l=n).x,r):(h=(l=r).x,n)).x):(c=(a=e.y<t.y?(s=(o=e).y,t):(s=(o=t).y,e)).y,(u=n.y<r.y?(h=(l=n).y,r):(h=(l=r).y,n)).y),s<=h?c<h?[]:c===h?i?[]:[l]:c<=x?[l,a]:[l,u]:x<s?[]:s===x?i?[]:[o]:c<=x?[o,a]:[o,u]))}function w(e,t,n,r){var i=t.x-e.x,t=t.y-e.y,o=n.x-e.x,n=n.y-e.y,a=r.x-e.x,r=r.y-e.y,e=i*n-t*o,i=i*r-t*a;return Math.abs(e)>Number.EPSILON?(t=a*n-r*o,0<e?0<=i&&0<=t:0<=i||0<=t):0<i}n(e),t.forEach(n);for(var r,i,o,a,s={},c=e.concat(),l=0,u=t.length;l<u;l++)Array.prototype.push.apply(c,t[l]);for(d=0,p=c.length;d<p;d++)void 0!==s[o=c[d].x+":"+c[d].y]&&console.warn("THREE.ShapeUtils: Duplicate point",o,d),s[o]=d;for(var e=((e,a)=>{for(var t,n,r,i,o,s,c,l=e.concat(),u=[],h=[],d=0,p=a.length;d<p;d++)u.push(d);for(var f=0,m=2*u.length;0<u.length;){if(--m<0){console.log('THREE.ShapeUtils: Infinite Loop! Holes left:" + indepHoles.length + ", Probably Hole outside Shape!');break}for(t=f;t<l.length;t++){for(var g=l[t],v=-1,d=0;d<u.length;d++)if(void 0===h[r=g.x+":"+g.y+":"+(n=u[d])]){for(var y=a[n],_=0;_<y.length;_++)if(i=y[_],((e,t)=>{var n=l.length-1,r=e-1,i=e+1;return(r=w(l[e],l[r=r<0?n:r],l[i=n<i?0:i],y[t]))&&(n=y.length-1,w(y[t],y[i=(i=t-1)<0?n:i],y[r=n<(r=t+1)?0:r],l[e]))?1:void 0})(t,_)&&!((e,t)=>{for(var n,r=0;r<l.length;r++)if(n=r+1,n%=l.length,0<x(e,t,l[r],l[n],!0).length)return 1})(g,i)&&!((e,t)=>{for(var n,r,i,o=0;o<u.length;o++)for(n=a[u[o]],r=0;r<n.length;r++)if(i=r+1,i%=n.length,0<x(e,t,n[r],n[i],!0).length)return 1})(g,i)){v=_,u.splice(d,1),i=l.slice(0,t+1),o=l.slice(t),s=y.slice(v),c=y.slice(0,v+1),l=i.concat(s).concat(c).concat(o),f=t;break}if(0<=v)break;h[r]=!0}if(0<=v)break}}return l})(e,t),h=Ja.triangulate(e,!1),d=0,p=h.length;d<p;d++)for(i=h[d],r=0;r<3;r++)void 0!==(a=s[o=i[r].x+":"+i[r].y])&&(i[r]=a);return h.concat()},isClockWise:function(e){return Ja.area(e)<0}};function Ka(e,t){fe.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},this.fromBufferGeometry(new $a(e,t)),this.mergeVertices()}function $a(e,t){void 0!==e&&(Z.call(this),this.type="ExtrudeBufferGeometry",e=Array.isArray(e)?e:[e],this.addShapeList(e,t),this.computeVertexNormals())}function es(e,t){fe.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:t},this.fromBufferGeometry(new ts(e,t)),this.mergeVertices()}function ts(e,t){var n=(t=t||{}).font;if(!n||!n.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new fe;n=n.generateShapes(e,t.size,t.curveSegments);t.amount=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),$a.call(this,n,t),this.type="TextBufferGeometry"}function ns(e,t,n,r,i,o,a){fe.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new rs(e,t,n,r,i,o,a)),this.mergeVertices()}function rs(e,t,n,r,i,o,a){Z.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:a},e=e||1,t=Math.max(3,Math.floor(t)||8),n=Math.max(2,Math.floor(n)||6),r=void 0!==r?r:0,i=void 0!==i?i:2*Math.PI;for(var s=(o=void 0!==o?o:0)+(a=void 0!==a?a:Math.PI),c=0,l=[],u=new Re,h=new Re,d=[],p=[],f=[],m=[],g=0;g<=n;g++){for(var v=[],y=g/n,_=0;_<=t;_++){var x=_/t;u.x=-e*Math.cos(r+x*i)*Math.sin(o+y*a),u.y=e*Math.cos(o+y*a),u.z=e*Math.sin(r+x*i)*Math.sin(o+y*a),p.push(u.x,u.y,u.z),h.set(u.x,u.y,u.z).normalize(),f.push(h.x,h.y,h.z),m.push(x,1-y),v.push(c++)}l.push(v)}for(g=0;g<n;g++)for(_=0;_<t;_++){var b=l[g][_+1],w=l[g][_],E=l[g+1][_],M=l[g+1][_+1];(0!==g||0<o)&&d.push(b,w,M),(g!==n-1||s<Math.PI)&&d.push(w,E,M)}this.setIndex(d),this.addAttribute("position",new te(p,3)),this.addAttribute("normal",new te(f,3)),this.addAttribute("uv",new te(m,2))}function is(e,t,n,r,i,o){fe.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:o},this.fromBufferGeometry(new os(e,t,n,r,i,o)),this.mergeVertices()}function os(e,t,n,r,i,o){Z.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:o},e=e||.5,t=t||1,i=void 0!==i?i:0,o=void 0!==o?o:2*Math.PI,n=void 0!==n?Math.max(3,n):8;for(var a=[],s=[],c=[],l=[],u=e,h=(t-e)/(r=void 0!==r?Math.max(1,r):1),d=new Re,p=new de,f=0;f<=r;f++){for(g=0;g<=n;g++)v=i+g/n*o,d.x=u*Math.cos(v),d.y=u*Math.sin(v),s.push(d.x,d.y,d.z),c.push(0,0,1),p.x=(d.x/t+1)/2,p.y=(d.y/t+1)/2,l.push(p.x,p.y);u+=h}for(f=0;f<r;f++)for(var m=f*(n+1),g=0;g<n;g++){var v,y=v=g+m,_=v+n+1,x=v+n+2,b=v+1;a.push(y,_,b),a.push(_,x,b)}this.setIndex(a),this.addAttribute("position",new te(s,3)),this.addAttribute("normal",new te(c,3)),this.addAttribute("uv",new te(l,2))}function as(e,t,n,r){fe.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},this.fromBufferGeometry(new ss(e,t,n,r)),this.mergeVertices()}function ss(e,t,n,r){Z.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},t=Math.floor(t)||12,n=n||0,r=r||2*Math.PI,r=Ae.clamp(r,0,2*Math.PI);for(var i=[],o=[],a=[],s=1/t,c=new Re,l=new de,u=0;u<=t;u++)for(var h=n+u*s*r,d=Math.sin(h),p=Math.cos(h),f=0;f<=e.length-1;f++)c.x=e[f].x*d,c.y=e[f].y,c.z=e[f].x*p,o.push(c.x,c.y,c.z),l.x=u/t,l.y=f/(e.length-1),a.push(l.x,l.y);for(u=0;u<t;u++)for(f=0;f<e.length-1;f++){var m,g=m=f+u*e.length,v=m+e.length,y=m+e.length+1,_=m+1;i.push(g,v,_),i.push(v,y,_)}if(this.setIndex(i),this.addAttribute("position",new te(o,3)),this.addAttribute("uv",new te(a,2)),this.computeVertexNormals(),r===2*Math.PI){var x=this.attributes.normal.array,b=new Re,w=new Re,E=new Re;for(m=t*e.length*3,f=u=0;u<e.length;u++,f+=3)b.x=x[f+0],b.y=x[f+1],b.z=x[f+2],w.x=x[m+f+0],w.y=x[m+f+1],w.z=x[m+f+2],E.addVectors(b,w).normalize(),x[f+0]=x[m+f+0]=E.x,x[f+1]=x[m+f+1]=E.y,x[f+2]=x[m+f+2]=E.z}}function cs(e,t){fe.call(this),this.type="ShapeGeometry","object"==typeof t&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),t=t.curveSegments),this.parameters={shapes:e,curveSegments:t},this.fromBufferGeometry(new ls(e,t)),this.mergeVertices()}function ls(e,h){Z.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:e,curveSegments:h},h=h||12;var d=[],p=[],f=[],m=[],t=0,g=0;if(!1===Array.isArray(e))r(e);else for(var n=0;n<e.length;n++)r(e[n]),this.addGroup(t,g,n),t+=g,g=0;function r(e){var t,n=p.length/3,e=e.extractPoints(h),r=e.shape,i=e.holes;if(!1===Ja.isClockWise(r))for(r=r.reverse(),a=0,s=i.length;a<s;a++)t=i[a],!0===Ja.isClockWise(t)&&(i[a]=t.reverse());for(var o=Ja.triangulateShape(r,i),a=0,s=i.length;a<s;a++)t=i[a],r=r.concat(t);for(a=0,s=r.length;a<s;a++){var c=r[a];p.push(c.x,c.y,0),f.push(0,0,1),m.push(c.x,c.y)}for(a=0,s=o.length;a<s;a++){var l=o[a],u=l[0]+n;d.push(u,l[1]+n,l[2]+n),g+=3}}this.setIndex(d),this.addAttribute("position",new te(p,3)),this.addAttribute("normal",new te(f,3)),this.addAttribute("uv",new te(m,2))}function us(e,t){Z.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:t},t=void 0!==t?t:1;for(var n,r,i,o,a=[],s=Math.cos(Ae.DEG2RAD*t),c=[0,0],l={},u=["a","b","c"],h=(e.isBufferGeometry?(o=new fe).fromBufferGeometry(e):o=e.clone(),o.mergeVertices(),o.computeFaceNormals(),o.vertices),d=o.faces,p=0,f=d.length;p<f;p++)for(var m=d[p],g=0;g<3;g++)n=m[u[g]],r=m[u[(g+1)%3]],c[0]=Math.min(n,r),c[1]=Math.max(n,r),void 0===l[i=c[0]+","+c[1]]?l[i]={index1:c[0],index2:c[1],face1:p,face2:void 0}:l[i].face2=p;for(i in l){var v,y=l[i];(void 0===y.face2||d[y.face1].normal.dot(d[y.face2].normal)<=s)&&(v=h[y.index1],a.push(v.x,v.y,v.z),v=h[y.index2],a.push(v.x,v.y,v.z))}this.addAttribute("position",new te(a,3))}function hs(e,t,n,r,i,o,a,s){fe.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new ds(e,t,n,r,i,o,a,s)),this.mergeVertices()}function ds(p,f,e,m,t,n,g,v){Z.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:p,radiusBottom:f,height:e,radialSegments:m,heightSegments:t,openEnded:n,thetaStart:g,thetaLength:v};var r,i,y=this,_=(p=void 0!==p?p:1,f=void 0!==f?f:1,e=e||1,m=Math.floor(m)||8,t=Math.floor(t)||1,n=void 0!==n&&n,g=void 0!==g?g:0,v=void 0!==v?v:2*Math.PI,[]),x=[],b=[],w=[],E=0,o=[],M=e/2,T=0,a=new Re,s=new Re,c=0,l=(f-p)/e;for(i=0;i<=t;i++){var u=[],h=i/t,d=h*(f-p)+p;for(r=0;r<=m;r++){var S=r/m,A=S*v+g,P=Math.sin(A),A=Math.cos(A);s.x=d*P,s.y=-h*e+M,s.z=d*A,x.push(s.x,s.y,s.z),a.set(P,l,A).normalize(),b.push(a.x,a.y,a.z),w.push(S,1-h),u.push(E++)}o.push(u)}for(r=0;r<m;r++)for(i=0;i<t;i++){var R=o[i][r],L=o[i+1][r],C=o[i+1][r+1],I=o[i][r+1];_.push(R,L,I),_.push(L,C,I),c+=6}function O(e){for(var t,n=new de,r=new Re,i=0,o=!0===e?p:f,a=!0===e?1:-1,s=E,c=1;c<=m;c++)x.push(0,M*a,0),b.push(0,a,0),w.push(.5,.5),E++;for(t=E,c=0;c<=m;c++){var l=c/m*v+g,u=Math.cos(l),l=Math.sin(l);r.x=o*l,r.y=M*a,r.z=o*u,x.push(r.x,r.y,r.z),b.push(0,a,0),n.x=.5*u+.5,n.y=.5*l*a+.5,w.push(n.x,n.y),E++}for(c=0;c<m;c++){var h=s+c,d=t+c;!0===e?_.push(d,d+1,h):_.push(d+1,d,h),i+=3}y.addGroup(T,i,!0===e?1:2),T+=i}y.addGroup(T,c,0),T+=c,!1===n&&(0<p&&O(!0),0<f)&&O(!1),this.setIndex(_),this.addAttribute("position",new te(x,3)),this.addAttribute("normal",new te(b,3)),this.addAttribute("uv",new te(w,2))}function ps(e,t,n,r,i,o,a){hs.call(this,0,e,t,n,r,i,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:a}}function fs(e,t,n,r,i,o,a){ds.call(this,0,e,t,n,r,i,o,a),this.type="ConeBufferGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:a}}function ms(e,t,n,r){fe.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},this.fromBufferGeometry(new gs(e,t,n,r)),this.mergeVertices()}function gs(e,t,n,r){Z.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},e=e||1,t=void 0!==t?Math.max(3,t):8,n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI;var i,o,a=[],s=[],c=[],l=[],u=new Re,h=new de;for(s.push(0,0,0),c.push(0,0,1),l.push(.5,.5),o=0,i=3;o<=t;o++,i+=3){var d=n+o/t*r;u.x=e*Math.cos(d),u.y=e*Math.sin(d),s.push(u.x,u.y,u.z),c.push(0,0,1),h.x=(s[i]/e+1)/2,h.y=(s[i+1]/e+1)/2,l.push(h.x,h.y)}for(i=1;i<=t;i++)a.push(i,i+1,0);this.setIndex(a),this.addAttribute("position",new te(s,3)),this.addAttribute("normal",new te(c,3)),this.addAttribute("uv",new te(l,2))}(Ka.prototype=Object.create(fe.prototype)).constructor=Ka,(($a.prototype=Object.create(Z.prototype)).constructor=$a).prototype.getArrays=function(){var e=this.getAttribute("position"),e=e?Array.prototype.slice.call(e.array):[],t=this.getAttribute("uv"),t=t?Array.prototype.slice.call(t.array):[],n=this.index;return{position:e,uv:t,index:n?Array.prototype.slice.call(n.array):[]}},$a.prototype.addShapeList=function(e,t){var n=e.length;t.arrays=this.getArrays();for(var r=0;r<n;r++){var i=e[r];this.addShape(i,t)}this.setIndex(t.arrays.index),this.addAttribute("position",new te(t.arrays.position,3)),this.addAttribute("uv",new te(t.arrays.uv,2))},$a.prototype.addShape=function(F,e){var t,n,r,i,o,a,s=e.arrays||this.getArrays(),d=s.position,D=s.index,H=s.uv,c=[],U=void 0!==e.amount?e.amount:100,z=void 0!==e.bevelThickness?e.bevelThickness:6,k=void 0!==e.bevelSize?e.bevelSize:z-2,p=void 0!==e.bevelSegments?e.bevelSegments:3,l=void 0===e.bevelEnabled||e.bevelEnabled,s=void 0!==e.curveSegments?e.curveSegments:12,f=void 0!==e.steps?e.steps:1,B=e.extrudePath,V=!1,G=void 0!==e.UVGenerator?e.UVGenerator:Ka.WorldUVGenerator,W=(B&&(t=B.getSpacedPoints(f),l=!(V=!0),n=void 0!==e.frames?e.frames:B.computeFrenetFrames(f,!1),r=new Re,i=new Re,o=new Re),l||(k=z=p=0),this),B=F.extractPoints(s),u=B.shape,h=B.holes;if(!Ja.isClockWise(u))for(u=u.reverse(),g=0,v=h.length;g<v;g++)a=h[g],Ja.isClockWise(a)&&(h[g]=a.reverse());for(var q=Ja.triangulateShape(u,h),m=u,g=0,v=h.length;g<v;g++)a=h[g],u=u.concat(a);function y(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(n).add(e)}var _,x,b,w,E,M,T=u.length,X=q.length;function Y(e,t,n){var r=e.x-t.x,i=e.y-t.y,o=n.x-e.x,a=n.y-e.y,s=r*r+i*i;if(Math.abs(r*a-i*o)>Number.EPSILON){var c=Math.sqrt(s),l=Math.sqrt(o*o+a*a),u=t.x-i/c,t=t.y+r/c,c=((n.x-a/l-u)*a-(n.y+o/l-t)*o)/(r*a-i*o),n=(l=u+r*c-e.x)*l+(u=t+i*c-e.y)*u;if(n<=2)return new de(l,u);c=Math.sqrt(n/2)}else{t=!1;r>Number.EPSILON?o>Number.EPSILON&&(t=!0):r<-Number.EPSILON?o<-Number.EPSILON&&(t=!0):Math.sign(i)===Math.sign(a)&&(t=!0),c=t?(l=-i,u=r,Math.sqrt(s)):(l=r,u=i,Math.sqrt(s/2))}return new de(l/c,u/c)}for(var Q=[],S=0,A=m.length,P=A-1,R=S+1;S<A;S++,P++,R++)Q[S]=Y(m[S],m[P=P===A?0:P],m[R=R===A?0:R]);var L,C,Z=[],J=Q.concat();for(g=0,v=h.length;g<v;g++){for(a=h[g],L=[],S=0,P=(A=a.length)-1,R=S+1;S<A;S++,P++,R++)P===A&&(P=0),R===A&&(R=0),L[S]=Y(a[S],a[P],a[R]);Z.push(L),J=J.concat(L)}for(_=0;_<p;_++){for(b=_/p,w=z*Math.cos(b*Math.PI/2),x=k*Math.sin(b*Math.PI/2),S=0,A=m.length;S<A;S++)O((E=y(m[S],Q[S],x)).x,E.y,-w);for(g=0,v=h.length;g<v;g++)for(a=h[g],L=Z[g],S=0,A=a.length;S<A;S++)O((E=y(a[S],L[S],x)).x,E.y,-w)}for(x=k,S=0;S<T;S++)E=l?y(u[S],J[S],x):u[S],V?(i.copy(n.normals[0]).multiplyScalar(E.x),r.copy(n.binormals[0]).multiplyScalar(E.y),o.copy(t[0]).add(i).add(r),O(o.x,o.y,o.z)):O(E.x,E.y,0);for(C=1;C<=f;C++)for(S=0;S<T;S++)E=l?y(u[S],J[S],x):u[S],V?(i.copy(n.normals[C]).multiplyScalar(E.x),r.copy(n.binormals[C]).multiplyScalar(E.y),o.copy(t[C]).add(i).add(r),O(o.x,o.y,o.z)):O(E.x,E.y,U/f*C);for(_=p-1;0<=_;_--){for(b=_/p,w=z*Math.cos(b*Math.PI/2),x=k*Math.sin(b*Math.PI/2),S=0,A=m.length;S<A;S++)O((E=y(m[S],Q[S],x)).x,E.y,U+w);for(g=0,v=h.length;g<v;g++)for(a=h[g],L=Z[g],S=0,A=a.length;S<A;S++)E=y(a[S],L[S],x),V?O(E.x,E.y+t[f-1].y,t[f-1].x+w):O(E.x,E.y,U+w)}F=d.length/3;if(l){var I=0*T;for(S=0;S<X;S++)ee((M=q[S])[2]+I,M[1]+I,M[0]+I);for(I=T*(f+2*p),S=0;S<X;S++)ee((M=q[S])[0]+I,M[1]+I,M[2]+I)}else{for(S=0;S<X;S++)ee((M=q[S])[2],M[1],M[0]);for(S=0;S<X;S++)ee((M=q[S])[0]+T*f,M[1]+T*f,M[2]+T*f)}W.addGroup(F,d.length/3-F,void 0!==e.material?e.material:0);var s=d.length/3,K=0;for($(m,K),K+=m.length,g=0,v=h.length;g<v;g++)$(a=h[g],K),K+=a.length;function $(e,t){var n,r;for(S=e.length;0<=--S;){(r=(n=S)-1)<0&&(r=e.length-1);for(var i=0,o=f+2*p,i=0;i<o;i++){var a=T*i,s=T*(i+1),c=(h=u=l=c=void 0,t+n+a),l=t+r+a,u=t+r+s,h=t+n+s;j(c),j(l),j(h),j(l),j(u),j(h),c=d.length/3,N((l=G.generateSideWallUV(W,d,c-6,c-3,c-2,c-1))[0]),N(l[1]),N(l[3]),N(l[1]),N(l[2]),N(l[3])}}}function O(e,t,n){c.push(e),c.push(t),c.push(n)}function ee(e,t,n){j(e),j(t),j(n);e=d.length/3,t=G.generateTopUV(W,d,e-3,e-2,e-1);N(t[0]),N(t[1]),N(t[2])}function j(e){D.push(d.length/3),d.push(c[3*e+0]),d.push(c[3*e+1]),d.push(c[3*e+2])}function N(e){H.push(e.x),H.push(e.y)}W.addGroup(s,d.length/3-s,void 0!==e.extrudeMaterial?e.extrudeMaterial:1),e.arrays||(this.setIndex(D),this.addAttribute("position",new te(d,3)),this.addAttribute("uv",new te(e.arrays.uv,2)))},Ka.WorldUVGenerator={generateTopUV:function(e,t,n,r,i){var o=t[3*n],a=t[3*r],r=t[3*r+1],s=t[3*i],i=t[3*i+1];return[new de(o,t[3*n+1]),new de(a,r),new de(s,i)]},generateSideWallUV:function(e,t,n,r,i,o){var a=t[3*n],s=t[3*n+1],n=t[3*n+2],c=t[3*r],l=t[3*r+1],r=t[3*r+2],u=t[3*i],h=t[3*i+1],i=t[3*i+2],d=t[3*o],p=t[3*o+1],t=t[3*o+2];return Math.abs(s-l)<.01?[new de(a,1-n),new de(c,1-r),new de(u,1-i),new de(d,1-t)]:[new de(s,1-n),new de(l,1-r),new de(h,1-i),new de(p,1-t)]}},(es.prototype=Object.create(fe.prototype)).constructor=es,(ts.prototype=Object.create($a.prototype)).constructor=ts,(ns.prototype=Object.create(fe.prototype)).constructor=ns,(rs.prototype=Object.create(Z.prototype)).constructor=rs,(is.prototype=Object.create(fe.prototype)).constructor=is,(os.prototype=Object.create(Z.prototype)).constructor=os,(as.prototype=Object.create(fe.prototype)).constructor=as,(ss.prototype=Object.create(Z.prototype)).constructor=ss,(cs.prototype=Object.create(fe.prototype)).constructor=cs,(ls.prototype=Object.create(Z.prototype)).constructor=ls,(us.prototype=Object.create(Z.prototype)).constructor=us,(hs.prototype=Object.create(fe.prototype)).constructor=hs,(ds.prototype=Object.create(Z.prototype)).constructor=ds,(ps.prototype=Object.create(hs.prototype)).constructor=ps,(fs.prototype=Object.create(ds.prototype)).constructor=fs,(ms.prototype=Object.create(fe.prototype)).constructor=ms,(gs.prototype=Object.create(Z.prototype)).constructor=gs;var vs=Object.freeze({WireframeGeometry:Oa,ParametricGeometry:ja,ParametricBufferGeometry:Na,TetrahedronGeometry:Da,TetrahedronBufferGeometry:Ha,OctahedronGeometry:Ua,OctahedronBufferGeometry:za,IcosahedronGeometry:ka,IcosahedronBufferGeometry:Ba,DodecahedronGeometry:Va,DodecahedronBufferGeometry:Ga,PolyhedronGeometry:Fa,PolyhedronBufferGeometry:o,TubeGeometry:Wa,TubeBufferGeometry:qa,TorusKnotGeometry:Xa,TorusKnotBufferGeometry:Ya,TorusGeometry:Qa,TorusBufferGeometry:Za,TextGeometry:es,TextBufferGeometry:ts,SphereGeometry:ns,SphereBufferGeometry:rs,RingGeometry:is,RingBufferGeometry:os,PlaneGeometry:po,PlaneBufferGeometry:fo,LatheGeometry:as,LatheBufferGeometry:ss,ShapeGeometry:cs,ShapeBufferGeometry:ls,ExtrudeGeometry:Ka,ExtrudeBufferGeometry:$a,EdgesGeometry:us,ConeGeometry:ps,ConeBufferGeometry:fs,CylinderGeometry:hs,CylinderBufferGeometry:ds,CircleGeometry:ms,CircleBufferGeometry:gs,BoxGeometry:uo,BoxBufferGeometry:ho});function ys(e){t.call(this),this.type="ShadowMaterial",this.color=new pe(0),this.opacity=1,this.lights=!0,this.transparent=!0,this.setValues(e)}function _s(e){go.call(this,e),this.type="RawShaderMaterial"}function xs(e){t.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new pe(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new pe(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new de(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function bs(e){xs.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(e)}function ws(e){t.call(this),this.type="MeshPhongMaterial",this.color=new pe(16777215),this.specular=new pe(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new pe(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new de(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ve,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Es(e){ws.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(e)}function Ms(e){t.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new de(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Ts(e){t.call(this),this.type="MeshLambertMaterial",this.color=new pe(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new pe(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ve,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Ss(e){v.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}((ys.prototype=Object.create(t.prototype)).constructor=ys).prototype.isShadowMaterial=!0,((_s.prototype=Object.create(go.prototype)).constructor=_s).prototype.isRawShaderMaterial=!0,((xs.prototype=Object.create(t.prototype)).constructor=xs).prototype.isMeshStandardMaterial=!0,xs.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},((bs.prototype=Object.create(xs.prototype)).constructor=bs).prototype.isMeshPhysicalMaterial=!0,bs.prototype.copy=function(e){return xs.prototype.copy.call(this,e),this.defines={PHYSICAL:""},this.reflectivity=e.reflectivity,this.clearCoat=e.clearCoat,this.clearCoatRoughness=e.clearCoatRoughness,this},((ws.prototype=Object.create(t.prototype)).constructor=ws).prototype.isMeshPhongMaterial=!0,ws.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},((Es.prototype=Object.create(ws.prototype)).constructor=Es).prototype.isMeshToonMaterial=!0,Es.prototype.copy=function(e){return ws.prototype.copy.call(this,e),this.gradientMap=e.gradientMap,this},((Ms.prototype=Object.create(t.prototype)).constructor=Ms).prototype.isMeshNormalMaterial=!0,Ms.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},((Ts.prototype=Object.create(t.prototype)).constructor=Ts).prototype.isMeshLambertMaterial=!0,Ts.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},((Ss.prototype=Object.create(v.prototype)).constructor=Ss).prototype.isLineDashedMaterial=!0,Ss.prototype.copy=function(e){return v.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var As=Object.freeze({ShadowMaterial:ys,SpriteMaterial:xa,RawShaderMaterial:_s,ShaderMaterial:go,PointsMaterial:Aa,MeshPhysicalMaterial:bs,MeshStandardMaterial:xs,MeshPhongMaterial:ws,MeshToonMaterial:Es,MeshNormalMaterial:Ms,MeshLambertMaterial:Ts,MeshDepthMaterial:yr,MeshDistanceMaterial:_r,MeshBasicMaterial:mo,LineDashedMaterial:Ss,LineBasicMaterial:v,Material:t}),Ps={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function Rs(e,t,n){var r=this,i=!1,o=0,a=0,s=void 0;this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){a++,!1===i&&void 0!==r.onStart&&r.onStart(e,o,a),i=!0},this.itemEnd=function(e){o++,void 0!==r.onProgress&&r.onProgress(e,o,a),o===a&&(i=!1,void 0!==r.onLoad)&&r.onLoad()},this.itemError=function(e){void 0!==r.onError&&r.onError(e)},this.resolveURL=function(e){return s?s(e):e},this.setURLModifier=function(e){s=e}}var n=new Rs,Ls={};function Cs(e){this.manager=void 0!==e?e:n}function Is(e){this.manager=void 0!==e?e:n,this._parser=null}function Os(e){this.manager=void 0!==e?e:n,this._parser=null}function js(e){this.manager=void 0!==e?e:n}function Ns(e){this.manager=void 0!==e?e:n}function Fs(e){this.manager=void 0!==e?e:n}function a(e,t){f.call(this),this.type="Light",this.color=new pe(e),this.intensity=void 0!==t?t:1,this.receiveShadow=void 0}function Ds(e,t,n){a.call(this,e,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(f.DefaultUp),this.updateMatrix(),this.groundColor=new pe(t)}function Hs(e){this.camera=e,this.bias=0,this.radius=1,this.mapSize=new de(512,512),this.map=null,this.matrix=new Pe}function Us(){Hs.call(this,new g(50,1,.5,500))}function zs(e,t,n,r,i,o){a.call(this,e,t),this.type="SpotLight",this.position.copy(f.DefaultUp),this.updateMatrix(),this.target=new f,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==r?r:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==o?o:1,this.shadow=new Us}function ks(e,t,n,r){a.call(this,e,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==r?r:1,this.shadow=new Hs(new g(90,1,.5,500))}function Bs(){Hs.call(this,new Zr(-5,5,5,-5,.5,500))}function Vs(e,t){a.call(this,e,t),this.type="DirectionalLight",this.position.copy(f.DefaultUp),this.updateMatrix(),this.target=new f,this.shadow=new Bs}function Gs(e,t){a.call(this,e,t),this.type="AmbientLight",this.castShadow=void 0}function Ws(e,t,n,r){a.call(this,e,t),this.type="RectAreaLight",this.position.set(0,1,0),this.updateMatrix(),this.width=void 0!==n?n:10,this.height=void 0!==r?r:10}Object.assign(Cs.prototype,{load:function(a,e,t,n){void 0===a&&(a=""),void 0!==this.path&&(a=this.path+a),a=this.manager.resolveURL(a);var s=this,r=Ps.get(a);if(void 0!==r)return s.manager.itemStart(a),setTimeout(function(){e&&e(r),s.manager.itemEnd(a)},0),r;if(void 0===Ls[a]){var i=a.match(/^data:(.*?)(;base64)?,(.*)$/);if(i){var o=i[1],c=!!i[2],l=i[3],l=window.decodeURIComponent(l);c&&(l=window.atob(l));try{var u=(this.responseType||"").toLowerCase();switch(u){case"arraybuffer":case"blob":for(var h=new Uint8Array(l.length),d=0;d<l.length;d++)h[d]=l.charCodeAt(d);p="blob"===u?new Blob([h.buffer],{type:o}):h.buffer;break;case"document":var p=(new DOMParser).parseFromString(l,o);break;case"json":p=JSON.parse(l);break;default:p=l}window.setTimeout(function(){e&&e(p),s.manager.itemEnd(a)},0)}catch(e){window.setTimeout(function(){n&&n(e),s.manager.itemEnd(a),s.manager.itemError(a)},0)}}else{Ls[a]=[],Ls[a].push({onLoad:e,onProgress:t,onError:n});var f,m=new XMLHttpRequest;for(f in m.open("GET",a,!0),m.addEventListener("load",function(e){var t=e.target.response,n=(Ps.add(a,t),Ls[a]);if(delete Ls[a],200===this.status){for(var r=0,i=n.length;r<i;r++)(o=n[r]).onLoad&&o.onLoad(t);s.manager.itemEnd(a)}else if(0===this.status){console.warn("THREE.FileLoader: HTTP Status 0 received.");for(r=0,i=n.length;r<i;r++)(o=n[r]).onLoad&&o.onLoad(t);s.manager.itemEnd(a)}else{for(var o,r=0,i=n.length;r<i;r++)(o=n[r]).onError&&o.onError(e);s.manager.itemEnd(a),s.manager.itemError(a)}},!1),m.addEventListener("progress",function(e){for(var t=Ls[a],n=0,r=t.length;n<r;n++){var i=t[n];i.onProgress&&i.onProgress(e)}},!1),m.addEventListener("error",function(e){var t=Ls[a];delete Ls[a];for(var n=0,r=t.length;n<r;n++){var i=t[n];i.onError&&i.onError(e)}s.manager.itemEnd(a),s.manager.itemError(a)},!1),void 0!==this.responseType&&(m.responseType=this.responseType),void 0!==this.withCredentials&&(m.withCredentials=this.withCredentials),m.overrideMimeType&&m.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)m.setRequestHeader(f,this.requestHeader[f]);m.send(null)}return s.manager.itemStart(a),m}Ls[a].push({onLoad:e,onProgress:t,onError:n})},setPath:function(e){return this.path=e,this},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}}),Object.assign(Is.prototype,{load:function(e,o,n,r){var a=this,s=[],c=new Ca,i=(c.image=s,new Cs(this.manager));if(i.setPath(this.path),i.setResponseType("arraybuffer"),Array.isArray(e))for(var l=0,t=0,u=e.length;t<u;++t)(t=>{i.load(e[t],function(e){e=a._parser(e,!0);s[t]={width:e.width,height:e.height,format:e.format,mipmaps:e.mipmaps},6===(l+=1)&&(1===e.mipmapCount&&(c.minFilter=A),c.format=e.format,c.needsUpdate=!0,o)&&o(c)},n,r)})(t);else i.load(e,function(e){var t=a._parser(e,!0);if(t.isCubemap)for(var n=t.mipmaps.length/t.mipmapCount,r=0;r<n;r++){s[r]={mipmaps:[]};for(var i=0;i<t.mipmapCount;i++)s[r].mipmaps.push(t.mipmaps[r*t.mipmapCount+i]),s[r].format=t.format,s[r].width=t.width,s[r].height=t.height}else c.image.width=t.width,c.image.height=t.height,c.mipmaps=t.mipmaps;1===t.mipmapCount&&(c.minFilter=A),c.format=t.format,c.needsUpdate=!0,o&&o(c)},n,r);return c},setPath:function(e){return this.path=e,this}}),Object.assign(Os.prototype,{load:function(e,t,n,r){var i=this,o=new en,a=new Cs(this.manager);return a.setResponseType("arraybuffer"),a.load(e,function(e){e=i._parser(e);e&&(void 0!==e.image?o.image=e.image:void 0!==e.data&&(o.image.width=e.width,o.image.height=e.height,o.image.data=e.data),o.wrapS=void 0!==e.wrapS?e.wrapS:S,o.wrapT=void 0!==e.wrapT?e.wrapT:S,o.magFilter=void 0!==e.magFilter?e.magFilter:A,o.minFilter=void 0!==e.minFilter?e.minFilter:lt,o.anisotropy=void 0!==e.anisotropy?e.anisotropy:1,void 0!==e.format&&(o.format=e.format),void 0!==e.type&&(o.type=e.type),void 0!==e.mipmaps&&(o.mipmaps=e.mipmaps),1===e.mipmapCount&&(o.minFilter=A),o.needsUpdate=!0,t)&&t(o,e)},n,r),o}}),Object.assign(js.prototype,{crossOrigin:"Anonymous",load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i,o=this,a=Ps.get(t);return void 0!==a?(o.manager.itemStart(t),setTimeout(function(){e&&e(a),o.manager.itemEnd(t)},0),a):((i=document.createElementNS("http://www.w3.org/1999/xhtml","img")).addEventListener("load",function(){Ps.add(t,this),e&&e(this),o.manager.itemEnd(t)},!1),i.addEventListener("error",function(e){r&&r(e),o.manager.itemEnd(t),o.manager.itemError(t)},!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(i.crossOrigin=this.crossOrigin),o.manager.itemStart(t),i.src=t,i)},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(Ns.prototype,{crossOrigin:"Anonymous",load:function(e,n,t,r){var i=new tn,o=new js(this.manager),a=(o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),0);for(var s=0;s<e.length;++s)(t=>{o.load(e[t],function(e){i.images[t]=e,6===++a&&(i.needsUpdate=!0,n)&&n(i)},void 0,r)})(s);return i},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(Fs.prototype,{crossOrigin:"Anonymous",load:function(t,n,e,r){var i=new js(this.manager),o=(i.setCrossOrigin(this.crossOrigin),i.setPath(this.path),new d);return o.image=i.load(t,function(){var e=0<t.search(/\.(jpg|jpeg)$/)||0===t.search(/^data\:image\/jpeg/);o.format=e?Et:Mt,o.needsUpdate=!0,void 0!==n&&n(o)},e,r),o},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),a.prototype=Object.assign(Object.create(f.prototype),{constructor:a,isLight:!0,copy:function(e){return f.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){e=f.prototype.toJSON.call(this,e);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}),Ds.prototype=Object.assign(Object.create(a.prototype),{constructor:Ds,isHemisphereLight:!0,copy:function(e){return a.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),Object.assign(Hs.prototype,{copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),Us.prototype=Object.assign(Object.create(Hs.prototype),{constructor:Us,isSpotLightShadow:!0,update:function(e){var t=this.camera,n=2*Ae.RAD2DEG*e.angle,r=this.mapSize.width/this.mapSize.height,e=e.distance||t.far;n===t.fov&&r===t.aspect&&e===t.far||(t.fov=n,t.aspect=r,t.far=e,t.updateProjectionMatrix())}}),zs.prototype=Object.assign(Object.create(a.prototype),{constructor:zs,isSpotLight:!0,copy:function(e){return a.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),ks.prototype=Object.assign(Object.create(a.prototype),{constructor:ks,isPointLight:!0,copy:function(e){return a.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),Bs.prototype=Object.assign(Object.create(Hs.prototype),{constructor:Bs}),Vs.prototype=Object.assign(Object.create(a.prototype),{constructor:Vs,isDirectionalLight:!0,copy:function(e){return a.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),Gs.prototype=Object.assign(Object.create(a.prototype),{constructor:Gs,isAmbientLight:!0}),Ws.prototype=Object.assign(Object.create(a.prototype),{constructor:Ws,isRectAreaLight:!0,copy:function(e){return a.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){e=a.prototype.toJSON.call(this,e);return e.object.width=this.width,e.object.height=this.height,e}});var x={arraySlice:function(e,t,n){return x.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):e.slice(t,n)},convertArray:function(e,t,n){return!e||!n&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(n){for(var e=n.length,t=new Array(e),r=0;r!==e;++r)t[r]=r;return t.sort(function(e,t){return n[e]-n[t]}),t},sortedArray:function(e,t,n){for(var r=e.length,i=new e.constructor(r),o=0,a=0;a!==r;++o)for(var s=n[o]*t,c=0;c!==t;++c)i[a++]=e[s+c];return i},flattenJSON:function(e,t,n,r){for(var i=1,o=e[0];void 0!==o&&void 0===o[r];)o=e[i++];if(void 0!==o){var a=o[r];if(void 0!==a)if(Array.isArray(a))for(;void 0!==(a=o[r])&&(t.push(o.time),n.push.apply(n,a)),void 0!==(o=e[i++]););else if(void 0!==a.toArray)for(;void 0!==(a=o[r])&&(t.push(o.time),a.toArray(n,n.length)),void 0!==(o=e[i++]););else for(;void 0!==(a=o[r])&&(t.push(o.time),n.push(a)),void 0!==(o=e[i++]););}}};function s(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n}function qs(e,t,n,r){s.call(this,e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function Xs(e,t,n,r){s.call(this,e,t,n,r)}function Ys(e,t,n,r){s.call(this,e,t,n,r)}function Qs(e,t,n,r){if(void 0===e)throw new Error("track name is undefined");if(void 0===t||0===t.length)throw new Error("no keyframes in track named "+e);this.name=e,this.times=x.convertArray(t,this.TimeBufferType),this.values=x.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation),this.validate(),this.optimize()}function Zs(e,t,n,r){Qs.call(this,e,t,n,r)}function Js(e,t,n,r){s.call(this,e,t,n,r)}function Ks(e,t,n,r){Qs.call(this,e,t,n,r)}function $s(e,t,n,r){Qs.call(this,e,t,n,r)}function ec(e,t,n,r){Qs.call(this,e,t,n,r)}function tc(e,t,n){Qs.call(this,e,t,n)}function nc(e,t,n,r){Qs.call(this,e,t,n,r)}function rc(e,t,n,r){Qs.apply(this,e,t,n,r)}function ic(e,t,n){this.name=e,this.tracks=n,this.duration=void 0!==t?t:-1,this.uuid=Ae.generateUUID(),this.duration<0&&this.resetDuration(),this.optimize()}function oc(e){this.manager=void 0!==e?e:n,this.textures={}}function ac(e){this.manager=void 0!==e?e:n}Object.assign(s.prototype,{evaluate:function(e){var t,n=this.parameterPositions,r=this._cachedIndex,i=n[r],o=n[r-1];e:{t:{n:{r:if(!(e<i)){for(var a=r+2;;){if(void 0===i){if(e<o)break r;return r=n.length,this._cachedIndex=r,this.afterEnd_(r-1,e,o)}if(r===a)break;if(o=i,e<(i=n[++r]))break t}t=n.length;break n}if(o<=e)break e;var s=n[1];e<s&&(r=2,o=s);for(a=r-2;;){if(void 0===o)return this._cachedIndex=0,this.beforeStart_(0,e,i);if(r===a)break;if(i=o,(o=n[--r-1])<=e)break t}t=r,r=0}for(;r<t;){var c=r+t>>>1;e<n[c]?t=c:r=1+c}if(i=n[r],void 0===(o=n[r-1]))return this._cachedIndex=0,this.beforeStart_(0,e,i);if(void 0===i)return r=n.length,this._cachedIndex=r,this.afterEnd_(r-1,o,e)}this._cachedIndex=r,this.intervalChanged_(r,o,i)}return this.interpolate_(r,o,e,i)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r,o=0;o!==r;++o)t[o]=n[i+o];return t},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(s.prototype,{beforeStart_:s.prototype.copySampleValue_,afterEnd_:s.prototype.copySampleValue_}),qs.prototype=Object.assign(Object.create(s.prototype),{constructor:qs,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(e,t,n){var r=this.parameterPositions,i=e-2,o=e+1,a=r[i],s=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:i=e,a=2*t-n;break;case 2402:a=t+r[i=r.length-2]-r[i+1];break;default:i=e,a=n}if(void 0===s)switch(this.getSettings_().endingEnd){case 2401:o=e,s=2*n-t;break;case 2402:s=n+r[o=1]-r[0];break;default:o=e-1,s=t}var c=.5*(n-t),l=this.valueSize;this._weightPrev=c/(t-a),this._weightNext=c/(s-n),this._offsetPrev=i*l,this._offsetNext=o*l},interpolate_:function(e,t,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,c=s-a,l=this._offsetPrev,u=this._offsetNext,e=this._weightPrev,h=this._weightNext,n=(n-t)/(r-t),r=n*n,t=r*n,d=-e*t+2*e*r-e*n,p=(1+e)*t+(-1.5-2*e)*r+(-.5+e)*n+1,f=(-1-h)*t+(1.5+h)*r+.5*n,m=h*t-h*r,g=0;g!==a;++g)i[g]=d*o[l+g]+p*o[c+g]+f*o[s+g]+m*o[u+g];return i}}),Xs.prototype=Object.assign(Object.create(s.prototype),{constructor:Xs,interpolate_:function(e,t,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,c=s-a,l=(n-t)/(r-t),u=1-l,h=0;h!==a;++h)i[h]=o[c+h]*u+o[s+h]*l;return i}}),Ys.prototype=Object.assign(Object.create(s.prototype),{constructor:Ys,interpolate_:function(e){return this.copySampleValue_(e-1)}}),Rc={TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(e){return new Ys(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new Xs(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new qs(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var t;switch(e){case 2300:t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}console.warn("THREE.KeyframeTrackPrototype:",n)}else this.createInterpolant=t},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(0!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]+=e;return this},scale:function(e){if(1!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]*=e;return this},trim:function(e,t){for(var n,r=this.times,i=r.length,o=0,a=i-1;o!==i&&r[o]<e;)++o;for(;-1!==a&&r[a]>t;)--a;return++a,0===o&&a===i||(a<=o&&(o=(a=Math.max(a,1))-1),n=this.getValueSize(),this.times=x.arraySlice(r,o,a),this.values=x.arraySlice(this.values,o*n,a*n)),this},validate:function(){for(var e=!0,t=this.getValueSize(),n=(t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrackPrototype: Invalid value size in track.",this),e=!1),this.times),r=this.values,i=n.length,o=(0===i&&(console.error("THREE.KeyframeTrackPrototype: Track is empty.",this),e=!1),null),a=0;a!==i;a++){var s=n[a];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrackPrototype: Time is not a valid number.",this,a,s),e=!1;break}if(null!==o&&s<o){console.error("THREE.KeyframeTrackPrototype: Out of order keys.",this,a,s,o),e=!1;break}o=s}if(void 0!==r&&x.isTypedArray(r))for(var a=0,c=r.length;a!==c;++a){var l=r[a];if(isNaN(l)){console.error("THREE.KeyframeTrackPrototype: Value is not a valid number.",this,a,l),e=!1;break}}return e},optimize:function(){for(var e=this.times,t=this.values,n=this.getValueSize(),r=2302===this.getInterpolation(),i=1,o=e.length-1,a=1;a<o;++a){var s=!1,c=e[a];if(c!==e[a+1]&&(1!==a||c!==c[0]))if(r)s=!0;else for(var l=a*n,u=l-n,h=l+n,d=0;d!==n;++d){var p=t[l+d];if(p!==t[u+d]||p!==t[h+d]){s=!0;break}}if(s){if(a!==i){e[i]=e[a];for(var f=a*n,m=i*n,d=0;d!==n;++d)t[m+d]=t[f+d]}++i}}if(0<o){e[i]=e[o];for(f=o*n,m=i*n,d=0;d!==n;++d)t[m+d]=t[f+d];++i}return i!==e.length&&(this.times=x.arraySlice(e,0,i),this.values=x.arraySlice(t,0,i*n)),this}},Zs.prototype=Object.assign(Object.create(Rc),{constructor:Zs,ValueTypeName:"vector"}),Js.prototype=Object.assign(Object.create(s.prototype),{constructor:Js,interpolate_:function(e,t,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,c=(n-t)/(r-t),l=s+a;s!==l;s+=4)u.slerpFlat(i,0,o,s-a,o,s,c);return i}}),Ks.prototype=Object.assign(Object.create(Rc),{constructor:Ks,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(e){return new Js(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),$s.prototype=Object.assign(Object.create(Rc),{constructor:$s,ValueTypeName:"number"}),ec.prototype=Object.assign(Object.create(Rc),{constructor:ec,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),tc.prototype=Object.assign(Object.create(Rc),{constructor:tc,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),nc.prototype=Object.assign(Object.create(Rc),{constructor:nc,ValueTypeName:"color"}),(rc.prototype=Rc).constructor=rc,Object.assign(rc,{parse:function(e){if(void 0===e.type)throw new Error("track type undefined, can not parse");var t,n,r=rc._getTrackTypeForValueTypeName(e.type);return void 0===e.times&&(x.flattenJSON(e.keys,t=[],n=[],"value"),e.times=t,e.values=n),void 0!==r.parse?r.parse(e):new r(e.name,e.times,e.values,e.interpolation)},toJSON:function(e){var t,n=e.constructor;return void 0!==n.toJSON?t=n.toJSON(e):(t={name:e.name,times:x.convertArray(e.times,Array),values:x.convertArray(e.values,Array)},(n=e.getInterpolation())!==e.DefaultInterpolation&&(t.interpolation=n)),t.type=e.ValueTypeName,t},_getTrackTypeForValueTypeName:function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return $s;case"vector":case"vector2":case"vector3":case"vector4":return Zs;case"color":return nc;case"quaternion":return Ks;case"bool":case"boolean":return tc;case"string":return ec}throw new Error("Unsupported typeName: "+e)}}),Object.assign(ic,{parse:function(e){for(var t=[],n=e.tracks,r=1/(e.fps||1),i=0,o=n.length;i!==o;++i)t.push(rc.parse(n[i]).scale(r));return new ic(e.name,e.duration,t)},toJSON:function(e){for(var t=[],n=e.tracks,e={name:e.name,duration:e.duration,tracks:t},r=0,i=n.length;r!==i;++r)t.push(rc.toJSON(n[r]));return e},CreateFromMorphTargetSequence:function(e,t,n,r){for(var i=t.length,o=[],a=0;a<i;a++){var s=[],c=((l=[]).push((a+i-1)%i,a,(a+1)%i),s.push(0,1,0),x.getKeyframeOrder(l)),l=x.sortedArray(l,1,c),s=x.sortedArray(s,1,c);r||0!==l[0]||(l.push(i),s.push(s[0])),o.push(new $s(".morphTargetInfluences["+t[a].name+"]",l,s).scale(1/n))}return new ic(e,-1,o)},findByName:function(e,t){var n=e;Array.isArray(e)||(n=e.geometry&&e.geometry.animations||e.animations);for(var r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null},CreateClipsFromMorphTargetSequences:function(e,t,n){for(var r={},i=/^([\w-]*?)([\d]+)$/,o=0,a=e.length;o<a;o++){var s=e[o],c=s.name.match(i);c&&1<c.length&&((c=r[l=c[1]])||(r[l]=c=[]),c.push(s))}var l,u=[];for(l in r)u.push(ic.CreateFromMorphTargetSequence(l,r[l],t,n));return u},parseAnimation:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(e,t,n,r,i){var o;0!==n.length&&(x.flattenJSON(n,n=[],o=[],r),0!==n.length)&&i.push(new e(t,n,o))},r=[],i=e.name||"default",o=e.length||-1,a=e.fps||30,s=e.hierarchy||[],c=0;c<s.length;c++){var l=s[c].keys;if(l&&0!==l.length)if(l[0].morphTargets){for(var u,h={},d=0;d<l.length;d++)if(l[d].morphTargets)for(var p=0;p<l[d].morphTargets.length;p++)h[l[d].morphTargets[p]]=-1;for(u in h){for(var f=[],m=[],p=0;p!==l[d].morphTargets.length;++p){var g=l[d];f.push(g.time),m.push(g.morphTarget===u?1:0)}r.push(new $s(".morphTargetInfluence["+u+"]",f,m))}o=h.length*(a||1)}else{var v=".bones["+t[c].name+"]";n(Zs,v+".position",l,"pos",r),n(Ks,v+".quaternion",l,"rot",r),n(Zs,v+".scale",l,"scl",r)}}return 0===r.length?null:new ic(i,o,r)}}),Object.assign(ic.prototype,{resetDuration:function(){for(var e=0,t=0,n=this.tracks.length;t!==n;++t)var r=this.tracks[t],e=Math.max(e,r.times[r.times.length-1]);this.duration=e},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}}),Object.assign(oc.prototype,{load:function(e,t,n,r){var i=this;new Cs(i.manager).load(e,function(e){t(i.parse(JSON.parse(e)))},n,r)},setTextures:function(e){this.textures=e},parse:function(e){var t=this.textures;function n(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}var r,i=new As[e.type];return void 0!==e.uuid&&(i.uuid=e.uuid),void 0!==e.name&&(i.name=e.name),void 0!==e.color&&i.color.setHex(e.color),void 0!==e.roughness&&(i.roughness=e.roughness),void 0!==e.metalness&&(i.metalness=e.metalness),void 0!==e.emissive&&i.emissive.setHex(e.emissive),void 0!==e.specular&&i.specular.setHex(e.specular),void 0!==e.shininess&&(i.shininess=e.shininess),void 0!==e.clearCoat&&(i.clearCoat=e.clearCoat),void 0!==e.clearCoatRoughness&&(i.clearCoatRoughness=e.clearCoatRoughness),void 0!==e.uniforms&&(i.uniforms=e.uniforms),void 0!==e.vertexShader&&(i.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(i.fragmentShader=e.fragmentShader),void 0!==e.vertexColors&&(i.vertexColors=e.vertexColors),void 0!==e.fog&&(i.fog=e.fog),void 0!==e.flatShading&&(i.flatShading=e.flatShading),void 0!==e.blending&&(i.blending=e.blending),void 0!==e.side&&(i.side=e.side),void 0!==e.opacity&&(i.opacity=e.opacity),void 0!==e.transparent&&(i.transparent=e.transparent),void 0!==e.alphaTest&&(i.alphaTest=e.alphaTest),void 0!==e.depthTest&&(i.depthTest=e.depthTest),void 0!==e.depthWrite&&(i.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(i.colorWrite=e.colorWrite),void 0!==e.wireframe&&(i.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(i.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(i.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(i.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(i.rotation=e.rotation),1!==e.linewidth&&(i.linewidth=e.linewidth),void 0!==e.dashSize&&(i.dashSize=e.dashSize),void 0!==e.gapSize&&(i.gapSize=e.gapSize),void 0!==e.scale&&(i.scale=e.scale),void 0!==e.skinning&&(i.skinning=e.skinning),void 0!==e.morphTargets&&(i.morphTargets=e.morphTargets),void 0!==e.dithering&&(i.dithering=e.dithering),void 0!==e.visible&&(i.visible=e.visible),void 0!==e.userData&&(i.userData=e.userData),void 0!==e.shading&&(i.flatShading=1===e.shading),void 0!==e.size&&(i.size=e.size),void 0!==e.sizeAttenuation&&(i.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(i.map=n(e.map)),void 0!==e.alphaMap&&(i.alphaMap=n(e.alphaMap),i.transparent=!0),void 0!==e.bumpMap&&(i.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(i.bumpScale=e.bumpScale),void 0!==e.normalMap&&(i.normalMap=n(e.normalMap)),void 0!==e.normalScale&&(r=e.normalScale,!1===Array.isArray(r)&&(r=[r,r]),i.normalScale=(new de).fromArray(r)),void 0!==e.displacementMap&&(i.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(i.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(i.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(i.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(i.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(i.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(i.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(i.specularMap=n(e.specularMap)),void 0!==e.envMap&&(i.envMap=n(e.envMap)),void 0!==e.reflectivity&&(i.reflectivity=e.reflectivity),void 0!==e.lightMap&&(i.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(i.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(i.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(i.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(i.gradientMap=n(e.gradientMap)),i}}),Object.assign(ac.prototype,{load:function(e,t,n,r){var i=this;new Cs(i.manager).load(e,function(e){t(i.parse(JSON.parse(e)))},n,r)},parse:function(e){var t,n=new Z,r=e.data.index,i=(void 0!==r&&(a=new dc[r.type](r.array),n.setIndex(new b(a,1))),e.data.attributes);for(t in i){var o=i[t],a=new dc[o.type](o.array);n.addAttribute(t,new b(a,o.itemSize,o.normalized))}var s=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==s)for(var c=0,l=s.length;c!==l;++c){var u=s[c];n.addGroup(u.start,u.count,u.materialIndex)}r=e.data.boundingSphere;return void 0!==r&&(e=new Re,void 0!==r.center&&e.fromArray(r.center),n.boundingSphere=new wr(e,r.radius)),n}});var sc,cc,lc,uc,hc,dc={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function pc(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}}function fc(e){"boolean"==typeof e&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),e=void 0),this.manager=void 0!==e?e:n,this.withCredentials=!1}function mc(e){this.manager=void 0!==e?e:n,this.texturePath=""}pc.Handlers={handlers:[],add:function(e,t){this.handlers.push(e,t)},get:function(e){for(var t=this.handlers,n=0,r=t.length;n<r;n+=2){var i=t[n],o=t[n+1];if(i.test(e))return o}return null}},Object.assign(pc.prototype,{crossOrigin:void 0,extractUrlBase:function(e){e=e.split("/");return 1===e.length?"./":(e.pop(),e.join("/")+"/")},initMaterials:function(e,t,n){for(var r=[],i=0;i<e.length;++i)r[i]=this.createMaterial(e[i],t,n);return r},createMaterial:(sc={NoBlending:ie,NormalBlending:oe,AdditiveBlending:ae,SubtractiveBlending:se,MultiplyBlending:ce,CustomBlending:le},cc=new pe,lc=new Fs,uc=new oc,function(e,a,s){var c={};function t(e,t,n,r,i){var e=a+e,o=pc.Handlers.get(e),o=(null!==o?o:(lc.setCrossOrigin(s),lc)).load(e),e=(void 0!==t&&(o.repeat.fromArray(t),1!==t[0]&&(o.wrapS=it),1!==t[1])&&(o.wrapT=it),void 0!==n&&o.offset.fromArray(n),void 0!==r&&("repeat"===r[0]&&(o.wrapS=it),"mirror"===r[0]&&(o.wrapS=ot),"repeat"===r[1]&&(o.wrapT=it),"mirror"===r[1])&&(o.wrapT=ot),void 0!==i&&(o.anisotropy=i),Ae.generateUUID());return c[e]=o,e}var n,r={uuid:Ae.generateUUID(),type:"MeshLambertMaterial"};for(n in e){var i=e[n];switch(n){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":r.name=i;break;case"blending":r.blending=sc[i];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",n,"is no longer supported.");break;case"colorDiffuse":r.color=cc.fromArray(i).getHex();break;case"colorSpecular":r.specular=cc.fromArray(i).getHex();break;case"colorEmissive":r.emissive=cc.fromArray(i).getHex();break;case"specularCoef":r.shininess=i;break;case"shading":"basic"===i.toLowerCase()&&(r.type="MeshBasicMaterial"),"phong"===i.toLowerCase()&&(r.type="MeshPhongMaterial"),"standard"===i.toLowerCase()&&(r.type="MeshStandardMaterial");break;case"mapDiffuse":r.map=t(i,e.mapDiffuseRepeat,e.mapDiffuseOffset,e.mapDiffuseWrap,e.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":r.emissiveMap=t(i,e.mapEmissiveRepeat,e.mapEmissiveOffset,e.mapEmissiveWrap,e.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":r.lightMap=t(i,e.mapLightRepeat,e.mapLightOffset,e.mapLightWrap,e.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":r.aoMap=t(i,e.mapAORepeat,e.mapAOOffset,e.mapAOWrap,e.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":r.bumpMap=t(i,e.mapBumpRepeat,e.mapBumpOffset,e.mapBumpWrap,e.mapBumpAnisotropy);break;case"mapBumpScale":r.bumpScale=i;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":r.normalMap=t(i,e.mapNormalRepeat,e.mapNormalOffset,e.mapNormalWrap,e.mapNormalAnisotropy);break;case"mapNormalFactor":r.normalScale=[i,i];break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":r.specularMap=t(i,e.mapSpecularRepeat,e.mapSpecularOffset,e.mapSpecularWrap,e.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":r.metalnessMap=t(i,e.mapMetalnessRepeat,e.mapMetalnessOffset,e.mapMetalnessWrap,e.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":r.roughnessMap=t(i,e.mapRoughnessRepeat,e.mapRoughnessOffset,e.mapRoughnessWrap,e.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":r.alphaMap=t(i,e.mapAlphaRepeat,e.mapAlphaOffset,e.mapAlphaWrap,e.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":r.side=ne;break;case"doubleSided":r.side=re;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),r.opacity=i;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":r[n]=i;break;case"vertexColors":!0===i&&(r.vertexColors=2),"face"===i&&(r.vertexColors=1);break;default:console.error("THREE.Loader.createMaterial: Unsupported",n,i)}}return"MeshBasicMaterial"===r.type&&delete r.emissive,"MeshPhongMaterial"!==r.type&&delete r.specular,r.opacity<1&&(r.transparent=!0),uc.setTextures(c),uc.parse(r)})}),Object.assign(fc.prototype,{load:function(n,r,e,t){var i=this,o=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:pc.prototype.extractUrlBase(n),a=new Cs(this.manager);a.setWithCredentials(this.withCredentials),a.load(n,function(e){var e=JSON.parse(e),t=e.metadata;if(void 0!==t){t=t.type;if(void 0!==t){if("object"===t.toLowerCase())return void console.error("THREE.JSONLoader: "+n+" should be loaded with THREE.ObjectLoader instead.");if("scene"===t.toLowerCase())return void console.error("THREE.JSONLoader: "+n+" should be loaded with THREE.SceneLoader instead.")}}t=i.parse(e,o);r(t.geometry,t.materials)},e,t)},setTexturePath:function(e){this.texturePath=e},parse:function(e,F){void 0!==(e=void 0!==e.data?e.data:e).scale?e.scale=1/e.scale:e.scale=1;var t,n,r,i,o,a,s,c,l,u,D,H,U,z,k,B,h,d,p,f,m,g,v,y,_=new fe,x=e,b=_,w=x.faces,E=x.vertices,M=x.normals,V=x.colors,G=x.scale,W=0;if(void 0!==x.uvs){for(t=0;t<x.uvs.length;t++)x.uvs[t].length&&W++;for(t=0;t<W;t++)b.faceVertexUvs[t]=[]}for(i=0,o=E.length;i<o;)(h=new Re).x=E[i++]*G,h.y=E[i++]*G,h.z=E[i++]*G,b.vertices.push(h);for(i=0,o=w.length;i<o;)if(D=(u=w[i++])&2,H=u&8,U=u&16,z=u&32,k=u&64,B=u&128,u&1){if((p=new Jr).a=w[i],p.b=w[i+1],p.c=w[i+3],(f=new Jr).a=w[i+1],f.b=w[i+2],f.c=w[i+3],i+=4,D&&(l=w[i++],p.materialIndex=l,f.materialIndex=l),r=b.faces.length,H)for(t=0;t<W;t++)for(v=x.uvs[t],b.faceVertexUvs[t][r]=[],b.faceVertexUvs[t][r+1]=[],n=0;n<4;n++)y=new de(v[2*(c=w[i++])],v[2*c+1]),2!==n&&b.faceVertexUvs[t][r].push(y),0!==n&&b.faceVertexUvs[t][r+1].push(y);if(U&&(s=3*w[i++],p.normal.set(M[s++],M[s++],M[s]),f.normal.copy(p.normal)),z)for(t=0;t<4;t++)s=3*w[i++],g=new Re(M[s++],M[s++],M[s]),2!==t&&p.vertexNormals.push(g),0!==t&&f.vertexNormals.push(g);if(k&&(m=V[a=w[i++]],p.color.setHex(m),f.color.setHex(m)),B)for(t=0;t<4;t++)m=V[a=w[i++]],2!==t&&p.vertexColors.push(new pe(m)),0!==t&&f.vertexColors.push(new pe(m));b.faces.push(p),b.faces.push(f)}else{if((d=new Jr).a=w[i++],d.b=w[i++],d.c=w[i++],D&&(l=w[i++],d.materialIndex=l),r=b.faces.length,H)for(t=0;t<W;t++)for(v=x.uvs[t],b.faceVertexUvs[t][r]=[],n=0;n<3;n++)y=new de(v[2*(c=w[i++])],v[2*c+1]),b.faceVertexUvs[t][r].push(y);if(U&&(s=3*w[i++],d.normal.set(M[s++],M[s++],M[s])),z)for(t=0;t<3;t++)s=3*w[i++],g=new Re(M[s++],M[s++],M[s]),d.vertexNormals.push(g);if(k&&(a=w[i++],d.color.setHex(V[a])),B)for(t=0;t<3;t++)a=w[i++],d.vertexColors.push(new pe(V[a]));b.faces.push(d)}var T=e,S=_,A=void 0!==T.influencesPerVertex?T.influencesPerVertex:2;if(T.skinWeights)for(var P=0,q=T.skinWeights.length;P<q;P+=A){var X=T.skinWeights[P],Y=1<A?T.skinWeights[P+1]:0,Q=2<A?T.skinWeights[P+2]:0,Z=3<A?T.skinWeights[P+3]:0;S.skinWeights.push(new Le(X,Y,Q,Z))}if(T.skinIndices)for(P=0,q=T.skinIndices.length;P<q;P+=A){var J=T.skinIndices[P],K=1<A?T.skinIndices[P+1]:0,$=2<A?T.skinIndices[P+2]:0,ee=3<A?T.skinIndices[P+3]:0;S.skinIndices.push(new Le(J,K,$,ee))}S.bones=T.bones,S.bones&&0<S.bones.length&&(S.skinWeights.length!==S.skinIndices.length||S.skinIndices.length!==S.vertices.length)&&console.warn("When skinning, number of vertices ("+S.vertices.length+"), skinIndices ("+S.skinIndices.length+"), and skinWeights ("+S.skinWeights.length+") should match.");var R=e,L=_,te=R.scale;if(void 0!==R.morphTargets)for(var C=0,ne=R.morphTargets.length;C<ne;C++){L.morphTargets[C]={},L.morphTargets[C].name=R.morphTargets[C].name,L.morphTargets[C].vertices=[];for(var re=L.morphTargets[C].vertices,ie=R.morphTargets[C].vertices,I=0,oe=ie.length;I<oe;I+=3){var ae=new Re;ae.x=ie[I]*te,ae.y=ie[I+1]*te,ae.z=ie[I+2]*te,re.push(ae)}}if(void 0!==R.morphColors&&0<R.morphColors.length){console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.');for(var se=L.faces,ce=R.morphColors[0].colors,C=0,ne=se.length;C<ne;C++)se[C].color.fromArray(ce,3*C)}var O=e,le=_,j=[],N=[];void 0!==O.animation&&N.push(O.animation),void 0!==O.animations&&(O.animations.length?N=N.concat(O.animations):N.push(O.animations));for(var ue=0;ue<N.length;ue++){var he=ic.parseAnimation(N[ue],le.bones);he&&j.push(he)}return le.morphTargets&&(O=ic.CreateClipsFromMorphTargetSequences(le.morphTargets,10),j=j.concat(O)),0<j.length&&(le.animations=j),_.computeFaceNormals(),_.computeBoundingSphere(),void 0===e.materials||0===e.materials.length?{geometry:_}:{geometry:_,materials:pc.prototype.initMaterials(e.materials,F,this.crossOrigin)}}}),Object.assign(mc.prototype,{load:function(n,r,e,i){""===this.texturePath&&(this.texturePath=n.substring(0,n.lastIndexOf("/")+1));var o=this;new Cs(o.manager).load(n,function(e){var t=null;try{t=JSON.parse(e)}catch(e){return void 0!==i&&i(e),void console.error("THREE:ObjectLoader: Can't parse "+n+".",e.message)}e=t.metadata;void 0===e||void 0===e.type||"geometry"===e.type.toLowerCase()?console.error("THREE.ObjectLoader: Can't load "+n+". Use THREE.JSONLoader instead."):o.parse(t,r)},e,i)},setTexturePath:function(e){this.texturePath=e},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e,t){var n=this.parseGeometries(e.geometries),r=this.parseImages(e.images,function(){void 0!==t&&t(i)}),r=this.parseTextures(e.textures,r),r=this.parseMaterials(e.materials,r),i=this.parseObject(e.object,n,r);return e.animations&&(i.animations=this.parseAnimations(e.animations)),void 0!==e.images&&0!==e.images.length||void 0!==t&&t(i),i},parseGeometries:function(e){var t={};if(void 0!==e)for(var n=new fc,r=new ac,i=0,o=e.length;i<o;i++){var a,s=e[i];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":a=new vs[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":a=new vs[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":a=new vs[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":a=new vs[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":a=new vs[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":a=new vs[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":a=new vs[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":a=new vs[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":a=new vs[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":a=new vs[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"LatheGeometry":case"LatheBufferGeometry":a=new vs[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":a=new vs[s.type](s.vertices,s.indices,s.radius,s.details);break;case"BufferGeometry":a=r.parse(s);break;case"Geometry":a=n.parse(s,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),t[s.uuid]=a}return t},parseMaterials:function(e,t){var n={};if(void 0!==e){var r=new oc;r.setTextures(t);for(var i=0,o=e.length;i<o;i++){var a=e[i];if("MultiMaterial"===a.type){for(var s=[],c=0;c<a.materials.length;c++)s.push(r.parse(a.materials[c]));n[a.uuid]=s}else n[a.uuid]=r.parse(a)}}return n},parseAnimations:function(e){for(var t=[],n=0;n<e.length;n++){var r=ic.parse(e[n]);t.push(r)}return t},parseImages:function(e,t){var n=this,r={};if(void 0!==e&&0<e.length){var i=new js(new Rs(t));i.setCrossOrigin(this.crossOrigin);for(var o=0,a=e.length;o<a;o++){var s=e[o],c=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(s.url)?s.url:n.texturePath+s.url;r[s.uuid]=(e=>(n.manager.itemStart(e),i.load(e,function(){n.manager.itemEnd(e)},void 0,function(){n.manager.itemEnd(e),n.manager.itemError(e)})))(c)}}return r},parseTextures:function(e,t){function n(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var r={};if(void 0!==e)for(var i=0,o=e.length;i<o;i++){var a=e[i],s=(void 0===a.image&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),void 0===t[a.image]&&console.warn("THREE.ObjectLoader: Undefined image",a.image),new d(t[a.image]));s.needsUpdate=!0,s.uuid=a.uuid,void 0!==a.name&&(s.name=a.name),void 0!==a.mapping&&(s.mapping=n(a.mapping,gc)),void 0!==a.offset&&s.offset.fromArray(a.offset),void 0!==a.repeat&&s.repeat.fromArray(a.repeat),void 0!==a.center&&s.center.fromArray(a.center),void 0!==a.rotation&&(s.rotation=a.rotation),void 0!==a.wrap&&(s.wrapS=n(a.wrap[0],vc),s.wrapT=n(a.wrap[1],vc)),void 0!==a.minFilter&&(s.minFilter=n(a.minFilter,yc)),void 0!==a.magFilter&&(s.magFilter=n(a.magFilter,yc)),void 0!==a.anisotropy&&(s.anisotropy=a.anisotropy),void 0!==a.flipY&&(s.flipY=a.flipY),r[a.uuid]=s}return r},parseObject:(hc=new Pe,function(e,t,o){function n(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function r(e){if(void 0!==e){if(Array.isArray(e)){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];void 0===o[i]&&console.warn("THREE.ObjectLoader: Undefined material",i),t.push(o[i])}return t}return void 0===o[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),o[e]}}switch(e.type){case"Scene":s=new ya,void 0!==e.background&&Number.isInteger(e.background)&&(s.background=new pe(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?s.fog=new va(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(s.fog=new ga(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":s=new g(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(s.focus=e.focus),void 0!==e.zoom&&(s.zoom=e.zoom),void 0!==e.filmGauge&&(s.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(s.filmOffset=e.filmOffset),void 0!==e.view&&(s.view=Object.assign({},e.view));break;case"OrthographicCamera":s=new Zr(e.left,e.right,e.top,e.bottom,e.near,e.far);break;case"AmbientLight":s=new Gs(e.color,e.intensity);break;case"DirectionalLight":s=new Vs(e.color,e.intensity);break;case"PointLight":s=new ks(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":s=new Ws(e.color,e.intensity,e.width,e.height);break;case"SpotLight":s=new zs(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":s=new Ds(e.color,e.groundColor,e.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var i=n(e.geometry),a=r(e.material),s=new(i.bones&&0<i.bones.length?Ta:m)(i,a);break;case"LOD":s=new wa;break;case"Line":s=new y(n(e.geometry),r(e.material),e.mode);break;case"LineLoop":s=new Sa(n(e.geometry),r(e.material));break;case"LineSegments":s=new _(n(e.geometry),r(e.material));break;case"PointCloud":case"Points":s=new Pa(n(e.geometry),r(e.material));break;case"Sprite":s=new ba(r(e.material));break;case"Group":s=new Ra;break;default:s=new f}if(s.uuid=e.uuid,void 0!==e.name&&(s.name=e.name),void 0!==e.matrix?(hc.fromArray(e.matrix),hc.decompose(s.position,s.quaternion,s.scale)):(void 0!==e.position&&s.position.fromArray(e.position),void 0!==e.rotation&&s.rotation.fromArray(e.rotation),void 0!==e.quaternion&&s.quaternion.fromArray(e.quaternion),void 0!==e.scale&&s.scale.fromArray(e.scale)),void 0!==e.castShadow&&(s.castShadow=e.castShadow),void 0!==e.receiveShadow&&(s.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(s.shadow.bias=e.shadow.bias),void 0!==e.shadow.radius&&(s.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&s.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera)&&(s.shadow.camera=this.parseObject(e.shadow.camera)),void 0!==e.visible&&(s.visible=e.visible),void 0!==e.userData&&(s.userData=e.userData),void 0!==e.children)for(var c=e.children,l=0;l<c.length;l++)s.add(this.parseObject(c[l],t,o));if("LOD"===e.type)for(var u=e.levels,h=0;h<u.length;h++){var d=u[h],p=s.getObjectByProperty("uuid",d.object);void 0!==p&&s.addLevel(p,d.distance)}return s})});var gc={UVMapping:300,CubeReflectionMapping:Je,CubeRefractionMapping:Ke,EquirectangularReflectionMapping:$e,EquirectangularRefractionMapping:et,SphericalReflectionMapping:tt,CubeUVReflectionMapping:nt,CubeUVRefractionMapping:rt},vc={RepeatWrapping:it,ClampToEdgeWrapping:S,MirroredRepeatWrapping:ot},yc={NearestFilter:P,NearestMipMapNearestFilter:at,NearestMipMapLinearFilter:st,LinearFilter:A,LinearMipMapNearestFilter:ct,LinearMipMapLinearFilter:lt};function _c(e,t,n,r,i){var t=.5*(r-t),i=.5*(i-n),o=e*e;return(2*n-2*r+t+i)*(e*o)+(-3*n+3*r-2*t-i)*o+t*e+n}function xc(e,t,n,r){return(i=1-(i=e))*i*t+2*(1-e)*e*n+e*e*r;var i}function bc(e,t,n,r,i){return(o=1-(o=e))*o*o*t+3*(o=1-e)*o*e*n+3*(1-e)*e*e*r+e*e*e*i;var o}function c(){this.type="Curve",this.arcLengthDivisions=200}function wc(e,t){c.call(this),this.type="LineCurve",this.v1=e||new de,this.v2=t||new de}function Ec(){c.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function Mc(e,t,n,r,i,o,a,s){c.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=t||0,this.xRadius=n||1,this.yRadius=r||1,this.aStartAngle=i||0,this.aEndAngle=o||2*Math.PI,this.aClockwise=a||!1,this.aRotation=s||0}function Tc(e){c.call(this),this.type="SplineCurve",this.points=e||[]}function Sc(e,t,n,r){c.call(this),this.type="CubicBezierCurve",this.v0=e||new de,this.v1=t||new de,this.v2=n||new de,this.v3=r||new de}function Ac(e,t,n){c.call(this),this.type="QuadraticBezierCurve",this.v0=e||new de,this.v1=t||new de,this.v2=n||new de}Object.assign(c.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,t){e=this.getUtoTmapping(e);return this.getPoint(e,t)},getPoints:function(e){void 0===e&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return t},getSpacedPoints:function(e){void 0===e&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,n,r=[],i=this.getPoint(0),o=0;for(r.push(0),n=1;n<=e;n++)o+=(t=this.getPoint(n/e)).distanceTo(i),r.push(o),i=t;return this.cacheArcLengths=r},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){for(var n,r=this.getLengths(),i=0,o=r.length,a=t||e*r[o-1],s=0,c=o-1;s<=c;)if((n=r[i=Math.floor(s+(c-s)/2)]-a)<0)s=i+1;else{if(!(0<n)){c=i;break}c=i-1}return r[i=c]===a?i/(o-1):(i+(a-(t=r[i]))/(r[i+1]-t))/(o-1)},getTangent:function(e){var t=e-1e-4,e=e+1e-4,t=(1<e&&(e=1),this.getPoint(t=t<0?0:t));return this.getPoint(e).clone().sub(t).normalize()},getTangentAt:function(e){e=this.getUtoTmapping(e);return this.getTangent(e)},computeFrenetFrames:function(e,t){for(var n,r=new Re,i=[],o=[],a=[],s=new Re,c=new Pe,l=0;l<=e;l++)i[l]=this.getTangentAt(l/e),i[l].normalize();o[0]=new Re,a[0]=new Re;var u=Number.MAX_VALUE,h=Math.abs(i[0].x),d=Math.abs(i[0].y),p=Math.abs(i[0].z);for(h<=u&&(u=h,r.set(1,0,0)),d<=u&&(u=d,r.set(0,1,0)),p<=u&&r.set(0,0,1),s.crossVectors(i[0],r).normalize(),o[0].crossVectors(i[0],s),a[0].crossVectors(i[0],o[0]),l=1;l<=e;l++)o[l]=o[l-1].clone(),a[l]=a[l-1].clone(),s.crossVectors(i[l-1],i[l]),s.length()>Number.EPSILON&&(s.normalize(),n=Math.acos(Ae.clamp(i[l-1].dot(i[l]),-1,1)),o[l].applyMatrix4(c.makeRotationAxis(s,n))),a[l].crossVectors(i[l],o[l]);if(!0===t)for(n=Math.acos(Ae.clamp(o[0].dot(o[e]),-1,1)),n/=e,0<i[0].dot(s.crossVectors(o[0],o[e]))&&(n=-n),l=1;l<=e;l++)o[l].applyMatrix4(c.makeRotationAxis(i[l],n*l)),a[l].crossVectors(i[l],o[l]);return{tangents:i,normals:o,binormals:a}},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}),((wc.prototype=Object.create(c.prototype)).constructor=wc).prototype.isLineCurve=!0,wc.prototype.getPoint=function(e,t){t=t||new de;return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t},wc.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},wc.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},wc.prototype.copy=function(e){return c.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Ec.prototype=Object.assign(Object.create(c.prototype),{constructor:Ec,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new wc(t,e))},getPoint:function(e){for(var t,n,r,i=e*this.getLength(),o=this.getCurveLengths(),a=0;a<o.length;){if(o[a]>=i)return t=o[a]-i,r=(n=this.curves[a]).getLength(),n.getPointAt(0===r?0:1-t/r);a++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e},getSpacedPoints:function(e){void 0===e&&(e=40);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(e){e=e||12;for(var t,n=[],r=0,i=this.curves;r<i.length;r++)for(var o=i[r],a=o&&o.isEllipseCurve?2*e:o&&o.isLineCurve?1:o&&o.isSplineCurve?e*o.points.length:e,s=o.getPoints(a),c=0;c<s.length;c++){var l=s[c];t&&t.equals(l)||(n.push(l),t=l)}return this.autoClose&&1<n.length&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},copy:function(e){c.prototype.copy.call(this,e),this.curves=[];for(var t=0,n=e.curves.length;t<n;t++){var r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}}),((Mc.prototype=Object.create(c.prototype)).constructor=Mc).prototype.isEllipseCurve=!0,Mc.prototype.getPoint=function(e,t){for(var t=t||new de,n=2*Math.PI,r=this.aEndAngle-this.aStartAngle,i=Math.abs(r)<Number.EPSILON;r<0;)r+=n;for(;n<r;)r-=n;r<Number.EPSILON&&(r=i?0:n),!0!==this.aClockwise||i||(r===n?r=-n:r-=n);var o,a,s,c,i=this.aStartAngle+e*r,e=this.aX+this.xRadius*Math.cos(i),i=this.aY+this.yRadius*Math.sin(i);return 0!==this.aRotation&&(o=Math.cos(this.aRotation),a=Math.sin(this.aRotation),e=(s=e-this.aX)*o-(c=i-this.aY)*a+this.aX,i=s*a+c*o+this.aY),t.set(e,i)},Mc.prototype.copy=function(e){return c.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},((Tc.prototype=Object.create(c.prototype)).constructor=Tc).prototype.isSplineCurve=!0,Tc.prototype.getPoint=function(e,t){var t=t||new de,n=this.points,e=(n.length-1)*e,r=Math.floor(e),e=e-r,i=n[0===r?r:r-1],o=n[r],a=n[r>n.length-2?n.length-1:r+1],n=n[r>n.length-3?n.length-1:r+2];return t.set(_c(e,i.x,o.x,a.x,n.x),_c(e,i.y,o.y,a.y,n.y)),t},Tc.prototype.copy=function(e){c.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push(r.clone())}return this},((Sc.prototype=Object.create(c.prototype)).constructor=Sc).prototype.isCubicBezierCurve=!0,Sc.prototype.getPoint=function(e,t){var t=t||new de,n=this.v0,r=this.v1,i=this.v2,o=this.v3;return t.set(bc(e,n.x,r.x,i.x,o.x),bc(e,n.y,r.y,i.y,o.y)),t},Sc.prototype.copy=function(e){return c.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},((Ac.prototype=Object.create(c.prototype)).constructor=Ac).prototype.isQuadraticBezierCurve=!0,Ac.prototype.getPoint=function(e,t){var t=t||new de,n=this.v0,r=this.v1,i=this.v2;return t.set(xc(e,n.x,r.x,i.x),xc(e,n.y,r.y,i.y)),t},Ac.prototype.copy=function(e){return c.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this};var Pc,Rc=Object.assign(Object.create(Ec.prototype),{setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y)},moveTo:function(e,t){this.currentPoint.set(e,t)},lineTo:function(e,t){var n=new wc(this.currentPoint.clone(),new de(e,t));this.curves.push(n),this.currentPoint.set(e,t)},quadraticCurveTo:function(e,t,n,r){e=new Ac(this.currentPoint.clone(),new de(e,t),new de(n,r));this.curves.push(e),this.currentPoint.set(n,r)},bezierCurveTo:function(e,t,n,r,i,o){e=new Sc(this.currentPoint.clone(),new de(e,t),new de(n,r),new de(i,o));this.curves.push(e),this.currentPoint.set(i,o)},splineThru:function(e){var t=new Tc([this.currentPoint.clone()].concat(e));this.curves.push(t),this.currentPoint.copy(e[e.length-1])},arc:function(e,t,n,r,i,o){var a=this.currentPoint.x,s=this.currentPoint.y;this.absarc(e+a,t+s,n,r,i,o)},absarc:function(e,t,n,r,i,o){this.absellipse(e,t,n,n,r,i,o)},ellipse:function(e,t,n,r,i,o,a,s){var c=this.currentPoint.x,l=this.currentPoint.y;this.absellipse(e+c,t+l,n,r,i,o,a,s)},absellipse:function(e,t,n,r,i,o,a,s){e=new Mc(e,t,n,r,i,o,a,s),0<this.curves.length&&((t=e.getPoint(0)).equals(this.currentPoint)||this.lineTo(t.x,t.y)),this.curves.push(e),n=e.getPoint(1);this.currentPoint.copy(n)},copy:function(e){return Ec.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this}});function Lc(e){Ec.call(this),this.type="Path",this.currentPoint=new de,e&&this.setFromPoints(e)}function Cc(e){Lc.call(this,e),this.type="Shape",this.holes=[]}function Ic(){this.type="ShapePath",this.subPaths=[],this.currentPath=null}function Oc(e){this.type="Font",this.data=e}function jc(e){this.manager=void 0!==e?e:n}(Lc.prototype=Rc).constructor=Lc,Cc.prototype=Object.assign(Object.create(Rc),{constructor:Cc,getPointsHoles:function(e){for(var t=[],n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){Lc.prototype.copy.call(this,e),this.holes=[];for(var t=0,n=e.holes.length;t<n;t++){var r=e.holes[t];this.holes.push(r.clone())}return this}}),Object.assign(Ic.prototype,{moveTo:function(e,t){this.currentPath=new Lc,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t)},lineTo:function(e,t){this.currentPath.lineTo(e,t)},quadraticCurveTo:function(e,t,n,r){this.currentPath.quadraticCurveTo(e,t,n,r)},bezierCurveTo:function(e,t,n,r,i,o){this.currentPath.bezierCurveTo(e,t,n,r,i,o)},splineThru:function(e){this.currentPath.splineThru(e)},toShapes:function(e,t){function n(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n],o=new Cc;o.curves=i.curves,t.push(o)}return t}var r=Ja.isClockWise,i=this.subPaths;if(0===i.length)return[];if(!0===t)return n(i);var o,a,s,c=[];if(1===i.length)a=i[0],(s=new Cc).curves=a.curves,c.push(s);else{var l,u=!r(i[0].getPoints()),u=e?!u:u,h=[],d=[],p=[],f=0;d[f]=void 0,p[f]=[];for(var m=0,g=i.length;m<g;m++)o=r(l=(a=i[m]).getPoints()),(e?!o:o)?(!u&&d[f]&&f++,d[f]={s:new Cc,p:l},d[f].s.curves=a.curves,u&&f++,p[f]=[]):p[f].push({h:a,p:l[0]});if(!d[0])return n(i);if(1<d.length){for(var v=!1,y=[],_=0,x=d.length;_<x;_++)h[_]=[];for(_=0,x=d.length;_<x;_++)for(var b=p[_],w=0;w<b.length;w++){for(var E=b[w],M=!0,T=0;T<d.length;T++)((e,t)=>{for(var n=t.length,r=!1,i=n-1,o=0;o<n;i=o++){var a=t[i],s=t[o],c=s.x-a.x,l=s.y-a.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(a=t[o],c=-c,s=t[i],l=-l),!(e.y<a.y||e.y>s.y))if(e.y===a.y){if(e.x===a.x)return 1}else{l=l*(e.x-a.x)-c*(e.y-a.y);if(0==l)return 1;l<0||(r=!r)}}else if(e.y===a.y&&(s.x<=e.x&&e.x<=a.x||a.x<=e.x&&e.x<=s.x))return 1}return r})(E.p,d[T].p)&&(_!==T&&y.push({froms:_,tos:T,hole:w}),M?(M=!1,h[T].push(E)):v=!0);M&&h[_].push(E)}0<y.length&&(v||(p=h))}for(var m=0,S=d.length;m<S;m++){s=d[m].s,c.push(s);for(var A,P=0,R=(A=p[m]).length;P<R;P++)s.holes.push(A[P].h)}}return c}}),Object.assign(Oc.prototype,{isFont:!0,generateShapes:function(e,l,w){void 0===l&&(l=100),void 0===w&&(w=4);for(var E=this.data,t=(e=>{for(var t=String(e).split(""),n=l/E.resolution,r=(E.boundingBox.yMax-E.boundingBox.yMin+E.underlineThickness)*n,i=0,o=0,a=[],s=0;s<t.length;s++){var c=t[s];"\n"===c?(i=0,o-=r):(i+=(c=((e,t,n,r)=>{if(e=E.glyphs[e]||E.glyphs["?"]){var i,o,a,s,c,l,u,h,d,p,f,m=new Ic,g=[];if(e.o)for(var v=e._cachedOutline||(e._cachedOutline=e.o.split(" ")),y=0,_=v.length;y<_;)switch(v[y++]){case"m":i=v[y++]*t+n,o=v[y++]*t+r,m.moveTo(i,o);break;case"l":i=v[y++]*t+n,o=v[y++]*t+r,m.lineTo(i,o);break;case"q":if(a=v[y++]*t+n,s=v[y++]*t+r,u=v[y++]*t+n,h=v[y++]*t+r,m.quadraticCurveTo(u,h,a,s),f=g[g.length-1]){c=f.x,l=f.y;for(var x=1;x<=w;x++)xc(b=x/w,c,u,a),xc(b,l,h,s)}break;case"b":if(a=v[y++]*t+n,s=v[y++]*t+r,u=v[y++]*t+n,h=v[y++]*t+r,d=v[y++]*t+n,p=v[y++]*t+r,m.bezierCurveTo(u,h,d,p,a,s),f=g[g.length-1]){c=f.x,l=f.y;for(var b,x=1;x<=w;x++)bc(b=x/w,c,u,d,a),bc(b,l,h,p,s)}}return{offsetX:e.ha*t,path:m}}})(c,n,i,o)).offsetX,a.push(c.path))}return a})(e),n=[],r=0,i=t.length;r<i;r++)Array.prototype.push.apply(n,t[r].toShapes());return n}}),Object.assign(jc.prototype,{load:function(e,r,t,n){var i=this,o=new Cs(this.manager);o.setPath(this.path),o.load(e,function(t){var n;try{n=JSON.parse(t)}catch(e){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(t.substring(65,t.length-2))}t=i.parse(n);r&&r(t)},t,n)},parse:function(e){return new Oc(e)},setPath:function(e){return this.path=e,this}});var Nc,Fc,Dc,Hc,Uc,zc,kc,Bc,Vc,Gc,Wc,qc,Xc,Yc,Qc,Zc,Jc,Kc,$c,el,tl,nl,rl,il,ol,al,sl,cl,ll,ul,hl,dl,pl,fl,ml,gl,vl,yl,_l,xl,bl,wl,El,Ml={getContext:function(){return Pc=void 0===Pc?new(window.AudioContext||window.webkitAudioContext):Pc},setContext:function(e){Pc=e}};function Tl(e){this.manager=void 0!==e?e:n}function Sl(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new g,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new g,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function Al(e,t,n){f.call(this),this.type="CubeCamera";var i=new g(90,1,e,t),o=(i.up.set(0,-1,0),i.lookAt(new Re(1,0,0)),this.add(i),new g(90,1,e,t)),a=(o.up.set(0,-1,0),o.lookAt(new Re(-1,0,0)),this.add(o),new g(90,1,e,t)),s=(a.up.set(0,0,1),a.lookAt(new Re(0,1,0)),this.add(a),new g(90,1,e,t)),c=(s.up.set(0,0,-1),s.lookAt(new Re(0,-1,0)),this.add(s),new g(90,1,e,t)),l=(c.up.set(0,-1,0),c.lookAt(new Re(0,0,1)),this.add(c),new g(90,1,e,t)),e=(l.up.set(0,-1,0),l.lookAt(new Re(0,0,-1)),this.add(l),{format:Et,magFilter:A,minFilter:A});this.renderTarget=new $t(n,n,e),this.renderTarget.texture.name="CubeCamera",this.update=function(e,t){null===this.parent&&this.updateMatrixWorld();var n=this.renderTarget,r=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,n.activeCubeFace=0,e.render(t,i,n),n.activeCubeFace=1,e.render(t,o,n),n.activeCubeFace=2,e.render(t,a,n),n.activeCubeFace=3,e.render(t,s,n),n.activeCubeFace=4,e.render(t,c,n),n.texture.generateMipmaps=r,n.activeCubeFace=5,e.render(t,l,n),e.setRenderTarget(null)},this.clear=function(e,t,n,r){for(var i=this.renderTarget,o=0;o<6;o++)i.activeCubeFace=o,e.setRenderTarget(i),e.clear(t,n,r);e.setRenderTarget(null)}}function Pl(){f.call(this),this.type="AudioListener",this.context=Ml.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}function Rl(e){f.call(this),this.type="Audio",this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.loop=!1,this.startTime=0,this.offset=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function Ll(e){Rl.call(this,e),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function Cl(e,t){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=void 0!==t?t:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}function Il(e,t,n){this.binding=e,this.valueSize=n;var r,i=Float64Array;switch(t){case"quaternion":r=this._slerp;break;case"string":case"bool":i=Array,r=this._select;break;default:r=this._lerp}this.buffer=new i(4*n),this._mixBufferRegion=r,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}function Ol(e,t,n){n=n||w.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,n)}function w(e,t,n){this.path=t,this.parsedPath=n||w.parseTrackName(t),this.node=w.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}function jl(){this.uuid=Ae.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var t=0,n=arguments.length;t!==n;++t)e[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var r=this;this.stats={objects:{get total(){return r._objects.length},get inUse(){return this.total-r.nCachedObjects_}},get bindingsPerObject(){return r._bindings.length}}}function Nl(e,t,n){this._mixer=e,this._clip=t,this._localRoot=n||null;for(var r=t.tracks,i=r.length,o=new Array(i),a={endingStart:2400,endingEnd:2400},s=0;s!==i;++s){var c=r[s].createInterpolant(null);(o[s]=c).settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(i),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function Fl(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function Dl(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}function Hl(){Z.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function Ul(e,t,n,r){this.uuid=Ae.generateUUID(),this.data=e,this.itemSize=t,this.offset=n,this.normalized=!0===r}function zl(e,t){this.uuid=Ae.generateUUID(),this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function kl(e,t,n){zl.call(this,e,t),this.meshPerAttribute=n||1}function Bl(e,t,n){b.call(this,e,t),this.meshPerAttribute=n||1}function Vl(e,t,n,r){this.ray=new vo(e,t),this.near=n||0,this.far=r||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Gl(e,t){return e.distance-t.distance}function Wl(e,t,n,r){if(!1!==e.visible&&(e.raycast(t,n),!0===r))for(var i=e.children,o=0,a=i.length;o<a;o++)Wl(i[o],t,n,!0)}function ql(e){this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function Xl(e,t,n){return this.radius=void 0!==e?e:1,this.phi=void 0!==t?t:0,this.theta=void 0!==n?n:0,this}function Yl(e,t,n){return this.radius=void 0!==e?e:1,this.theta=void 0!==t?t:0,this.y=void 0!==n?n:0,this}function Ql(e){f.call(this),this.material=e,this.render=function(){}}function Zl(e,t,n,r){this.object=e,this.size=void 0!==t?t:1;e=void 0!==n?n:16711680,t=void 0!==r?r:1,n=0,r=this.object.geometry,r&&r.isGeometry?n=3*r.faces.length:r&&r.isBufferGeometry&&(n=r.attributes.normal.count),r=new Z,n=new te(2*n*3,3);r.addAttribute("position",n),_.call(this,r,new v({color:e,linewidth:t})),this.matrixAutoUpdate=!1,this.update()}function Jl(e,t){f.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;for(var e=new Z,n=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],r=0,i=1;r<32;r++,i++){var o=r/32*Math.PI*2,a=i/32*Math.PI*2;n.push(Math.cos(o),Math.sin(o),1,Math.cos(a),Math.sin(a),1)}e.addAttribute("position",new te(n,3));t=new v({fog:!1});this.cone=new _(e,t),this.add(this.cone),this.update()}function Kl(e){for(var t=function e(t){var n=[];t&&t.isBone&&n.push(t);for(var r=0;r<t.children.length;r++)n.push.apply(n,e(t.children[r]));return n}(e),n=new Z,r=[],i=[],o=new pe(0,0,1),a=new pe(0,1,0),s=0;s<t.length;s++){var c=t[s];c.parent&&c.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(o.r,o.g,o.b),i.push(a.r,a.g,a.b))}n.addAttribute("position",new te(r,3)),n.addAttribute("color",new te(i,3));var l=new v({vertexColors:2,depthTest:!1,depthWrite:!1,transparent:!0});_.call(this,n,l),this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}function $l(e,t,n){this.light=e,this.light.updateMatrixWorld(),this.color=n;e=new rs(t,4,2),n=new mo({wireframe:!0,fog:!1});m.call(this,e,n),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function eu(e,t){f.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;e=new v({fog:!1}),t=new Z;t.addAttribute("position",new b(new Float32Array(15),3)),this.line=new y(t,e),this.add(this.line),this.update()}function tu(e,t,n){f.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;e=new za(t),e.rotateY(.5*Math.PI),this.material=new mo({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=2),n=e.getAttribute("position"),t=new Float32Array(3*n.count);e.addAttribute("color",new b(t,3)),this.add(new m(e,this.material)),this.update()}function nu(e,t,n,r){e=e||10,t=t||10,n=new pe(void 0!==n?n:4473924),r=new pe(void 0!==r?r:8947848);for(var i=t/2,o=e/t,a=e/2,s=[],c=[],l=0,u=0,h=-a;l<=t;l++,h+=o){s.push(-a,0,h,a,0,h),s.push(h,0,-a,h,0,a);var d=l===i?n:r;d.toArray(c,u),u+=3,d.toArray(c,u),u+=3,d.toArray(c,u),u+=3,d.toArray(c,u),u+=3}var e=new Z,p=(e.addAttribute("position",new te(s,3)),e.addAttribute("color",new te(c,3)),new v({vertexColors:2}));_.call(this,e,p)}function ru(e,t,n,r,i,o){e=e||10,t=t||16,n=n||8,r=r||64,i=new pe(void 0!==i?i:4473924),o=new pe(void 0!==o?o:8947848);for(var a,s,c,l,u,h,d=[],p=[],f=0;f<=t;f++)c=f/t*(2*Math.PI),a=Math.sin(c)*e,s=Math.cos(c)*e,d.push(0,0,0),d.push(a,0,s),p.push((h=1&f?i:o).r,h.g,h.b),p.push(h.r,h.g,h.b);for(f=0;f<=n;f++)for(h=1&f?i:o,u=e-e/n*f,l=0;l<r;l++)c=l/r*(2*Math.PI),a=Math.sin(c)*u,s=Math.cos(c)*u,d.push(a,0,s),p.push(h.r,h.g,h.b),c=(l+1)/r*(2*Math.PI),a=Math.sin(c)*u,s=Math.cos(c)*u,d.push(a,0,s),p.push(h.r,h.g,h.b);var m=new Z,g=(m.addAttribute("position",new te(d,3)),m.addAttribute("color",new te(p,3)),new v({vertexColors:2}));_.call(this,m,g)}function iu(e,t,n,r){this.object=e,this.size=void 0!==t?t:1;e=void 0!==n?n:16776960,t=void 0!==r?r:1,n=0,r=this.object.geometry,r&&r.isGeometry?n=r.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead."),r=new Z,n=new te(2*n*3,3);r.addAttribute("position",n),_.call(this,r,new v({color:e,linewidth:t})),this.matrixAutoUpdate=!1,this.update()}function ou(e,t,n){f.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===t&&(t=1);e=new Z,e.addAttribute("position",new te([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3)),n=new v({fog:!1});this.lightPlane=new y(e,n),this.add(this.lightPlane),(e=new Z).addAttribute("position",new te([0,0,0,0,0,1],3)),this.targetLine=new y(e,n),this.add(this.targetLine),this.update()}function au(e){var t=new Z,n=new v({color:16777215,vertexColors:1}),r=[],i=[],o={},a=new pe(16755200),s=new pe(16711680),c=new pe(43775),l=new pe(16777215),u=new pe(3355443);function h(e,t,n){d(e,n),d(t,n)}function d(e,t){r.push(0,0,0),i.push(t.r,t.g,t.b),void 0===o[e]&&(o[e]=[]),o[e].push(r.length/3-1)}h("n1","n2",a),h("n2","n4",a),h("n4","n3",a),h("n3","n1",a),h("f1","f2",a),h("f2","f4",a),h("f4","f3",a),h("f3","f1",a),h("n1","f1",a),h("n2","f2",a),h("n3","f3",a),h("n4","f4",a),h("p","n1",s),h("p","n2",s),h("p","n3",s),h("p","n4",s),h("u1","u2",c),h("u2","u3",c),h("u3","u1",c),h("c","t",l),h("p","c",u),h("cn1","cn2",u),h("cn3","cn4",u),h("cf1","cf2",u),h("cf3","cf4",u),t.addAttribute("position",new te(r,3)),t.addAttribute("color",new te(i,3)),_.call(this,t,n),this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()}function r(e,t,n,r){vl.set(t,n,r).unproject(yl);var i=gl[e];if(void 0!==i)for(var o=ml.getAttribute("position"),a=0,s=i.length;a<s;a++)o.setXYZ(i[a],vl.x,vl.y,vl.z)}function su(e,t){this.object=e,void 0===t&&(t=16776960);var e=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Float32Array(24),r=new Z;r.setIndex(new b(e,1)),r.addAttribute("position",new b(n,3)),_.call(this,r,new v({color:t})),this.matrixAutoUpdate=!1,this.update()}function cu(e,t){this.type="Box3Helper",this.box=e;var e=void 0!==t?t:16776960,t=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Z;n.setIndex(new b(t,1)),n.addAttribute("position",new te([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),_.call(this,n,new v({color:e})),this.geometry.computeBoundingSphere()}function lu(e,t,n){this.type="PlaneHelper",this.plane=e,this.size=void 0===t?1:t;e=void 0!==n?n:16776960,t=new Z,t.addAttribute("position",new te([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),t.computeBoundingSphere(),y.call(this,t,new v({color:e})),n=new Z;n.addAttribute("position",new te([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),n.computeBoundingSphere(),this.add(new m(n,new mo({color:e,opacity:.2,transparent:!0,depthWrite:!1})))}function uu(e,t,n,r,i,o){f.call(this),void 0===r&&(r=16776960),void 0===n&&(n=1),void 0===i&&(i=.2*n),void 0===o&&(o=.2*i),void 0===xl&&((xl=new Z).addAttribute("position",new te([0,0,0,0,1,0],3)),(bl=new ds(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(t),this.line=new y(xl,new v({color:r})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new m(bl,new mo({color:r})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,i,o)}function hu(e){var e=[0,0,0,e=e||1,0,0,0,0,0,0,e,0,0,0,0,0,0,e],t=new Z,e=(t.addAttribute("position",new te(e,3)),t.addAttribute("color",new te([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),new v({vertexColors:2}));_.call(this,t,e)}function du(){var i=0,o=0,a=0,s=0;function c(e,t,n,r){a=-3*(i=e)+3*t-2*(o=n)-r,s=2*e-2*t+n+r}return{initCatmullRom:function(e,t,n,r,i){c(t,n,i*(n-e),i*(r-t))},initNonuniformCatmullRom:function(e,t,n,r,i,o,a){e=(t-e)/i-(n-e)/(i+o)+(n-t)/o,i=(n-t)/o-(r-t)/(o+a)+(r-n)/a;c(t,n,e*=o,i*=o)},calc:function(e){var t=e*e;return i+o*e+a*t+s*(t*e)}}}Object.assign(Tl.prototype,{load:function(e,t,n,r){var i=new Cs(this.manager);i.setResponseType("arraybuffer"),i.load(e,function(e){Ml.getContext().decodeAudioData(e,function(e){t(e)})},n,r)}}),Object.assign(Sl.prototype,{update:(Vc=new Pe,Gc=new Pe,function(e){var t,n,r,i,o;Nc===this&&Fc===e.focus&&Dc===e.fov&&Hc===e.aspect*this.aspect&&Uc===e.near&&zc===e.far&&kc===e.zoom&&Bc===this.eyeSep||(Nc=this,Fc=e.focus,Dc=e.fov,Hc=e.aspect*this.aspect,Uc=e.near,zc=e.far,kc=e.zoom,t=e.projectionMatrix.clone(),n=(Bc=this.eyeSep/2)*Uc/Fc,r=Uc*Math.tan(Ae.DEG2RAD*Dc*.5)/kc,Gc.elements[12]=-Bc,Vc.elements[12]=Bc,i=-r*Hc+n,o=r*Hc+n,t.elements[0]=2*Uc/(o-i),t.elements[8]=(o+i)/(o-i),this.cameraL.projectionMatrix.copy(t),i=-r*Hc-n,o=r*Hc-n,t.elements[0]=2*Uc/(o-i),t.elements[8]=(o+i)/(o-i),this.cameraR.projectionMatrix.copy(t)),this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(Gc),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(Vc)})}),(Al.prototype=Object.create(f.prototype)).constructor=Al,Pl.prototype=Object.assign(Object.create(f.prototype),{constructor:Pl,getInput:function(){return this.gain},removeFilter:function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},getFilter:function(){return this.filter},setFilter:function(e){(null!==this.filter?(this.gain.disconnect(this.filter),this.filter):this.gain).disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){this.gain.gain.value=e},updateMatrixWorld:(Wc=new Re,qc=new u,Xc=new Re,Yc=new Re,function(e){f.prototype.updateMatrixWorld.call(this,e);var e=this.context.listener,t=this.up;this.matrixWorld.decompose(Wc,qc,Xc),Yc.set(0,0,-1).applyQuaternion(qc),e.positionX?(e.positionX.setValueAtTime(Wc.x,this.context.currentTime),e.positionY.setValueAtTime(Wc.y,this.context.currentTime),e.positionZ.setValueAtTime(Wc.z,this.context.currentTime),e.forwardX.setValueAtTime(Yc.x,this.context.currentTime),e.forwardY.setValueAtTime(Yc.y,this.context.currentTime),e.forwardZ.setValueAtTime(Yc.z,this.context.currentTime),e.upX.setValueAtTime(t.x,this.context.currentTime),e.upY.setValueAtTime(t.y,this.context.currentTime),e.upZ.setValueAtTime(t.z,this.context.currentTime)):(e.setPosition(Wc.x,Wc.y,Wc.z),e.setOrientation(Yc.x,Yc.y,Yc.z,t.x,t.y,t.z))})}),Rl.prototype=Object.assign(Object.create(f.prototype),{constructor:Rl,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0===this.isPlaying)console.warn("THREE.Audio: Audio is already playing.");else{var e;if(!1!==this.hasPlaybackControl)return(e=this.context.createBufferSource()).buffer=this.buffer,e.loop=this.loop,e.onended=this.onEnded.bind(this),e.playbackRate.setValueAtTime(this.playbackRate,this.startTime),this.startTime=this.context.currentTime,e.start(this.startTime,this.offset),this.isPlaying=!0,this.source=e,this.connect();console.warn("THREE.Audio: this Audio has no playback control.")}},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this.source.stop(),this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.offset=0,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e=e||[],!0===this.isPlaying?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.value=e,this}}),Ll.prototype=Object.assign(Object.create(Rl.prototype),{constructor:Ll,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){this.panner.refDistance=e},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){this.panner.rolloffFactor=e},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){this.panner.distanceModel=e},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){this.panner.maxDistance=e},updateMatrixWorld:(Qc=new Re,function(e){f.prototype.updateMatrixWorld.call(this,e),Qc.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(Qc.x,Qc.y,Qc.z)})}),Object.assign(Cl.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var e=0,t=this.getFrequencyData(),n=0;n<t.length;n++)e+=t[n];return e/t.length}}),Object.assign(Il.prototype,{accumulate:function(e,t){var n=this.buffer,r=this.valueSize,i=e*r+r,e=this.cumulativeWeight;if(0===e){for(var o=0;o!==r;++o)n[i+o]=n[o];e=t}else this._mixBufferRegion(n,i,0,t/(e+=t),r);this.cumulativeWeight=e},apply:function(e){var t=this.valueSize,n=this.buffer,r=e*t+t,e=this.cumulativeWeight,i=this.binding;this.cumulativeWeight=0,e<1&&this._mixBufferRegion(n,r,3*t,1-e,t);for(var o=t,a=t+t;o!==a;++o)if(n[o]!==n[o+t]){i.setValue(n,r);break}},saveOriginalState:function(){var e=this.binding,t=this.buffer,n=this.valueSize,r=3*n;e.getValue(t,r);for(var i=n,o=r;i!==o;++i)t[i]=t[r+i%n];this.cumulativeWeight=0},restoreOriginalState:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)},_select:function(e,t,n,r,i){if(.5<=r)for(var o=0;o!==i;++o)e[t+o]=e[n+o]},_slerp:function(e,t,n,r){u.slerpFlat(e,t,e,t,e,n,r)},_lerp:function(e,t,n,r,i){for(var o=1-r,a=0;a!==i;++a){var s=t+a;e[s]=e[s]*o+e[n+a]*r}}}),Object.assign(Ol.prototype,{getValue:function(e,t){this.bind();var n=this._targetGroup.nCachedObjects_,n=this._bindings[n];void 0!==n&&n.getValue(e,t)},setValue:function(e,t){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(e,t)},bind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}),Object.assign(w,{Composite:Ol,create:function(e,t,n){return new(e&&e.isAnimationObjectGroup?w.Composite:w)(e,t,n)},sanitizeNodeName:function(e){return e.replace(/\s/g,"_").replace(/[^\w-]/g,"")},parseTrackName:(Zc=new RegExp("^"+/((?:[\w-]+[\/:])*)/.source+/([\w-\.]+)?/.source+/(?:\.([\w-]+)(?:\[(.+)\])?)?/.source+/\.([\w-]+)(?:\[(.+)\])?/.source+"$"),Jc=["material","materials","bones"],function(e){var t=Zc.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var n,t={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=t.nodeName&&t.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r&&(n=t.nodeName.substring(r+1),-1!==Jc.indexOf(n))&&(t.nodeName=t.nodeName.substring(0,r),t.objectName=n),null===t.propertyName||0===t.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return t}),findNode:function(e,r){if(!r||""===r||"root"===r||"."===r||-1===r||r===e.name||r===e.uuid)return e;if(e.skeleton){var t=(e=>{for(var t=0;t<e.bones.length;t++){var n=e.bones[t];if(n.name===r)return n}return null})(e.skeleton);if(t)return t}if(e.children){var i=function(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.name===r||n.uuid===r)return n;n=i(n.children);if(n)return n}return null},t=i(e.children);if(t)return t}return null}}),Object.assign(w.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)e[t++]=n[r]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.targetObject[this.propertyName]=e[t]},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++]},function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){var e=this.node,t=this.parsedPath,n=t.objectName,r=t.propertyName,i=t.propertyIndex;if(e||(e=w.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(n){var o=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);for(var e=e.skeleton.bones,a=0;a<e.length;a++)if(e[a].name===o){o=a;break}break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==o){if(void 0===e[o])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[o]}}var s=e[r];if(void 0===s)t=t.nodeName,console.error("THREE.PropertyBinding: Trying to update property for track: "+t+"."+r+" but it wasn't found.",e);else{var t=this.Versioning.None,c=(void 0!==e.needsUpdate?(t=this.Versioning.NeedsUpdate,this.targetObject=e):void 0!==e.matrixWorldNeedsUpdate&&(t=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=e),this.BindingType.Direct);if(void 0!==i){if("morphTargetInfluences"===r){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(a=0;a<this.node.geometry.morphAttributes.position.length;a++)if(e.geometry.morphAttributes.position[a].name===i){i=a;break}}else{if(!e.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(a=0;a<this.node.geometry.morphTargets.length;a++)if(e.geometry.morphTargets[a].name===i){i=a;break}}}c=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(c=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=r;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][t]}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(w.prototype,{_getValue_unbound:w.prototype.getValue,_setValue_unbound:w.prototype.setValue}),Object.assign(jl.prototype,{isAnimationObjectGroup:!0,add:function(){for(var e=this._objects,t=e.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._paths,o=this._parsedPaths,a=this._bindings,s=a.length,c=0,l=arguments.length;c!==l;++c){var u=arguments[c],h=u.uuid,d=r[h],p=void 0;if(void 0===d){d=t++,r[h]=d,e.push(u);for(var f=0,m=s;f!==m;++f)a[f].push(new w(u,i[f],o[f]))}else if(d<n){var p=e[d],g=--n,v=e[g];e[r[v.uuid]=d]=v,e[r[h]=g]=u;for(f=0,m=s;f!==m;++f){var y=a[f],_=y[g],x=y[d];y[d]=_,void 0===x&&(x=new w(u,i[f],o[f])),y[g]=x}}else e[d]!==p&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=n},remove:function(){for(var e=this._objects,t=this.nCachedObjects_,n=this._indicesByUUID,r=this._bindings,i=r.length,o=0,a=arguments.length;o!==a;++o){var s=arguments[o],c=s.uuid,l=n[c];if(void 0!==l&&t<=l){var u=t++,h=e[u];e[n[h.uuid]=l]=h,e[n[c]=u]=s;for(var d=0,p=i;d!==p;++d){var f=r[d],m=f[u],g=f[l];f[l]=m,f[u]=g}}}this.nCachedObjects_=t},uncache:function(){for(var e=this._objects,t=e.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._bindings,o=i.length,a=0,s=arguments.length;a!==s;++a){var c=arguments[a].uuid,l=r[c];if(void 0!==l)if(delete r[c],l<n){var u,h=--n,c=e[h],d=e[u=--t];e[r[c.uuid]=l]=c,e[r[d.uuid]=h]=d,e.pop();for(var p=0,f=o;p!==f;++p){var m=(v=i[p])[h],g=v[u];v[l]=m,v[h]=g,v.pop()}}else{e[r[(d=e[u=--t]).uuid]=l]=d,e.pop();for(var v,p=0,f=o;p!==f;++p)(v=i[p])[l]=v[u],v.pop()}}this.nCachedObjects_=n},subscribe_:function(e,t){var n=this._bindingsIndicesByPath,r=n[e],i=this._bindings;if(void 0!==r)return i[r];var o=this._paths,a=this._parsedPaths,s=this._objects,c=s.length,l=this.nCachedObjects_,u=new Array(c),r=i.length;n[e]=r,o.push(e),a.push(t),i.push(u);for(var h=l,d=s.length;h!==d;++h){var p=s[h];u[h]=new w(p,e,t)}return u},unsubscribe_:function(e){var t,n,r,i,o,a=this._bindingsIndicesByPath,s=a[e];void 0!==s&&(t=this._paths,n=this._parsedPaths,o=(r=this._bindings)[i=r.length-1],r[a[e[i]]=s]=o,r.pop(),n[s]=n[i],n.pop(),t[s]=t[i],t.pop())}}),Object.assign(Nl.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,t){return this.loop=e,this.repetitions=t,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,t,n){var r,i;return e.fadeOut(t),this.fadeIn(t),n&&(i=(n=this._clip.duration)/(r=e._clip.duration),e.warp(1,r/n,t),this.warp(i,1,t)),this},crossFadeTo:function(e,t,n){return e.crossFadeFrom(this,t,n)},stopFading:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,t,n){var r=this._mixer,i=r.time,o=this._timeScaleInterpolant,a=this.timeScale,r=(null===o&&(o=r._lendControlInterpolant(),this._timeScaleInterpolant=o),o.parameterPositions),o=o.sampleValues;return r[0]=i,r[1]=i+n,o[0]=e/a,o[1]=t/a,this},stopWarping:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,t,n,r){if(this.enabled){var i=this._startTime;if(null!==i){i=(e-i)*n;if(i<0||0===n)return;this._startTime=null,t=n*i}t*=this._updateTimeScale(e);var o=this._updateTime(t),a=this._updateWeight(e);if(0<a)for(var s=this._interpolants,c=this._propertyBindings,l=0,u=s.length;l!==u;++l)s[l].evaluate(o),c[l].accumulate(r,a)}else this._updateWeight(e)},_updateWeight:function(e){var t,n,r=0;return this.enabled&&(r=this.weight,null!==(t=this._weightInterpolant))&&(r*=n=t.evaluate(e)[0],e>t.parameterPositions[1])&&(this.stopFading(),0===n)&&(this.enabled=!1),this._effectiveWeight=r},_updateTimeScale:function(e){var t,n=0;return this.paused||(n=this.timeScale,null!==(t=this._timeScaleInterpolant)&&(n*=t.evaluate(e)[0],e>t.parameterPositions[1])&&(this.stopWarping(),0===n?this.paused=!0:this.timeScale=n)),this._effectiveTimeScale=n},_updateTime:function(e){var t=this.time+e;if(0!==e){var n=this._clip.duration,r=this.loop,i=this._loopCount;if(2200===r){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(n<=t)t=n;else{if(!(t<0))break e;t=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{var o,a,r=2202===r;if(-1===i&&(0<=e?this._setEndings(!(i=0),0===this.repetitions,r):this._setEndings(0===this.repetitions,!0,r)),(n<=t||t<0)&&(t-=n*(o=Math.floor(t/n)),i+=Math.abs(o),(a=this.repetitions-i)<0?(this.clampWhenFinished?this.paused=!0:this.enabled=!1,t=0<e?n:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<e?1:-1})):(0==a?this._setEndings(a=e<0,!a,r):this._setEndings(!1,!1,r),this._loopCount=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o}))),r&&1==(1&i))return n-(this.time=t)}this.time=t}return t},_setEndings:function(e,t,n){var r=this._interpolantSettings;n?(r.endingStart=2401,r.endingEnd=2401):(r.endingStart=e?this.zeroSlopeAtStart?2401:2400:2402,r.endingEnd=t?this.zeroSlopeAtEnd?2401:2400:2402)},_scheduleFading:function(e,t,n){var r=this._mixer,i=r.time,o=this._weightInterpolant,r=(null===o&&(o=r._lendControlInterpolant(),this._weightInterpolant=o),o.parameterPositions),o=o.sampleValues;return r[0]=i,o[0]=t,r[1]=i+e,o[1]=n,this}}),Object.assign(Fl.prototype,l.prototype,{_bindAction:function(e,t){var n=e._localRoot||this._root,r=e._clip.tracks,i=r.length,o=e._propertyBindings,a=e._interpolants,s=n.uuid,e=this._bindingsByRootAndName,c=e[s];void 0===c&&(e[s]=c={});for(var l=0;l!==i;++l){var u=r[l],h=u.name,d=c[h];if(void 0===d){if(void 0!==(d=o[l])){null===d._cacheIndex&&(++d.referenceCount,this._addInactiveBinding(d,s,h));continue}var p=t&&t._propertyBindings[l].binding.parsedPath;++(d=new Il(w.create(n,h,p),u.ValueTypeName,u.getValueSize())).referenceCount,this._addInactiveBinding(d,s,h)}o[l]=d,a[l].resultBuffer=d.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){null===e._cacheIndex&&(t=(e._localRoot||this._root).uuid,n=e._clip.uuid,r=this._actionsByClip[n],this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,n,t));for(var t,n,r,i=e._propertyBindings,o=0,a=i.length;o!==a;++o){var s=i[o];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var i=t[n];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){e=e._cacheIndex;return null!==e&&e<this._nActiveActions},_addInactiveAction:function(e,t,n){var r=this._actions,i=this._actionsByClip,o=i[t];void 0===o?(o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=o):(i=o.knownActions,e._byClipCacheIndex=i.length,i.push(e)),e._cacheIndex=r.length,r.push(e),o.actionByRoot[n]=e},_removeInactiveAction:function(e){var t=this._actions,n=t[t.length-1],r=e._cacheIndex,r=(t[n._cacheIndex=r]=n,t.pop(),e._cacheIndex=null,e._clip.uuid),n=this._actionsByClip,t=n[r],i=t.knownActions,o=i[i.length-1],a=e._byClipCacheIndex;i[o._byClipCacheIndex=a]=o,i.pop(),e._byClipCacheIndex=null,delete t.actionByRoot[(e._localRoot||this._root).uuid],0===i.length&&delete n[r],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var i=t[n];0==--i.referenceCount&&this._removeInactiveBinding(i)}},_lendAction:function(e){var t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,i=t[r];t[e._cacheIndex=r]=e,t[i._cacheIndex=n]=i},_takeBackAction:function(e){var t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,i=t[r];t[e._cacheIndex=r]=e,t[i._cacheIndex=n]=i},_addInactiveBinding:function(e,t,n){var r=this._bindingsByRootAndName,i=r[t],o=this._bindings;void 0===i&&(r[t]=i={}),(i[n]=e)._cacheIndex=o.length,o.push(e)},_removeInactiveBinding:function(e){var t=this._bindings,n=e.binding,r=n.rootNode.uuid,n=n.path,i=this._bindingsByRootAndName,o=i[r],a=t[t.length-1],e=e._cacheIndex;t[a._cacheIndex=e]=a,t.pop(),delete o[n];e:{for(var s in o)break e;delete i[r]}},_lendBinding:function(e){var t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,i=t[r];t[e._cacheIndex=r]=e,t[i._cacheIndex=n]=i},_takeBackBinding:function(e){var t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,i=t[r];t[e._cacheIndex=r]=e,t[i._cacheIndex=n]=i},_lendControlInterpolant:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,n=e[t];return void 0===n&&(e[(n=new Xs(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t]=n),n},_takeBackControlInterpolant:function(e){var t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,i=t[r];t[e.__cacheIndex=r]=e,t[i.__cacheIndex=n]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,t){var n=t||this._root,r=n.uuid,n="string"==typeof e?ic.findByName(n,e):e,e=null!==n?n.uuid:e,i=this._actionsByClip[e],o=null;if(void 0!==i){var a=i.actionByRoot[r];if(void 0!==a)return a;o=i.knownActions[0],null===n&&(n=o._clip)}return null===n?null:(a=new Nl(this,n,t),this._bindAction(a,o),this._addInactiveAction(a,e,r),a)},existingAction:function(e,t){var t=t||this._root,n=t.uuid,t="string"==typeof e?ic.findByName(t,e):e,t=t?t.uuid:e,e=this._actionsByClip[t];return void 0!==e&&e.actionByRoot[n]||null},stopAllAction:function(){var e=this._actions,t=this._nActiveActions,n=this._bindings,r=this._nActiveBindings;this._nActiveActions=0;for(var i=this._nActiveBindings=0;i!==t;++i)e[i].reset();for(i=0;i!==r;++i)n[i].useCount=0;return this},update:function(e){e*=this.timeScale;for(var t=this._actions,n=this._nActiveActions,r=this.time+=e,i=Math.sign(e),o=this._accuIndex^=1,a=0;a!==n;++a)t[a]._update(r,e,i,o);for(var s=this._bindings,c=this._nActiveBindings,a=0;a!==c;++a)s[a].apply(o);return this},getRoot:function(){return this._root},uncacheClip:function(e){var t=this._actions,e=e.uuid,n=this._actionsByClip,r=n[e];if(void 0!==r){for(var i=r.knownActions,o=0,a=i.length;o!==a;++o){var s=i[o],c=(this._deactivateAction(s),s._cacheIndex),l=t[t.length-1];s._cacheIndex=null,s._byClipCacheIndex=null,t[l._cacheIndex=c]=l,t.pop(),this._removeInactiveBindingsForAction(s)}delete n[e]}},uncacheRoot:function(e){var t,n=e.uuid,r=this._actionsByClip;for(t in r){var i=r[t].actionByRoot[n];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var o=this._bindingsByRootAndName[n];if(void 0!==o)for(var a in o){a=o[a];a.restoreOriginalState(),this._removeInactiveBinding(a)}},uncacheAction:function(e,t){e=this.existingAction(e,t);null!==e&&(this._deactivateAction(e),this._removeInactiveAction(e))}}),Dl.prototype.clone=function(){return new Dl(void 0===this.value.clone?this.value:this.value.clone())},Hl.prototype=Object.assign(Object.create(Z.prototype),{constructor:Hl,isInstancedBufferGeometry:!0,copy:function(e){return Z.prototype.copy.call(this,e),this.maxInstancedCount=e.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)}}),Object.defineProperties(Ul.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(Ul.prototype,{isInterleavedBufferAttribute:!0,setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this},setXYZ:function(e,t,n,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this},setXYZW:function(e,t,n,r,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=i,this}}),Object.defineProperty(zl.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(zl.prototype,{isInterleavedBuffer:!0,setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==e?e.length/this.stride:0,this.array=e},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.dynamic=e.dynamic,this},copyAt:function(e,t,n){e*=this.stride,n*=t.stride;for(var r=0,i=this.stride;r<i;r++)this.array[e+r]=t.array[n+r];return this},set:function(e,t){return this.array.set(e,t=void 0===t?0:t),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(e){return this.onUploadCallback=e,this}}),kl.prototype=Object.assign(Object.create(zl.prototype),{constructor:kl,isInstancedInterleavedBuffer:!0,copy:function(e){return zl.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Bl.prototype=Object.assign(Object.create(b.prototype),{constructor:Bl,isInstancedBufferAttribute:!0,copy:function(e){return b.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Object.assign(Vl.prototype,{linePrecision:1,set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize()):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,t){var n=[];return Wl(e,this,n,t),n.sort(Gl),n},intersectObjects:function(e,t){var n=[];if(!1===Array.isArray(e))console.warn("THREE.Raycaster.intersectObjects: objects is not an Array.");else{for(var r=0,i=e.length;r<i;r++)Wl(e[r],this,n,t);n.sort(Gl)}return n}}),Object.assign(ql.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e,t=0;return this.autoStart&&!this.running?(this.start(),0):(this.running&&(t=((e=("undefined"==typeof performance?Date:performance).now())-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t),t)}}),Object.assign(Xl.prototype,{set:function(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(e){return this.radius=e.length(),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e.x,e.z),this.phi=Math.acos(Ae.clamp(e.y/this.radius,-1,1))),this}}),Object.assign(Yl.prototype,{set:function(e,t,n){return this.radius=e,this.theta=t,this.y=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.radius=Math.sqrt(e.x*e.x+e.z*e.z),this.theta=Math.atan2(e.x,e.z),this.y=e.y,this}}),((Ql.prototype=Object.create(f.prototype)).constructor=Ql).prototype.isImmediateRenderObject=!0,((Zl.prototype=Object.create(_.prototype)).constructor=Zl).prototype.update=(Kc=new Re,$c=new Re,el=new R,function(){var e=["a","b","c"],t=(this.object.updateMatrixWorld(!0),el.getNormalMatrix(this.object.matrixWorld),this.object.matrixWorld),n=this.geometry.attributes.position,r=this.object.geometry;if(r&&r.isGeometry)for(var i=r.vertices,o=r.faces,a=0,s=0,c=o.length;s<c;s++)for(var l=o[s],u=0,h=l.vertexNormals.length;u<h;u++){var d=i[l[e[u]]],p=l.vertexNormals[u];Kc.copy(d).applyMatrix4(t),$c.copy(p).applyMatrix3(el).normalize().multiplyScalar(this.size).add(Kc),n.setXYZ(a,Kc.x,Kc.y,Kc.z),a+=1,n.setXYZ(a,$c.x,$c.y,$c.z),a+=1}else if(r&&r.isBufferGeometry)for(var f=r.attributes.position,m=r.attributes.normal,a=0,u=0,h=f.count;u<h;u++)Kc.set(f.getX(u),f.getY(u),f.getZ(u)).applyMatrix4(t),$c.set(m.getX(u),m.getY(u),m.getZ(u)),$c.applyMatrix3(el).normalize().multiplyScalar(this.size).add(Kc),n.setXYZ(a,Kc.x,Kc.y,Kc.z),n.setXYZ(a+=1,$c.x,$c.y,$c.z),a+=1;n.needsUpdate=!0}),((Jl.prototype=Object.create(f.prototype)).constructor=Jl).prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},Jl.prototype.update=(tl=new Re,nl=new Re,function(){this.light.updateMatrixWorld();var e=this.light.distance||1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),tl.setFromMatrixPosition(this.light.matrixWorld),nl.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(nl.sub(tl)),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}),((Kl.prototype=Object.create(_.prototype)).constructor=Kl).prototype.updateMatrixWorld=(rl=new Re,il=new Pe,ol=new Pe,function(e){var t=this.bones,n=this.geometry,r=n.getAttribute("position");ol.getInverse(this.root.matrixWorld);for(var i=0,o=0;i<t.length;i++){var a=t[i];a.parent&&a.parent.isBone&&(il.multiplyMatrices(ol,a.matrixWorld),rl.setFromMatrixPosition(il),r.setXYZ(o,rl.x,rl.y,rl.z),il.multiplyMatrices(ol,a.parent.matrixWorld),rl.setFromMatrixPosition(il),r.setXYZ(o+1,rl.x,rl.y,rl.z),o+=2)}n.getAttribute("position").needsUpdate=!0,f.prototype.updateMatrixWorld.call(this,e)}),(($l.prototype=Object.create(m.prototype)).constructor=$l).prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},$l.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},((eu.prototype=Object.create(f.prototype)).constructor=eu).prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},eu.prototype.update=function(){var e=.5*this.light.width,t=.5*this.light.height,n=this.line.geometry.attributes.position,r=n.array;r[0]=e,r[1]=-t,r[2]=0,r[3]=e,r[4]=t,r[5]=0,r[6]=-e,r[7]=t,r[8]=0,r[9]=-e,r[10]=-t,r[11]=0,r[12]=e,r[13]=-t,n.needsUpdate=!(r[14]=0),void 0!==this.color?this.line.material.color.set(this.color):this.line.material.color.copy(this.light.color)},((tu.prototype=Object.create(f.prototype)).constructor=tu).prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},tu.prototype.update=(al=new Re,sl=new pe,cl=new pe,function(){var e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var t=e.geometry.getAttribute("color");sl.copy(this.light.color),cl.copy(this.light.groundColor);for(var n=0,r=t.count;n<r;n++){var i=n<r/2?sl:cl;t.setXYZ(n,i.r,i.g,i.b)}t.needsUpdate=!0}e.lookAt(al.setFromMatrixPosition(this.light.matrixWorld).negate())}),(nu.prototype=Object.create(_.prototype)).constructor=nu,(ru.prototype=Object.create(_.prototype)).constructor=ru,((iu.prototype=Object.create(_.prototype)).constructor=iu).prototype.update=(ll=new Re,ul=new Re,hl=new R,function(){this.object.updateMatrixWorld(!0),hl.getNormalMatrix(this.object.matrixWorld);for(var e=this.object.matrixWorld,t=this.geometry.attributes.position,n=this.object.geometry,r=n.vertices,i=n.faces,o=0,a=0,s=i.length;a<s;a++){var c=i[a],l=c.normal;ll.copy(r[c.a]).add(r[c.b]).add(r[c.c]).divideScalar(3).applyMatrix4(e),ul.copy(l).applyMatrix3(hl).normalize().multiplyScalar(this.size).add(ll),t.setXYZ(o,ll.x,ll.y,ll.z),o+=1,t.setXYZ(o,ul.x,ul.y,ul.z),o+=1}t.needsUpdate=!0}),((ou.prototype=Object.create(f.prototype)).constructor=ou).prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},ou.prototype.update=(dl=new Re,pl=new Re,fl=new Re,function(){dl.setFromMatrixPosition(this.light.matrixWorld),pl.setFromMatrixPosition(this.light.target.matrixWorld),fl.subVectors(pl,dl),this.lightPlane.lookAt(fl),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(fl),this.targetLine.scale.z=fl.length()}),((au.prototype=Object.create(_.prototype)).constructor=au).prototype.update=(vl=new Re,yl=new Qr,function(){ml=this.geometry,gl=this.pointMap;yl.projectionMatrix.copy(this.camera.projectionMatrix),r("c",0,0,-1),r("t",0,0,1),r("n1",-1,-1,-1),r("n2",1,-1,-1),r("n3",-1,1,-1),r("n4",1,1,-1),r("f1",-1,-1,1),r("f2",1,-1,1),r("f3",-1,1,1),r("f4",1,1,1),r("u1",.7,1.1,-1),r("u2",-.7,1.1,-1),r("u3",0,2,-1),r("cf1",-1,0,1),r("cf2",1,0,1),r("cf3",0,-1,1),r("cf4",0,1,1),r("cn1",-1,0,-1),r("cn2",1,0,-1),r("cn3",0,-1,-1),r("cn4",0,1,-1),ml.getAttribute("position").needsUpdate=!0}),((su.prototype=Object.create(_.prototype)).constructor=su).prototype.update=(_l=new xr,function(e){var t,n,r;void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&_l.setFromObject(this.object),_l.isEmpty()||(e=_l.min,t=_l.max,(r=(n=this.geometry.attributes.position).array)[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=e.x,r[4]=t.y,r[5]=t.z,r[6]=e.x,r[7]=e.y,r[8]=t.z,r[9]=t.x,r[10]=e.y,r[11]=t.z,r[12]=t.x,r[13]=t.y,r[14]=e.z,r[15]=e.x,r[16]=t.y,r[17]=e.z,r[18]=e.x,r[19]=e.y,r[20]=e.z,r[21]=t.x,r[22]=e.y,r[23]=e.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere())}),su.prototype.setFromObject=function(e){return this.object=e,this.update(),this},((cu.prototype=Object.create(_.prototype)).constructor=cu).prototype.updateMatrixWorld=function(e){var t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),f.prototype.updateMatrixWorld.call(this,e))},((lu.prototype=Object.create(y.prototype)).constructor=lu).prototype.updateMatrixWorld=function(e){var t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.lookAt(this.plane.normal),f.prototype.updateMatrixWorld.call(this,e)},((uu.prototype=Object.create(f.prototype)).constructor=uu).prototype.setDirection=(El=new Re,function(e){.99999<e.y?this.quaternion.set(0,0,0,1):e.y<-.99999?this.quaternion.set(1,0,0,0):(El.set(e.z,0,-e.x).normalize(),wl=Math.acos(e.y),this.quaternion.setFromAxisAngle(El,wl))}),uu.prototype.setLength=function(e,t,n){void 0===t&&(t=.2*e),void 0===n&&(n=.2*t),this.line.scale.set(1,Math.max(0,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()},uu.prototype.setColor=function(e){this.line.material.color.copy(e),this.cone.material.color.copy(e)},(hu.prototype=Object.create(_.prototype)).constructor=hu;var pu=new Re,fu=new du,mu=new du,gu=new du;function vu(e,t,n,r){c.call(this),this.type="CatmullRomCurve3",this.points=e||[],this.closed=t||!1,this.curveType=n||"centripetal",this.tension=r||.5}function yu(e,t,n,r){c.call(this),this.type="CubicBezierCurve3",this.v0=e||new Re,this.v1=t||new Re,this.v2=n||new Re,this.v3=r||new Re}function _u(e,t,n){c.call(this),this.type="QuadraticBezierCurve3",this.v0=e||new Re,this.v1=t||new Re,this.v2=n||new Re}function xu(e,t){c.call(this),this.type="LineCurve3",this.v1=e||new Re,this.v2=t||new Re}function bu(e,t,n,r,i,o){Mc.call(this,e,t,n,n,r,i,o),this.type="ArcCurve"}((vu.prototype=Object.create(c.prototype)).constructor=vu).prototype.isCatmullRomCurve3=!0,vu.prototype.getPoint=function(e,t){var n,r,i,o,t=t||new Re,a=this.points,s=a.length,e=(s-(this.closed?0:1))*e,c=Math.floor(e),e=e-c;return this.closed?c+=0<c?0:(Math.floor(Math.abs(c)/a.length)+1)*a.length:0===e&&c===s-1&&(c=s-2,e=1),n=this.closed||0<c?a[(c-1)%s]:(pu.subVectors(a[0],a[1]).add(a[0]),pu),r=a[c%s],i=a[(c+1)%s],c=this.closed||c+2<s?a[(c+2)%s]:(pu.subVectors(a[s-1],a[s-2]).add(a[s-1]),pu),"centripetal"===this.curveType||"chordal"===this.curveType?(a="chordal"===this.curveType?.5:.25,s=Math.pow(n.distanceToSquared(r),a),(o=Math.pow(r.distanceToSquared(i),a))<1e-4&&(o=1),s<1e-4&&(s=o),(a=Math.pow(i.distanceToSquared(c),a))<1e-4&&(a=o),fu.initNonuniformCatmullRom(n.x,r.x,i.x,c.x,s,o,a),mu.initNonuniformCatmullRom(n.y,r.y,i.y,c.y,s,o,a),gu.initNonuniformCatmullRom(n.z,r.z,i.z,c.z,s,o,a)):"catmullrom"===this.curveType&&(fu.initCatmullRom(n.x,r.x,i.x,c.x,this.tension),mu.initCatmullRom(n.y,r.y,i.y,c.y,this.tension),gu.initCatmullRom(n.z,r.z,i.z,c.z,this.tension)),t.set(fu.calc(e),mu.calc(e),gu.calc(e)),t},vu.prototype.copy=function(e){c.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},((yu.prototype=Object.create(c.prototype)).constructor=yu).prototype.isCubicBezierCurve3=!0,yu.prototype.getPoint=function(e,t){var t=t||new Re,n=this.v0,r=this.v1,i=this.v2,o=this.v3;return t.set(bc(e,n.x,r.x,i.x,o.x),bc(e,n.y,r.y,i.y,o.y),bc(e,n.z,r.z,i.z,o.z)),t},yu.prototype.copy=function(e){return c.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},((_u.prototype=Object.create(c.prototype)).constructor=_u).prototype.isQuadraticBezierCurve3=!0,_u.prototype.getPoint=function(e,t){var t=t||new Re,n=this.v0,r=this.v1,i=this.v2;return t.set(xc(e,n.x,r.x,i.x),xc(e,n.y,r.y,i.y),xc(e,n.z,r.z,i.z)),t},_u.prototype.copy=function(e){return c.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},((xu.prototype=Object.create(c.prototype)).constructor=xu).prototype.isLineCurve3=!0,xu.prototype.getPoint=function(e,t){t=t||new Re;return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t},xu.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},xu.prototype.copy=function(e){return c.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},((bu.prototype=Object.create(Mc.prototype)).constructor=bu).prototype.isArcCurve=!0;Rc={createMultiMaterialObject:function(e,t){for(var n=new Ra,r=0,i=t.length;r<i;r++)n.add(new m(e,t[r]));return n},detach:function(e,t,n){e.applyMatrix(t.matrixWorld),t.remove(e),n.add(e)},attach:function(e,t,n){e.applyMatrix((new Pe).getInverse(n.matrixWorld)),t.remove(e),n.add(e)}};var wu;function Eu(e){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),vu.call(this,e),this.type="catmullrom",this.closed=!0}function Mu(e){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),vu.call(this,e),this.type="catmullrom"}function Tu(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),vu.call(this,e),this.type="catmullrom"}c.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(c.prototype),(e.prototype.constructor=e).prototype.getPoint=t,e},Object.assign(Ec.prototype,{createPointsGeometry:function(e){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");e=this.getPoints(e);return this.createGeometry(e)},createSpacedPointsGeometry:function(e){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");e=this.getSpacedPoints(e);return this.createGeometry(e)},createGeometry:function(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var t=new fe,n=0,r=e.length;n<r;n++){var i=e[n];t.vertices.push(new Re(i.x,i.y,i.z||0))}return t}}),Object.assign(Lc.prototype,{fromPoints:function(e){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}}),Eu.prototype=Object.create(vu.prototype),Mu.prototype=Object.create(vu.prototype),Tu.prototype=Object.create(vu.prototype),Object.assign(Tu.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),nu.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Kl.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(qn.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(xr.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),yo.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Object.assign(Ae,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),Ae.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),Ae.ceilPowerOfTwo(e)}}),Object.assign(R.prototype,{flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(Pe.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},getPosition:function(){return void 0===wu&&(wu=new Re),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),wu.setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,t,n,r,i,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,r,n,i,o)}}),Er.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},u.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Object.assign(vo.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(Cc.prototype,{extractAllPoints:function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Ka(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new cs(this,e)}}),Object.assign(de.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Re.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,t,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Le.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),fe.prototype.computeTangents=function(){console.warn("THREE.Geometry: .computeTangents() has been removed.")},Object.assign(f.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)}}),Object.defineProperties(f.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(wa.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Ea.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Object.defineProperty(c.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),g.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(a.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(b.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}}}),Object.assign(Z.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addDrawCall:function(e,t,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(Z.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(Dl.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(t.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new pe}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===e}}}),Object.defineProperties(ws.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(go.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(ma.prototype,{getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")}}),Object.defineProperties(ma.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){return this.shadowMap.cullFace},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace."),this.shadowMap.cullFace=e}}}),Object.defineProperties(Tr.prototype,{cullFace:{get:function(){return this.renderReverseSided?J:Q},set:function(e){e=e!==Q;console.warn("WebGLRenderer: .shadowMap.cullFace is deprecated. Set .shadowMap.renderReverseSided to "+e+"."),this.renderReverseSided=e}}}),Object.defineProperties(Kt.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Rl.prototype.load=function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this;return(new Tl).load(e,function(e){t.setBuffer(e)}),this},Cl.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Al.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)};var Su={merge:function(e,t,n){var r;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),t.isMesh&&(t.matrixAutoUpdate&&t.updateMatrix(),r=t.matrix,t=t.geometry),e.merge(t,r,n)},center:function(e){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}},Au={crossOrigin:void 0,loadTexture:function(e,t,n,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new Fs,i=(i.setCrossOrigin(this.crossOrigin),i.load(e,n,void 0,r));return t&&(i.mapping=t),i},loadTextureCube:function(e,t,n,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new Ns,i=(i.setCrossOrigin(this.crossOrigin),i.load(e,n,void 0,r));return t&&(i.mapping=t),i},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}};e.WebGLRenderTargetCube=$t,e.WebGLRenderTarget=Kt,e.WebGLRenderer=ma,e.ShaderLib=Wn,e.UniformsLib=Ce,e.UniformsUtils=Ie,e.ShaderChunk=E,e.FogExp2=ga,e.Fog=va,e.Scene=ya,e.LensFlare=_a,e.Sprite=ba,e.LOD=wa,e.SkinnedMesh=Ta,e.Skeleton=Ea,e.Bone=Ma,e.Mesh=m,e.LineSegments=_,e.LineLoop=Sa,e.Line=y,e.Points=Pa,e.Group=Ra,e.VideoTexture=La,e.DataTexture=en,e.CompressedTexture=Ca,e.CubeTexture=tn,e.CanvasTexture=Yn,e.DepthTexture=Ia,e.Texture=d,e.CompressedTextureLoader=Is,e.DataTextureLoader=Os,e.CubeTextureLoader=Ns,e.TextureLoader=Fs,e.ObjectLoader=mc,e.MaterialLoader=oc,e.BufferGeometryLoader=ac,e.DefaultLoadingManager=n,e.LoadingManager=Rs,e.JSONLoader=fc,e.ImageLoader=js,e.FontLoader=jc,e.FileLoader=Cs,e.Loader=pc,e.Cache=Ps,e.AudioLoader=Tl,e.SpotLightShadow=Us,e.SpotLight=zs,e.PointLight=ks,e.RectAreaLight=Ws,e.HemisphereLight=Ds,e.DirectionalLightShadow=Bs,e.DirectionalLight=Vs,e.AmbientLight=Gs,e.LightShadow=Hs,e.Light=a,e.StereoCamera=Sl,e.PerspectiveCamera=g,e.OrthographicCamera=Zr,e.CubeCamera=Al,e.ArrayCamera=ua,e.Camera=Qr,e.AudioListener=Pl,e.PositionalAudio=Ll,e.AudioContext=Ml,e.AudioAnalyser=Cl,e.Audio=Rl,e.VectorKeyframeTrack=Zs,e.StringKeyframeTrack=ec,e.QuaternionKeyframeTrack=Ks,e.NumberKeyframeTrack=$s,e.ColorKeyframeTrack=nc,e.BooleanKeyframeTrack=tc,e.PropertyMixer=Il,e.PropertyBinding=w,e.KeyframeTrack=rc,e.AnimationUtils=x,e.AnimationObjectGroup=jl,e.AnimationMixer=Fl,e.AnimationClip=ic,e.Uniform=Dl,e.InstancedBufferGeometry=Hl,e.BufferGeometry=Z,e.Geometry=fe,e.InterleavedBufferAttribute=Ul,e.InstancedInterleavedBuffer=kl,e.InterleavedBuffer=zl,e.InstancedBufferAttribute=Bl,e.Face3=Jr,e.Object3D=f,e.Raycaster=Vl,e.Layers=Pr,e.EventDispatcher=l,e.Clock=ql,e.QuaternionLinearInterpolant=Js,e.LinearInterpolant=Xs,e.DiscreteInterpolant=Ys,e.CubicInterpolant=qs,e.Interpolant=s,e.Triangle=_o,e.Math=Ae,e.Spherical=Xl,e.Cylindrical=Yl,e.Plane=Er,e.Frustum=Mr,e.Sphere=wr,e.Ray=vo,e.Matrix4=Pe,e.Matrix3=R,e.Box3=xr,e.Box2=qn,e.Line3=yo,e.Euler=Ar,e.Vector4=Le,e.Vector3=Re,e.Vector2=de,e.Quaternion=u,e.Color=pe,e.ImmediateRenderObject=Ql,e.VertexNormalsHelper=Zl,e.SpotLightHelper=Jl,e.SkeletonHelper=Kl,e.PointLightHelper=$l,e.RectAreaLightHelper=eu,e.HemisphereLightHelper=tu,e.GridHelper=nu,e.PolarGridHelper=ru,e.FaceNormalsHelper=iu,e.DirectionalLightHelper=ou,e.CameraHelper=au,e.BoxHelper=su,e.Box3Helper=cu,e.PlaneHelper=lu,e.ArrowHelper=uu,e.AxesHelper=hu,e.CatmullRomCurve3=vu,e.CubicBezierCurve3=yu,e.QuadraticBezierCurve3=_u,e.LineCurve3=xu,e.ArcCurve=bu,e.EllipseCurve=Mc,e.SplineCurve=Tc,e.CubicBezierCurve=Sc,e.QuadraticBezierCurve=Ac,e.LineCurve=wc,e.Shape=Cc,e.Path=Lc,e.ShapePath=Ic,e.Font=Oc,e.CurvePath=Ec,e.Curve=c,e.ShapeUtils=Ja,e.SceneUtils=Rc,e.WebGLUtils=fa,e.WireframeGeometry=Oa,e.ParametricGeometry=ja,e.ParametricBufferGeometry=Na,e.TetrahedronGeometry=Da,e.TetrahedronBufferGeometry=Ha,e.OctahedronGeometry=Ua,e.OctahedronBufferGeometry=za,e.IcosahedronGeometry=ka,e.IcosahedronBufferGeometry=Ba,e.DodecahedronGeometry=Va,e.DodecahedronBufferGeometry=Ga,e.PolyhedronGeometry=Fa,e.PolyhedronBufferGeometry=o,e.TubeGeometry=Wa,e.TubeBufferGeometry=qa,e.TorusKnotGeometry=Xa,e.TorusKnotBufferGeometry=Ya,e.TorusGeometry=Qa,e.TorusBufferGeometry=Za,e.TextGeometry=es,e.TextBufferGeometry=ts,e.SphereGeometry=ns,e.SphereBufferGeometry=rs,e.RingGeometry=is,e.RingBufferGeometry=os,e.PlaneGeometry=po,e.PlaneBufferGeometry=fo,e.LatheGeometry=as,e.LatheBufferGeometry=ss,e.ShapeGeometry=cs,e.ShapeBufferGeometry=ls,e.ExtrudeGeometry=Ka,e.ExtrudeBufferGeometry=$a,e.EdgesGeometry=us,e.ConeGeometry=ps,e.ConeBufferGeometry=fs,e.CylinderGeometry=hs,e.CylinderBufferGeometry=ds,e.CircleGeometry=ms,e.CircleBufferGeometry=gs,e.BoxGeometry=uo,e.BoxBufferGeometry=ho,e.ShadowMaterial=ys,e.SpriteMaterial=xa,e.RawShaderMaterial=_s,e.ShaderMaterial=go,e.PointsMaterial=Aa,e.MeshPhysicalMaterial=bs,e.MeshStandardMaterial=xs,e.MeshPhongMaterial=ws,e.MeshToonMaterial=Es,e.MeshNormalMaterial=Ms,e.MeshLambertMaterial=Ts,e.MeshDepthMaterial=yr,e.MeshDistanceMaterial=_r,e.MeshBasicMaterial=mo,e.LineDashedMaterial=Ss,e.LineBasicMaterial=v,e.Material=t,e.Float64BufferAttribute=di,e.Float32BufferAttribute=te,e.Uint32BufferAttribute=hi,e.Int32BufferAttribute=ui,e.Uint16BufferAttribute=li,e.Int16BufferAttribute=ci,e.Uint8ClampedBufferAttribute=si,e.Uint8BufferAttribute=ai,e.Int8BufferAttribute=oi,e.BufferAttribute=b,e.REVISION="88",e.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},e.CullFaceNone=Y,e.CullFaceBack=Q,e.CullFaceFront=J,e.CullFaceFrontBack=3,e.FrontFaceDirectionCW=0,e.FrontFaceDirectionCCW=1,e.BasicShadowMap=0,e.PCFShadowMap=K,e.PCFSoftShadowMap=$,e.FrontSide=ee,e.BackSide=ne,e.DoubleSide=re,e.FlatShading=1,e.SmoothShading=2,e.NoColors=0,e.FaceColors=1,e.VertexColors=2,e.NoBlending=ie,e.NormalBlending=oe,e.AdditiveBlending=ae,e.SubtractiveBlending=se,e.MultiplyBlending=ce,e.CustomBlending=le,e.AddEquation=ue,e.SubtractEquation=he,e.ReverseSubtractEquation=me,e.MinEquation=ge,e.MaxEquation=ve,e.ZeroFactor=ye,e.OneFactor=_e,e.SrcColorFactor=xe,e.OneMinusSrcColorFactor=be,e.SrcAlphaFactor=we,e.OneMinusSrcAlphaFactor=Ee,e.DstAlphaFactor=Me,e.OneMinusDstAlphaFactor=Te,e.DstColorFactor=Se,e.OneMinusDstColorFactor=Oe,e.SrcAlphaSaturateFactor=je,e.NeverDepth=Ne,e.AlwaysDepth=Fe,e.LessDepth=De,e.LessEqualDepth=He,e.EqualDepth=Ue,e.GreaterEqualDepth=ze,e.GreaterDepth=ke,e.NotEqualDepth=Be,e.MultiplyOperation=Ve,e.MixOperation=Ge,e.AddOperation=We,e.NoToneMapping=qe,e.LinearToneMapping=Xe,e.ReinhardToneMapping=Ye,e.Uncharted2ToneMapping=Qe,e.CineonToneMapping=Ze,e.UVMapping=300,e.CubeReflectionMapping=Je,e.CubeRefractionMapping=Ke,e.EquirectangularReflectionMapping=$e,e.EquirectangularRefractionMapping=et,e.SphericalReflectionMapping=tt,e.CubeUVReflectionMapping=nt,e.CubeUVRefractionMapping=rt,e.RepeatWrapping=it,e.ClampToEdgeWrapping=S,e.MirroredRepeatWrapping=ot,e.NearestFilter=P,e.NearestMipMapNearestFilter=at,e.NearestMipMapLinearFilter=st,e.LinearFilter=A,e.LinearMipMapNearestFilter=ct,e.LinearMipMapLinearFilter=lt,e.UnsignedByteType=ut,e.ByteType=ht,e.ShortType=dt,e.UnsignedShortType=pt,e.IntType=ft,e.UnsignedIntType=mt,e.FloatType=gt,e.HalfFloatType=vt,e.UnsignedShort4444Type=yt,e.UnsignedShort5551Type=_t,e.UnsignedShort565Type=xt,e.UnsignedInt248Type=bt,e.AlphaFormat=wt,e.RGBFormat=Et,e.RGBAFormat=Mt,e.LuminanceFormat=Tt,e.LuminanceAlphaFormat=St,e.RGBEFormat=At,e.DepthFormat=Pt,e.DepthStencilFormat=Rt,e.RGB_S3TC_DXT1_Format=Lt,e.RGBA_S3TC_DXT1_Format=Ct,e.RGBA_S3TC_DXT3_Format=It,e.RGBA_S3TC_DXT5_Format=Ot,e.RGB_PVRTC_4BPPV1_Format=jt,e.RGB_PVRTC_2BPPV1_Format=Nt,e.RGBA_PVRTC_4BPPV1_Format=Ft,e.RGBA_PVRTC_2BPPV1_Format=Dt,e.RGB_ETC1_Format=Ht,e.LoopOnce=2200,e.LoopRepeat=2201,e.LoopPingPong=2202,e.InterpolateDiscrete=2300,e.InterpolateLinear=2301,e.InterpolateSmooth=2302,e.ZeroCurvatureEnding=2400,e.ZeroSlopeEnding=2401,e.WrapAroundEnding=2402,e.TrianglesDrawMode=Ut,e.TriangleStripDrawMode=1,e.TriangleFanDrawMode=2,e.LinearEncoding=zt,e.sRGBEncoding=kt,e.GammaEncoding=Bt,e.RGBEEncoding=Vt,e.LogLuvEncoding=3003,e.RGBM7Encoding=Gt,e.RGBM16Encoding=Wt,e.RGBDEncoding=qt,e.BasicDepthPacking=Xt,e.RGBADepthPacking=Yt,e.CubeGeometry=uo,e.Face4=function(e,t,n,r,i,o,a){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new Jr(e,t,n,i,o,a)},e.LineStrip=0,e.LinePieces=1,e.MeshFaceMaterial=function(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e},e.MultiMaterial=function(e){return void 0===e&&(e=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,(e.materials=e).clone=function(){return e.slice()},e},e.PointCloud=function(e,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new Pa(e,t)},e.Particle=function(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new ba(e)},e.ParticleSystem=function(e,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new Pa(e,t)},e.PointCloudMaterial=function(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Aa(e)},e.ParticleBasicMaterial=function(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Aa(e)},e.ParticleSystemMaterial=function(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Aa(e)},e.Vertex=function(e,t,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new Re(e,t,n)},e.DynamicBufferAttribute=function(e,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new b(e,t).setDynamic(!0)},e.Int8Attribute=function(e,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new oi(e,t)},e.Uint8Attribute=function(e,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new ai(e,t)},e.Uint8ClampedAttribute=function(e,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new si(e,t)},e.Int16Attribute=function(e,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new ci(e,t)},e.Uint16Attribute=function(e,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new li(e,t)},e.Int32Attribute=function(e,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new ui(e,t)},e.Uint32Attribute=function(e,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new hi(e,t)},e.Float32Attribute=function(e,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new te(e,t)},e.Float64Attribute=function(e,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new di(e,t)},e.ClosedSplineCurve3=Eu,e.SplineCurve3=Mu,e.Spline=Tu,e.AxisHelper=function(e){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new hu(e)},e.BoundingBoxHelper=function(e,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new su(e,t)},e.EdgesHelper=function(e,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new _(new us(e.geometry),new v({color:void 0!==t?t:16777215}))},e.WireframeHelper=function(e,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new _(new Oa(e.geometry),new v({color:void 0!==t?t:16777215}))},e.XHRLoader=function(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Cs(e)},e.BinaryTextureLoader=function(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Os(e)},e.GeometryUtils=Su,e.ImageUtils=Au,e.Projector=function(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(e,t){console.warn("THREE.Projector: .projectVector() is now vector.project()."),e.project(t)},this.unprojectVector=function(e,t){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),e.unproject(t)},this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}},e.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}},Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof n&&void 0!==t?i(n):"function"==typeof define&&define.amd?define(["exports"],i):i(r.THREE=r.THREE||{})},{}],408:[function(e,t,n){THREE.OrbitControls=function(e,t){this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.target=new THREE.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return d.phi},this.getAzimuthalAngle=function(){return d.theta},this.saveState=function(){s.target0.copy(s.target),s.position0.copy(s.object.position),s.zoom0=s.object.zoom},this.reset=function(){s.target.copy(s.target0),s.object.position.copy(s.position0),s.object.zoom=s.zoom0,s.object.updateProjectionMatrix(),s.dispatchEvent(F),s.update(),h=u.NONE},this.update=(n=new THREE.Vector3,r=(new THREE.Quaternion).setFromUnitVectors(e.up,new THREE.Vector3(0,1,0)),i=r.clone().inverse(),o=new THREE.Vector3,a=new THREE.Quaternion,function(){var e=s.object.position;return n.copy(e).sub(s.target),n.applyQuaternion(r),d.setFromVector3(n),s.autoRotate&&h===u.NONE&&A(2*Math.PI/60/60*s.autoRotateSpeed),d.theta+=p.theta,d.phi+=p.phi,d.theta=Math.max(s.minAzimuthAngle,Math.min(s.maxAzimuthAngle,d.theta)),d.phi=Math.max(s.minPolarAngle,Math.min(s.maxPolarAngle,d.phi)),d.makeSafe(),d.radius*=f,d.radius=Math.max(s.minDistance,Math.min(s.maxDistance,d.radius)),s.target.add(m),n.setFromSpherical(d),n.applyQuaternion(i),e.copy(s.target).add(n),s.object.lookAt(s.target),!0===s.enableDamping?(p.theta*=1-s.dampingFactor,p.phi*=1-s.dampingFactor):p.set(0,0,0),f=1,m.set(0,0,0),!(!(g||o.distanceToSquared(s.object.position)>D||8*(1-a.dot(s.object.quaternion))>D)||(s.dispatchEvent(F),o.copy(s.object.position),a.copy(s.object.quaternion),g=!1))}),this.dispose=function(){s.domElement.removeEventListener("contextmenu",X,!1),s.domElement.removeEventListener("mousedown",k,!1),s.domElement.removeEventListener("wheel",B,!1),s.domElement.removeEventListener("touchstart",G,!1),s.domElement.removeEventListener("touchend",q,!1),s.domElement.removeEventListener("touchmove",W,!1),document.removeEventListener("mousemove",j,!1),document.removeEventListener("mouseup",N,!1),window.removeEventListener("keydown",V,!1)};var n,r,i,o,a,s=this,F={type:"change"},c={type:"start"},l={type:"end"},u={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},h=u.NONE,D=1e-6,d=new THREE.Spherical,p=new THREE.Spherical,f=1,m=new THREE.Vector3,g=!1,v=new THREE.Vector2,y=new THREE.Vector2,_=new THREE.Vector2,x=new THREE.Vector2,b=new THREE.Vector2,w=new THREE.Vector2,E=new THREE.Vector2,M=new THREE.Vector2,T=new THREE.Vector2;function S(){return Math.pow(.95,s.zoomSpeed)}function A(e){p.theta-=e}function H(e){p.phi-=e}P=new THREE.Vector3;var P,R,L,U=function(e,t){P.setFromMatrixColumn(t,0),P.multiplyScalar(-e),m.add(P)},z=(R=new THREE.Vector3,function(e,t){R.setFromMatrixColumn(t,1),R.multiplyScalar(e),m.add(R)}),C=(L=new THREE.Vector3,function(e,t){var n,r=s.domElement===document?s.domElement.body:s.domElement;s.object.isPerspectiveCamera?(n=s.object.position,L.copy(n).sub(s.target),n=L.length(),n*=Math.tan(s.object.fov/2*Math.PI/180),U(2*e*n/r.clientHeight,s.object.matrix),z(2*t*n/r.clientHeight,s.object.matrix)):s.object.isOrthographicCamera?(U(e*(s.object.right-s.object.left)/s.object.zoom/r.clientWidth,s.object.matrix),z(t*(s.object.top-s.object.bottom)/s.object.zoom/r.clientHeight,s.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),s.enablePan=!1)});function I(e){s.object.isPerspectiveCamera?f/=e:s.object.isOrthographicCamera?(s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom*e)),s.object.updateProjectionMatrix(),g=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),s.enableZoom=!1)}function O(e){s.object.isPerspectiveCamera?f*=e:s.object.isOrthographicCamera?(s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom/e)),s.object.updateProjectionMatrix(),g=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),s.enableZoom=!1)}function k(e){if(!1!==s.enabled){switch(e.preventDefault(),e.button){case s.mouseButtons.ORBIT:if(!1===s.enableRotate)return;v.set(e.clientX,e.clientY),h=u.ROTATE;break;case s.mouseButtons.ZOOM:if(!1===s.enableZoom)return;E.set(e.clientX,e.clientY),h=u.DOLLY;break;case s.mouseButtons.PAN:if(!1===s.enablePan)return;x.set(e.clientX,e.clientY),h=u.PAN}h!==u.NONE&&(document.addEventListener("mousemove",j,!1),document.addEventListener("mouseup",N,!1),s.dispatchEvent(c))}}function j(e){var t;if(!1!==s.enabled)switch(e.preventDefault(),h){case u.ROTATE:!1!==s.enableRotate&&(t=e,y.set(t.clientX,t.clientY),_.subVectors(y,v),t=s.domElement===document?s.domElement.body:s.domElement,A(2*Math.PI*_.x/t.clientWidth*s.rotateSpeed),H(2*Math.PI*_.y/t.clientHeight*s.rotateSpeed),v.copy(y),s.update());break;case u.DOLLY:!1!==s.enableZoom&&(M.set(e.clientX,e.clientY),T.subVectors(M,E),0<T.y?I(S()):T.y<0&&O(S()),E.copy(M),s.update());break;case u.PAN:!1!==s.enablePan&&(b.set(e.clientX,e.clientY),w.subVectors(b,x),C(w.x,w.y),x.copy(b),s.update())}}function N(e){!1!==s.enabled&&(document.removeEventListener("mousemove",j,!1),document.removeEventListener("mouseup",N,!1),s.dispatchEvent(l),h=u.NONE)}function B(e){!1===s.enabled||!1===s.enableZoom||h!==u.NONE&&h!==u.ROTATE||(e.preventDefault(),e.stopPropagation(),(e=e).deltaY<0?O(S()):0<e.deltaY&&I(S()),s.update(),s.dispatchEvent(c),s.dispatchEvent(l))}function V(e){if(!1!==s.enabled&&!1!==s.enableKeys&&!1!==s.enablePan)switch(e.keyCode){case s.keys.UP:C(0,s.keyPanSpeed),s.update();break;case s.keys.BOTTOM:C(0,-s.keyPanSpeed),s.update();break;case s.keys.LEFT:C(s.keyPanSpeed,0),s.update();break;case s.keys.RIGHT:C(-s.keyPanSpeed,0),s.update()}}function G(e){if(!1!==s.enabled){switch(e.touches.length){case 1:if(!1===s.enableRotate)return;v.set(e.touches[0].pageX,e.touches[0].pageY),h=u.TOUCH_ROTATE;break;case 2:if(!1===s.enableZoom)return;n=(t=e).touches[0].pageX-t.touches[1].pageX,t=t.touches[0].pageY-t.touches[1].pageY,n=Math.sqrt(n*n+t*t),E.set(0,n),h=u.TOUCH_DOLLY;break;case 3:if(!1===s.enablePan)return;x.set(e.touches[0].pageX,e.touches[0].pageY),h=u.TOUCH_PAN;break;default:h=u.NONE}var t,n;h!==u.NONE&&s.dispatchEvent(c)}}function W(e){var t,n;if(!1!==s.enabled)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:!1!==s.enableRotate&&h===u.TOUCH_ROTATE&&(n=e,y.set(n.touches[0].pageX,n.touches[0].pageY),_.subVectors(y,v),n=s.domElement===document?s.domElement.body:s.domElement,A(2*Math.PI*_.x/n.clientWidth*s.rotateSpeed),H(2*Math.PI*_.y/n.clientHeight*s.rotateSpeed),v.copy(y),s.update());break;case 2:!1!==s.enableZoom&&h===u.TOUCH_DOLLY&&(t=(n=e).touches[0].pageX-n.touches[1].pageX,n=n.touches[0].pageY-n.touches[1].pageY,t=Math.sqrt(t*t+n*n),M.set(0,t),T.subVectors(M,E),0<T.y?O(S()):T.y<0&&I(S()),E.copy(M),s.update());break;case 3:!1!==s.enablePan&&h===u.TOUCH_PAN&&(b.set(e.touches[0].pageX,e.touches[0].pageY),w.subVectors(b,x),C(w.x,w.y),x.copy(b),s.update());break;default:h=u.NONE}}function q(e){!1!==s.enabled&&(s.dispatchEvent(l),h=u.NONE)}function X(e){!1!==s.enabled&&e.preventDefault()}s.domElement.addEventListener("contextmenu",X,!1),s.domElement.addEventListener("mousedown",k,!1),s.domElement.addEventListener("wheel",B,!1),s.domElement.addEventListener("touchstart",G,!1),s.domElement.addEventListener("touchend",q,!1),s.domElement.addEventListener("touchmove",W,!1),window.addEventListener("keydown",V,!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls,Object.defineProperties(THREE.OrbitControls.prototype,{center:{get:function(){return console.warn("THREE.OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(e){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!e}},noRotate:{get:function(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(e){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!e}},noPan:{get:function(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(e){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!e}},noKeys:{get:function(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(e){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!e}},staticMoving:{get:function(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(e){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!e}},dynamicDampingFactor:{get:function(){return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(e){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=e}}})},{}],409:[function(e,t,n){t.exports=function(s){var E="front",M="back",T="straddle",S="on",A=function(t,e){var n,r=[],i=t.vertices.length,o=[],a=[],e=(e.forEach(function(e){return-1!==(n=t.vertices.indexOf(e.vertex))?r.push(n):(t.vertices.push(e.vertex),r.push(i),i+=1),e.normal&&o.push(e.normal),e.uv&&a.push(e.uv),!0}),new s.Face3(r[0],r[1],r[2],o));t.faces.push(e),a.length&&t.faceVertexUvs[0].push(a)},P=function(e,t,n){var r=new s.Line3(e.vertex,t.vertex),n=n.intersectLine(r);if(n)return r=e.vertex.distanceTo(n)/r.distance(),{vertex:n,normal:e.normal.clone().lerp(t.normal,r).normalize(),uv:e.uv&&t.uv?e.uv.clone().lerp(t.uv,r):null}},R=function(e,t){e=e.distanceToPoint(t);return e<0?M:0<e?E:S};return function(y,_){var x,b,w=new s.Geometry;return y.faces.forEach(function(e,t){var n,r,i,o,a,s;if(r=e,i=t,o=(n=y).faceVertexUvs[0],x=["a","b","c"].map(function(e,t){return{vertex:n.vertices[r[e]],normal:r.vertexNormals[t],uv:o[i]?o[i][t]:void 0}}),a=R(e=_,(t=x)[0].vertex),s=R(e,t[1].vertex),e=R(e,t[2].vertex),(b=a!=M&&s!=M&&e!=M?a!=E&&s!=E&&e!=E?S:a!=M&&s!=M&&e!=M?E:T:a!=E&&s!=E&&e!=E?M:T)==E||b==S)A(w,x);else if(b==T){for(var c,l,u,h,d,p=_,t=w,f=x,m=f.length,g=[],v=0;v<m;v++)c=f[v],l=v+1<m?f[v+1]:f[0],u=P(c,l,p),h=R(p,c.vertex),d=R(p,l.vertex),h==E&&-1===g.indexOf(c)&&g.push(c),u&&g.push(u),d==E&&-1===g.indexOf(l)&&g.push(l);3<g.length?(A(t,[g[0],g[1],g[2]]),A(t,[g[2],g[3],g[0]])):A(t,g)}}),w}}},{}],410:[function(e,t,n){var r,i;r=this,i=function(){return r=[function(e,t){e.exports=(()=>{if("undefined"==typeof document||"undefined"==typeof window)return{ask:function(){return"initial"},element:function(){return null},ignoreKeys:function(){},specificKeys:function(){},registerOnChange:function(){},unRegisterOnChange:function(){}};var t=document.documentElement,n=null,i="initial",o=i,r=Date.now(),a=!1,s=["button","input","select","textarea"],c=[],l=[16,17,18,91,93],u=[],h={keydown:"keyboard",keyup:"keyboard",mousedown:"mouse",mousemove:"mouse",MSPointerDown:"pointer",MSPointerMove:"pointer",pointerdown:"pointer",pointermove:"pointer",touchstart:"touch",touchend:"touch"},d=!1,p={x:null,y:null},f={2:"touch",3:"touch",4:"mouse"},m=!1;try{var e=Object.defineProperty({},"passive",{get:function(){m=!0}});window.addEventListener("test",null,e)}catch(e){}function g(){var e=!m||{passive:!0,capture:!0};document.addEventListener("DOMContentLoaded",v,!0),window.PointerEvent?(window.addEventListener("pointerdown",y,!0),window.addEventListener("pointermove",x,!0)):window.MSPointerEvent?(window.addEventListener("MSPointerDown",y,!0),window.addEventListener("MSPointerMove",x,!0)):(window.addEventListener("mousedown",y,!0),window.addEventListener("mousemove",x,!0),"ontouchstart"in window&&(window.addEventListener("touchstart",y,e),window.addEventListener("touchend",y,!0))),window.addEventListener(S(),x,e),window.addEventListener("keydown",y,!0),window.addEventListener("keyup",y,!0),window.addEventListener("focusin",b,!0),window.addEventListener("focusout",w,!0)}var v=function(){if(a=!("false"===t.getAttribute("data-whatpersist")||"false"===document.body.getAttribute("data-whatpersist")))try{window.sessionStorage.getItem("what-input")&&(i=window.sessionStorage.getItem("what-input")),window.sessionStorage.getItem("what-intent")&&(o=window.sessionStorage.getItem("what-intent"))}catch(e){}_("input"),_("intent")},y=function(e){var t=e.which,n=h[e.type],e=("pointer"===n&&(n=M(e)),!u.length&&-1===l.indexOf(t)),r=u.length&&-1!==u.indexOf(t),t="keyboard"===n&&t&&(e||r)||"mouse"===n||"touch"===n;(t=T(n)?!1:t)&&i!==n&&(E("input",i=n),_("input")),t&&o!==n&&(e=document.activeElement)&&e.nodeName&&(-1===s.indexOf(e.nodeName.toLowerCase())||"button"===e.nodeName.toLowerCase()&&!R(e,"form"))&&(E("intent",o=n),_("intent"))},_=function(e){t.setAttribute("data-what"+e,"input"===e?i:o),A(e)},x=function(e){var t=h[e.type];"pointer"===t&&(t=M(e)),P(e),(!d&&!T(t)||d&&"wheel"===e.type||"mousewheel"===e.type||"DOMMouseScroll"===e.type)&&o!==t&&(E("intent",o=t),_("intent"))},b=function(e){e.target.nodeName?(n=e.target.nodeName.toLowerCase(),t.setAttribute("data-whatelement",n),e.target.classList&&e.target.classList.length&&t.setAttribute("data-whatclasses",e.target.classList.toString().replace(" ",","))):w()},w=function(){n=null,t.removeAttribute("data-whatelement"),t.removeAttribute("data-whatclasses")},E=function(e,t){if(a)try{window.sessionStorage.setItem("what-"+e,t)}catch(e){}},M=function(e){return"number"==typeof e.pointerType?f[e.pointerType]:"pen"===e.pointerType?"touch":e.pointerType},T=function(e){var t=Date.now(),e="mouse"===e&&"touch"===i&&t-r<200;return r=t,e},S=function(){return"onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll"},A=function(e){for(var t=0,n=c.length;t<n;t++)c[t].type===e&&c[t].fn.call(void 0,"input"===e?i:o)},P=function(e){p.x!==e.screenX||p.y!==e.screenY?(d=!1,p.x=e.screenX,p.y=e.screenY):d=!0},R=function(e,t){var n=window.Element.prototype;if(n.matches||(n.matches=n.msMatchesSelector||n.webkitMatchesSelector),n.closest)return e.closest(t);do{if(e.matches(t))return e}while(null!==(e=e.parentElement||e.parentNode)&&1===e.nodeType);return null};return"addEventListener"in window&&Array.prototype.indexOf&&(h[S()]="mouse",g()),{ask:function(e){return"intent"===e?o:i},element:function(){return n},ignoreKeys:function(e){l=e},specificKeys:function(e){u=e},registerOnChange:function(e,t){c.push({fn:e,type:t||"input"})},unRegisterOnChange:function(e){e=(e=>{for(var t=0,n=c.length;t<n;t++)if(c[t].fn===e)return t})(e);!e&&0!==e||c.splice(e,1)},clearStorage:function(){window.sessionStorage.clear()}}})()}],i={},n.m=r,n.c=i,n.p="",n(0);function n(e){var t;return(i[e]||(t=i[e]={exports:{},id:e,loaded:!1},r[e].call(t.exports,t,t.exports,n),t.loaded=!0,t)).exports}var r,i},"object"==typeof n&&"object"==typeof t?t.exports=i():"function"==typeof define&&define.amd?define("whatInput",[],i):"object"==typeof n?n.whatInput=i():r.whatInput=i()},{}],411:[function(e,t,n){function r(){this.isActive=!0,this.setInactive(),document.addEventListener("mousemove",this.move.bind(this)),document.addEventListener("touchmove",this.move.bind(this)),document.addEventListener("keydown",this.start.bind(this)),document.addEventListener("mousedown",this.start.bind(this)),document.addEventListener("touchstart",this.start.bind(this)),document.addEventListener("mouseup",this.end.bind(this)),document.addEventListener("touchend",this.end.bind(this)),document.addEventListener("keyup",this.end.bind(this))}r.prototype.clearTimeout=function(){this.timeout&&(clearTimeout(this.timeout),delete this.timeout)},r.prototype.move=function(){this.end()},r.prototype.start=function(){this.clearTimeout(),this.setActive()},r.prototype.end=function(){var e=this;this.clearTimeout(),this.timeout=setTimeout(function(){e.clearTimeout(),e.setInactive()},2500),this.setActive()},r.prototype.setActive=function(){this.isActive||(this.isActive=!0,document.body.classList.remove("activity-monitor-inactive"))},r.prototype.setInactive=function(){this.isActive&&(this.isActive=!1,document.body.classList.add("activity-monitor-inactive"))},t.exports=r},{}],412:[function(e,t,n){function o(e){var t=e.startPoint||0,n=e.loopPoint;if(!n)throw new Error("Specify a loopPoint");if(n<=t)throw new Error("startPoint must be before loopPoint");this.loopPoint=n,this.startPoint=t,this.sound=new a.Howl(e)}var a=e("howler");o.prototype.play=function(){var e=this,t=(this.sound.once("seek",function(){e.timeout=setTimeout(e._loop.bind(e),e.loopPoint-e.startPoint)}),this.sound.play());this.sound.seek(this.startPoint/1e3,t)},o.prototype.stop=function(){clearTimeout(this.timeout),this.sound.stop()},o.prototype.volume=function(e){this.sound.volume(e)},o.prototype.mute=function(e){this.sound.mute(e)},o.prototype._loop=function(){var e=this;this.sound.once("play",function(){e.timeout=setTimeout(e._loop.bind(e),e.loopPoint)}),this.sound.play()},t.exports=function(e){var t=0,n=(a.Howler.volume(t),new o({src:["audio/ambience.mp3"],loopPoint:19250,volume:.5})),r=(n.play(),e.on("crystal.growth",function(e){e=Math.max(e,t);e!==t&&(t=e,a.Howler.volume(Math.pow(e,2)))}),!1),i=new o({src:["audio/hyper.mp3"],volume:0,loopPoint:4790});e.on("hyper-power",function(e){e&&!r&&(i.play(),r=!0),i.volume(e),!e&&r&&(i.stop(),r=!1)}),e.on("mute",function(){n.mute(!0),i.mute(!0)}),e.on("unmute",function(){n.mute(!1),i.mute(!1)})}},{howler:365}],413:[function(e,t,n){function r(e,t){var n=this,r=(this.app=e,this.object=t,this.speed=.075,this.time=0,this.rotation=0,this.currentSpeed=0,this.targetSpeed=0,this.startAcceleration=1,this.stopAcceleration=5,this.direction=1,e.eventMediator.on("soil.mouseover",this.interactBegin.bind(this)),e.eventMediator.on("soil.touchstart",this.interactBegin.bind(this)),e.eventMediator.on("soil.mouseout",this.interactEnd.bind(this)),e.eventMediator.on("scene.touchend",this.interactEnd.bind(this)),e.eventMediator.on("update",this.update.bind(this)),0),i=!1;e.eventMediator.on("camera.rotate.azimuth",function(e){e+=Math.PI;var t=THREE.Math.euclideanModulo(r-e+3*Math.PI,2*Math.PI)-Math.PI;Math.abs(t)<.001?i&&(i=!1,n.interactEnd()):i||(i=!0,n.interactBegin()),n.direction=t<0?-1:1,r=e}),e.eventMediator.on("crystal.growth",this.crystalGrowth.bind(this))}r.prototype.interactBegin=function(){this.pause()},r.prototype.interactEnd=function(){this.resume()},r.prototype.crystalGrowth=function(){this.wasRotating=!1,this.stop(),this.start(3e3)},r.prototype.pause=function(){this.rotating&&(this.wasRotating=!0),this.stop()},r.prototype.resume=function(){this.wasRotating?(this.wasRotating=!1,this.start()):this.wasWaiting?(this.wasWaiting=!1,this.start(3e3)):this.delay&&(this.stop(),this.start(3e3))},r.prototype.start=function(e){var t=this;e||this.rotating||(this.rotating=!0,this.rotateOn()),e&&!this.delay&&(this.delay=setTimeout(function(){delete t.delay,t.start()},e))},r.prototype.stop=function(){this.delay&&(clearTimeout(this.delay),delete this.delay,this.wasWaiting=!0),this.rotating&&(this.rotating=!1,this.rotateOff())},r.prototype.update=function(){var e=this.app.delta,t=this.rotating?this.startAcceleration:this.stopAcceleration,t=(this.targetSpeed-this.currentSpeed)*t*e;this.currentSpeed=0<t?Math.min(this.targetSpeed,this.currentSpeed+t):Math.max(this.targetSpeed,this.currentSpeed+t),this.rotation+=this.currentSpeed*e,this.object.setRotation(this.rotation)},r.prototype.rotateOn=function(){this.targetSpeed=this.speed*this.direction},r.prototype.rotateOff=function(){this.targetSpeed=0},t.exports=r},{}],414:[function(e,t,n){function r(e,t,n){n=new THREE.Mesh(n,i.containerBack),e.add(n),this.mesh=n}var i=e("./materials");r.prototype.setVisible=function(e){this.mesh.visible=e},t.exports=r},{"./materials":433}],415:[function(e,t,n){t.exports=function(){var e=new THREE.IcosahedronGeometry(1,1);return e.computeFlatVertexNormals(),e}},{}],416:[function(e,t,n){function r(e,t,n){n=i.wireframeMesh(n,.0025),n=new THREE.Mesh(n,o.containerWireframe),e.add(n),this.mesh=n}var i=e("./geometry-tools"),o=e("./materials");r.prototype.setVisible=function(e){this.mesh.visible=e},t.exports=r},{"./geometry-tools":423,"./materials":433}],417:[function(e,t,n){e("./materials");t.exports=function(e){var t,n=e.eventMediator;n.on("ready",function(){t=setTimeout(function(){t=void 0,e.terrarium.soil.showHighlight(!0)},4e3)}),n.on("crystal.growth",function(){t?(clearTimeout(t),t=void 0):e.terrarium.soil.showHighlight(!1)}),e.eventMediator.on("crystal.click",function(){e.hyperMap.addWave()})}},{"./materials":433}],418:[function(e,t,n){function r(e,t){var n=t.history,t=t.eventMediator,r=document.querySelector(".controls-undo"),i=document.querySelector(".controls-mute");this.eventMediator=t,this.muted=!1,r.addEventListener("click",n.undo.bind(n)),i.addEventListener("click",this.toggleMute.bind(this)),t.on("history",function(){n.undoStack.length?r.removeAttribute("disabled"):r.setAttribute("disabled","")})}r.prototype.toggleMute=function(){this.muted?(this.eventMediator.emit("unmute"),document.body.classList.remove("muted"),this.muted=!1):(this.eventMediator.emit("mute"),document.body.classList.add("muted"),this.muted=!0)},t.exports=r},{}],419:[function(e,t,n){function r(e,t){function n(){Object.keys(i).forEach(function(e){var t=a(r,e);t!==a(o,e)&&i[e](t)}),o=Object.assign({},r)}t.interactionPublisher.add(e,"crystal",!0),this.eventMediator=t.eventMediator;var r={cursorVisible:!1,isOver:!1,hover:function(e){return e.isOver&&!e.cursorVisible}},i={hover:function(e){this.hover(e)}.bind(this)},o=r,a=function(e,t){t=e[t];return"function"==typeof t?t(e):t},e=(t.eventMediator.on("soil-cursor.visible",function(){r.cursorVisible=!0,n()}),t.eventMediator.on("soil-cursor.hidden",function(){r.cursorVisible=!1,n()}),function(e,t){-1==t.indexOf("soil")&&this.click()}.bind(this));t.eventMediator.on("crystal.mousedown",e),t.eventMediator.on("crystal.touchstart",e),t.eventMediator.on("crystal.mouseover",function(){r.isOver=!0,n()}),t.eventMediator.on("crystal.mouseout",function(){r.isOver=!1,n()})}r.prototype.hover=function(e){e?document.body.classList.add("show-pointer"):document.body.classList.remove("show-pointer")},r.prototype.click=function(){this.eventMediator.emit("crystal.click")},t.exports=r},{}],420:[function(e,t,n){var s=e("ThreeCSG")(THREE);function m(e,t,n,r){e=new THREE.Vector3(0,Math.cos((.5*e-.5)*Math.PI),Math.sin((.5*e-.5)*Math.PI)),e.applyAxisAngle(new THREE.Vector3(0,0,1),t*Math.PI*2),r&&(e=e.negate()),t=(new THREE.Plane).setFromNormalAndCoplanarPoint(e,n);return[t.normal.toArray(),t.constant]}function r(){this.size=100,this.box=new THREE.Mesh(new THREE.BoxGeometry(this.size,this.size,this.size))}r.prototype={extrude:function(e,t,n){for(var r=new THREE.Shape,i=(r.moveTo(e[0][0],e[0][1]),e.slice(1).forEach(function(e){r.lineTo(e[0],e[1])}),r.lineTo(e[0][0],e[0][1]),new THREE.ExtrudeGeometry(r,{steps:1,amount:t,bevelEnabled:!1})),o=0;o<e.length;o++){var a=i.vertices[o+e.length];a.x=a.x*n,a.y=a.y*n}return new s(i)},slice:function(e,t){var n=(new THREE.Vector3).fromArray(t[0]),t=new THREE.Plane(n,t[1]),t=(this.box.position.copy(n),.5*this.size+t.constant),t=(this.box.position.multiplyScalar(-1*t),this.box.lookAt(n),new s(this.box));return e.subtract(t)},asThreeGeometry:function(e){return e.toGeometry()}};var g=new r;t.exports=function(t,n){for(var r,i,e,o,a,s,c=g,l=(r=t.sides,i=t.diameter,Array.apply(null,Array(r)).map(function(e,t){t=t/r*Math.PI*2;return[Math.sin(t)*i,Math.cos(t)*i]})),u=t.doubleSide||!1,h=(l.forEach(function(e){e[0]+=.2*(2*n()-1)*t.diameter,e[1]+=.2*(2*n()-1)*t.diameter}),c.extrude(l,t.height,t.topScale)),d=new THREE.Vector3(0,0,t.height),p=2*Math.PI/(2*t.topFacets),f=0;f<t.topFacets;f++)e=.05*(2*n()-1),o=.1*(2*n()-1),a=f/t.topFacets+p+e,s=m(t.topSlope+o,a,d),h=c.slice(h,s);if(u)for(d=new THREE.Vector3(0,0,0),f=0;f<t.topFacets;f++)e=.05*(2*n()-1),o=.1*(2*n()-1),a=f/t.topFacets+p+e,s=m(t.topSlope+o,a,d,!0),h=c.slice(h,s);return c.asThreeGeometry(h)}},{ThreeCSG:3}],421:[function(e,t,n){function r(e,t){this.app=t,this.crystals=[],this.object=new THREE.Group,e.add(this.object),this.material=i.crystal,this.material.uniforms.seed.value=Math.random(),this.material.uniforms.height.value=1,this.material.uniforms.scale.value=1,e=new THREE.SphereGeometry(.1,2,2),(e=new THREE.Mesh(e,this.material)).position.set(0,-.6,0),this.object.add(e),t.eventMediator.on("soil-cursor.down",this.onMouseDown.bind(this)),t.eventMediator.on("soil-cursor.up",this.onMouseUp.bind(this)),new a(this.object,t)}var d=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var n=t,r=[],i=!0,t=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(r.push(a.value),!n||r.length!==n);i=!0);}catch(e){t=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw o}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=e("./materials"),o=e("./crystal"),a=e("./crystal-click");r.prototype.onMouseDown=function(e){var t=e.point.clone(),e=(this.object.worldToLocal(t),e.normal.clone()),t=new o(this.object,this.app,t,e,this.material);this.crystals.push(t),this.activeCrystal=t,this.adjustNormals()},r.prototype.onMouseUp=function(){this.activeCrystal&&(this.activeCrystal.stopGrowth(),this.app.history.add({destroy:this.destroy.bind(this,this.activeCrystal),restore:this.restore.bind(this,this.activeCrystal)}),delete this.activeCrystal)},r.prototype.destroy=function(t){t.destroy(),this.crystals=this.crystals.filter(function(e){return e!==t}),this.clearIdealNormalsCache(t),this.adjustNormals()},r.prototype.restore=function(e){e.restore(),this.crystals.push(e),this.activeCrystal=e,this.adjustNormals()},r.prototype.clearIdealNormalsCache=function(t){this.crystals.forEach(function(e){e.idealNormals.hasOwnProperty(t.id)&&delete e.idealNormals[t.id]})},r.prototype.adjustNormals=function(){var h=this;this.crystals.forEach(function(i){h.crystals.forEach(function(e){var t,n,r;i===e||i.idealNormals.hasOwnProperty(e.id)||(n=i.normal.clone().add(e.normal).normalize(),r=i.position.clone().sub(e.position).normalize(),r=n.clone().cross(r),t=n.clone().applyAxisAngle(r,.3),n=n.clone().applyAxisAngle(r,-.3),r=i.position.distanceTo(e.position),i.idealNormals[e.id]=[t,r],e.idealNormals[i.id]=[n,r])})}),this.crystals.forEach(function(e){var t=e.normal.clone(),n=!0,r=!1,i=void 0;try{for(var o,a=Object.entries(e.idealNormals)[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s,c=d(o.value,2),l=(c[0],c[1]),u=Math.max(1-l[1],0);u&&(u=Math.pow(u,2),(s=l[0].clone()).multiplyScalar(u),t.add(s))}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}t.normalize();r=500*e.position.distanceTo(h.activeCrystal.position);r+=500*Math.random(),e.setDirection(t,!0,r)})},r.prototype.setVisible=function(e){this.object.visible=e},t.exports=r},{"./crystal":422,"./crystal-click":419,"./materials":433}],422:[function(e,t,n){function r(e,n,t,r,i){var o=this,a=(this.app=n,this.parent=e,this.idealNormals={},this.position=t,this.normal=r,Math.random()),i=(this.material=i.clone(),this.material.uniforms.seed.value=a,this.createGeometry(a));(a=new THREE.Mesh(i,this.material)).castShadow=!0;(u=new THREE.Group).add(a),e.add(u);var e=Math.random(),e=(u.up=new THREE.Vector3(Math.sin(e),0,Math.cos(e)),this.mesh=a,this.group=u,this.id=a.id,u.position.copy(t),this.setDirection(r),i.computeBoundingSphere(),i.boundingSphere),a=(this.height=2*e.radius,n.TWEEN),s=0,c={t:0},l={t:0},u=new a.Tween(c).to({t:.2},500).easing(a.Easing.Sinusoidal.Out).onComplete(function(){s+=1}),h=(this.growTween=new a.Tween(l).to({t:1},5e3).easing(a.Easing.Sinusoidal.Out).onUpdate(function(e,t){n.eventMediator.emit("crystal.growth",t)}).onComplete(function(){s+=1}).onStop(function(){s+=1}),new a.Tween({t:0}).to({t:1},1).repeat(1/0).onUpdate(function(){2<=s?h.stop():o.setSize(c.t+.8*l.t)}));u.start(),this.growTween.start(),h.start()}var i=e("./crystal-gen"),o=e("random-seed");r.prototype.setSize=function(e){var t=THREE.Math.lerp(.2,1,this.app.TWEEN.Easing.Sinusoidal.In(e)),e=THREE.Math.lerp(1,0,this.app.TWEEN.Easing.Sinusoidal.Out(e)),n=this.height*t,r=-1*(n-.01)*e-.01;this.mesh.scale.set(t,t,t),this.mesh.position.set(0,0,r),this.material.uniforms.bottomClip.value=(this.height-.01/t)*e,this.material.uniforms.height.value=n,this.material.uniforms.scale.value=t},r.prototype.setDirection=function(e,t,n){var r,i,o=this,e=(this.directionTween&&this.directionTween.stop(),this.position.clone().add(e));t?(n=n||0,(t=new THREE.Matrix4).lookAt(e,this.group.position,this.group.up),r=(new THREE.Quaternion).setFromRotationMatrix(t),i=this.group.quaternion.clone(),this.directionTween=new this.app.TWEEN.Tween({t:0}).to({t:1},750+n).easing(this.app.TWEEN.Easing.Quadratic.InOut).onUpdate(function(e){THREE.Quaternion.slerp(i,r,o.group.quaternion,e.t)}).delay(n).start()):this.group.lookAt(e)},r.prototype.createGeometry=function(e){e=o(e).random,e=i({sides:5,diameter:.125,height:1.25,topSlope:.7,topFacets:3,topScale:1.5},e);return e.computeFlatVertexNormals(),e},r.prototype.stopGrowth=function(){this.growTween.stop()},r.prototype.destroy=function(){this.parent.remove(this.group)},r.prototype.restore=function(){this.parent.add(this.group)},t.exports=r},{"./crystal-gen":420,"random-seed":405}],423:[function(e,t,n){function x(t,e){return e=M.FaceVertices(e).slice(0,3).map(function(e){return(new THREE.Vector3).fromArray(t.positions[e.index])}),(new THREE.Plane).setFromCoplanarPoints(e[0],e[1],e[2]).normal}function b(e,t){var n,r=e.normal.clone().cross(t.normal),i=r.lengthSq();if(i)return n=r.clone().cross(t.normal).multiplyScalar(e.constant),e=e.normal.clone().cross(r).multiplyScalar(t.constant),t=n.add(e).divideScalar(i),n=r.normalize(),new THREE.Ray(t,n)}function w(e){var t=e.vertices.map(function(e){return[e.x,e.y,e.z]}),e=e.faces.map(function(e){return[e.a,e.b,e.c]}),n=new M.Mesh;return n.setPositions(t),n.setCells(e),n.process(),n}function E(e){M.TriangulateOperator(e);var t=e.getPositions(),e=e.getCells(),n=new THREE.Geometry;return n.vertices=t.map(function(e){return(new THREE.Vector3).fromArray(e)}),n.faces=e.map(function(e){return new THREE.Face3(e[0],e[1],e[2])}),n}var M=e("mda");t.exports={wireframeMesh:function(e,a){for(var t,n,r,i,s=new Array(e.vertices.length),o=0,c=e.vertices.length;o<c;o++)s[o]=new THREE.Vector3;for(var l=new THREE.Vector3,u=new THREE.Vector3,h=0,d=e.faces.length;h<d;h++)t=e.faces[h],n=e.vertices[t.a],r=e.vertices[t.b],i=e.vertices[t.c],l.subVectors(i,r),u.subVectors(n,r),l.cross(u),s[t.a].add(l),s[t.b].add(l),s[t.c].add(l);for(o=0,c=s.length;o<c;o++)s[o].normalize();var p=w(e),f=[],m=[],g=[],v=new THREE.Vector3,y=new THREE.Vector3,_=(p.edges.forEach(function(e){var t=e.halfEdge,n=t.flipHalfEdge,r=x(p,t.face),i=x(p,n.face),i=(r.add(i).normalize(),v.fromArray(p.positions[t.vertex.index]),y.fromArray(p.positions[n.vertex.index]),e.topPlane=(new THREE.Plane).setFromNormalAndCoplanarPoint(r,v),v.sub(y).cross(r).normalize(),(new THREE.Plane).setFromNormalAndCoplanarPoint(v,y)),t=i.clone().negate();e.halfEdge.sidePlane=i,e.halfEdge.flipHalfEdge.sidePlane=t}),p.halfEdges.forEach(function(e){var t=e.edge.topPlane.clone(),n=e.edge.topPlane.clone(),r=(t.constant-=a,n.constant+=a,e.nextHalfEdge),i=e.sidePlane.clone(),o=r.sidePlane.clone(),i=(i.constant-=a,o.constant-=a,b(i,o)),o=i.intersectPlane(t),t=i.intersectPlane(n),i=f.length,n=(f.push(o.toArray()),f.push(t.toArray()),s[r.vertex.index]),r=(new THREE.Color).fromArray(n.toArray());g.push(r),g.push(r),e.vTopIndex=i,e.vBottomIndex=i+1,e.vTop=o,e.vBottom=t}),p.edges.forEach(function(e){var e=e.halfEdge,t=e.flipHalfEdge,n=M.HalfEdgePrev(e),r=M.HalfEdgePrev(t);m.push([e.vTopIndex,e.vBottomIndex,n.vBottomIndex,n.vTopIndex]),m.push([t.vTopIndex,t.vBottomIndex,r.vBottomIndex,r.vTopIndex]),m.push([e.vTopIndex,n.vTopIndex,t.vTopIndex,r.vTopIndex]),m.push([r.vBottomIndex,t.vBottomIndex,n.vBottomIndex,e.vBottomIndex])}),p.vertices.forEach(function(e){var e=M.VertexHalfEdges(e).map(function(e){return e.flipHalfEdge}),t=e.map(function(e){return e.vTopIndex}),e=(e.reverse(),e.map(function(e){return e.vBottomIndex}));m.push(t),m.push(e)}),new M.Mesh);return _.setPositions(f),_.setCells(m),_.process(),(e=E(_)).faces.forEach(function(t){t.vertexColors=["a","b","c"].map(function(e){return g[t[e]]})}),e}}},{mda:367}],424:[function(e,t,n){function r(e){this.eventMediator=e,this.undoStack=[],this.redoStack=[],this.publishUpdates()}r.prototype.add=function(e){this.undoStack.push(e),this.redoStack=[],this.publishUpdates()},r.prototype.undo=function(){var e=this.undoStack.pop();e.destroy(),this.redoStack.push(e),this.publishUpdates()},r.prototype.redo=function(){var e=this.redoStack.pop();e.restore(),this.undoStack.push(e),this.publishUpdates()},r.prototype.publishUpdates=function(){this.eventMediator.emit("history")},t.exports=r},{}],425:[function(e,t,n){function r(e){var t=this;this.eventMediator=e,this.waves=[],this.waveDuration=3,this.wavePower=.75,this.dataTexture=[0,0,0,0],this.tapSpeed=0,this.lastTap=0,e.on("update",function(e){e&&t.update(e)})}e("@tweenjs/tween.js");r.prototype.addWave=function(){var e=Date.now(),t=e-this.lastTap;this.tapSpeed=Math.max(0,500-t)/500,this.lastTap=e,this.waves.length<this.dataTexture.length&&this.waves.unshift(0)},r.prototype.update=function(t){var n,r=this,i=(t/=this.waveDuration,0),o=(this.waves=this.waves.map(function(e){return.5<r.tapSpeed&&.2<e&&e<.35?.25:e+t}).filter(function(e){return!(.2<e&&e<.35&&2<(i+=1))}).filter(function(e){return e<=1}),0);this.dataTexture.forEach(function(e,t){n=t<r.waves.length?r.waves[t]:0,r.dataTexture[t]=n,n=Math.min(1,1.5*n),o+=.5*(.5*Math.sin(n*Math.PI*2-.5*Math.PI)+.5)}),this.publishPower(Math.min(1,o)),this.tapSpeed*=.9},r.prototype.publishPower=function(e){e!==this.power&&this.eventMediator.emit("hyper-power",e),this.power=e},t.exports=r},{"@tweenjs/tween.js":2}],426:[function(e,t,n){function r(e,t,n){var r=new THREE.InstancedBufferGeometry,i=(r.attributes.position=e.attributes.position,r.attributes.normal=e.attributes.normal,this.objectMap=[],[]),o=[],a=[],s=[],c=(new THREE.Matrix4,new THREE.Vector3),l=new THREE.Quaternion,u=new THREE.Vector3;n.forEach(function e(t){t.updateMatrixWorld(),t.children.length?t.children.forEach(e.bind(this)):(t.matrixWorld.decompose(c,l,u),i.push(c.x,c.y,c.z),o.push(l.x,l.y,l.z,l.w),a.push(u.x,u.y,u.z),s.push(t.spec&&t.spec.variant||0),this.objectMap.length,this.objectMap.push(t))}.bind(this)),this.positionAttr=new THREE.InstancedBufferAttribute(new Float32Array(i),3).setDynamic(!0),this.quaternionAttr=new THREE.InstancedBufferAttribute(new Float32Array(o),4).setDynamic(!0),this.scaleAttr=new THREE.InstancedBufferAttribute(new Float32Array(a),3).setDynamic(!0),this.variantAttr=new THREE.InstancedBufferAttribute(new Float32Array(s),1),r.addAttribute("instancePosition",this.positionAttr),r.addAttribute("instanceQuaternion",this.quaternionAttr),r.addAttribute("instanceScale",this.scaleAttr),r.addAttribute("instanceVariant",this.variantAttr),this.mesh=new THREE.Mesh(r,t)}r.prototype.update=function(){for(var e=new THREE.Vector3,t=new THREE.Quaternion,n=new THREE.Vector3,r=0;r<this.objectMap.length;r++)this.objectMap[r].matrixWorld.decompose(e,t,n),this.positionAttr.setXYZ(r,e.x,e.y,e.z),this.quaternionAttr.setXYZW(r,t.x,t.y,t.z,t.w),this.scaleAttr.setXYZ(r,n.x,n.y,n.z);this.positionAttr.needsUpdate=!0,this.quaternionAttr.needsUpdate=!0,this.scaleAttr.needsUpdate=!0},t.exports=r},{}],427:[function(e,t,n){function r(e,t,n,r){this.camera=t,this.eventMediator=n,this.log=r,this.rayCaster=new THREE.Raycaster,this.objects=[],this.objectStates=[],this.objectStateMap={},this.showObjects=[],this.isTouchDevice=!1,e.addEventListener("mousemove",this.mouseMove.bind(this),!1),e.addEventListener("mousedown",this.mouseDown.bind(this),!1),e.addEventListener("mouseup",this.mouseUp.bind(this),!1),e.addEventListener("touchstart",this.touchStart.bind(this),!1),e.addEventListener("touchmove",this.touchMove.bind(this),!1),e.addEventListener("touchend",this.touchEnd.bind(this),!1)}r.prototype.TOUCH_HOLD_DELAY=500,r.prototype.TOUCH_HOLD_ALLOW_MOVEMENT=10,r.prototype.add=function(e,t,n){this.objects.push(e);t={namespace:t,isOver:!1,isTouchDown:!1,isTouchHoldDown:!1};this.objectStates.push(t),this.objectStateMap[e.id]=t,n&&this.show(e)},r.prototype.show=function(e){this.showObjects.push(e)},r.prototype.mouseMove=function(e){var n;e.preventDefault(),this.isTouchDevice||(n=this.findIntersections(e),this.objectStates.forEach(function(e){var t=-1!==n.indexOf(e);t&&!e.isOver&&(this.emit("mouseover",e),e.isOver=!0),!t&&e.isOver&&(this.emit("mouseout",e,!1),e.isOver=!1),t&&this.emit("mousemove",e)}.bind(this)),this.emit("mousemove"))},r.prototype.mouseDown=function(e){e.preventDefault(),this.isTouchDevice||(this.findIntersections(e).forEach(function(e){this.emit("mousedown",e)}.bind(this)),this.emit("mousedown"))},r.prototype.mouseUp=function(e){e.preventDefault(),this.isTouchDevice||(this.findIntersections(e).forEach(function(e){this.emit("mouseup",e)}.bind(this)),this.emit("mouseup"))},r.prototype.touchHoldDown=function(e){e.isTouchHoldDown=!0,this.emit("touchholddown",e)},r.prototype.touchStart=function(t){t.preventDefault(),this.isTouchDevice=!0,1<t.touches.length||(t=t.touches[0],this.findIntersections(t).forEach(function(e){this.emit("touchstart",e),e.isTouchDown=!0,e.isTouchHoldDown||this.initTouchHold(t,e)}.bind(this)),this.emit("touchstart"))},r.prototype.initTouchHold=function(e,t){t.touchStartPosition=this.eventPositionPx(e);e=this.touchHoldDown.bind(this,t);t.touchHoldTimeout=setTimeout(e,this.TOUCH_HOLD_DELAY),this.emit("touchholdstart",t,!1)},r.prototype.touchMove=function(n){n.preventDefault(),n=n.touches[0],this.findIntersections(n).forEach(function(e){this.emit("touchmove",e)}.bind(this)),this.objectStates.forEach(function(e){var t;!e.isTouchHoldDown&&e.touchHoldTimeout&&(t=this.eventPositionPx(n),e.touchStartPosition.distanceTo(t)<this.TOUCH_HOLD_ALLOW_MOVEMENT||(clearTimeout(e.touchHoldTimeout),delete e.touchHoldTimeout,this.emit("touchholdend",e,!1),this.initTouchHold(n,e)))}.bind(this)),this.emit("touchmove")},r.prototype.touchEnd=function(e){e.preventDefault(),e=e.changedTouches[0],this.objectStates.forEach(function(e){e.isTouchDown&&(e.isTouchDown=!1),(e.touchHoldTimeout||e.isTouchHoldDown)&&this.emit("touchholdend",e,!1),e.isTouchHoldDown&&(e.isTouchHoldDown=!1),e.touchHoldTimeout&&(clearTimeout(e.touchHoldTimeout),delete e.touchHoldTimeout)}.bind(this)),this.findIntersections(e).forEach(function(e){this.emit("touchend",e)}.bind(this)),this.eventMediator.emit("scene.touchend")},r.prototype.findIntersections=function(e){var e=this.eventPosition(e),e=(this.rayCaster.setFromCamera(e,this.camera),this.showObjects.filter(function(e){if(!e.visible)return e.visible=!0})),n={},t=[],t=(this.flattenObjects(this.objects,t,n),this.rayCaster.intersectObjects(t)),r=(e.forEach(function(e){e.visible=!1}),[]),e=t.map(function(e){var t=e.object,t=n[t.id],t=this.objectStateMap[t];return t.intersect=e,r.push(t.namespace),t}.bind(this));return e.forEach(function(e){e.alsoIntersected=r}),e},r.prototype.flattenObjects=function(e,t,n,r){for(var i=e.length,o=0;o<i;o++){var a=e[o],s=r||a.id;a.children.length?this.flattenObjects(a.children,t,n,s):(t.push(a),n[a.id]=s)}},r.prototype.eventPosition=function(e){return new THREE.Vector2(e.clientX/window.innerWidth*2-1,-e.clientY/window.innerHeight*2+1)},r.prototype.eventPositionPx=function(e){return new THREE.Vector2(e.clientX,e.clientY)},r.prototype.emit=function(e,t,n){n=void 0===n||n;e=[t?t.namespace:"scene",e].join(".");t&&n?this.eventMediator.emit(e,t.intersect,t.alsoIntersected):this.eventMediator.emit(e)},t.exports=r},{}],428:[function(e,t,n){t.exports={platonic:{Dodecahedron:{name:"Dodecahedron",category:["Platonic Solid"],vertex:[[0,0,1.070466],[.7136442,0,.7978784],[-.3568221,.618034,.7978784],[-.3568221,-.618034,.7978784],[.7978784,.618034,.3568221],[.7978784,-.618034,.3568221],[-.9341724,.381966,.3568221],[.1362939,1,.3568221],[.1362939,-1,.3568221],[-.9341724,-.381966,.3568221],[.9341724,.381966,-.3568221],[.9341724,-.381966,-.3568221],[-.7978784,.618034,-.3568221],[-.1362939,1,-.3568221],[-.1362939,-1,-.3568221],[-.7978784,-.618034,-.3568221],[.3568221,.618034,-.7978784],[.3568221,-.618034,-.7978784],[-.7136442,0,-.7978784],[0,0,-1.070466]],edge:[[0,1],[0,2],[0,3],[1,4],[1,5],[2,6],[2,7],[3,8],[3,9],[4,7],[4,10],[5,8],[5,11],[6,9],[6,12],[7,13],[8,14],[9,15],[10,11],[10,16],[11,17],[12,13],[12,18],[13,16],[14,15],[14,17],[15,18],[16,19],[17,19],[18,19]],face:[[0,1,4,7,2],[0,2,6,9,3],[0,3,8,5,1],[1,5,11,10,4],[2,7,13,12,6],[3,9,15,14,8],[4,10,16,13,7],[5,8,14,17,11],[6,12,18,15,9],[10,11,17,19,16],[12,13,16,19,18],[14,15,18,19,17]]}},archimedean:{Icosidodecahedron:{name:"Icosidodecahedron",category:["Archimedean Solid"],vertex:[[0,0,1.051462],[.618034,0,.8506508],[.2763932,.5527864,.8506508],[-.618034,0,.8506508],[-.2763932,-.5527864,.8506508],[1,0,.3249197],[.7236068,-.5527864,.5257311],[-.1708204,.8944272,.5257311],[.4472136,.8944272,.3249197],[-1,0,.3249197],[-.7236068,.5527864,.5257311],[.1708204,-.8944272,.5257311],[-.4472136,-.8944272,.3249197],[1,0,-.3249197],[.8944272,.5527864,0],[.5527864,-.8944272,0],[-.5527864,.8944272,0],[.4472136,.8944272,-.3249197],[-1,0,-.3249197],[-.8944272,-.5527864,0],[-.4472136,-.8944272,-.3249197],[.618034,0,-.8506508],[.7236068,-.5527864,-.5257311],[.1708204,-.8944272,-.5257311],[-.7236068,.5527864,-.5257311],[-.1708204,.8944272,-.5257311],[.2763932,.5527864,-.8506508],[-.618034,0,-.8506508],[-.2763932,-.5527864,-.8506508],[0,0,-1.051462]],edge:[[0,1],[1,2],[2,0],[0,3],[3,4],[4,0],[1,6],[6,5],[5,1],[2,8],[8,7],[7,2],[3,10],[10,9],[9,3],[4,12],[12,11],[11,4],[5,13],[13,14],[14,5],[6,11],[11,15],[15,6],[7,16],[16,10],[10,7],[8,14],[14,17],[17,8],[9,18],[18,19],[19,9],[12,19],[19,20],[20,12],[13,22],[22,21],[21,13],[15,23],[23,22],[22,15],[16,25],[25,24],[24,16],[17,26],[26,25],[25,17],[18,24],[24,27],[27,18],[20,28],[28,23],[23,20],[21,29],[29,26],[26,21],[27,29],[29,28],[28,27]],face:[[0,1,2],[0,3,4],[1,6,5],[2,8,7],[3,10,9],[4,12,11],[5,13,14],[6,11,15],[7,16,10],[8,14,17],[9,18,19],[12,19,20],[13,22,21],[15,23,22],[16,25,24],[17,26,25],[18,24,27],[20,28,23],[21,29,26],[27,29,28],[0,2,7,10,3],[0,4,11,6,1],[1,5,14,8,2],[3,9,19,12,4],[5,6,15,22,13],[7,8,17,25,16],[9,10,16,24,18],[11,12,20,23,15],[13,21,26,17,14],[18,27,28,20,19],[21,22,23,28,29],[24,25,26,29,27]]}}}},{}],429:[function(e,t,n){var c=THREE.Math;function r(e,t,n,r){THREE.PerspectiveCamera.call(this)}r.prototype=Object.assign(Object.create(THREE.PerspectiveCamera.prototype),{constructor:r,updateProjectionMatrix:function(){1<this.aspect?(r=2*(i=(e=this.near)*Math.tan(.5*c.DEG2RAD*this.fov)/this.zoom),t=-.5*(n=this.aspect*r)):(n=-2*(t=-(e=this.near)*Math.tan(.5*c.DEG2RAD*this.fov)/this.zoom),i=.5*(r=1/this.aspect*n)),null!==(o=this.view)&&(s=o.fullWidth,a=o.fullHeight,t+=o.offsetX*n/s,i-=o.offsetY*r/a,n*=o.width/s,r*=o.height/a);var e,t,n,r,i,o,a,s=this.filmOffset;0!==s&&(t+=e*s/this.getFilmWidth()),this.projectionMatrix.makePerspective(t,t+n,i,i-r,e,this.far)}}),t.exports=r},{}],430:[function(e,t,n){var r=e("ThreeCSG");t.exports=function(e){var n=r(e);return n.prototype.cut=function(e){var t=this.tree.clone(),e=e.tree.clone();return e.clipTo(t),e.invert(),t.clipTo(e),(t=new n(t)).matrix=this.matrix,t},n}},{ThreeCSG:3}],431:[function(e,t,n){function r(e){var t=new THREE.Group,n=(this.object=t,new THREE.Vector3(-1,2,0)),r=new THREE.HemisphereLight(16777215,7645414,1);r.position.set(-2,0,0),t.add(r),this.shadowLights={},(r=new THREE.PointLight(16777152,.1)).position.copy(n),t.add(r),(n=(this.shadowLights[this.SHADOW_OPTIONS.OFF]=r).clone()).castShadow=!0,n.shadow.mapSize.width=256,n.shadow.mapSize.height=256,t.add(n),this.shadowLights[this.SHADOW_OPTIONS.LOW]=n,(n=r.clone()).castShadow=!0,n.shadow.mapSize.width=512,n.shadow.mapSize.height=512,t.add(n),this.shadowLights[this.SHADOW_OPTIONS.MEDIUM]=n,(n=r.clone()).castShadow=!0,n.shadow.mapSize.width=1024,n.shadow.mapSize.height=1024,t.add(n),this.shadowLights[this.SHADOW_OPTIONS.HIGH]=n,e.add(t)}r.prototype.SHADOW_OPTIONS={OFF:"off",LOW:"low",MEDIUM:"medium",HIGH:"high"},r.prototype.setRotation=function(e){this.object.setRotationFromEuler(e)},r.prototype.setShadows=function(t){Object.entries(this.shadowLights).forEach(function(e){e[0]===t?e[1].visible=!0:e[1].visible=!1})},t.exports=r},{}],432:[function(y,_,e){!function(v){!function(){v.THREE=y("three/build/three"),y("three/examples/js/controls/OrbitControls");function e(){var e=this,t=(this.log=console,new n,(()=>{var e=n,t=r;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);function n(){var e=this,t=n;if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");e=this,t=(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments);if(e)return!t||"object"!=typeof t&&"function"!=typeof t?e:t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t),n})());this.eventMediator=new t,this.initThree(),this.initApp(),this.initScene(),window.addEventListener("resize",this.onResize.bind(this),!1),this.onResize(),setTimeout(function(){e.startTime=Date.now(),requestAnimationFrame(e.animate.bind(e)),setTimeout(function(){e.eventMediator.emit("start"),setTimeout(function(){e.adjust.enable()},1e3)},100)},100)}var r=y("events"),i=y("./lib/square-perspective-camera"),o=y("@tweenjs/tween.js"),n=y("./activity"),a=y("./materials"),s=y("./interaction-publisher"),c=y("./history"),t=y("./terrarium"),l=y("./space"),u=y("./lights"),h=y("./controls"),d=y("./quality-adjust"),p=y("./controller"),f=y("./autorotate"),m=y("./hyper-map"),g=y("./audio");e.prototype.initApp=function(){var e=new s(this.renderer.domElement,this.camera,this.eventMediator,this.log),t=new c(this.eventMediator),n=new m(this.eventMediator);new g(this.eventMediator),a.addHyperMap(n),this.app={TWEEN:o,eventMediator:this.eventMediator,interactionPublisher:e,camera:this.camera,history:t,log:this.log,scene:this.scene,elapsed:0,delta:0,hyperMap:n},new h(document.body,this.app)},e.prototype.initScene=function(){this.lights=new u(this.scene),this.terrarium=new t(this.scene,this.app),this.space=new l(this.scene,this.app),this.app.space=this.space,this.adjust=new d(this),this.app.terrarium=this.terrarium;new p(this.app);this.autorotate=new f(this.app,this.terrarium)},e.prototype.initThree=function(){var t=this,e=document.body.clientWidth,n=document.body.clientHeight,r=(this.renderer=new THREE.WebGLRenderer({alpha:!0,antialias:!0,preserveDrawingBuffer:!0}),this.renderer.setSize(e,n),this.renderer.autoClearColor=!1,this.renderer.autoClearDepth=!1,this.renderer.autoClearStencil=!1,this.renderer.shadowMap.enabled=!0,this.renderer.setPixelRatio(window.devicePixelRatio),this.container=document.createElement("div"),this.container.classList.add("container"),document.body.insertBefore(this.container,document.body.firstChild),this.container.appendChild(this.renderer.domElement),this.camera=new i(45,e/n,.1,1e3),this.camera.position.set(3*1.2,.6,0),this.cameraControls=new THREE.OrbitControls(this.camera,this.renderer.domElement),this.cameraControls.enableDamping=!0,this.cameraControls.dampingFactor=.05,this.cameraControls.rotateSpeed=.066,this.cameraControls.maxDistance=20,this.cameraControls.minDistance=.75,0);this.cameraControls.addEventListener("change",function(){var e=t.cameraControls.getAzimuthalAngle();e!==r&&t.eventMediator.emit("camera.rotate.azimuth",e),r=e}),this.scene=new THREE.Scene,this.scene.add(this.camera)},e.prototype.render=function(){this.cameraControls.update();var e=new THREE.Euler(0,this.cameraControls.getAzimuthalAngle(),0);this.lights.setRotation(e),this.afterFirstPaint?this.renderer.clear():this.fadeIn(),this.afterFirstPaint=!0,(this.terrarium.soilCursor.renderOnTop?(this.terrarium.soilCursor.setVisible(!1),this.terrarium.container.setVisible(!1),this.terrarium.soil.setVisible(!1),this.terrarium.soilCursor.setVisible(!1),this.renderer.render(this.scene,this.camera),this.space.setVisible(!1),this.terrarium.containerBackground.setVisible(!1),this.terrarium.soilCursor.setVisible(!0),this.terrarium.container.setVisible(!0),this.terrarium.soil.setVisible(!0),this.terrarium.soilCursor.setVisible(!0),this.renderer.render(this.scene,this.camera),this.space.setVisible(!0),this.terrarium.containerBackground):(this.terrarium.soilCursor.setVisible(!1),this.renderer.render(this.scene,this.camera),this.renderer.clearDepth(),this.space.setVisible(!1),this.terrarium.containerBackground.setVisible(!1),this.terrarium.soil.setVisible(!1),this.terrarium.soilCursor.setVisible(!1),this.renderer.context.colorMask(!1,!1,!1,!1),this.renderer.render(this.scene,this.camera),this.renderer.context.colorMask(!0,!0,!0,!0),this.terrarium.container.setVisible(!1),this.terrarium.crystalPlanter.setVisible(!1),this.terrarium.soilCursor.setVisible(!0),this.renderer.render(this.scene,this.camera),this.space.setVisible(!0),this.terrarium.container.setVisible(!0),this.terrarium.containerBackground.setVisible(!0),this.terrarium.soil.setVisible(!0),this.terrarium.crystalPlanter)).setVisible(!0)},e.prototype.animate=function(){var e=Date.now();this.startTime&&(this.app.elapsed=(e-this.startTime)/1e3,a.setTime(this.app.elapsed)),this.lastNow=this.lastNow||e,this.app.delta=(e-this.lastNow)/1e3,this.lastNow=e,requestAnimationFrame(this.animate.bind(this)),this.eventMediator.emit("update",this.app.delta,this.app.elapsed),o.update(),this.render(),this.adjust.update()},e.prototype.onResize=function(){var e=this,t=document.body.clientWidth,n=document.body.clientHeight,r=(this.camera.aspect=t/n,this.camera.updateProjectionMatrix(),this.renderer.setSize(t,n),this.renderer.getDrawingBufferSize());a.setResolution(r.width,r.height),this.container.style.height=n+1+"px",requestAnimationFrame(function(){e.container.style.width=t+"px",e.container.style.height=n+"px"})},e.prototype.setPixelRatio=function(e){this.renderer.getPixelRatio()!==e&&(this.renderer.setPixelRatio(e),this.onResize(),this.render())},e.prototype.fadeIn=function(){document.body.classList.remove("hide-canvas")},_.exports=e}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./activity":411,"./audio":412,"./autorotate":413,"./controller":417,"./controls":418,"./history":424,"./hyper-map":425,"./interaction-publisher":427,"./lib/square-perspective-camera":429,"./lights":431,"./materials":433,"./quality-adjust":434,"./space":438,"./terrarium":439,"@tweenjs/tween.js":2,events:355,"three/build/three":407,"three/examples/js/controls/OrbitControls":408}],433:[function(e,t,n){var e=e("glslify"),r=new THREE.Color(16777215),i=T(THREE.PointsMaterial),o=T(THREE.MeshPhongMaterial),a=T(THREE.MeshBasicMaterial),s=["attribute vec3 instancePosition;","attribute vec4 instanceQuaternion;","attribute vec3 instanceScale;","attribute float instanceVariant;","varying float vVariant;","vec3 applyTRS( vec3 position, vec3 translation, vec4 quaternion, vec3 scale ) {","position *= scale;","position += 2.0 * cross( quaternion.xyz, cross( quaternion.xyz, position ) + quaternion.w * position );","return position + translation;","}"].join("\n"),c=["transformed = applyTRS(transformed.xyz, instancePosition, instanceQuaternion, instanceScale);","vVariant = instanceVariant;"].join("\n"),l=["varying vec2 screenUv;","uniform vec4 hyperMap;","uniform vec2 uResolution;",e(["#define GLSLIFY 1\nfloat hyperEasing(float x) {\n    return x;\n    return pow(x, 1.25);\n}\n\nconst int NUM_WAVES = 9;\n\nvoid calcWave(inout float value, float x, float offset) {\n    float wavelengthStart = 3.;\n    float wavelengthEnd = 3.;\n    float wavePower = .75;\n\n    if (offset > 0. && offset <= 1.) {\n        offset = hyperEasing(offset);\n        float wavelength = mix(wavelengthStart, wavelengthEnd, offset);\n        float waveX = x - offset + wavelength * (1. - offset);\n        waveX = max(waveX / wavelength, 0.);\n        waveX = waveX > 1. ? 0. : waveX;\n        value += waveX * wavePower;\n    }\n}\n\nfloat hyperValue(vec4 waves, float x) {\n\n    float value = 0.;\n\n    calcWave(value, x, waves.x);\n    calcWave(value, x, waves.y);\n    calcWave(value, x, waves.z);\n    calcWave(value, x, waves.w);\n\n    value = min(value, 1.);\n\n    return value;\n}\n\nfloat waveShape(float x) {\n    float blur = .2;\n    x = x == 0. ? 1. : x;\n    x = smoothstep(1., 1. - blur, x) - smoothstep(1. - blur, .0, x);\n    return x;\n}\n\nvoid calcWaveSmooth(inout float value, float x, float offset) {\n    float wavelengthStart = 3.;\n    float wavelengthEnd = 3.;\n    float wavePower = .75;\n\n    if (offset > 0. && offset <= 1.) {\n        offset = hyperEasing(offset);\n        float wavelength = mix(wavelengthStart, wavelengthEnd, offset);\n        float waveX = x - offset + wavelength * (1. - offset);\n        waveX = max(waveX / wavelength, 0.);\n        waveX = waveX > 1. ? 0. : waveX;\n        value += waveShape(waveX) * wavePower;\n    }\n}\n\n// Blend the leading edge\nfloat hyperValueSmooth(vec4 waves, float x) {\n\n    x -= .5;\n\n    float value = 0.;\n\n    calcWaveSmooth(value, x, waves.x);\n    calcWaveSmooth(value, x, waves.y);\n    calcWaveSmooth(value, x, waves.z);\n    calcWaveSmooth(value, x, waves.w);\n\n    value = min(value, 1.);\n\n    return value;\n}\n"]),"float calcHyperPower(vec3 hyperPos) {","vec2 xy = uResolution.xy;","vec2 ratio = xy / sqrt(pow(xy.x, 2.) + pow(xy.y, 2.));","float radial = length(screenUv * ratio);","float sphere = length(hyperPos / 90.); //35","float offset = mix(radial, sphere, .95);","float t = hyperValue(hyperMap, offset);","return t;","}","float calcHyperPowerRadial() {","vec2 xy = uResolution.xy;","vec2 ratio = xy / sqrt(pow(xy.x, 2.) + pow(xy.y, 2.));","float radial = length(screenUv * ratio);","float offset = radial;","float t = hyperValueSmooth(hyperMap, offset);","return t;","}"].join("\n"),u=["uniform float time;","varying vec3 hyperPos;",l].join("\n"),h=["hyperPos = (modelMatrix * vec4( transformed, 1.0 )).xyz;","float hyperPower = calcHyperPower(hyperPos);","float dist = length(hyperPos / 400.) + .01;","float str = hyperPower;","transformed += sin(hyperPos * dist * 400. + time * 100.) * dist * str;"].join("\n"),d=["screenUv = gl_Position.xy / gl_Position.w;"].join("\n"),p=["varying vec3 hyperPos;","uniform float time;",l,e(["#define GLSLIFY 1\n// --------------------------------------------------------\n// IQ\n// https://www.shadertoy.com/view/ll2GD3\n// --------------------------------------------------------\n\nvec3 pal( in float t, in vec3 a, in vec3 b, in vec3 c, in vec3 d ) {\n    return a + b*cos( 6.28318*(c*t+d) );\n}\n\nvec3 spectrum(float n) {\n    return pal(\n        n,\n        vec3(0.5,0.5,0.5),\n        vec3(0.5,0.5,0.5),\n        vec3(1.0,1.0,1.0),\n        vec3(0.0,0.33,0.67)\n    );\n}\n\n"]),e(["#define GLSLIFY 1\n// --------------------------------------------------------\n// Gamma\n// https://www.shadertoy.com/view/Xds3zN\n// --------------------------------------------------------\n\nconst float GAMMA = 2.2;\n\nvec3 gamma(vec3 color, float g) {\n    return pow(color, vec3(g));\n}\n\nvec3 linearToScreen(vec3 linearRGB) {\n    return gamma(linearRGB, 1.0 / GAMMA);\n}\n\n"]),"vec3 hyperColor(vec3 color) {","float hyperPower = calcHyperPower(hyperPos);","hyperPower = max(0., hyperPower * 2. - 1.);","float t = hyperPower;","float dist = pow(length(hyperPos), 1./4.);","vec3 col = spectrum(dist * 4. - time * .5);","col = linearToScreen(col);","return mix(color, col, t);","}"].join("\n"),f="gl_FragColor.rgb = hyperColor(gl_FragColor.rgb);",l=(t.exports.addHyperMap=function(e){x.enableHyper(e.dataTexture),b.enableHyper(e.dataTexture),w.enableHyper(e.dataTexture),_.enableHyper(e.dataTexture),y.enableHyper(e.dataTexture),g.enableHyper(e.dataTexture),v.enableHyper(e.dataTexture),M.enableHyper(e.dataTexture,!0)},t.exports.setResolution=function(e,t){e=[e,t];E.uniforms.uResolution.value=e,x.uniforms.uResolution.value=e,b.uniforms.uResolution.value=e,w.uniforms.uResolution.value=e,_.uniforms.uResolution.value=e,y.uniforms.uResolution.value=e,g.uniforms.uResolution.value=e,v.uniforms.uResolution.value=e,M.uniforms.uResolution.value=e},t.exports.setTime=function(e){E.uniforms.time.value=e,x.uniforms.time.value=e,b.uniforms.time.value=e,w.uniforms.time.value=e,_.uniforms.time.value=e,y.uniforms.time.value=e,g.uniforms.time.value=e,v.uniforms.time.value=e,M.uniforms.time.value=e},new THREE.Color(7383283)),m=new THREE.Color(3288919),g=(m.lerp(l,.25),new o({vertexColors:THREE.VertexColors})),v=(g.uniforms.frontColor={type:"v3",value:l.toArray()},g.uniforms.backColor={type:"v3",value:m.toArray()},g.updateVertexShader("#include <common>","varying float vAngleOfIncidence;"),g.updateVertexShader("#include <fog_vertex>",["vec3 sourceNormal = color;","vec3 modelPosition = (modelMatrix * vec4(position, 1)).xyz;","vec3 cameraRay = normalize(cameraPosition - modelPosition);","vec3 modelNormal = normalize((modelMatrix * vec4(sourceNormal, 1)).xyz);","vAngleOfIncidence = dot(cameraRay, modelNormal);"].join("\n")),g.updateFragmentShader("#include <common>",["varying float vAngleOfIncidence;","uniform vec3 frontColor;","uniform vec3 backColor;"].join("\n")),g.updateFragmentShader("#include <fog_fragment>",["vec3 color = mix(frontColor, backColor, smoothstep(.0, -.5, vAngleOfIncidence));","gl_FragColor = vec4(color, 1);"].join("\n"),!0),t.exports.containerWireframe=g,t.exports.containerBack=new THREE.MeshBasicMaterial({color:1841203,side:THREE.BackSide,transparent:!0,opacity:.75}),new o),y=(v.uniforms.seed={type:"f"},v.uniforms.bottomClip={type:"f"},v.uniforms.height={type:"f"},v.uniforms.scale={type:"f"},v.updateVertexShader("#include <common>",["varying vec3 vPosition;","varying vec3 vReflect;"].join("\n"),!0),v.updateVertexShader("#include <fog_vertex>",["vPosition = position;","vReflect = reflect(vec3(0,0,-1), transformedNormal);"].join("\n")),v.updateFragmentShader("#include <common>",["varying vec3 vPosition;","varying vec3 vReflect;","uniform float seed;","uniform float bottomClip;","uniform float height;","uniform float scale;",e(["#define GLSLIFY 1\n// https://www.shadertoy.com/view/4djSRW\n\n#define HASHSCALE1 .1031\n\n//----------------------------------------------------------------------------------------\n//  1 out, 1 in...\nfloat hash(float p)\n{\n    vec3 p3  = fract(vec3(p) * HASHSCALE1);\n    p3 += dot(p3, p3.yzx + 19.19);\n    return fract((p3.x + p3.y) * p3.z);\n}\n\n// Based on Morgan McGuire @morgan3d\n// https://www.shadertoy.com/view/4dS3Wd\nfloat noise(vec3 x) {\n    const vec3 step = vec3(110, 241, 171);\n\n    vec3 i = floor(x);\n    vec3 f = fract(x);\n \n    // For performance, compute the base input to a 1D hash from the integer part of the argument and the \n    // incremental change to the 1D based on the 3D -> 1D wrapping\n    float n = dot(i, step);\n\n    vec3 u = f * f * (3.0 - 2.0 * f);\n    return mix(mix(mix( hash(n + dot(step, vec3(0, 0, 0))), hash(n + dot(step, vec3(1, 0, 0))), u.x),\n                   mix( hash(n + dot(step, vec3(0, 1, 0))), hash(n + dot(step, vec3(1, 1, 0))), u.x), u.y),\n               mix(mix( hash(n + dot(step, vec3(0, 0, 1))), hash(n + dot(step, vec3(1, 0, 1))), u.x),\n                   mix( hash(n + dot(step, vec3(0, 1, 1))), hash(n + dot(step, vec3(1, 1, 1))), u.x), u.y), u.z);\n}\n\n#define NUM_OCTAVES 2\n\nfloat fbm ( in vec3 _st) {\n    float v = 0.0;\n    float a = 0.5;\n    vec3 shift = vec3(20.0);\n    // Rotate to reduce axial bias\n    mat3 rot = mat3(cos(0.5), sin(0.5), 0,\n                    -sin(0.5), cos(0.50), 0,\n                    0, 0, 1\n                );\n    for (int i = 0; i < NUM_OCTAVES; ++i) {\n        v += a * noise(_st);\n        _st = rot * _st * 2.2 + shift;\n        a *= 0.5;\n    }\n    return v;\n}\n\n#define NUM_OCTAVES2 4\n\nfloat fbm2 ( in vec3 _st) {\n    float v = 0.0;\n    float a = 0.5;\n    vec3 shift = vec3(20.0);\n    // Rotate to reduce axial bias\n    mat3 rot = mat3(cos(0.5), sin(0.5), 0,\n                    -sin(0.5), cos(0.50), 0,\n                    0, 0, 1\n                );\n    for (int i = 0; i < NUM_OCTAVES2; ++i) {\n        v += a * noise(_st);\n        _st = rot * _st * 2.2 + shift;\n        a *= 0.5;\n    }\n    return v;\n}\n\nfloat pattern(float seed, float time, vec3 st ) {\n    // st *= 3.5;\n\n    st.x += seed * 100.;\n    \n    vec3 color = vec3(0.);\n    vec3 a, b, c;\n    \n    a.x = fbm2( st);\n    a.y = fbm2( st + vec3(1.0));\n    a.z = fbm2( st + vec3(2.0));\n    \n    b.x = fbm2( st + 4.*a);\n    b.y = fbm2( st);\n    b.z = fbm2( st + 10. * a);\n\n    c.x = fbm2( st + 7.0*b + vec3(10.7,.2,0)+ 0.215 * time );\n    c.y = fbm2( st + 3.944*b + vec3(.3,12.8,0)+ 0.16 * time );\n    c.z = fbm2( st + 1.8*b + vec3(8.3,1.8,0)+ 0.16 * time );\n\n    float f = fbm2(st+b+c);\n\n    // f -= c.x;\n    // f += c.y;\n\n    f -= (c.x / b.y) * .25;\n    f += (c.y / b.x) * .25;\n\n    // f /= a.y * 1.55;\n\n    float o = .2;\n    float s = .3;\n    float g = f;\n\n    float gg = smoothstep(o, o + s, g) - smoothstep(o + s, o + s * 2., g);\n\n    f = mix(f, c.x, gg);\n\n    f = pow(c.x*2., 2.);\n\n    float j = floor(f * 2.) / 2.;\n\n    j = hash(j);\n\n    f = j * f;\n\n    f = pow(f,3.);\n\n    return clamp(f, 0., 1.);\n}\n\nvec4 map(float seed, float time, vec3 st) {\n\n    st.x += seed * 100.;\n    \n    vec3 color = vec3(0.);\n    vec3 a, b, c;\n    \n    a.x = fbm( st);\n    a.y = fbm( st + vec3(1.0));\n    a.z = fbm( st + vec3(2.0));\n\n    b.x = fbm( st + 4. * a + time * .05);\n    b.y = fbm( st + time * .2);\n    b.z = fbm( st + 10. * a + time * .1);\n\n    return vec4(normalize(b * 2. - 1.), 0.);\n}\n\n"])].join("\n")),v.updateFragmentShader("#include <logdepthbuf_fragment>",["if (vPosition.z < bottomClip) { discard; }","vec3 positon = vPosition;","positon *= scale;","positon.z += height * .5;","float cTime = time * 2.5;","vec4 m = map(seed, cTime, positon);","float angleOfIncidence = acos(dot(normalize(vNormal + m.xyz * .2), normalize(vViewPosition)));","vec3 col = spectrum(angleOfIncidence);","float pat = pattern(seed, cTime * .5, positon + vec3(0,0,cTime * .01));","float ee = pat * .2 + .8;","col = spectrum(angleOfIncidence * ee);","float sp = 0.;","sp += clamp(dot(normalize(vec3(-1,0,0)), vReflect), 0., 1.);","sp += clamp(dot(normalize(vec3(0,1,0)), vReflect), 0., 1.);","sp += clamp(dot(normalize(vec3(-1,-.5,0)), vReflect), 0., 1.);","sp /= 3.;","sp = pow(sp, 3.);","sp = clamp(sp, 0., 1.);","sp = pow(sp * 3., 10.);","sp = clamp(sp, 0., 1.);","col = mix(col, vec3(1), sp * (.5 + (1. - pat) * .5) * .5);","col = linearToScreen(col);","diffuseColor.rgb = col;","gl_FragColor = diffuseColor;","return;"].join("\n"),!0),t.exports.crystal=v,t.exports.soilCursor=new THREE.ShaderMaterial({uniforms:{t1:{value:0},t2:{value:0}},vertexShader:e(["#define GLSLIFY 1\nvarying vec2 vUv;\n\nvoid main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1);\n}\n"]),fragmentShader:e(["#define GLSLIFY 1\nvarying vec2 vUv;\n\nuniform float t1;\nuniform float t2;\n\nvoid main() {\n    float fill1 = step(1.- vUv.y, t1);\n    float fill2 = step(vUv.y, t2);\n    vec3 colorA = vec3(0, .8, 1);\n    vec3 colorB = vec3(0, 1, .2);\n    vec3 colorC = vec3(1, 0, 1);\n    vec3 color = mix(colorA, colorB, fill1);\n    color = mix(color, colorC, fill2);\n    gl_FragColor = vec4(color, 1);\n}\n"]),side:THREE.DoubleSide}),new o({color:r,shininess:0})),_=(t.exports.soilBottom=y,new o),l=(_.updateVertexShader("#include <common>","varying vec3 vPosition;"),_.updateVertexShader("#include <uv_vertex>","vPosition = position;"),_.updateFragmentShader("#include <common>",["varying vec3 vPosition;","uniform float highlightTime;","uniform vec3 highlightColor3;"].join("\n")),_.updateFragmentShader("#include <color_fragment>",["float magnitude = length(vPosition.xz);","vec4 highlightColor = vec4(highlightColor3,1);","float highlightAnim = magnitude * 35. + highlightTime * -40.;","float highlight = sin(highlightAnim) * .5 + .5;","float highlightSize = mix(.2, 1., magnitude * 1.2);","highlightSize = pow(highlightSize, .5);","float highlightInterval = 5.;","float highlightInterval2 = 10.;","float highlightGap = sin(highlightAnim / highlightInterval) * .5 + .5;","highlightGap = step(highlightGap, .5);","float highlightGap2 = sin(highlightAnim / highlightInterval2) * .5 + .5;","highlightGap2 = step(highlightGap2, .5);","highlightGap = highlightGap * highlightGap2;","float highlightFade = min(pow(magnitude * 1.5, 2.), 1.);","float highlightStep = 1. - highlightSize;","diffuseColor = mix(diffuseColor, highlightColor, step(highlight, highlightStep) * (1. - highlightFade) * highlightGap);"].join("\n")),new THREE.Color(16529571)),m=(_.uniforms.highlightTime={type:"f",value:0},_.uniforms.highlightColor3={type:"v3",value:l.toArray()},t.exports.soilTop=_,new THREE.Color(6077695)),l=new THREE.Color(4404858),x=new o({color:r,shininess:0}),b=(x.updateVertexShader("#include <common>",s),x.updateVertexShader("#include <begin_vertex>",c),x.uniforms.colorA={type:"v3",value:l},x.updateFragmentShader("#include <common>",["varying float vVariant;","uniform vec3 colorA;"].join("\n")),x.updateFragmentShader("#include <color_fragment>",["diffuseColor.xyz = mix(diffuseColor.xyz, colorA, vVariant);"].join("\n")),t.exports.planetSolid=x,new o({color:l,shininess:0})),w=(b.updateVertexShader("#include <common>",s),b.updateVertexShader("#include <begin_vertex>",c),t.exports.planetBackground=b,new a({color:m,opacity:.5,transparent:!0})),E=(w.updateVertexShader("#include <common>",s),w.updateVertexShader("#include <begin_vertex>",c),t.exports.planetWireframe=w,new i({transparent:!0,depthWrite:!1})),M=(E.extensions={derivatives:!0},E.updateVertexShader("#include <common>",["attribute float aSize;","attribute float aSeed;","uniform vec2 uResolution;","varying float vSeed;"].join("\n")),E.updateVertexShader("#include <color_vertex>",["float sizeRez = min(uResolution.x, uResolution.y);","vSeed = aSeed;"].join("\n")),E.vertexShader=E.vertexShader.replace(/gl_PointSize = size/g,"gl_PointSize = (aSize * sizeRez)"),E.vertexShader=E.vertexShader.replace("* ( scale / - mvPosition.z )","/ length(cameraPosition - mvPosition.xyz)"),E.updateFragmentShader("#include <common>",[e(["#define GLSLIFY 1\n// --------------------------------------------------------\n// IQ\n// https://www.shadertoy.com/view/ll2GD3\n// --------------------------------------------------------\n\nvec3 pal( in float t, in vec3 a, in vec3 b, in vec3 c, in vec3 d ) {\n    return a + b*cos( 6.28318*(c*t+d) );\n}\n\nvec3 spectrum(float n) {\n    return pal(\n        n,\n        vec3(0.5,0.5,0.5),\n        vec3(0.5,0.5,0.5),\n        vec3(1.0,1.0,1.0),\n        vec3(0.0,0.33,0.67)\n    );\n}\n\n"]),e(["#define GLSLIFY 1\n// --------------------------------------------------------\n// Gamma\n// https://www.shadertoy.com/view/Xds3zN\n// --------------------------------------------------------\n\nconst float GAMMA = 2.2;\n\nvec3 gamma(vec3 color, float g) {\n    return pow(color, vec3(g));\n}\n\nvec3 linearToScreen(vec3 linearRGB) {\n    return gamma(linearRGB, 1.0 / GAMMA);\n}\n\n"]),e(["#define GLSLIFY 1\n#define HASHSCALE1 .1031\n\n//----------------------------------------------------------------------------------------\n//  1 out, 1 in...\nfloat hash11(float p)\n{\n    vec3 p3  = fract(vec3(p) * HASHSCALE1);\n    p3 += dot(p3, p3.yzx + 19.19);\n    return fract((p3.x + p3.y) * p3.z);\n}\n\n"]),"varying float vSeed;","uniform float time;"].join("\n")),E.updateFragmentShader("#include <color_fragment>",["vec2 cxy = 2.0 * gl_PointCoord - 1.0;","float r = dot(cxy, cxy);","float delta = fwidth(r);","diffuseColor.a = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);","diffuseColor.xyz = spectrum(vSeed * 6. + time * .2 * ceil(vSeed * 6.));","diffuseColor.xyz = mix(diffuseColor.xyz, vec3(1), hash11(vSeed));"].join("\n")),E.uniforms.uResolution={type:"v2"},E.uniforms.time={type:"float",value:0},t.exports.stars=E,new o({color:0,side:THREE.BackSide,transparent:!0}));function T(t){function e(e){t.call(this,e),e=this.type,this.type="ShaderMaterial",e=THREE.ShaderLib[n[e]],this.vertexShader=e.vertexShader,this.fragmentShader=e.fragmentShader,this.uniforms=THREE.UniformsUtils.clone(e.uniforms)}var n={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow"};return((e.prototype=Object.create(t.prototype)).constructor=e).prototype.enableHyper=function(e,t){this.updateVertexShader("#include <common>",u),this.updateVertexShader("#include <fog_vertex>",d),this.updateFragmentShader("#include <common>",p),this.uniforms.hyperMap={type:"v4",value:e},this.uniforms.uResolution={type:"v2",value:[0,0]},this.uniforms.time={type:"f",value:0},t||(this.updateVertexShader("#include <skinning_vertex>",h),this.updateFragmentShader("#include <fog_fragment>",f))},e.prototype.updateVertexShader=function(e,t,n){this.vertexShader=this.insertGlsl(this.vertexShader,e,t,n)},e.prototype.updateFragmentShader=function(e,t,n){this.fragmentShader=this.insertGlsl(this.fragmentShader,e,t,n)},e.prototype.insertGlsl=function(e,t,n,r){return r?e.replace(t,n+"\n"+t):e.replace(t,t+"\n"+n)},e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=THREE.UniformsUtils.clone(e.uniforms),this.uniforms.hyperMap&&(this.uniforms.hyperMap=e.uniforms.hyperMap),this.uniforms.uResolution&&(this.uniforms.uResolution=e.uniforms.uResolution),this.uniforms.time&&(this.uniforms.time=e.uniforms.time),this},e}M.updateVertexShader("#include <common>",["varying vec3 vCameraPosition;","varying vec3 vPosition;","varying float hyperPowerRadial;","varying vec2 cartCoords;",e(["#define GLSLIFY 1\nvec2 coords(vec3 pos, vec3 cam) {\n    pos = normalize(pos);\n    cam = normalize(cam);\n    float radius = acos(dot(pos, -cam)) / PI * 4.;\n\n    vec3 up = normalize(cross(-cam, vec3(0,1,0)));\n    vec3 left = cross(cam, up);\n    vec3 dir = normalize(cross(cam, cross(pos, cam)));\n    float angle = acos(dot(dir, up)) * sign(dot(dir, left));\n\n    vec2 polar = vec2(\n        radius,\n        angle\n    );\n\n    vec2 cartesian = vec2(\n        radius * cos(angle),\n        radius * sin(angle)\n    );\n\n    return cartesian;\n}"])].join("\n")),M.updateVertexShader("#include <fog_vertex>",["vCameraPosition = cameraPosition;","vPosition = (modelMatrix * vec4( transformed, 1.0 )).xyz;","hyperPowerRadial = calcHyperPowerRadial();","cartCoords = coords(vPosition, vCameraPosition);"].join("\n")),M.updateFragmentShader("#include <common>",["varying vec3 vCameraPosition;","varying vec3 vPosition;","varying float hyperPowerRadial;","varying vec2 cartCoords;",e(['#define GLSLIFY 1\n#define PI 3.14159265359\n\n// Repeat around the origin by a fixed angle.\n// For easier use, num of repetitions is use to specify the angle.\nfloat pModPolar(inout vec2 p, float repetitions) {\n    float angle = 2.*PI/repetitions;\n    float a = atan(p.y, p.x) + angle/2.;\n    float r = length(p);\n    float c = floor(a/angle);\n    a = mod(a,angle) - angle/2.;\n    p = vec2(cos(a), sin(a))*r;\n    // For an odd number of repetitions, fix cell index of the cell in -x direction\n    // (cell index would be e.g. -5 and 5 in the two halves of the cell):\n    if (abs(c) >= (repetitions/2.)) c = abs(c);\n    return c;\n}\n\n// Repeat space along one axis. Use like this to repeat along the x axis:\n// <float cell = pMod1(p.x,5);> - using the return value is optional.\nfloat pMod1(inout float p, float size) {\n    float halfsize = size*0.5;\n    float c = floor((p + halfsize)/size);\n    p = mod(p + halfsize, size) - halfsize;\n    return c;\n}\n\n// Repeat in two dimensions\nvec2 pMod2(inout vec2 p, vec2 size) {\n    vec2 c = floor((p + size*0.5)/size);\n    p = mod(p + size*0.5,size) - size*0.5;\n    return c;\n}\n\n// Rotate around a coordinate axis (i.e. in a plane perpendicular to that axis) by angle <a>.\n// Read like this: R(p.xz, a) rotates "x towards z".\n// This is fast if <a> is a compile-time constant and slower (but still practical) if not.\nvoid pR(inout vec2 p, float a) {\n    p = cos(a)*p + sin(a)*vec2(p.y, -p.x);\n}\n\nvec4 bgPattern(vec2 polarCoords) {\n\n    vec2 r = polarCoords;\n\n    float crop = .25;\n    float hp = max(0., (hyperPowerRadial - crop) * (1./(1.-crop)));\n    // float hp = calcHyperPowerRadial();\n\n    vec4 c = vec4(0,0,r);\n\n    // 0 -> 0\n    // 1 -> 0\n    // .9 -> 1\n    // .8 -> 0\n\n    // float ss = .1;\n\n    // hp = hp == 0. ? 1. : hp;\n    // hp = smoothstep(1., 1. - ss, hp) - smoothstep(1. - ss, .5, hp);\n\n    // hp = (hp - .9) * 10.;\n\n    // vec3 ee = spectrum(hp);\n    // ee = hp <= 0. || hp >= 1. ? vec3(0.) : ee;\n    // return vec4(vec3(hp), 1);\n\n    r.x = pow(r.x * 5., 1./2.);\n\n    // r.x += mix(-.5, 0., hp);\n\n    r *= 1.5;\n\n    r.x -= time * .1;\n\n    pR(r, PI / 4.);\n\n    float rep = 11.;\n    pMod2(r, vec2(2.2222 / rep));\n\n    float d = 1e12;\n    float part;\n\n    float o = c.w * 2.;\n    o = 0.5;\n    float w = (sin(c.z * 12. + time - o) * .5 + .5) * .05;\n    float ww = (sin(c.z * 12. + time - o) * .5 + .3) * .05;\n    float w3 = (sin(c.z * 12. + time - o) * .5 + .8) * .08;\n\n    float partA = abs(dot(r, vec2(1,0)));\n    float partB = abs(dot(r, vec2(0,1)));\n    d = min(partA, partB);\n\n    // w *= 1. - c.z * .5;\n    // ww *= 1. - c.z * .5;\n\n    float po = sin(time * 5.) * .5 + .5;\n    po = hp;\n\n    float pat = smoothstep(0., .005, d - w - .1 * (1. - po));\n    float pat2 = smoothstep(0., .005 * po, d - ww * po);\n    float pat3 = smoothstep(0., .005, d - w3 - .075 * (1. - po));\n\n    float fill = mix(0., mix(1., .5, hp), pat2);\n    fill = mix(fill, .2, pat);\n    fill = mix(fill, .0, pat3);\n\n    // fill = 1.-pat3;\n\n    // fill = pat;\n    // return vec4(vec3(fill), 1.);\n\n    float alpha = 1. - fill;\n    alpha = alpha * hp;\n    vec3 color = mix(vec3(.3,.19,.5) * 2., vec3(.3,.19,.5) * .1, clamp(hp * 1.5 - .5, 0., 1.));\n\n    return vec4(color, alpha);\n}\n'])].join("\n")),M.updateFragmentShader("#include <color_fragment>",["vec2 c = cartCoords;","vec2 polarCoords = vec2(sqrt(c.x * c.x + c.y * c.y), atan(c.y, c.x));","vec4 pattern = bgPattern(polarCoords);","diffuseColor = pattern;"].join("\n")),t.exports.background=M},{glslify:357}],434:[function(e,t,n){function r(e){this.main=e,this.qualityRange=6,this.initialQuality=this.qualityRange-1,this.adjust(this.initialQuality)}var i=e("./quality-throttle");r.prototype.enable=function(){this.throttle=new i(this.qualityRange,this.initialQuality,this.adjust.bind(this))},r.prototype.update=function(){this.throttle&&this.throttle.update()},r.prototype.adjust=function(e){this.main.log.log("Switching quality to "+e);var t=this.main.lights,n=this.main.terrarium.soilCursor;switch(e){case 0:this.main.setPixelRatio(.25*window.devicePixelRatio),n.setRenderOnTop(!0),t.setShadows(t.SHADOW_OPTIONS.LOW);break;case 1:this.main.setPixelRatio(.5*window.devicePixelRatio),n.setRenderOnTop(!0),t.setShadows(t.SHADOW_OPTIONS.LOW);break;case 2:this.main.setPixelRatio(.75*window.devicePixelRatio),n.setRenderOnTop(!1),t.setShadows(t.SHADOW_OPTIONS.LOW);break;case 3:this.main.setPixelRatio(window.devicePixelRatio),n.setRenderOnTop(!1),t.setShadows(t.SHADOW_OPTIONS.LOW);break;case 4:this.main.setPixelRatio(window.devicePixelRatio),n.setRenderOnTop(!1),t.setShadows(t.SHADOW_OPTIONS.MEDIUM);break;case 5:this.main.setPixelRatio(window.devicePixelRatio),n.setRenderOnTop(!1),t.setShadows(t.SHADOW_OPTIONS.HIGH)}},t.exports=r},{"./quality-throttle":435}],435:[function(e,t,n){function r(e,t,n){this.callback=n,this.lastTime=(performance||Date).now(),this.frames=0,this.lastLower=0,this.qualityRange=e,this.quality=t}var i=[30,50];r.prototype.update=function(){this.frames+=1;var e,t=(performance||Date).now();t>=this.lastTime+500&&(e=1e3*this.frames/(t-this.lastTime),this.lastTime=t,this.frames=0,this.throttle(e))},r.prototype.throttle=function(e){e<i[0]?this.lowerQuality():i[1]<e&&this.raiseQuality()},r.prototype.lowerQuality=function(){this.lastLower=Date.now();var e=Math.max(this.quality-1,0);e!==this.quality&&(this.quality=e,this.callback(e))},r.prototype.raiseQuality=function(){var e;Date.now()<this.lastLower+3e3||(e=Math.min(this.quality+1,this.qualityRange-1))!==this.quality&&(this.quality=e,this.callback(e))},t.exports=r},{}],436:[function(e,t,n){function r(e,t){var n=new THREE.RingGeometry(.35,.5,32),r=new THREE.CylinderGeometry(.05,0,1),r=(this.iterateFaceVertexUvs(n,function(e,t,n){var t=new THREE.Vector2(t.x,t.y),r=t.angle()/(2*Math.PI),t=t.length();n.set(r,(t-.35)/(.5-.35))}),this.iterateFaceVertexUvs(r,function(e,t,n){.9<e.normal.y&&n.set(.999,.999)}),r.rotateX(.5*Math.PI),r.translate(0,0,.5),n.merge(r),n),n=i.soilCursor;(r=new THREE.Mesh(r,n)).visible=!1,this.visible=!1,e.add(r),this.parent=e,this.app=t,this.mesh=r,this.material=n,t.eventMediator.on("ready",this.enable.bind(this)),t.eventMediator.on("soil.mouseover",this.show.bind(this)),t.eventMediator.on("soil.touchstart",this.show.bind(this)),t.eventMediator.on("soil.mousemove",this.position.bind(this)),t.eventMediator.on("soil.touchstart",this.position.bind(this)),t.eventMediator.on("soil.mouseout",this.hide.bind(this)),t.eventMediator.on("scene.touchend",this.hide.bind(this)),t.eventMediator.on("crystal.growth",this.showProgress.bind(this)),this.countdownTween=new t.TWEEN.Tween(n.uniforms.t1).to({value:1},t.interactionPublisher.TOUCH_HOLD_DELAY).easing(t.TWEEN.Easing.Quadratic.In)}var i=e("./materials");r.prototype.enable=function(){var e;this.enabled||(this.enabled=!0,(e=this.app).eventMediator.on("soil.touchholdstart",this.startCountdown.bind(this)),e.eventMediator.on("soil.touchholdend",this.resetCountdown.bind(this)),e.eventMediator.on("soil.mousedown",this.highlightOn.bind(this)),e.eventMediator.on("soil.touchholddown",this.highlightOn.bind(this)),e.eventMediator.on("scene.mouseup",this.highlightOff.bind(this)),e.eventMediator.on("scene.touchend",this.highlightOff.bind(this)))},r.prototype.setRenderOnTop=function(e){e?(this.material.depthTest=!1,this.mesh.renderOrder=1):(this.material.depthTest=!0,this.mesh.renderOrder=0),this.renderOnTop=e},r.prototype.startCountdown=function(){this.isHeld||this.countdownTween.start()},r.prototype.resetCountdown=function(){this.isHeld||(this.countdownTween&&this.countdownTween.stop(),this.material.uniforms.t1.value=0)},r.prototype.show=function(){this.enabled?(this.isOver=!0,this.visible=!0,this.mesh.visible=!0,this.app.eventMediator.emit("soil-cursor.visible")):this.readyShowHandler||(this.readyShowHandler=this.show.bind(this),this.app.eventMediator.on("ready",this.readyShowHandler))},r.prototype.hide=function(){this.enabled?(this.isOver=!1,this.isHeld||(this.visible=!1,this.mesh.visible=!1,this.app.eventMediator.emit("soil-cursor.hidden"))):this.readyShowHandler&&this.app.eventMediator.removeListener("ready",this.readyShowHandler)},r.prototype.setVisible=function(e){this.mesh.visible=this.visible&&e},r.prototype.position=function(e){this.intersect=e,this.setPosition()},r.prototype.setPosition=function(){var e,t;!this.isHeld&&this.intersect&&(this.positionIntersect=this.intersect,this.intersect.normal=this.normalIntersection(this.intersect),e=this.intersect.point.clone(),t=this.intersect.normal.clone(),this.intersect.object.localToWorld(t),t=e.clone().add(t),this.mesh.position.copy(e),this.mesh.lookAt(t),this.app.interactionPublisher.isTouchDevice?(t=.55*this.app.camera.position.distanceTo(e),this.mesh.scale.set(t,t,t)):this.mesh.scale.set(1,1,1))},r.prototype.highlightOn=function(){this.isHeld=!0,this.material.uniforms.t1.value=1,this.app.eventMediator.emit("soil-cursor.down",this.positionIntersect)},r.prototype.highlightOff=function(){this.isHeld=!1,this.setPosition(),this.isOver||this.hide(),this.material.uniforms.t1.value=0,this.resetProgress(),this.app.eventMediator.emit("soil-cursor.up")},r.prototype.showProgress=function(e){this.material.uniforms.t2.value=e},r.prototype.resetProgress=function(){this.material.uniforms.t2.value=0},r.prototype.iterateFaceVertexUvs=function(i,o){i.faces.forEach(function(n,r){[n.a,n.b,n.c].forEach(function(e,t){e=i.vertices[e],t=i.faceVertexUvs[0][r][t];o(n,e,t)})})},r.prototype.normalIntersection=function(e){var t=e.object,n=t.geometry,r=e.point.clone(),e=e.face,t=(t.worldToLocal(r),n.vertices[e.a]),i=n.vertices[e.b],n=n.vertices[e.c],o=e.vertexNormals[0].clone(),a=e.vertexNormals[1].clone(),e=e.vertexNormals[2].clone(),s=new THREE.Vector3;return THREE.Triangle.barycoordFromPoint(r,t,i,n,s),o.multiplyScalar(s.x),a.multiplyScalar(s.y),e.multiplyScalar(s.z),o.add(a).add(e),o},t.exports=r},{"./materials":433}],437:[function(e,t,n){function r(e,n,t){n.computeBoundingBox();var r=n.boundingBox.getSize(),r=(this.width=r.x,this.depth=r.z,this.height=.1*r.y,this.offset=.2*r.y,h.soilBottom),i=h.soilTop,o=(this.highlightActive=i.uniforms.highlightActive,t.TWEEN),o=(this.highlightTween=new o.Tween(i.uniforms.highlightTime).to({value:1},2e3).repeat(1/0),new THREE.ParametricGeometry(this.generate.bind(this),15,15)),a=new l(n),s=new l(o),c=o.clone();n.faces.forEach(function(e,t){e=(new THREE.Plane).setFromCoplanarPoints(n.vertices[e.b],n.vertices[e.a],n.vertices[e.c]);c=u(c,e)}),(o=new THREE.Mesh(c,i)).receiveShadow=!0,e.add(o),i=a.cut(s).toGeometry(),(a=new THREE.Mesh(i,r)).receiveShadow=!0,e.add(a),this.top=o,this.bottom=a,t.interactionPublisher.add(o,"soil",!0)}var l=e("./lib/three-js-csg")(THREE),u=e("threejs-slice-geometry")(THREE),h=e("./materials");r.prototype.showHighlight=function(e){e?this.highlightTween.start():this.highlightTween.repeat(0)},r.prototype.generate=function(e,t){var e=(e-.5)*this.width,t=(t-.5)*this.depth,n=Math.sin(5*t)*Math.sin(2*e)*.5*this.height;return n-=this.offset,new THREE.Vector3(t,n,e)},r.prototype.setVisible=function(e){this.top.visible=e,this.bottom.visible=e},t.exports=r},{"./lib/three-js-csg":430,"./materials":433,"threejs-slice-geometry":409}],438:[function(e,t,n){function r(e,t){var n=new THREE.Group,e=(e.add(n),this.group=n,this.app=t,this.addPlanets(),this.addStars(),new THREE.IcosahedronGeometry(36,3)),r=((e=new THREE.Mesh(e,u.background)).renderOrder=-1,n.add(e),this.hyperMultiplier=0,new THREE.Vector3(1,1,0).normalize()),i=new t.TWEEN.Tween({t:0}).to({t:1},1e6).onUpdate(function(e){n.quaternion.setFromAxisAngle(r,e.t*Math.PI*2)}).repeat(1/0);t.eventMediator.on("start",function(){i.start()})}var s=e("random-seed").create("escher/fuller/moebius"),a=e("./lib/polyhedra"),c=e("./instanced-mesh"),l=(e("./crystal-gen"),e("./geometry-tools")),u=e("./materials");r.prototype.setVisible=function(e){this.group.visible=e},r.prototype.addStars=function(){for(var e=new THREE.BufferGeometry,t=new Float32Array(15e3),n=new Float32Array(5e3),r=new Float32Array(5e3),i=0;i<5e3;i++){var o=this.randomPointOnSphere(s.floatBetween(30,40),s.random);t[3*i+0]=o[0],t[3*i+1]=o[1],t[3*i+2]=o[2],n[i]=.05+.2*Math.pow(s.random(),4),r[i]=s.random()}e.addAttribute("position",new THREE.BufferAttribute(t,3)),e.addAttribute("aSize",new THREE.BufferAttribute(n,1)),e.addAttribute("aSeed",new THREE.BufferAttribute(r,1));var a=u.stars,e=new THREE.Points(e,a);this.group.add(e)},r.prototype.addPlanets=function(){var n=this,e=this.planetArrangements(),t=this.planetGeometries(),r=[],i=[],o=(e[0].forEach(function(e,t){(-1===[0,4,7,10,5,6].indexOf(t)?i:r).push(e)}),[]),a=[];e[2].forEach(function(e,t){(t%2==0?o:a).push(e)}),[{geometry:t.snowflakeSolid.geometry,material:u.planetSolid,objects:o.map(this.createPlanet.bind(this,{object:t.snowflakeSolid.object,size:[.75,2],dist:[10,15],speed:[5,2],variants:1}))},{geometry:t.snowballSolid.geometry,material:u.planetSolid,objects:a.map(this.createPlanet.bind(this,{object:t.snowballSolid.object,size:[.2,.4],dist:[10,15],speed:[10,5],variants:2})).concat(e[2].map(this.createPlanet.bind(this,{object:t.snowballSolid.object,size:[.2,.4],dist:[20,30],speed:[10,5],variants:2})))},{geometry:t.snowflakeWireframe.geometry,material:u.planetWireframe,objects:i.map(this.createPlanet.bind(this,{object:t.snowflakeWireframe.object,size:[6,9],dist:[20,30],speed:[1,.5],variants:2}))},{geometry:t.snowballSolid.geometry,material:u.planetBackground,objects:r.map(this.createPlanet.bind(this,{object:t.snowballSolid.object,size:[15,20],dist:[65,75],speed:[1,.5],variants:2}))}].forEach(function(e){var t=new c(e.geometry,e.material,e.objects),i=(n.group.add(t.mesh),e.material.transparent&&(t.mesh.renderOrder=-1),new THREE.Vector3(0,0,1)),o=new THREE.Quaternion,a=new THREE.Quaternion;t.mesh.onBeforeRender=function(){var n=this,r=.025*this.app.delta;e.objects.forEach(function(e){var t=Math.min(40*n.hyperMultiplier,500)*r;o.setFromAxisAngle(i,t+e.spec.rotateSpeed*r),a.setFromAxisAngle(i,t+e.spec.rotateSpeed*r*5),e.quaternion.multiply(o),e.updateMatrixWorld(!0),e.children&&e.children.forEach(function(e){e.quaternion.multiply(a)})}),t.update()}.bind(n)})},r.prototype.planetArrangements=function(){var n=this,e=a.archimedean.Icosidodecahedron,r=e.vertex.map(function(e){return(new THREE.Vector3).fromArray(e)}),t=[],i=e.face.reduce(function(e,t){return(e[t.length]=e[t.length]||[]).push(n.findFaceNormal(r,t)),e},{});return Object.keys(i).forEach(function(e){t.push(i[e])}),t.push(r.map(function(e){return e.normalize()})),t.sort(function(e,t){return e.length-t.length}),t},r.prototype.findFaceNormal=function(n,e){return e.reduce(function(e,t){return e.add(n[t])},new THREE.Vector3).normalize()},r.prototype.planetGeometries=function(){var i=this,e={},t=a.platonic.Dodecahedron,o=new THREE.Geometry,t=(o.vertices=t.vertex.map(function(e){return(new THREE.Vector3).fromArray(e)}),t.face.forEach(function(e){var t=o.vertices.length,n=i.findFaceNormal(o.vertices,e).multiplyScalar(1.9);o.vertices.push(n);for(var r=0;r<e.length;r++)o.faces.push(new THREE.Face3(e[r],e[(r+1)%e.length],t))}),o),t=(t.computeFlatVertexNormals(),(new THREE.BufferGeometry).fromGeometry(t)),n=(e.snowballSolid={geometry:t,object:new THREE.Object3D},new THREE.Object3D),t=(new THREE.IcosahedronGeometry(1).vertices.forEach(function(e){var t=new THREE.Object3D;t.lookAt(e),t.position.copy(e).multiplyScalar(.75),n.add(t)}),new THREE.OctahedronBufferGeometry),t=(t.scale(.2,.2,.5),e.snowflakeSolid={geometry:t,object:n},new THREE.OctahedronGeometry),t=(t.scale(.2,.2,.5),t=l.wireframeMesh(t,.002),(new THREE.BufferGeometry).fromGeometry(t));return e.snowflakeWireframe={geometry:t,object:n},e},r.prototype.createPlanet=function(e,t,n){var n=n%2==0?s.floatBetween(0,.5):s.floatBetween(.5,1),n=Math.pow(n,2),r=THREE.Math.lerp(e.size[0],e.size[1],n),n=THREE.Math.lerp(e.speed[0],e.speed[1],n),i=s.floatBetween(e.dist[0],e.dist[1]),i=t.clone().multiplyScalar(i),o=(new THREE.Vector3).fromArray(this.randomPointOnSphere(1,s.random)),t=(o.cross(t).normalize(),o.multiplyScalar(.3*e.dist[0]),i.add(o),new THREE.Euler(s.random()*Math.PI*2,s.random()*Math.PI,0)),o=e.object.clone();return o.position.copy(i),o.quaternion.setFromEuler(t),o.scale.set(r,r,r),o.spec={rotateSpeed:n,variant:s.intBetween(0,e.variants-1)},o},r.prototype.randomPointOnSphere=function(e,t){var n=t(),t=t(),n=2*Math.PI*n,t=Math.acos(2*t-1);return[e*Math.sin(t)*Math.cos(n),e*Math.sin(t)*Math.sin(n),e*Math.cos(t)]},t.exports=r},{"./crystal-gen":420,"./geometry-tools":423,"./instanced-mesh":426,"./lib/polyhedra":428,"./materials":433,"random-seed":405}],439:[function(e,t,n){function r(e,t){var n=this,r=new THREE.Group,i=(e.add(r),this.group=r,new u),o=new d(r,t,i),a=new h(r,t,i),i=new p(r,i,t),e=new f(e,t),s=new m(r,t),a=(this.container=a,this.containerBackground=o,this.soil=i,this.soilCursor=e,this.crystalPlanter=s,t.TWEEN),c=(r.scale.set(.001,.001,.001),new a.Tween(r.scale).to({x:1,y:1,z:1},1250).easing(a.Easing.Cubic.Out).onComplete(function(){t.eventMediator.emit("ready")})),l=(this.rotateLock=!0,r.rotation.y=-Math.PI,new a.Tween(r.rotation).to({y:0},1500).easing(a.Easing.Cubic.Out).onComplete(function(){n.rotateLock=!1}));t.eventMediator.on("start",function(){c.start(),l.start()})}var u=e("./container-geometry"),h=e("./container"),d=e("./container-background"),p=e("./soil"),f=e("./soil-cursor"),m=e("./crystal-planter");e("./materials");r.prototype.setRotation=function(e){this.rotateLock||(this.group.rotation.y=e%(2*Math.PI))},t.exports=r},{"./container":416,"./container-background":414,"./container-geometry":415,"./crystal-planter":421,"./materials":433,"./soil":437,"./soil-cursor":436}]},{},[1]);